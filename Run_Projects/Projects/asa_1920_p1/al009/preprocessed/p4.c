/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>


typedef struct 
{
  int id;
  int low;
  bool onStack;
  int grade;
  int nfriends;
  int *friends;
} Aluno;
Aluno *table;
int nalunos;
int namizades;
int id = 0;
int *stack;
int nstack = 0;
void inicialize_table();
void put_friendship(int first, int second);
void tarjan();
void tarjan_visit(int node);
void inicialize_stack();
void push_stack(int n);
int pop_stack();
int main()
{
  int i;
  nalunos = new_sym_var(sizeof(int) * 8);
  namizades = new_sym_var(sizeof(int) * 8);
  if ((nalunos < 2) || (namizades < 1))
  {
    exit(1);
  }
  else
  {
    
  }

  table = malloc((sizeof(Aluno)) * nalunos);
  inicialize_table();
  inicialize_stack();
  for (i = 0; i < nalunos; i++)
  {
    table[i].grade = new_sym_var(sizeof(int) * 8);
  }

  for (i = 0; i < namizades; i++)
  {
    int first;
    int second;
    first = new_sym_var(sizeof(int) * 8);
    second = new_sym_var(sizeof(int) * 8);
    put_friendship(first, second);
  }

  tarjan();
  for (i = 0; i < nalunos; i++)
  {
    printf("%d\n", table[i].grade);
  }

  free(table);
  free(stack);
  return 0;
}

void put_friendship(int a, int b)
{
  int i;
  int *new_friends;
  if (table[a - 1].nfriends == 0)
  {
    table[a - 1].friends = malloc(sizeof(int));
    table[a - 1].friends[0] = b - 1;
    table[a - 1].nfriends++;
  }
  else
  {
    table[a - 1].nfriends++;
    new_friends = malloc((sizeof(int)) * table[a - 1].nfriends);
    for (i = 0; i < (table[a - 1].nfriends - 1); i++)
      new_friends[i] = table[a - 1].friends[i];

    new_friends[i] = b - 1;
    table[a - 1].friends = new_friends;
  }

}

void inicialize_table()
{
  int i;
  for (i = 0; i < nalunos; i++)
  {
    table[i].id = -1;
    table[i].low = -1;
    table[i].onStack = false;
    table[i].nfriends = 0;
    table[i].friends = 0;
  }

}

void inicialize_stack()
{
  int i;
  stack = malloc((sizeof(int)) * nalunos);
  for (i = 0; i < nalunos; i++)
  {
    stack[i] = -1;
  }

}

void push_stack(int n)
{
  stack[nstack] = n;
  nstack++;
}

int pop_stack()
{
  nstack--;
  return stack[nstack];
}

void tarjan()
{
  int i;
  for (i = 0; i < nalunos; i++)
  {
    if (table[i].id == (-1))
    {
      tarjan_visit(i);
    }
    else
    {
      
    }

  }

}

void tarjan_visit(int node)
{
  int i;
  int friend;
  push_stack(node);
  table[node].onStack = true;
  table[node].id = id;
  table[node].low = id;
  id++;
  for (i = 0; i < table[node].nfriends; i++)
  {
    friend = table[node].friends[i];
    if (table[friend].id == (-1))
    {
      tarjan_visit(table[node].friends[i]);
      table[node].grade = (table[friend].grade > table[node].grade) ? (table[friend].grade) : (table[node].grade);
    }
    else
    {
      
    }

    if (table[table[node].friends[i]].onStack)
    {
      table[node].low = (table[friend].low < table[node].low) ? (table[friend].low) : (table[node].low);
      table[node].grade = (table[friend].grade > table[node].grade) ? (table[friend].grade) : (table[node].grade);
    }
    else
    {
      table[node].grade = (table[friend].grade > table[node].grade) ? (table[friend].grade) : (table[node].grade);
    }

  }

  if (table[node].id == table[node].low)
  {
    for (i = pop_stack();; i = pop_stack())
    {
      table[i].onStack = false;
      table[i].low = table[node].id;
      table[i].grade = (table[node].grade > table[i].grade) ? (table[node].grade) : (table[i].grade);
      if (i == node)
      {
        break;
      }
      else
      {
        
      }

    }

  }
  else
  {
    
  }

}

