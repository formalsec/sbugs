/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct aluno
{
  int index;
  int notaprev;
  int notarec;
  int *amigos;
  int numa;
  int marca;
} *alunos;
static alunos *listalunos;
alunos *inserir(char *buffer, char *bufferaux, int na, int nam, alunos *listalunos)
{
  char delim[] = "\n";
  char *token = strtok(buffer, delim);
  int a;
  int b;
  int i;
  int j;
  for (i = 0; i < na; i++)
  {
    token = strtok(0, delim);
    listalunos[i] = (alunos) malloc(sizeof(struct aluno));
    listalunos[i]->notaprev = atoi(token);
    listalunos[i]->notarec = 0;
    listalunos[i]->index = i;
    listalunos[i]->amigos = 0;
    listalunos[i]->numa = 0;
    listalunos[i]->marca = 1;
  }

  for (j = 0; j < nam; j++)
  {
    delim[0] = ' ';
    token = strtok(0, delim);
    a = atoi(token);
    a -= 1;
    delim[0] = '\n';
    token = strtok(0, delim);
    b = atoi(token);
    b -= 1;
    if (listalunos[a]->amigos == 0)
    {
      listalunos[a]->numa += 1;
      listalunos[a]->amigos = (int *) malloc(sizeof(int));
      listalunos[a]->amigos[0] = b;
    }
    else
    {
      listalunos[a]->numa += 1;
      listalunos[a]->amigos = (int *) realloc(listalunos[a]->amigos, (sizeof(int)) * listalunos[a]->numa);
      listalunos[a]->amigos[listalunos[a]->numa - 1] = b;
    }

  }

  return listalunos;
}

int recalcula(alunos aluno, int nota)
{
  int i;
  if (aluno->notarec > nota)
  {
    nota = aluno->notarec;
    return nota;
  }
  else
  {
    
  }

  if (aluno->marca)
  {
    if (aluno->notaprev > nota)
    {
      nota = aluno->notaprev;
    }
    else
    {
      
    }

    aluno->marca = 0;
    for (i = 0; i < aluno->numa; i++)
    {
      nota = recalcula(listalunos[aluno->amigos[i]], nota);
    }

  }
  else
  {
    
  }

  return nota;
}

int *contar(char *buf)
{
  int *nl = (int *) malloc((sizeof(int)) * 2);
  char delim[] = ",";
  char *token = strtok(buf, delim);
  token[strlen(token)] = '\0';
  nl[0] = atoi(token);
  delim[0] = '\n';
  token = strtok(0, delim);
  token[strlen(token)] = '\0';
  nl[1] = atoi(token);
  return nl;
}

int main()
{
  char *bufferaux;
  int *nl;
  char *buf;
  char *buff;
  int i = 0;
  int nota;
  int j;
  int l;
  int u;
  buf = (char *) malloc(10000000);
  buff = (char *) malloc(10000000);
  bufferaux = (char *) malloc(10000000);
  fgets(buf, 10000000, stdin);
  strcpy(buff, buf);
  nl = contar(buf);
  listalunos = (alunos *) malloc((sizeof(alunos)) * nl[0]);
  while (i < (nl[0] + nl[1]))
  {
    fgets(buf, 10000000, stdin);
    strcat(buff, buf);
    i++;
  }

  strcpy(bufferaux, buff);
  listalunos = inserir(buff, bufferaux, nl[0], nl[1], listalunos);
  for (j = 0; j < nl[0]; j++)
  {
    nota = listalunos[j]->notaprev;
    nota = recalcula(listalunos[j], nota);
    listalunos[j]->notarec = nota;
    for (u = 0; u < nl[0]; u++)
    {
      listalunos[u]->marca = 1;
    }

  }

  for (l = 0; l < nl[0]; l++)
  {
    printf("%d\n", listalunos[l]->notarec);
  }

  for (i = 0; i < nl[0]; i++)
  {
    free(listalunos[i]->amigos);
    free(listalunos[i]);
  }

  free(listalunos);
  free(nl);
  free(buf);
  free(buff);
  free(bufferaux);
  return 0;
}

