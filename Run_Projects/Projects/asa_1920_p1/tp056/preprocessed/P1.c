/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct Node
{
  int dest;
  int studentNumber;
  int averageGrade;
  struct Node *next;
} Node;
typedef struct Graph
{
  Node **head;
} Graph;
typedef struct Edge
{
  int src;
  int dest;
} Edge;
Node **nodes;
long int numberOfStudents = 0;
long int numberOfEdges = 0;
int *visited;
int *stack;
int top = 0;
int *grades;
Edge *edges;
void parseInput()
{
  long int e = 0;
  numberOfStudents = new_sym_var(sizeof(long int) * 8);
  numberOfEdges = new_sym_var(sizeof(long int) * 8);
  grades = malloc((sizeof(int)) * numberOfStudents);
  edges = malloc((sizeof(Edge)) * numberOfEdges);
  visited = malloc((sizeof(int)) * numberOfStudents);
  stack = malloc((sizeof(int)) * numberOfStudents);
  while (e < numberOfStudents)
  {
    grades[e] = new_sym_var(sizeof(int) * 8);
    e++;
  }

  e = 0;
  while (e < numberOfEdges)
  {
    edges[e].src = new_sym_var(sizeof(int) * 8);
    edges[e].dest = new_sym_var(sizeof(int) * 8);
    e++;
  }

}

Graph *createGraph()
{
  long int e;
  Graph *graph = (Graph *) malloc(sizeof(Graph));
  graph->head = malloc((sizeof(Node *)) * numberOfStudents);
  for (e = 0; e < numberOfStudents; e++)
  {
    graph->head[e] = 0;
  }

  for (e = 0; e < numberOfEdges; e++)
  {
    int src = edges[e].src - 1;
    int dest = edges[e].dest - 1;
    Node *newNode = malloc(sizeof(Node));
    newNode->next = graph->head[src];
    newNode->averageGrade = grades[src];
    newNode->studentNumber = src;
    newNode->dest = dest;
    graph->head[src] = newNode;
  }

  return graph;
}

Graph *createTransposeGraph()
{
  long int e;
  Graph *graph = (Graph *) malloc(sizeof(Graph));
  graph->head = malloc((sizeof(Node *)) * numberOfStudents);
  for (e = 0; e < numberOfStudents; e++)
  {
    graph->head[e] = 0;
  }

  for (e = 0; e < numberOfEdges; e++)
  {
    int src = edges[e].dest - 1;
    int dest = edges[e].src - 1;
    Node *newNode = malloc(sizeof(Node));
    newNode->next = graph->head[src];
    newNode->averageGrade = grades[src];
    newNode->studentNumber = src;
    newNode->dest = dest;
    graph->head[src] = newNode;
  }

  return graph;
}

void DFS(Graph *graph, int i)
{
  Node *p;
  p = graph->head[i];
  visited[i] = 1;
  while (p != 0)
  {
    i = p->dest;
    if (!visited[i])
    {
      DFS(graph, i);
    }
    else
    {
      
    }

    i = p->studentNumber;
    p = p->next;
  }

  stack[top++] = i;
}

void DFS1(Graph *graph, int i)
{
  Node *p;
  p = graph->head[i];
  visited[i] = 1;
  while (p != 0)
  {
    i = p->dest;
    if (grades[i] < grades[p->studentNumber])
    {
      grades[i] = grades[p->studentNumber];
      visited[i] = 0;
    }
    else
    {
      
    }

    if (!visited[i])
    {
      DFS1(graph, i);
    }
    else
    {
      
    }

    p = p->next;
  }

}

void printGrades()
{
  int e = 0;
  while (e < numberOfStudents)
  {
    printf("%d\n", grades[e]);
    e++;
  }

}

void freeMemory(Graph *graph, Graph *graphTransposed)
{
  int e;
  Node *p;
  Node *pAux;
  free(grades);
  free(edges);
  free(stack);
  free(visited);
  for (e = 0; e < numberOfStudents; e++)
  {
    p = graph->head[e];
    while (p != 0)
    {
      pAux = p;
      free(pAux);
      p = p->next;
    }

  }

  free(graph->head);
  free(graph);
  for (e = 0; e < numberOfStudents; e++)
  {
    p = graphTransposed->head[e];
    while (p != 0)
    {
      pAux = p;
      free(pAux);
      p = p->next;
    }

  }

  free(graphTransposed->head);
  free(graphTransposed);
}

int main()
{
  int e = 0;
  parseInput();
  Graph *graph = createGraph();
  Graph *graphTransposed = createTransposeGraph();
  for (e = 0; e < numberOfStudents; e++)
  {
    visited[e] = 0;
  }

  e = 0;
  while (e < numberOfStudents)
  {
    if (!visited[e])
    {
      DFS(graph, e);
    }
    else
    {
      
    }

    e++;
  }

  for (e = 0; e < numberOfStudents; e++)
  {
    visited[e] = 0;
  }

  e = 0;
  top--;
  while (e < numberOfStudents)
  {
    if (!visited[stack[top]])
    {
      DFS1(graphTransposed, stack[top]);
    }
    else
    {
      
    }

    e++;
    top--;
  }

  printGrades();
  freeMemory(graph, graphTransposed);
  return 0;
}

