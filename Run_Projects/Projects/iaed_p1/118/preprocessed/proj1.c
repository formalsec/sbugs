/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  char descricao[64];
  int preco;
  int peso;
  int stock;
  int id;
} produto;
int existe_produto_sistema(int identificador);
int verfica_stock_produto(int identificador, int quantidade);
void ordena(produto a[], int left, int right, int chave);
void copia_sistema(produto destino[]);
produto aux[10000];
produto sistema[10000];
int tamanho_sistema = 0;
int tamanho_encomenda[500];
produto encomendas[500][200];
int verifica_peso_encomenda(int identificador, int id_produto, int quantidade)
{
  int i;
  int peso_total = 0;
  for (i = 0; i < tamanho_encomenda[identificador]; i++)
  {
    peso_total += encomendas[identificador][i].peso * encomendas[identificador][i].stock;
  }

  if ((peso_total + (sistema[id_produto].peso * quantidade)) > 200)
  {
    return -1;
  }
  else
  {
    
  }

  return 1;
}

int existe_encomenda(int identificador)
{
  if (strcmp(encomendas[identificador][0].descricao, "\0") != 0)
  {
    return 1;
  }
  else
  {
    {
      return -1;
    }
  }

}

int procura_produto_encomenda(int id_produto, int id_encomenda)
{
  int i;
  for (i = 0; i < tamanho_encomenda[id_encomenda]; i++)
  {
    if (encomendas[id_encomenda][i].id == id_produto)
    {
      return i;
    }
    else
    {
      
    }

  }

  return -1;
}

void cria_encomenda()
{
  static int i = 0;
  strcpy(encomendas[i][0].descricao, "existe");
  printf("Nova encomenda %d.\n", i);
  i++;
}

void lista_produto_encomenda(int id_encomenda, int id_produto)
{
  int local;
  if (existe_encomenda(id_encomenda) == (-1))
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id_encomenda);
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto_sistema(id_produto) == (-1))
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", id_produto);
      return;
    }
  }
  else
  {
    
  }

  local = procura_produto_encomenda(id_produto, id_encomenda);
  if (local != (-1))
  {
    printf("%s %d.\n", encomendas[id_encomenda][local].descricao, encomendas[id_encomenda][local].stock);
  }
  else
  {
    {
      printf("%s %d.\n", sistema[id_produto].descricao, 0);
    }
  }

}

void lista_encomenda(int id)
{
  int i;
  if (existe_encomenda(id) == (-1))
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id);
      return;
    }
  }
  else
  {
    
  }

  ordena(encomendas[id], 0, tamanho_encomenda[id] - 1, 2);
  printf("Encomenda %d\n", id);
  for (i = 0; i < tamanho_encomenda[id]; i++)
  {
    if (encomendas[id][i].stock != 0)
    {
      {
        printf("* %s %d %d\n", encomendas[id][i].descricao, encomendas[id][i].preco, encomendas[id][i].stock);
      }
    }
    else
    {
      
    }

  }

}

void adicionar_produto_encomenda(int identificador_produto, int identificador_encomenda, int stock)
{
  int local;
  if (existe_encomenda(identificador_encomenda) == (-1))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", identificador_produto, identificador_encomenda);
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto_sistema(identificador_produto) == (-1))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", identificador_produto, identificador_encomenda);
      return;
    }
  }
  else
  {
    
  }

  if (verfica_stock_produto(identificador_produto, stock) == (-1))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", identificador_produto, identificador_encomenda);
      return;
    }
  }
  else
  {
    
  }

  if (verifica_peso_encomenda(identificador_encomenda, identificador_produto, stock) == (-1))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", identificador_produto, identificador_encomenda);
      return;
    }
  }
  else
  {
    
  }

  local = procura_produto_encomenda(identificador_produto, identificador_encomenda);
  if (local == (-1))
  {
    {
      encomendas[identificador_encomenda][tamanho_encomenda[identificador_encomenda]] = sistema[identificador_produto];
      encomendas[identificador_encomenda][tamanho_encomenda[identificador_encomenda]].stock = stock;
      tamanho_encomenda[identificador_encomenda]++;
    }
  }
  else
  {
    {
      encomendas[identificador_encomenda][local].stock += stock;
    }
  }

  sistema[identificador_produto].stock -= stock;
}

void remove_produto_encomenda(int id_encomenda, int id_produto)
{
  int local;
  if (existe_encomenda(id_encomenda) == (-1))
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", id_produto, id_encomenda);
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto_sistema(id_produto) == (-1))
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", id_produto, id_encomenda);
      return;
    }
  }
  else
  {
    
  }

  local = procura_produto_encomenda(id_produto, id_encomenda);
  if (local != (-1))
  {
    {
      sistema[id_produto].stock += encomendas[id_encomenda][local].stock;
      encomendas[id_encomenda][local].stock = 0;
    }
  }
  else
  {
    
  }

}

produto cria_produto(char descricao[], int preco, int peso, int stock, int id)
{
  produto novo;
  strcpy(novo.descricao, descricao);
  novo.peso = peso;
  novo.stock = stock;
  novo.preco = preco;
  novo.id = id;
  return novo;
}

int existe_produto_sistema(int identificador)
{
  if (sistema[identificador].peso != 0)
  {
    return 1;
  }
  else
  {
    {
      return -1;
    }
  }

}

int verfica_stock_produto(int identificador, int quantidade)
{
  if (sistema[identificador].stock >= quantidade)
  {
    return 1;
  }
  else
  {
    {
      return -1;
    }
  }

}

void lista_produtos_sistema()
{
  int i;
  produto copia[10000];
  copia_sistema(copia);
  ordena(copia, 0, tamanho_sistema - 1, 3);
  printf("Produtos\n");
  for (i = 0; i < tamanho_sistema; i++)
    printf("* %s %d %d\n", copia[i].descricao, copia[i].preco, copia[i].stock);

}

void adiciona_sistema(char descricao[], int preco, int peso, int stock)
{
  produto novo_produto;
  novo_produto = cria_produto(descricao, preco, peso, stock, tamanho_sistema);
  sistema[tamanho_sistema] = novo_produto;
  printf("Novo produto %d.\n", tamanho_sistema);
  tamanho_sistema++;
}

void adiciona_quantidade(int quantidade, int identificador)
{
  if (existe_produto_sistema(identificador) == 1)
  {
    sistema[identificador].stock += quantidade;
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", identificador);
    }
  }

}

void remove_stock_sistema(int id_produto, int stock)
{
  if (existe_produto_sistema(id_produto) == (-1))
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", id_produto);
      return;
    }
  }
  else
  {
    
  }

  if ((sistema[id_produto].stock - stock) < 0)
  {
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", stock, id_produto);
      return;
    }
  }
  else
  {
    
  }

  sistema[id_produto].stock -= stock;
}

void calcula_custo(int id_encomenda)
{
  int i;
  int custo_total = 0;
  if (existe_encomenda(id_encomenda) == (-1))
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", id_encomenda);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < tamanho_encomenda[id_encomenda]; i++)
    custo_total += encomendas[id_encomenda][i].preco * encomendas[id_encomenda][i].stock;

  printf("Custo da encomenda %d %d.\n", id_encomenda, custo_total);
}

void altera_preco(int id, int preco)
{
  int i;
  int local;
  if (existe_produto_sistema(id) == (-1))
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", id);
      return;
    }
  }
  else
  {
    
  }

  sistema[id].preco = preco;
  for (i = 0; (i < 500) && (existe_encomenda(i) != (-1)); i++)
  {
    local = procura_produto_encomenda(id, i);
    if (local != (-1))
    {
      encomendas[i][local].preco = preco;
    }
    else
    {
      
    }

  }

}

void copia_sistema(produto destino[])
{
  int i;
  for (i = 0; (i < 10000) && (i < tamanho_sistema); i++)
  {
    destino[i] = sistema[i];
  }

}

void maior_quantidade_encomenda(int id_produto)
{
  int i;
  int maior = -1;
  int quantidade = 0;
  int local = -1;
  if (existe_produto_sistema(id_produto) == (-1))
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", id_produto);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; (i < 500) && (existe_encomenda(i) != (-1)); i++)
  {
    local = procura_produto_encomenda(id_produto, i);
    if (local != (-1))
    {
      {
        if (encomendas[i][local].stock > quantidade)
        {
          {
            quantidade = encomendas[i][local].stock;
            maior = i;
          }
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

  if (maior != (-1))
  {
    printf("Maximo produto %d %d %d.\n", id_produto, maior, quantidade);
  }
  else
  {
    
  }

}

void merge(produto a[], int left, int m, int right, int chave)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
    if ((((chave == 3) && (aux[j].preco < aux[i].preco)) || ((chave == 2) && (strcmp(aux[j].descricao, aux[i].descricao) < 0))) || (i > m))
  {
    {
      a[k] = aux[j];
      j--;
    }
  }
  else
  {
    {
      a[k] = aux[i];
      i++;
    }
  }


}

void ordena(produto a[], int left, int right, int chave)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  ordena(a, left, m, chave);
  ordena(a, m + 1, right, chave);
  merge(a, left, m, right, chave);
}

int main()
{
  char c;
  char descricao[64];
  int peso;
  int preco;
  int stock;
  int identificador_produto;
  int identificador_encomenda;
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
      {
        for (int descricao_index = 0; descricao_index < 10; descricao_index++)
        {
          descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
        }

        descricao[10 - 1] = '\0';
        preco = new_sym_var(sizeof(int) * 8);
        peso = new_sym_var(sizeof(int) * 8);
        stock = new_sym_var(sizeof(int) * 8);
        adiciona_sistema(descricao, preco, peso, stock);
        break;
      }

      case 'q':
      {
        identificador_produto = new_sym_var(sizeof(int) * 8);
        stock = new_sym_var(sizeof(int) * 8);
        adiciona_quantidade(stock, identificador_produto);
        break;
      }

      case 'N':
      {
        cria_encomenda();
        break;
      }

      case 'A':
      {
        identificador_encomenda = new_sym_var(sizeof(int) * 8);
        identificador_produto = new_sym_var(sizeof(int) * 8);
        stock = new_sym_var(sizeof(int) * 8);
        adicionar_produto_encomenda(identificador_produto, identificador_encomenda, stock);
        break;
      }

      case 'r':
      {
        identificador_produto = new_sym_var(sizeof(int) * 8);
        stock = new_sym_var(sizeof(int) * 8);
        remove_stock_sistema(identificador_produto, stock);
        break;
      }

      case 'R':
      {
        identificador_encomenda = new_sym_var(sizeof(int) * 8);
        identificador_produto = new_sym_var(sizeof(int) * 8);
        remove_produto_encomenda(identificador_encomenda, identificador_produto);
        break;
      }

      case 'C':
      {
        identificador_encomenda = new_sym_var(sizeof(int) * 8);
        calcula_custo(identificador_encomenda);
        break;
      }

      case 'p':
      {
        identificador_produto = new_sym_var(sizeof(int) * 8);
        preco = new_sym_var(sizeof(int) * 8);
        altera_preco(identificador_produto, preco);
        break;
      }

      case 'E':
      {
        identificador_encomenda = new_sym_var(sizeof(int) * 8);
        identificador_produto = new_sym_var(sizeof(int) * 8);
        lista_produto_encomenda(identificador_encomenda, identificador_produto);
        break;
      }

      case 'm':
      {
        identificador_produto = new_sym_var(sizeof(int) * 8);
        maior_quantidade_encomenda(identificador_produto);
        break;
      }

      case 'l':
      {
        lista_produtos_sistema();
        break;
      }

      case 'L':
      {
        identificador_encomenda = new_sym_var(sizeof(int) * 8);
        lista_encomenda(identificador_encomenda);
        break;
      }

    }

  }

  return 0;
}

