/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


struct produto
{
  int ident;
  char desc[64];
  int preco;
  int peso;
  int quant;
};
struct encomenda
{
  struct produto encomenda_produtos[10000];
  int peso;
  int preco_total;
  int numero_produtos;
};
void a(int contador, struct produto tabela_produtos[10000]);
void q(int contador, struct produto tabela_produtos[10000]);
void N(int contador_encomendas);
void A(int contador_encomendas, int contador, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000]);
void r(int contador, struct produto tabela_produtos[10000]);
void R(int contador, int contador_encomendas, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000]);
void C(int contador_encomendas, struct encomenda tabela_encomendas[500]);
void p(int contador, int contador_encomendas, struct produto tabela_produtos[10000], struct encomenda tabela_encomendas[500]);
void E(int contador, int contador_encomendas, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000]);
void m(int contador_encomendas, int contador, struct encomenda tabela_encomendas[500]);
void l(int contador, struct produto tabela_produtos[10000]);
void L(int contador_encomendas, struct encomenda tabela_encomendas[500]);
struct encomenda tabela_encomendas[500];
int main()
{
  struct produto tabela_produtos[10000];
  char c;
  int contador = 0;
  int contador_encomendas = 0;
  while ((c = getchar()) != 'x')
  {
    if (c == 'a')
    {
      {
        a(contador, tabela_produtos);
        contador++;
      }
    }
    else
    {
      if (c == 'q')
      {
        {
          q(contador, tabela_produtos);
        }
      }
      else
      {
        if (c == 'N')
        {
          {
            N(contador_encomendas);
            contador_encomendas++;
          }
        }
        else
        {
          if (c == 'A')
          {
            {
              A(contador_encomendas, contador, tabela_encomendas, tabela_produtos);
            }
          }
          else
          {
            if (c == 'r')
            {
              {
                r(contador, tabela_produtos);
              }
            }
            else
            {
              if (c == 'R')
              {
                {
                  R(contador, contador_encomendas, tabela_encomendas, tabela_produtos);
                }
              }
              else
              {
                if (c == 'C')
                {
                  {
                    C(contador_encomendas, tabela_encomendas);
                  }
                }
                else
                {
                  if (c == 'p')
                  {
                    {
                      p(contador, contador_encomendas, tabela_produtos, tabela_encomendas);
                    }
                  }
                  else
                  {
                    if (c == 'E')
                    {
                      {
                        E(contador, contador_encomendas, tabela_encomendas, tabela_produtos);
                      }
                    }
                    else
                    {
                      if (c == 'm')
                      {
                        {
                          m(contador_encomendas, contador, tabela_encomendas);
                        }
                      }
                      else
                      {
                        if (c == 'l')
                        {
                          {
                            l(contador, tabela_produtos);
                          }
                        }
                        else
                        {
                          if (c == 'L')
                          {
                            {
                              L(contador_encomendas, tabela_encomendas);
                            }
                          }
                          else
                          {
                            continue;
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

  }

  return 0;
}

void a(int contador, struct produto tabela_produtos[10000])
{
  char c;
  int i = 0;
  getchar();
  while (((c = getchar()) != ':') || (i > 64))
  {
    tabela_produtos[contador].desc[i] = c;
    i++;
  }

  tabela_produtos[contador].desc[i] = '\0';
  tabela_produtos[contador].ident = contador;
  tabela_produtos[contador].preco = new_sym_var(sizeof(int) * 8);
  tabela_produtos[contador].peso = new_sym_var(sizeof(int) * 8);
  tabela_produtos[contador].quant = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", contador);
}

void q(int contador, struct produto tabela_produtos[10000])
{
  int idp;
  int qnt;
  getchar();
  idp = new_sym_var(sizeof(int) * 8);
  qnt = new_sym_var(sizeof(int) * 8);
  if (idp >= contador)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      tabela_produtos[idp].quant += qnt;
    }
  }

}

void N(int contador_encomendas)
{
  printf("Nova encomenda %d.\n", contador_encomendas);
}

void A(int contador_encomendas, int contador, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000])
{
  int ide;
  int idp;
  int qtd;
  int i;
  int x;
  x = -1;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp >= contador)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      if (tabela_produtos[idp].quant < qtd)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        }
      }
      else
      {
        if ((tabela_encomendas[ide].peso + (tabela_produtos[idp].peso * qtd)) > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
          }
        }
        else
        {
          {
            for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
            {
              if (tabela_encomendas[ide].encomenda_produtos[i].ident == idp)
              {
                {
                  x = i;
                  break;
                }
              }
              else
              {
                
              }

            }

            if (x != (-1))
            {
              {
                tabela_encomendas[ide].encomenda_produtos[x].quant += qtd;
                tabela_produtos[idp].quant -= qtd;
                tabela_encomendas[ide].peso += tabela_produtos[idp].peso * qtd;
                tabela_encomendas[ide].preco_total += tabela_produtos[idp].preco * qtd;
              }
            }
            else
            {
              {
                tabela_encomendas[ide].encomenda_produtos[tabela_encomendas[ide].numero_produtos].ident = idp;
                tabela_encomendas[ide].encomenda_produtos[tabela_encomendas[ide].numero_produtos].peso = tabela_produtos[idp].peso;
                tabela_encomendas[ide].encomenda_produtos[tabela_encomendas[ide].numero_produtos].preco = tabela_produtos[idp].preco;
                strcpy(tabela_encomendas[ide].encomenda_produtos[tabela_encomendas[ide].numero_produtos].desc, tabela_produtos[idp].desc);
                tabela_encomendas[ide].encomenda_produtos[tabela_encomendas[ide].numero_produtos].quant = qtd;
                tabela_produtos[idp].quant -= qtd;
                tabela_encomendas[ide].peso += tabela_produtos[idp].peso * qtd;
                tabela_encomendas[ide].preco_total += tabela_produtos[idp].preco * qtd;
                tabela_encomendas[ide].numero_produtos++;
              }
            }

          }
        }

      }

    }

  }

}

void r(int contador, struct produto tabela_produtos[10000])
{
  int idp;
  int qtd;
  getchar();
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= contador)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    if ((tabela_produtos[idp].quant - qtd) < 0)
    {
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      }
    }
    else
    {
      {
        tabela_produtos[idp].quant -= qtd;
      }
    }

  }

}

void R(int contador, int contador_encomendas, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000])
{
  int ide;
  int idp;
  int i;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp >= contador)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      {
        for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
        {
          if (tabela_encomendas[ide].encomenda_produtos[i].ident == idp)
          {
            {
              tabela_encomendas[ide].peso -= tabela_encomendas[ide].encomenda_produtos[i].peso * tabela_encomendas[ide].encomenda_produtos[i].quant;
              tabela_encomendas[ide].preco_total -= tabela_encomendas[ide].encomenda_produtos[i].preco * tabela_encomendas[ide].encomenda_produtos[i].quant;
              tabela_produtos[idp].quant += tabela_encomendas[ide].encomenda_produtos[i].quant;
              tabela_encomendas[ide].encomenda_produtos[i].quant = 0;
              break;
            }
          }
          else
          {
            
          }

        }

      }
    }

  }

}

void C(int contador_encomendas, struct encomenda tabela_encomendas[500])
{
  int ide;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      printf("Custo da encomenda %d %d.\n", ide, tabela_encomendas[ide].preco_total);
    }
  }

}

void p(int contador, int contador_encomendas, struct produto tabela_produtos[10000], struct encomenda tabela_encomendas[500])
{
  int idp;
  int preco;
  int i;
  int j;
  getchar();
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= contador)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      tabela_produtos[idp].preco = preco;
      for (i = 0; i < contador_encomendas; i++)
      {
        for (j = 0; j < tabela_encomendas[i].numero_produtos; j++)
        {
          if (tabela_encomendas[i].encomenda_produtos[j].ident == idp)
          {
            {
              tabela_encomendas[i].preco_total -= tabela_encomendas[i].encomenda_produtos[j].preco * tabela_encomendas[i].encomenda_produtos[j].quant;
              tabela_encomendas[i].encomenda_produtos[j].preco = preco;
              tabela_encomendas[i].preco_total += tabela_encomendas[i].encomenda_produtos[j].preco * tabela_encomendas[i].encomenda_produtos[j].quant;
            }
          }
          else
          {
            
          }

        }

      }

    }
  }

}

void E(int contador, int contador_encomendas, struct encomenda tabela_encomendas[500], struct produto tabela_produtos[10000])
{
  int ide;
  int idp;
  int i;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    if (idp >= contador)
    {
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      }
    }
    else
    {
      {
        for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
        {
          if (tabela_encomendas[ide].encomenda_produtos[i].ident == idp)
          {
            {
              printf("%s %d.\n", tabela_encomendas[ide].encomenda_produtos[i].desc, tabela_encomendas[ide].encomenda_produtos[i].quant);
              i = -1;
              break;
            }
          }
          else
          {
            
          }

        }

        if (i != (-1))
        {
          {
            printf("%s 0.\n", tabela_produtos[idp].desc);
          }
        }
        else
        {
          
        }

      }
    }

  }

}

void m(int contador_encomendas, int contador, struct encomenda tabela_encomendas[500])
{
  int idp;
  int i;
  int j;
  int qtd_max;
  int cont_max;
  qtd_max = 0;
  cont_max = -1;
  getchar();
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= contador)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      for (i = 0; i < contador_encomendas; i++)
      {
        for (j = 0; j < tabela_encomendas[i].numero_produtos; j++)
        {
          if (tabela_encomendas[i].encomenda_produtos[j].ident == idp)
          {
            {
              if (tabela_encomendas[i].encomenda_produtos[j].quant > qtd_max)
              {
                {
                  qtd_max = tabela_encomendas[i].encomenda_produtos[j].quant;
                  cont_max = i;
                }
              }
              else
              {
                
              }

              break;
            }
          }
          else
          {
            
          }

        }

      }

      if ((qtd_max > 0) && (cont_max > (-1)))
      {
        printf("Maximo produto %d %d %d.\n", idp, cont_max, qtd_max);
      }
      else
      {
        
      }

    }
  }

}

void merge(int *aux, int *p, int l, int m, int r, struct produto tabela_produtos[10000])
{
  int i;
  int j;
  int k;
  int x;
  i = l;
  j = m + 1;
  k = l;
  while ((i <= m) && (j <= r))
  {
    if (tabela_produtos[p[i]].preco <= tabela_produtos[p[j]].preco)
    {
      {
        aux[k] = p[i];
        i++;
      }
    }
    else
    {
      {
        aux[k] = p[j];
        j++;
      }
    }

    k++;
  }

  while (i <= m)
  {
    aux[k] = p[i];
    i++;
    k++;
  }

  while (j <= r)
  {
    aux[k] = p[j];
    j++;
    k++;
  }

  for (x = l; x <= r; x++)
    p[x] = aux[x];

}

void mergeSort(int *aux, int *p, int l, int r, struct produto tabela_produtos[10000])
{
  if (l < r)
  {
    {
      int m = (l + r) / 2;
      mergeSort(aux, p, l, m, tabela_produtos);
      mergeSort(aux, p, m + 1, r, tabela_produtos);
      merge(aux, p, l, m, r, tabela_produtos);
    }
  }
  else
  {
    
  }

}

void l(int contador, struct produto tabela_produtos[10000])
{
  int p[10000];
  int aux[10000];
  int i;
  if (contador == 0)
  {
    {
      printf("Produtos\n");
    }
  }
  else
  {
    {
      for (i = 0; i < contador; i++)
      {
        p[i] = tabela_produtos[i].ident;
      }

      mergeSort(aux, p, 0, contador - 1, tabela_produtos);
      printf("Produtos\n");
      for (i = 0; i < contador; i++)
      {
        printf("* %s %d %d\n", tabela_produtos[p[i]].desc, tabela_produtos[p[i]].preco, tabela_produtos[p[i]].quant);
      }

    }
  }

}

void L(int contador_encomendas, struct encomenda tabela_encomendas[500])
{
  int ide;
  int i;
  int j;
  char tab[10000][64];
  char temp[64];
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    if (tabela_encomendas[ide].numero_produtos == 0)
    {
      {
        printf("Encomenda %d\n", ide);
      }
    }
    else
    {
      {
        for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
        {
          strcpy(tab[i], tabela_encomendas[ide].encomenda_produtos[i].desc);
        }

        for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
        {
          for (j = i + 1; j < tabela_encomendas[ide].numero_produtos; j++)
          {
            if (strcmp(tab[i], tab[j]) > 0)
            {
              {
                strcpy(temp, tab[i]);
                strcpy(tab[i], tab[j]);
                strcpy(tab[j], temp);
              }
            }
            else
            {
              
            }

          }

        }

        printf("Encomenda %d\n", ide);
        for (i = 0; i < tabela_encomendas[ide].numero_produtos; i++)
        {
          for (j = 0; j < tabela_encomendas[ide].numero_produtos; j++)
          {
            if ((strcmp(tabela_encomendas[ide].encomenda_produtos[j].desc, tab[i]) == 0) && (tabela_encomendas[ide].encomenda_produtos[j].quant > 0))
            {
              {
                printf("* %s %d %d\n", tab[i], tabela_encomendas[ide].encomenda_produtos[j].preco, tabela_encomendas[ide].encomenda_produtos[j].quant);
              }
            }
            else
            {
              
            }

          }

        }

      }
    }

  }

}

