/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct Produto
{
  int identificador;
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
} Produto;
typedef struct Encomenda
{
  int ide;
  int tabela[10000];
} Encomenda;
int a(Produto sistema[]);
int q(Produto sistema[]);
int N(Encomenda encomendas[]);
int A(Encomenda encomendas[], Produto sistema[]);
int r(Produto sistema[]);
int R(Encomenda encomendas[]);
int C(Encomenda encomendas[], Produto sistema[]);
int p(Produto sistema[]);
int E(Encomenda encomendas[], Produto sistema[]);
int m(Encomenda encomendas[]);
int l(Produto sistema[], Produto auxiliar[]);
int L(Encomenda encomendas[], Produto sistema[], Produto auxiliar[]);
void copia(Produto sistema[], Produto auxiliar[]);
void mergesort_L(Produto auxiliar[], int left, int right);
void merge_L(Produto auxiliar[], int left, int m, int right);
void mergesort_l(Produto auxiliar[], int left, int right);
void merge_l(Produto auxiliar[], int left, int m, int right);
Produto sistema[10000];
Encomenda encomendas[500];
Produto auxiliar[10000];
int num_produtos = 0;
int num_encomendas = 0;
int main()
{
  char c;
  encomendas[0].ide = -1;
  sistema[0].identificador = -1;
  c = getchar();
  while (c != 'x')
  {
    switch (c)
    {
      case 'a':
        a(sistema);
        num_produtos++;
        break;

      case 'q':
        q(sistema);
        break;

      case 'N':
        N(encomendas);
        num_encomendas++;
        break;

      case 'A':
        A(encomendas, sistema);
        break;

      case 'r':
        r(sistema);
        break;

      case 'R':
        R(encomendas);
        break;

      case 'C':
        C(encomendas, sistema);
        break;

      case 'p':
        p(sistema);
        break;

      case 'E':
        E(encomendas, sistema);
        break;

      case 'm':
        m(encomendas);
        break;

      case 'l':
        l(sistema, auxiliar);
        break;

      case 'L':
        L(encomendas, sistema, auxiliar);
        break;

    }

    c = getchar();
  }

  return 0;
}

int a(Produto sistema[])
{
  static int i1 = 0;
  if (i1 < 10000)
  {
    for (int sistema_index = 0; sistema_index < 10; sistema_index++)
    {
      sistema[i1].descricao[sistema_index] = new_sym_var(sizeof(char) * 8);
    }

    sistema[i1].descricao[10 - 1] = '\0';
    sistema[i1].preco = new_sym_var(sizeof(int) * 8);
    sistema[i1].peso = new_sym_var(sizeof(int) * 8);
    sistema[i1].quantidade = new_sym_var(sizeof(int) * 8);
    sistema[i1].identificador = i1;
    printf("Novo produto %d.\r\n", i1);
  }
  else
  {
    
  }

  return i1++;
}

int q(Produto sistema[])
{
  int idp;
  int qtd;
  int i2;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if ((idp == 0) && (sistema[0].identificador == (-1)))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\r\n", idp);
    return 0;
  }
  else
  {
    
  }

  for (i2 = 0; i2 < 10000; i2++)
  {
    if (sistema[i2].identificador == idp)
    {
      sistema[i2].quantidade = sistema[i2].quantidade + qtd;
      return 0;
    }
    else
    {
      
    }

  }

  printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\r\n", idp);
  return 0;
}

int N(Encomenda encomendas[])
{
  static int i3 = 0;
  if (i3 < 500)
  {
    printf("Nova encomenda %d.\r\n", i3);
    encomendas[i3].ide = i3;
  }
  else
  {
    
  }

  return i3++;
}

int A(Encomenda encomendas[], Produto sistema[])
{
  int ide;
  int idp;
  int qtd;
  int i4;
  int pesototal = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= num_produtos)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\r\n", idp, ide);
    return 0;
  }
  else
  {
    
  }

  if (ide >= num_encomendas)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\r\n", idp, ide);
    return 0;
  }
  else
  {
    
  }

  for (i4 = 0; i4 < num_produtos; i4++)
  {
    pesototal = pesototal + (encomendas[ide].tabela[i4] * sistema[i4].peso);
  }

  if (sistema[idp].quantidade >= qtd)
  {
    if (((qtd * sistema[idp].peso) + pesototal) <= 200)
    {
      pesototal = pesototal + (qtd * sistema[idp].peso);
      encomendas[ide].tabela[idp] = encomendas[ide].tabela[idp] + qtd;
      sistema[idp].quantidade = sistema[idp].quantidade - qtd;
      return 0;
    }
    else
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\r\n", idp, ide);
      return 0;
    }

  }
  else
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\r\n", idp, ide);
    return 0;
  }

}

int r(Produto sistema[])
{
  int i5;
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  for (i5 = 0; i5 <= num_produtos; i5++)
  {
    if (sistema[i5].identificador == idp)
    {
      if ((sistema[i5].quantidade - qtd) >= 0)
      {
        sistema[i5].quantidade = sistema[i5].quantidade - qtd;
        return 0;
      }
      else
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\r\n", qtd, idp);
        return 0;
      }

    }
    else
    {
      if (sistema[i5].identificador != idp)
      {
        if (i5 == num_produtos)
        {
          printf("Impossivel remover stock do produto %d. Produto inexistente.\r\n", idp);
          return 0;
        }
        else
        {
          
        }

        continue;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int R(Encomenda encomendas[])
{
  int ide;
  int idp;
  int i6;
  int j6;
  int remover;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  for (i6 = 0; i6 <= num_encomendas; i6++)
  {
    if (encomendas[i6].ide == ide)
    {
      for (j6 = 0; j6 <= num_produtos; j6++)
      {
        if (sistema[j6].identificador == idp)
        {
          remover = encomendas[i6].tabela[j6];
          encomendas[i6].tabela[j6] = 0;
          sistema[idp].quantidade = sistema[idp].quantidade + remover;
          return 0;
        }
        else
        {
          if (sistema[j6].identificador != idp)
          {
            if (j6 == num_produtos)
            {
              printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\r\n", idp, ide);
              return 0;
            }
            else
            {
              
            }

            continue;
          }
          else
          {
            
          }

        }

      }

    }
    else
    {
      if (encomendas[i6].ide != ide)
      {
        if (i6 == num_encomendas)
        {
          printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\r\n", idp, ide);
          return 0;
        }
        else
        {
          
        }

        continue;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int C(Encomenda encomendas[], Produto sistema[])
{
  int i7;
  int j7;
  int ide;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  for (i7 = 0; i7 <= num_encomendas; i7++)
  {
    if (encomendas[i7].ide == ide)
    {
      for (j7 = 0; j7 < num_produtos; j7++)
      {
        if (encomendas[i7].tabela[j7] != 0)
        {
          custo = custo + (encomendas[i7].tabela[j7] * sistema[j7].preco);
        }
        else
        {
          
        }

      }

      printf("Custo da encomenda %d %d.\r\n", ide, custo);
      return 0;
    }
    else
    {
      if (encomendas[i7].ide != ide)
      {
        if (i7 == num_encomendas)
        {
          printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\r\n", ide);
          return 0;
        }
        else
        {
          
        }

        continue;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int p(Produto sistema[])
{
  int i8;
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  for (i8 = 0; i8 <= num_produtos; i8++)
  {
    if (sistema[i8].identificador == idp)
    {
      sistema[i8].preco = preco;
      return 0;
    }
    else
    {
      if (sistema[i8].identificador != idp)
      {
        if (i8 == num_produtos)
        {
          printf("Impossivel alterar preco do produto %d. Produto inexistente.\r\n", idp);
          return 0;
        }
        else
        {
          
        }

        continue;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int E(Encomenda encomendas[], Produto sistema[])
{
  int i9;
  int j9 = 0;
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if ((idp == 0) && (sistema[0].identificador == (-1)))
  {
    printf("Impossivel listar produto %d. Produto inexistente.\r\n", idp);
    return 0;
  }
  else
  {
    
  }

  for (i9 = 0; i9 <= num_encomendas; i9++)
  {
    if (encomendas[i9].ide == ide)
    {
      for (j9 = 0; j9 <= num_produtos; j9++)
      {
        if (sistema[j9].identificador == idp)
        {
          printf("%s %d.\r\n", sistema[j9].descricao, encomendas[i9].tabela[idp]);
          return 0;
        }
        else
        {
          if (sistema[j9].identificador != idp)
          {
            if (j9 == num_produtos)
            {
              printf("Impossivel listar produto %d. Produto inexistente.\r\n", idp);
              return 0;
            }
            else
            {
              
            }

            continue;
          }
          else
          {
            
          }

        }

      }

    }
    else
    {
      if (encomendas[i9].ide != ide)
      {
        if (i9 == num_encomendas)
        {
          printf("Impossivel listar encomenda %d. Encomenda inexistente.\r\n", ide);
          return 0;
        }
        else
        {
          
        }

        continue;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int m(Encomenda encomendas[])
{
  int idp;
  int i;
  int maior = 0;
  int idefinal = 0;
  int idpexiste = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= num_produtos)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\r\n", idp);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < num_encomendas; i++)
  {
    if (encomendas[i].tabela[idp] > maior)
    {
      maior = encomendas[i].tabela[idp];
      idefinal = i;
      idpexiste++;
    }
    else
    {
      
    }

  }

  if (idpexiste != 0)
  {
    printf("Maximo produto %d %d %d.\r\n", idp, idefinal, maior);
    return 0;
  }
  else
  {
    if (idpexiste == 0)
    {
      return 0;
    }
    else
    {
      
    }

  }

  return 0;
}

int l(Produto sistema[], Produto auxiliar[])
{
  int i;
  int left = 0;
  int right = num_produtos;
  copia(sistema, auxiliar);
  mergesort_l(auxiliar, left, right - 1);
  printf("Produtos\r\n");
  for (i = left; i < right; i++)
  {
    if (auxiliar[i].preco != 0)
    {
      printf("* %s %d %d\r\n", auxiliar[i].descricao, auxiliar[i].preco, auxiliar[i].quantidade);
    }
    else
    {
      
    }

  }

  return 0;
}

int L(Encomenda encomendas[], Produto sistema[], Produto auxiliar[])
{
  int ide;
  int i;
  int left = 0;
  int right = num_produtos;
  ide = new_sym_var(sizeof(int) * 8);
  if ((ide == 0) && (encomendas[0].ide == (-1)))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\r\n", ide);
    return 0;
  }
  else
  {
    
  }

  if (ide >= num_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\r\n", ide);
    return 0;
  }
  else
  {
    
  }

  copia(sistema, auxiliar);
  mergesort_L(auxiliar, left, right - 1);
  printf("Encomenda %d\r\n", ide);
  for (i = 0; i < num_produtos; i++)
  {
    if ((encomendas[ide].tabela[auxiliar[i].identificador] != 0) && (auxiliar[i].preco != 0))
    {
      printf("* %s %d %d\r\n", auxiliar[i].descricao, auxiliar[i].preco, encomendas[ide].tabela[auxiliar[i].identificador]);
    }
    else
    {
      
    }

  }

  return 0;
}

void copia(Produto sistema[], Produto auxiliar[])
{
  int i;
  for (i = 0; i < num_produtos; i++)
  {
    auxiliar[i] = sistema[i];
  }

}

void mergesort_L(Produto auxiliar[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_L(auxiliar, left, m);
  mergesort_L(auxiliar, m + 1, right);
  merge_L(auxiliar, left, m, right);
}

void merge_L(Produto auxiliar[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  Produto aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = auxiliar[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = auxiliar[j + 1];

  for (k = left; k <= right; k++)
  {
    if (strcmp(aux[j].descricao, aux[i].descricao) < 0)
    {
      auxiliar[k] = aux[j--];
    }
    else
    {
      auxiliar[k] = aux[i++];
    }

  }

}

void mergesort_l(Produto auxiliar[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_l(auxiliar, left, m);
  mergesort_l(auxiliar, m + 1, right);
  merge_l(auxiliar, left, m, right);
}

void merge_l(Produto auxiliar[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  Produto aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = auxiliar[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = auxiliar[j + 1];

  for (k = left; k <= right; k++)
  {
    if (aux[j].preco < aux[i].preco)
    {
      auxiliar[k] = aux[j--];
    }
    else
    {
      if (aux[j].preco == aux[i].preco)
      {
        if (aux[j].identificador < aux[i].identificador)
        {
          auxiliar[k] = aux[j--];
        }
        else
        {
          auxiliar[k] = aux[i++];
        }

      }
      else
      {
        auxiliar[k] = aux[i++];
      }

    }

  }

}

