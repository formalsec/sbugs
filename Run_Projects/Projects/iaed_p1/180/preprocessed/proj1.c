/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


int ide = 0;
int idp = 0;
typedef struct 
{
  int preco;
  int peso;
  int qtd;
  char descricao[63];
} Produto;
Produto produto[10000];
typedef struct 
{
  Produto prod[10000];
  int peso_total;
  int preco_total;
  int n_menor;
  int n_maior;
  int n_prod;
} Encomenda;
Encomenda encomenda[500];
void adiciona_produto()
{
  for (int produto_index = 0; produto_index < 10; produto_index++)
  {
    produto[idp].descricao[produto_index] = new_sym_var(sizeof(char) * 8);
  }

  produto[idp].descricao[10 - 1] = '\0';
  produto[idp].preco = new_sym_var(sizeof(int) * 8);
  produto[idp].peso = new_sym_var(sizeof(int) * 8);
  produto[idp].qtd = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", idp);
  ++idp;
}

void adiciona_stock()
{
  int num1;
  int qtd;
  num1 = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (num1 >= idp)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", num1);
  }
  else
  {
    produto[num1].qtd = produto[num1].qtd + qtd;
  }

}

void cria_encomenda()
{
  printf("Nova encomenda %d.\n", ide);
  ++ide;
  encomenda[ide].n_menor = 9999;
  encomenda[ide].n_maior = 0;
  encomenda[ide].n_prod = 0;
}

void adiciona_encomenda()
{
  int num1;
  int num2;
  int qtd;
  num2 = new_sym_var(sizeof(int) * 8);
  num1 = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (num2 >= ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", num1, num2);
  }
  else
  {
    if (num1 >= idp)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", num1, num2);
    }
    else
    {
      if (qtd > produto[num1].qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", num1, num2);
      }
      else
      {
        if ((encomenda[num2].peso_total + (produto[num1].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", num1, num2);
        }
        else
        {
          encomenda[num2].prod[num1].qtd = encomenda[num2].prod[num1].qtd + qtd;
          produto[num1].qtd = produto[num1].qtd - qtd;
          encomenda[num2].peso_total = (produto[num1].peso * qtd) + encomenda[num2].peso_total;
          if (num1 > encomenda[num2].n_maior)
          {
            encomenda[num2].n_maior = num1;
          }
          else
          {
            
          }

          if (num1 < encomenda[num2].n_menor)
          {
            encomenda[num2].n_menor = num1;
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void remove_stock()
{
  int num1;
  int qtd;
  num1 = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (num1 >= idp)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", num1);
  }
  else
  {
    if (qtd > produto[num1].qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, num1);
    }
    else
    {
      produto[num1].qtd = produto[num1].qtd - qtd;
    }

  }

}

void remove_produto()
{
  int num1;
  int num2;
  num2 = new_sym_var(sizeof(int) * 8);
  num1 = new_sym_var(sizeof(int) * 8);
  if (num2 >= ide)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", num1, num2);
  }
  else
  {
    if (num1 >= idp)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", num1, num2);
    }
    else
    {
      produto[num1].qtd = produto[num1].qtd + encomenda[num2].prod[num1].qtd;
      encomenda[num2].peso_total = encomenda[num2].peso_total - (encomenda[num2].prod[num1].qtd * produto[num1].peso);
      encomenda[num2].prod[num1].qtd = 0;
    }

  }

}

void calcula_custo()
{
  int i;
  int num2;
  num2 = new_sym_var(sizeof(int) * 8);
  if (num2 >= ide)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", num2);
  }
  else
  {
    encomenda[num2].preco_total = 0;
    for (i = 0; i < idp; i++)
    {
      encomenda[num2].preco_total = encomenda[num2].preco_total + (produto[i].preco * encomenda[num2].prod[i].qtd);
    }

    printf("Custo da encomenda %d %d.\n", num2, encomenda[num2].preco_total);
  }

}

void altera_preco()
{
  int i;
  int num1;
  int preco;
  num1 = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (num1 >= idp)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", num1);
  }
  else
  {
    produto[num1].preco = preco;
    for (i = 0; i < ide; i++)
    {
      encomenda[i].prod[num1].preco = preco;
    }

  }

}

void lista()
{
  int num1;
  int num2;
  num2 = new_sym_var(sizeof(int) * 8);
  num1 = new_sym_var(sizeof(int) * 8);
  if (num2 >= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", num2);
  }
  else
  {
    if (num1 >= idp)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", num1);
    }
    else
    {
      printf("%s %d.\n", produto[num1].descricao, encomenda[num2].prod[num1].qtd);
    }

  }

}

void lista_identificador()
{
  int i;
  int num1;
  int num_encomenda;
  int maior_qtd = 0;
  num1 = new_sym_var(sizeof(int) * 8);
  if (num1 >= idp)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", num1);
  }
  else
  {
    for (i = 0; i < ide; i++)
    {
      if (encomenda[i].prod[num1].qtd > maior_qtd)
      {
        maior_qtd = encomenda[i].prod[num1].qtd;
        num_encomenda = i;
      }
      else
      {
        
      }

    }

    if ((ide != 0) && (maior_qtd != 0))
    {
      printf("Maximo produto %d %d %d.\n", num1, num_encomenda, maior_qtd);
    }
    else
    {
      
    }

  }

}

void merge(int a[10000], int left, int m, int right)
{
  int i;
  int j;
  int k;
  int aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
    if ((produto[aux[j]].preco < produto[aux[i]].preco) || (i > m))
  {
    a[k] = aux[j--];
  }
  else
  {
    a[k] = aux[i++];
  }


}

void mergesort(int a[10000], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, left, m);
  mergesort(a, m + 1, right);
  merge(a, left, m, right);
}

void lista_stock()
{
  int i;
  int a[10000];
  for (i = 0; i < idp; i++)
  {
    a[i] = i;
  }

  mergesort(a, 0, idp - 1);
  printf("Produtos\n");
  for (i = 0; i < idp; i++)
  {
    printf("* %s %d %d\n", produto[a[i]].descricao, produto[a[i]].preco, produto[a[i]].qtd);
  }

}

void SelectionSort(int a[10000], int left, int right)
{
  int i;
  int j;
  for (i = left; i < right; i++)
  {
    int aux;
    int min = i;
    for (j = i + 1; j <= right; j++)
    {
      if (strcmp(produto[a[j]].descricao, produto[a[min]].descricao) < 0)
      {
        min = j;
      }
      else
      {
        
      }

    }

    aux = a[i];
    a[i] = a[min];
    a[min] = aux;
  }

}

void lista_encomenda()
{
  int i;
  int num2;
  int a[10000];
  int n = 0;
  num2 = new_sym_var(sizeof(int) * 8);
  if (num2 >= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", num2);
  }
  else
  {
    for (i = encomenda[num2].n_menor; i <= encomenda[num2].n_maior; i++)
    {
      if (encomenda[num2].prod[i].qtd != 0)
      {
        a[n] = i;
        ++n;
      }
      else
      {
        
      }

    }

    SelectionSort(a, 0, n - 1);
    printf("Encomenda %d\n", num2);
    for (i = 0; i < n; i++)
    {
      printf("* %s %d %d\n", produto[a[i]].descricao, produto[a[i]].preco, encomenda[num2].prod[a[i]].qtd);
    }

  }

}

int main()
{
  char c;
  for (;;)
  {
    switch (c = getchar())
    {
      case 'a':
        c = getchar();
        adiciona_produto();
        break;

      case 'q':
        c = getchar();
        adiciona_stock();
        break;

      case 'N':
        cria_encomenda();
        break;

      case 'A':
        c = getchar();
        adiciona_encomenda();
        break;

      case 'r':
        c = getchar();
        remove_stock();
        break;

      case 'R':
        c = getchar();
        remove_produto();
        break;

      case 'C':
        c = getchar();
        calcula_custo();
        break;

      case 'p':
        c = getchar();
        altera_preco();
        break;

      case 'E':
        c = getchar();
        lista();
        break;

      case 'm':
        c = getchar();
        lista_identificador();
        break;

      case 'l':
        lista_stock();
        break;

      case 'L':
        c = getchar();
        lista_encomenda();
        break;

      case 'x':
        return 0;
        break;

    }

  }

  return 0;
}

