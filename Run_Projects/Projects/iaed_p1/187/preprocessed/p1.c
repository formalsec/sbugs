/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  int identificador;
  char descricao[64];
  int preco;
  int peso;
  int stock;
  int vetor[500];
} produto;
typedef struct 
{
  int identificador;
  int quantidade;
} qtd_prod;
typedef struct 
{
  int identificador;
  int peso_total;
  qtd_prod prod_encom[200];
  int contador;
} encomenda;
produto produtos[10000];
encomenda encomendas[500];
int conta_prod = 0;
int conta_encom = 0;
void comando_a();
void comando_q();
void comando_N();
void comando_A();
void comando_r();
void comando_R();
void comando_C();
void comando_p();
void comando_E();
void comando_m();
int comando_l();
void comando_L();
void mergesort_l(produto a[], int left, int right);
void merge_l(produto a[], int left, int m, int right);
void mergesort_L(produto a[], int left, int right);
void merge_L(produto a[], int left, int m, int right);
int main()
{
  char c = getchar();
  encomendas[0].identificador = -1;
  produtos[0].identificador = -1;
  while (c != 'x')
  {
    switch (c)
    {
      case 'a':
        comando_a();
        break;

      case 'q':
        comando_q();
        break;

      case 'N':
        comando_N();
        break;

      case 'A':
        comando_A();
        break;

      case 'r':
        comando_r();
        break;

      case 'R':
        comando_R();
        break;

      case 'C':
        comando_C();
        break;

      case 'p':
        comando_p();
        break;

      case 'E':
        comando_E();
        break;

      case 'm':
        comando_m();
        break;

      case 'l':
        comando_l();
        break;

      case 'L':
        comando_L();
        break;

    }

    c = getchar();
  }

  return 0;
}

void comando_a()
{
  for (int produtos_index = 0; produtos_index < 10; produtos_index++)
  {
    produtos[conta_prod].descricao[produtos_index] = new_sym_var(sizeof(char) * 8);
  }

  produtos[conta_prod].descricao[10 - 1] = '\0';
  produtos[conta_prod].preco = new_sym_var(sizeof(int) * 8);
  produtos[conta_prod].peso = new_sym_var(sizeof(int) * 8);
  produtos[conta_prod].stock = new_sym_var(sizeof(int) * 8);
  produtos[conta_prod].identificador = conta_prod;
  printf("Novo produto %d.\n", produtos[conta_prod].identificador);
  conta_prod++;
}

void comando_q()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (produtos[idp].identificador == idp)
  {
    produtos[idp].stock += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

}

void comando_N()
{
  encomendas[conta_encom].identificador = conta_encom;
  printf("Nova encomenda %d.\n", encomendas[conta_encom].identificador);
  conta_encom++;
}

void comando_A()
{
  int ide;
  int idp;
  int qtd;
  int i;
  int conta;
  int e;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].identificador == ide)
  {
    {
      if (produtos[idp].identificador == idp)
      {
        {
          if ((produtos[idp].stock - qtd) >= 0)
          {
            {
              if (((produtos[idp].peso * qtd) + encomendas[ide].peso_total) <= 200)
              {
                {
                  for (i = 0; i < 200; i++)
                  {
                    if (encomendas[ide].prod_encom[i].identificador == idp)
                    {
                      {
                        encomendas[ide].prod_encom[i].quantidade += qtd;
                        produtos[idp].vetor[ide] += qtd;
                      }
                    }
                    else
                    {
                      {
                        for (e = 0; e < 200; e++)
                        {
                          if (encomendas[ide].prod_encom[e].quantidade == 0)
                          {
                            {
                              encomendas[ide].prod_encom[e].identificador = idp;
                              encomendas[ide].prod_encom[e].quantidade = qtd;
                            }
                          }
                          else
                          {
                            {
                              conta = encomendas[ide].contador;
                              encomendas[ide].prod_encom[conta].identificador = idp;
                              encomendas[ide].prod_encom[conta].quantidade = qtd;
                              encomendas[ide].contador++;
                            }
                          }

                        }

                        produtos[idp].vetor[ide] = qtd;
                      }
                    }

                  }

                  produtos[idp].stock -= qtd;
                  produtos[idp].peso = (produtos[idp].peso * qtd) + encomendas[ide].peso_total;
                }
              }
              else
              {
                printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
              }

            }
          }
          else
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
          }

        }
      }
      else
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }

    }
  }
  else
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }

}

void comando_r()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (produtos[idp].identificador == idp)
  {
    {
      if ((produtos[idp].stock - qtd) >= 0)
      {
        {
          produtos[idp].stock -= qtd;
        }
      }
      else
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      }

    }
  }
  else
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }

}

void comando_R()
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].identificador == ide)
  {
    {
      if (produtos[idp].identificador == idp)
      {
        {
          for (i = 0; i < 200; i++)
          {
            if (encomendas[ide].prod_encom[i].identificador == idp)
            {
              {
                encomendas[ide].prod_encom[i].quantidade = 0;
                produtos[idp].vetor[ide] = 0;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }

    }
  }
  else
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }

}

void comando_C()
{
  int ide;
  int idp;
  int qtd;
  int preco;
  int total;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].identificador == ide)
  {
    {
      total = 0;
      for (i = 0; i < 200; i++)
      {
        idp = encomendas[ide].prod_encom[i].identificador;
        qtd = encomendas[ide].prod_encom[i].quantidade;
        preco = produtos[idp].preco;
        total += preco * qtd;
      }

      printf("Custo da encomenda %d %d.\n", ide, total);
    }
  }
  else
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }

}

void comando_p()
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (produtos[idp].identificador == idp)
  {
    produtos[idp].preco = preco;
  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }

}

void comando_E()
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].identificador == ide)
  {
    {
      if (produtos[idp].identificador == idp)
      {
        {
          for (i = 0; i < 200; i++)
          {
            if (encomendas[ide].prod_encom[i].identificador == idp)
            {
              printf("%s %d.\n", produtos[idp].descricao, encomendas[ide].prod_encom[i].quantidade);
            }
            else
            {
              printf("%s 0.\n", produtos[idp].descricao);
            }

          }

        }
      }
      else
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      }

    }
  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }

}

void comando_m()
{
  int idp;
  int i;
  int e;
  int qtd;
  int ide;
  qtd = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (produtos[idp].identificador == idp)
  {
    {
      for (i = 0; i < 500; i++)
      {
        for (e = 0; e < 200; e++)
        {
          if (encomendas[i].prod_encom[e].identificador == idp)
          {
            {
              if (encomendas[i].prod_encom[e].quantidade > qtd)
              {
                {
                  qtd = encomendas[i].prod_encom[e].quantidade;
                  ide = i;
                }
              }
              else
              {
                
              }

            }
          }
          else
          {
            
          }

        }

      }

    }
  }
  else
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }

  if (qtd != 0)
  {
    printf("Maximo produto %d %d %d.\n", idp, ide, qtd);
  }
  else
  {
    
  }

}

int comando_l()
{
  int i;
  int left = 0;
  int right = 10000;
  produto a[10000];
  for (i = 0; i < 10000; i++)
  {
    a[i] = produtos[i];
  }

  mergesort_l(a, left, right - 1);
  printf("Produtos\n");
  for (i = left; i < right; i++)
  {
    printf("* %s %d %d\n", a[i].descricao, a[i].preco, a[i].stock);
  }

  return 0;
}

void mergesort_l(produto a[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_l(a, left, m);
  mergesort_l(a, m + 1, right);
  merge_l(a, left, m, right);
}

void merge_l(produto a[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  produto aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
  {
    if (aux[j].preco < aux[i].preco)
    {
      a[k] = aux[j--];
    }
    else
    {
      if (aux[j].preco == aux[i].preco)
      {
        {
          if (aux[j].identificador < aux[i].identificador)
          {
            a[k] = aux[j++];
          }
          else
          {
            a[k] = aux[i++];
          }

        }
      }
      else
      {
        a[k] = aux[i++];
      }

    }

  }

}

void comando_L()
{
  int ide;
  int i;
  int e;
  int left = 0;
  int right = 200;
  produto a[200];
  ide = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].identificador == ide)
  {
    {
      for (i = 0; i < 200; i++)
      {
        e = encomendas[ide].prod_encom[i].identificador;
        a[i] = produtos[e];
      }

      mergesort_L(a, left, right - 1);
      printf("Encomenda %d\n", ide);
      for (i = 0; i < 200; i++)
      {
        printf("* %s %d %d\n", a[i].descricao, a[i].preco, a[i].vetor[ide]);
      }

    }
  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.", ide);
  }

}

void mergesort_L(produto a[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_L(a, left, m);
  mergesort_L(a, m + 1, right);
  merge_L(a, left, m, right);
}

void merge_L(produto a[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  produto aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
  {
    if (strcmp(aux[j].descricao, aux[i].descricao) < 0)
    {
      a[k] = aux[j--];
    }
    else
    {
      a[k] = aux[i++];
    }

  }

}

