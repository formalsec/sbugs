/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int identificador;
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
} produto;
typedef struct encomenda
{
  int total;
  int identificador_e;
  int peso;
  produto produtos_e[200];
} encomenda;
produto lista_p[10000];
encomenda lista_e[500];
int tp = 0;
int te = 0;
void imprimir_produtos()
{
  int i;
  printf("Produtos\n");
  for (i = 0; i < tp; i++)
  {
    printf("* %s %d %d\n", lista_p[i].descricao, lista_p[i].preco, lista_p[i].quantidade);
  }

}

void cria_encomenda()
{
  encomenda b;
  b.identificador_e = te;
  b.peso = 0;
  b.total = 0;
  lista_e[te] = b;
  te += 1;
  printf("Nova encomenda %d.\n", b.identificador_e);
}

void cria_produto()
{
  produto a;
  getchar();
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a.descricao[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a.descricao[10 - 1] = '\0';
  a.preco = new_sym_var(sizeof(int) * 8);
  a.peso = new_sym_var(sizeof(int) * 8);
  a.quantidade = new_sym_var(sizeof(int) * 8);
  a.identificador = tp;
  lista_p[tp] = a;
  tp += 1;
  printf("Novo produto %d.\n", a.identificador);
}

void adiciona_produto_encomenda()
{
  int i;
  int ide;
  int idp;
  int qtd;
  int max;
  produto b;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  max = lista_e[ide].total;
  if (ide >= te)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    if (idp >= tp)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        return;
      }
    }
    else
    {
      if (lista_p[idp].quantidade < qtd)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
          return;
        }
      }
      else
      {
        if ((lista_e[ide].peso + (lista_p[idp].peso * qtd)) > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
            return;
          }
        }
        else
        {
          {
            lista_e[ide].peso += lista_p[idp].peso * qtd;
            for (i = 0; i < max; i++)
            {
              if (lista_e[ide].produtos_e[i].identificador == idp)
              {
                {
                  lista_e[ide].produtos_e[i].quantidade += qtd;
                  lista_p[idp].quantidade -= qtd;
                  return;
                }
              }
              else
              {
                
              }

            }

            b.identificador = lista_p[idp].identificador;
            for (i = 0; i < 63; i++)
            {
              b.descricao[i] = lista_p[idp].descricao[i];
            }

            b.peso = lista_p[idp].peso;
            b.preco = lista_p[idp].preco;
            b.quantidade = qtd;
            lista_e[ide].produtos_e[max] = b;
            lista_e[ide].total += 1;
            lista_p[idp].quantidade -= qtd;
          }
        }

      }

    }

  }

  return;
}

void retorna_produto_encomenda()
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= te)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    if (idp >= tp)
    {
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      }
    }
    else
    {
      {
        for (i = 0; i < lista_e[ide].total; i++)
        {
          if (lista_e[ide].produtos_e[i].identificador == idp)
          {
            {
              printf("%s %d.\n", lista_e[ide].produtos_e[i].descricao, lista_e[ide].produtos_e[i].quantidade);
              return;
            }
          }
          else
          {
            
          }

        }

        printf("%s 0.\n", lista_p[idp].descricao);
      }
    }

  }

}

void adiciona_stock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= tp)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      lista_p[idp].quantidade += qtd;
    }
  }

}

void remove_stock()
{
  int idp;
  int qtd;
  int valor;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= tp)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    {
      valor = lista_p[idp].quantidade;
      if ((valor -= qtd) < 0)
      {
        {
          printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
        }
      }
      else
      {
        {
          lista_p[idp].quantidade -= qtd;
        }
      }

    }
  }

}

void altera_preco()
{
  int i;
  int j;
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= tp)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      for (i = 0; i < tp; i++)
      {
        if (lista_p[i].identificador == idp)
        {
          {
            lista_p[i].preco = preco;
            break;
          }
        }
        else
        {
          
        }

      }

      for (i = 0; i < te; i++)
        for (j = 0; j < lista_e[i].total; j++)
      {
        if (lista_e[i].produtos_e[j].identificador == idp)
        {
          {
            lista_e[i].produtos_e[j].preco = preco;
            break;
          }
        }
        else
        {
          
        }

      }


    }
  }

}

void calcula_custo()
{
  int j;
  int total = 0;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= te)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      for (j = 0; j < lista_e[ide].total; j++)
      {
        total += lista_e[ide].produtos_e[j].quantidade * lista_e[ide].produtos_e[j].preco;
      }

      printf("Custo da encomenda %d %d.\n", ide, total);
    }
  }

}

void maximo_produto()
{
  int idp;
  int i;
  int j;
  int max = 0;
  int ide = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= tp)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    if (te == 0)
    {
      {
      }
    }
    else
    {
      {
        for (i = 0; i < te; i++)
        {
          for (j = 0; j < lista_e[i].total; j++)
          {
            if (lista_e[i].produtos_e[j].identificador == idp)
            {
              {
                if (lista_e[i].produtos_e[j].quantidade == max)
                {
                  {
                    if (i < ide)
                    {
                      {
                        ide = i;
                        break;
                      }
                    }
                    else
                    {
                      
                    }

                  }
                }
                else
                {
                  if (lista_e[i].produtos_e[j].quantidade > max)
                  {
                    {
                      max = lista_e[i].produtos_e[j].quantidade;
                      ide = i;
                      break;
                    }
                  }
                  else
                  {
                    {
                      break;
                    }
                  }

                }

              }
            }
            else
            {
              
            }

          }

        }

        if (max != 0)
        {
          {
            printf("Maximo produto %d %d %d.\n", idp, ide, max);
          }
        }
        else
        {
          
        }

      }
    }

  }

}

void remove_produto_encomenda()
{
  int i;
  int j;
  int idp;
  int ide;
  int pos = -1;
  int u;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= te)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp >= tp)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      {
        for (i = 0; i < lista_e[ide].total; i++)
          if (lista_e[ide].produtos_e[i].identificador == idp)
        {
          {
            pos = i;
          }
        }
        else
        {
          
        }


        if (pos == (-1))
        {
          {
            return;
          }
        }
        else
        {
          
        }

        lista_p[idp].quantidade += lista_e[ide].produtos_e[pos].quantidade;
        lista_e[ide].peso -= lista_e[ide].produtos_e[pos].peso * lista_e[ide].produtos_e[pos].quantidade;
        lista_e[ide].produtos_e[pos].identificador = 0;
        lista_e[ide].produtos_e[pos].quantidade = 0;
        lista_e[ide].produtos_e[pos].preco = 0;
        lista_e[ide].produtos_e[pos].peso = 0;
        for (j = 0; j < 63; j++)
        {
          lista_e[ide].produtos_e[pos].descricao[j] = 0;
        }

        u = lista_e[ide].total - 1;
        {
          produto t = lista_e[ide].produtos_e[pos];
          lista_e[ide].produtos_e[pos] = lista_e[ide].produtos_e[u];
          lista_e[ide].produtos_e[u] = t;
        }
        ;
        lista_e[ide].total -= 1;
      }
    }

  }

}

int particao_preco(produto b[], int l, int r)
{
  int i = l - 1;
  int j;
  produto v = b[r];
  for (j = l; j <= (r - 1); j++)
  {
    if (b[j].preco < v.preco)
    {
      {
        i++;
        if (i != j)
        {
          {
            produto t = b[i];
            b[i] = b[j];
            b[j] = t;
          }
        }
        else
        {
          
        }

        ;
      }
    }
    else
    {
      if (b[j].preco == v.preco)
      {
        {
          if (b[j].identificador < v.identificador)
          {
            {
              i++;
              if (i != j)
              {
                {
                  produto t = b[i];
                  b[i] = b[j];
                  b[j] = t;
                }
              }
              else
              {
                
              }

              ;
            }
          }
          else
          {
            
          }

        }
      }
      else
      {
        
      }

    }

  }

  {
    produto t = b[i + 1];
    b[i + 1] = b[r];
    b[r] = t;
  }
  ;
  return i + 1;
}

void quicksort_preco(produto b[], int l, int r)
{
  int i;
  if (l < r)
  {
    {
      i = particao_preco(b, l, r);
      quicksort_preco(b, l, i - 1);
      quicksort_preco(b, i + 1, r);
    }
  }
  else
  {
    
  }

}

void ordenar_produtos_preco()
{
  int i = 0;
  produto b[10000];
  memcpy(b, lista_p, sizeof(lista_p));
  quicksort_preco(b, 0, tp - 1);
  printf("Produtos\n");
  for (i = 0; i < tp; i++)
  {
    printf("* %s %d %d\n", b[i].descricao, b[i].preco, b[i].quantidade);
  }

}

void imprimir_encomenda(encomenda b)
{
  int i;
  printf("Encomenda %d\n", b.identificador_e);
  for (i = 0; i < b.total; i++)
  {
    printf("* %s %d %d\n", b.produtos_e[i].descricao, b.produtos_e[i].preco, b.produtos_e[i].quantidade);
  }

}

void comando_K()
{
  int ide;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  printf("Encomenda %d\n", ide);
  for (i = 0; i < lista_e[ide].total; i++)
  {
    printf("* %s:%d:%d\n", lista_e[ide].produtos_e[i].descricao, lista_e[ide].produtos_e[i].preco, lista_e[ide].produtos_e[i].quantidade);
  }

}

int particao_descricao(produto b[], int l, int r)
{
  int i = l - 1;
  int j;
  produto v = b[r];
  for (j = l; j <= (r - 1); j++)
  {
    if (strcmp(b[j].descricao, v.descricao) < 0)
    {
      {
        i++;
        if (i != j)
        {
          {
            produto t = b[i];
            b[i] = b[j];
            b[j] = t;
          }
        }
        else
        {
          
        }

        ;
      }
    }
    else
    {
      if (strcmp(b[j].descricao, v.descricao) == 0)
      {
        {
          if (b[j].identificador < v.identificador)
          {
            {
              i++;
              if (i != j)
              {
                {
                  produto t = b[i];
                  b[i] = b[j];
                  b[j] = t;
                }
              }
              else
              {
                
              }

              ;
            }
          }
          else
          {
            
          }

        }
      }
      else
      {
        
      }

    }

  }

  {
    produto t = b[i + 1];
    b[i + 1] = b[r];
    b[r] = t;
  }
  ;
  return i + 1;
}

void quicksort_descricao(produto b[], int l, int r)
{
  int i;
  if (l < r)
  {
    {
      i = particao_descricao(b, l, r);
      quicksort_descricao(b, l, i - 1);
      quicksort_descricao(b, i + 1, r);
    }
  }
  else
  {
    
  }

}

void ordenar_produtos_descricao()
{
  int i = 0;
  int ide;
  produto a[10000];
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= te)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      memcpy(a, lista_e[ide].produtos_e, sizeof(lista_e[ide].produtos_e));
      quicksort_descricao(a, 0, lista_e[ide].total - 1);
      printf("Encomenda %d\n", ide);
      for (i = 0; i < lista_e[ide].total; i++)
      {
        printf("* %s %d %d\n", a[i].descricao, a[i].preco, a[i].quantidade);
      }

    }
  }

}

int main()
{
  char letra;
  while (1 != EOF)
  {
    letra = new_sym_var(sizeof(char) * 8);
    switch (letra)
    {
      case 'a':
        cria_produto();
        break;

      case 'K':
        comando_K();
        break;

      case 'k':
        imprimir_produtos();
        break;

      case 'l':
        ordenar_produtos_preco();
        break;

      case 'L':
        ordenar_produtos_descricao();
        break;

      case 'N':
        cria_encomenda();
        break;

      case 'A':
        adiciona_produto_encomenda();
        break;

      case 'E':
        retorna_produto_encomenda();
        break;

      case 'q':
        adiciona_stock();
        break;

      case 'r':
        remove_stock();
        break;

      case 'R':
        remove_produto_encomenda();
        break;

      case 'p':
        altera_preco();
        break;

      case 'C':
        calcula_custo();
        break;

      case 'm':
        maximo_produto();
        break;

      case 'x':
        return 0;

      default:
        break;

    }

  }

  return 0;
}

