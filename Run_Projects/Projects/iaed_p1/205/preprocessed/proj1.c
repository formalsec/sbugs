/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int id;
  char description[63];
  int price;
  int weight;
  int stock;
} produto;
typedef struct encomenda
{
  int order_id;
  int order_weight;
  int contador_pe;
  produto products[200];
} encomenda;
typedef int item;
int less(produto A, produto B, char chave[12])
{
  if (strcmp(chave, "description\0") == 0)
  {
    return strcmp(A.description, B.description) < 0;
  }
  else
  {
    
  }

  if (strcmp(chave, "price\0") == 0)
  {
    {
      if ((A.price == B.price) && (A.id < B.id))
      {
        return 1;
      }
      else
      {
        return A.price < B.price;
      }

    }
  }
  else
  {
    
  }

  return 0;
}

void merge(item a[], int left, int m, int right, char chave[12], produto portfolio_p[10000])
{
  int i;
  int j;
  int k;
  item aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
    if (less(portfolio_p[aux[j]], portfolio_p[aux[i]], chave))
  {
    a[k] = aux[j--];
  }
  else
  {
    a[k] = aux[i++];
  }


}

void mergesort(item b[], int left, int right, char chave[12], produto portfolio_p[10000])
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(b, left, m, chave, portfolio_p);
  mergesort(b, m + 1, right, chave, portfolio_p);
  merge(b, left, m, right, chave, portfolio_p);
}

produto portfolio_p[10000] = {{0, "", 0, 0, 0}};
encomenda portfolio_e[500] = {{0, 0, 0, {{0, "", 0, 0, 0}}}};
void novo_p(int idp, produto a, produto portfolio_p[10000]);
int existe_p(int a, int idp);
void nova_e(int ide, encomenda e, encomenda portfolio_e[500]);
int existe_e(int i, int ide);
int letra_A(int a, int i, int qtd, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide);
int letra_r(int a, int qtd, produto portfolio_p[10000], int idp);
int letra_R(int a, int i, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide);
int letra_C(int i, produto portfolio_p[10000], encomenda portfolio_e[500], int total, int ide);
int letra_p(int a, int price, int ide, produto portfolio_p[10000], encomenda portfolio_e[500], int idp);
int letra_E(int a, int i, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide);
int letra_m(int a, produto maximo, int ide, encomenda portfolio_e[500], int idp);
int letra_l(int idp, produto portfolio_p[10000]);
int letra_L(int i, produto portfolio_p[10000], encomenda portfolio_e[500], int ide);
int main()
{
  int idp;
  int ide;
  int qtd;
  int price;
  int total;
  char c;
  produto a = {0};
  encomenda e = {0};
  idp = 0, ide = 0, total = 0;
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
      {
        for (int a_index = 0; a_index < 10; a_index++)
        {
          a.description[a_index] = new_sym_var(sizeof(char) * 8);
        }

        a.description[10 - 1] = '\0';
        a.price = new_sym_var(sizeof(int) * 8);
        a.weight = new_sym_var(sizeof(int) * 8);
        a.stock = new_sym_var(sizeof(int) * 8);
        novo_p(idp, a, portfolio_p);
        idp++;
        break;
      }

      case 'q':
      {
        a.id = new_sym_var(sizeof(int) * 8);
        a.stock = new_sym_var(sizeof(int) * 8);
        if (existe_p(a.id, idp) == 1)
        {
          portfolio_p[a.id].stock += a.stock;
        }
        else
        {
          printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", a.id);
        }

        break;
      }

      case 'N':
      {
        nova_e(ide, e, portfolio_e);
        ide++;
        break;
      }

      case 'A':
      {
        e.order_id = new_sym_var(sizeof(int) * 8);
        a.id = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        letra_A(a.id, e.order_id, qtd, portfolio_p, portfolio_e, idp, ide);
        break;
      }

      case 'r':
      {
        a.id = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        letra_r(a.id, qtd, portfolio_p, idp);
        break;
      }

      case 'R':
      {
        e.order_id = new_sym_var(sizeof(int) * 8);
        a.id = new_sym_var(sizeof(int) * 8);
        letra_R(a.id, e.order_id, portfolio_p, portfolio_e, idp, ide);
        break;
      }

      case 'C':
      {
        e.order_id = new_sym_var(sizeof(int) * 8);
        letra_C(e.order_id, portfolio_p, portfolio_e, total, ide);
        break;
      }

      case 'p':
      {
        a.id = new_sym_var(sizeof(int) * 8);
        price = new_sym_var(sizeof(int) * 8);
        letra_p(a.id, price, ide, portfolio_p, portfolio_e, idp);
        break;
      }

      case 'E':
      {
        e.order_id = new_sym_var(sizeof(int) * 8);
        a.id = new_sym_var(sizeof(int) * 8);
        letra_E(a.id, e.order_id, portfolio_p, portfolio_e, idp, ide);
        break;
      }

      case 'm':
      {
        produto maximo = {0};
        a.id = new_sym_var(sizeof(int) * 8);
        letra_m(a.id, maximo, ide, portfolio_e, idp);
        break;
      }

      case 'l':
      {
        letra_l(idp, portfolio_p);
        break;
      }

      case 'L':
      {
        e.order_id = new_sym_var(sizeof(int) * 8);
        letra_L(e.order_id, portfolio_p, portfolio_e, ide);
        break;
      }
        getchar();

    }

  }

  return 0;
}

void novo_p(int idp, produto a, produto portfolio_p[10000])
{
  if (idp != 10000)
  {
    {
      a.id = idp;
      portfolio_p[idp] = a;
      printf("Novo produto %d.\n", a.id);
    }
  }
  else
  {
    
  }

}

int existe_p(int a, int idp)
{
  if (a < idp)
  {
    {
      return 1;
    }
  }
  else
  {
    return 0;
  }

}

int existe_e(int i, int ide)
{
  if (i < ide)
  {
    return 1;
  }
  else
  {
    return 0;
  }

}

void nova_e(int ide, encomenda e, encomenda portfolio_e[500])
{
  if (ide != 500)
  {
    {
      e.order_id = ide;
      portfolio_e[ide] = e;
      printf("Nova encomenda %d.\n", e.order_id);
    }
  }
  else
  {
    
  }

}

int letra_A(int a, int i, int qtd, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide)
{
  int contador1;
  int k;
  if (existe_p(a, idp) != 1)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", a, i);
      return 0;
    }
  }
  else
  {
    if (existe_e(i, ide) != 1)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", a, i);
        return 0;
      }
    }
    else
    {
      if (portfolio_p[a].stock < qtd)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", a, i);
          return 0;
        }
      }
      else
      {
        if ((portfolio_e[i].order_weight + (qtd * portfolio_p[a].weight)) > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", a, i);
            return 0;
          }
        }
        else
        {
          
        }

      }

    }

  }

  for (k = 0; k < portfolio_e[i].contador_pe; k++)
  {
    if (portfolio_e[i].products[k].id == a)
    {
      {
        portfolio_e[i].products[k].stock += qtd;
        portfolio_p[a].stock -= qtd;
        portfolio_e[i].order_weight += qtd * portfolio_p[a].weight;
        return 0;
      }
    }
    else
    {
      
    }

  }

  {
    contador1 = portfolio_e[i].contador_pe;
    portfolio_e[i].products[contador1].id = a;
    portfolio_e[i].products[contador1].stock += qtd;
    portfolio_e[i].contador_pe++;
    portfolio_p[a].stock -= qtd;
    portfolio_e[i].order_weight += qtd * portfolio_p[a].weight;
    return 0;
  }
}

int letra_r(int a, int qtd, produto portfolio_p[10000], int idp)
{
  if (existe_p(a, idp) != 1)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", a);
      return 0;
    }
  }
  else
  {
    if ((portfolio_p[a].stock - qtd) < 0)
    {
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, a);
        return 0;
      }
    }
    else
    {
      {
        portfolio_p[a].stock -= qtd;
        return 0;
      }
    }

  }

}

int letra_R(int a, int i, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide)
{
  int k;
  int p;
  if (existe_e(i, ide) != 1)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", a, i);
      return 0;
    }
  }
  else
  {
    if (existe_p(a, idp) != 1)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", a, i);
        return 0;
      }
    }
    else
    {
      
    }

  }

  for (k = 0; k < portfolio_e[i].contador_pe; k++)
  {
    if (portfolio_e[i].products[k].id == a)
    {
      {
        portfolio_p[a].stock += portfolio_e[i].products[k].stock;
        portfolio_e[i].order_weight -= portfolio_p[a].weight * portfolio_e[i].products[k].stock;
        for (p = k; p < portfolio_e[i].contador_pe; p++)
          portfolio_e[i].products[p] = portfolio_e[i].products[p + 1];

        portfolio_e[i].contador_pe--;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

int letra_C(int i, produto portfolio_p[10000], encomenda portfolio_e[500], int total, int ide)
{
  int p;
  if (existe_e(i, ide) != 1)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", i);
      return 0;
    }
  }
  else
  {
    {
      for (p = 0; p < portfolio_e[i].contador_pe; p++)
        total = total + (portfolio_p[portfolio_e[i].products[p].id].price * portfolio_e[i].products[p].stock);

      printf("Custo da encomenda %d %d.\n", i, total);
      return 0;
    }
  }

}

int letra_p(int a, int price, int ide, produto portfolio_p[10000], encomenda portfolio_e[500], int idp)
{
  int i;
  int k;
  if (existe_p(a, idp) != 1)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", a);
      return 0;
    }
  }
  else
  {
    portfolio_p[a].price = price;
  }

  for (i = 0; i < ide; i++)
  {
    for (k = 0; k < portfolio_e[i].contador_pe; k++)
      if (portfolio_e[i].products[k].id == a)
    {
      portfolio_e[i].products[k].price = price;
    }
    else
    {
      
    }


  }

  return 0;
}

int letra_E(int a, int i, produto portfolio_p[10000], encomenda portfolio_e[500], int idp, int ide)
{
  int k;
  int existe_pe = 0;
  if (existe_p(a, idp) != 1)
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", a);
      return 0;
    }
  }
  else
  {
    if (existe_e(i, ide) != 1)
    {
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", i);
        return 0;
      }
    }
    else
    {
      {
        for (k = 0; k < portfolio_e[i].contador_pe; k++)
        {
          if (portfolio_e[i].products[k].id == a)
          {
            {
              existe_pe = 1;
              printf("%s %d.\n", portfolio_p[a].description, portfolio_e[i].products[k].stock);
            }
          }
          else
          {
            
          }

        }

        if (existe_pe == 0)
        {
          printf("%s 0.\n", portfolio_p[a].description);
        }
        else
        {
          
        }

        return 0;
      }
    }

  }

}

int letra_m(int a, produto maximo, int ide, encomenda portfolio_e[500], int idp)
{
  int i;
  int k;
  int existe_pe;
  existe_pe = 0;
  if (existe_p(a, idp) != 1)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", a);
      return 0;
    }
  }
  else
  {
    {
      for (i = 0; i < ide; i++)
      {
        for (k = 0; k < portfolio_e[i].contador_pe; k++)
        {
          if (portfolio_e[i].products[k].id == a)
          {
            {
              existe_pe = 1;
              if (portfolio_e[i].products[k].stock > maximo.stock)
              {
                {
                  maximo.stock = portfolio_e[i].products[k].stock;
                  maximo.id = portfolio_e[i].order_id;
                }
              }
              else
              {
                
              }

              if ((portfolio_e[i].products[k].stock == maximo.stock) && (portfolio_e[i].order_id < maximo.id))
              {
                {
                  maximo.stock = portfolio_e[i].products[k].stock;
                  maximo.id = portfolio_e[i].order_id;
                }
              }
              else
              {
                
              }

            }
          }
          else
          {
            
          }

        }

      }

      if (existe_pe == 1)
      {
        printf("Maximo produto %d %d %d.\n", a, maximo.id, maximo.stock);
      }
      else
      {
        
      }

      return 0;
    }
  }

}

int letra_l(int idp, produto portfolio_p[10000])
{
  int i;
  item b[10000];
  for (i = 0; i < idp; i++)
  {
    b[i] = portfolio_p[i].id;
  }

  mergesort(b, 0, idp - 1, "price\0", portfolio_p);
  printf("Produtos\n");
  for (i = 0; i < idp; i++)
  {
    printf("* %s %d %d\n", portfolio_p[b[i]].description, portfolio_p[b[i]].price, portfolio_p[b[i]].stock);
  }

  return 0;
}

int letra_L(int i, produto portfolio_p[10000], encomenda portfolio_e[500], int ide)
{
  int p;
  int k;
  int j;
  item b[10000];
  if (existe_e(i, ide) != 1)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", i);
      return 0;
    }
  }
  else
  {
    {
      for (k = 0; k < portfolio_e[i].contador_pe; k++)
      {
        b[k] = portfolio_e[i].products[k].id;
      }

      mergesort(b, 0, portfolio_e[i].contador_pe - 1, "description\0", portfolio_p);
      printf("Encomenda %d\n", i);
      for (p = 0; p < portfolio_e[i].contador_pe; p++)
      {
        for (j = 0; j < portfolio_e[i].contador_pe; j++)
          if (portfolio_e[i].products[j].id == b[p])
        {
          printf("* %s %d %d\n", portfolio_p[b[p]].description, portfolio_p[b[p]].price, portfolio_e[i].products[j].stock);
        }
        else
        {
          
        }


      }

    }
  }

  return 0;
}

