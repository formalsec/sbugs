/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct 
{
  int idp;
  char desc[64];
  int preco;
  int peso;
  int stock;
} Produto;
typedef struct 
{
  int ide;
  Produto vetor[500];
} Encomenda;
Produto sistemaprod[10000];
Produto prodvazio = {-1, " ", 0, 0, 0};
Encomenda sistemaenc[500];
void initprod(Produto vetorprod[])
{
  int i;
  for (i = 0; i < 10000; i++)
  {
    vetorprod[i] = prodvazio;
  }

}

Encomenda encvazia()
{
  Encomenda enc;
  int i;
  enc.ide = -1;
  for (i = 0; i < 200; i++)
  {
    enc.vetor[i] = prodvazio;
  }

  return enc;
}

void initenc()
{
  int i;
  for (i = 0; i < 500; i++)
  {
    sistemaenc[i] = encvazia();
  }

}

int existeProd(int idp)
{
  int i;
  for (i = 0; i < 10000; i++)
  {
    if (sistemaprod[i].idp == idp)
    {
      {
        return 1;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

int existeEnc(int ide)
{
  int i;
  for (i = 0; i < 500; i++)
  {
    if (sistemaenc[i].ide == ide)
    {
      {
        return 1;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

int pesoEnc(int ide)
{
  int i = 0;
  int peso = 0;
  while ((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1)))
  {
    peso += sistemaenc[ide].vetor[i].peso * sistemaenc[ide].vetor[i].stock;
    i++;
  }

  return peso;
}

void merge(Produto a[], int l, int m, int r)
{
  Produto aux[10000];
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
  {
    aux[i - 1] = a[i - 1];
  }

  for (j = m; j < r; j++)
  {
    aux[(r + m) - j] = a[j + 1];
  }

  for (k = l; k <= r; k++)
  {
    if ((aux[j].preco < aux[i].preco) || (i > m))
    {
      {
        a[k] = aux[j--];
      }
    }
    else
    {
      {
        a[k] = aux[i++];
      }
    }

  }

}

void mergesort(Produto a[], int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  mergesort(a, l, m);
  mergesort(a, m + 1, r);
  merge(a, l, m, r);
}

int partition(Produto a[], int l, int r)
{
  int i = l - 1;
  int j = r;
  Produto v = a[r];
  Produto t;
  while (i < j)
  {
    while (strcmp(a[++i].desc, v.desc) < 0)
      ;

    while (strcmp(v.desc, a[--j].desc) < 0)
    {
      if (j == l)
      {
        {
          break;
        }
      }
      else
      {
        
      }

    }

    if (i < j)
    {
      {
        t = a[i];
        a[i] = a[j];
        a[j] = t;
      }
    }
    else
    {
      
    }

  }

  t = a[i];
  a[i] = a[r];
  a[r] = t;
  return i;
}

void quicksort(Produto a[], int l, int r)
{
  int i;
  if (r <= l)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  i = partition(a, l, r);
  quicksort(a, l, i - 1);
  quicksort(a, i + 1, r);
}

void a()
{
  int c;
  int i = 0;
  int j = 0;
  char desc[64];
  while ((i < 10000) && (sistemaprod[i].idp != (-1)))
  {
    i++;
  }

  sistemaprod[i].idp = i;
  getchar();
  while (((c = getchar()) != ':') && (j < (64 - 1)))
  {
    desc[j] = c;
    j++;
  }

  desc[j] = '\0';
  memcpy(sistemaprod[i].desc, desc, strlen(desc) + 1);
  sistemaprod[i].preco = new_sym_var(sizeof(int) * 8);
  sistemaprod[i].peso = new_sym_var(sizeof(int) * 8);
  sistemaprod[i].stock = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", i);
}

void q()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (existeProd(idp))
  {
    {
      sistemaprod[idp].stock += qtd;
    }
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }

}

void N()
{
  int i = 0;
  while ((i < 500) && (sistemaenc[i].ide != (-1)))
  {
    i++;
  }

  sistemaenc[i].ide = i;
  printf("Nova encomenda %d.\n", i);
}

void A()
{
  int idp;
  int ide;
  int qtd;
  int i = 0;
  int encontrou = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (existeEnc(ide))
  {
    {
      if (existeProd(idp))
      {
        {
          if (sistemaprod[idp].stock >= qtd)
          {
            {
              if ((pesoEnc(ide) + (sistemaprod[idp].peso * qtd)) <= 200)
              {
                {
                  while (((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1))) && (encontrou == 0))
                  {
                    if (sistemaenc[ide].vetor[i].idp == idp)
                    {
                      {
                        sistemaenc[ide].vetor[i].stock += qtd;
                        sistemaprod[idp].stock -= qtd;
                        encontrou = 1;
                      }
                    }
                    else
                    {
                      
                    }

                    i++;
                  }

                  if (encontrou == 0)
                  {
                    {
                      sistemaenc[ide].vetor[i].idp = idp;
                      memcpy(sistemaenc[ide].vetor[i].desc, sistemaprod[idp].desc, strlen(sistemaprod[idp].desc) + 1);
                      sistemaenc[ide].vetor[i].preco = sistemaprod[idp].preco;
                      sistemaenc[ide].vetor[i].peso = sistemaprod[idp].peso;
                      sistemaenc[ide].vetor[i].stock = qtd;
                      sistemaprod[idp].stock -= qtd;
                    }
                  }
                  else
                  {
                    
                  }

                }
              }
              else
              {
                {
                  printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
                }
              }

            }
          }
          else
          {
            {
              printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
            }
          }

        }
      }
      else
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }

}

void r()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (existeProd(idp))
  {
    {
      if (sistemaprod[idp].stock >= qtd)
      {
        {
          sistemaprod[idp].stock -= qtd;
        }
      }
      else
      {
        {
          printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    }
  }

}

void R()
{
  int ide;
  int idp;
  int i = 0;
  int encontrou = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (existeEnc(ide))
  {
    {
      if (existeProd(idp))
      {
        {
          while (((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1))) && (encontrou == 0))
          {
            if (sistemaenc[ide].vetor[i].idp == idp)
            {
              {
                sistemaprod[idp].stock += sistemaenc[ide].vetor[i].stock;
                sistemaenc[ide].vetor[i].stock = 0;
                encontrou = 1;
              }
            }
            else
            {
              
            }

            i++;
          }

        }
      }
      else
      {
        {
          printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }

}

void C()
{
  int ide;
  int i = 0;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (existeEnc(ide))
  {
    {
      while ((i < 10000) && (sistemaenc[ide].vetor[i].idp != (-1)))
      {
        custo += sistemaenc[ide].vetor[i].preco * sistemaenc[ide].vetor[i].stock;
        i++;
      }

      printf("Custo da encomenda %d %d.\n", ide, custo);
    }
  }
  else
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    }
  }

}

void p()
{
  int idp;
  int preco;
  int i = 0;
  int j;
  int encontrou;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (existeProd(idp))
  {
    {
      sistemaprod[idp].preco = preco;
      while ((i < 500) && (sistemaenc[i].ide != (-1)))
      {
        j = 0;
        encontrou = 0;
        while (((j < 200) && (sistemaenc[i].vetor[j].idp != (-1))) && (encontrou == 0))
        {
          if (sistemaenc[i].vetor[j].idp == idp)
          {
            {
              sistemaenc[i].vetor[j].preco = preco;
              encontrou = 1;
            }
          }
          else
          {
            
          }

          j++;
        }

        i++;
      }

    }
  }
  else
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    }
  }

}

void E()
{
  int ide;
  int idp;
  int i = 0;
  int qtd = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (existeEnc(ide))
  {
    {
      if (existeProd(idp))
      {
        {
          while ((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1)))
          {
            if (sistemaenc[ide].vetor[i].idp == idp)
            {
              {
                qtd = sistemaenc[ide].vetor[i].stock;
                break;
              }
            }
            else
            {
              
            }

            i++;
          }

          printf("%s %d.\n", sistemaprod[idp].desc, qtd);
        }
      }
      else
      {
        {
          printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }

}

void m()
{
  int idp;
  int qtd = 0;
  int ide;
  int i = 0;
  int j;
  int encontrou;
  idp = new_sym_var(sizeof(int) * 8);
  if (existeProd(idp))
  {
    {
      while ((i < 500) && (sistemaenc[i].ide != (-1)))
      {
        j = 0;
        encontrou = 0;
        while (((j < 200) && (sistemaenc[i].vetor[j].idp != (-1))) && (encontrou == 0))
        {
          if (sistemaenc[i].vetor[j].idp == idp)
          {
            {
              if (sistemaenc[i].vetor[j].stock > qtd)
              {
                {
                  qtd = sistemaenc[i].vetor[j].stock;
                  ide = i;
                }
              }
              else
              {
                
              }

              encontrou = 1;
            }
          }
          else
          {
            
          }

          j++;
        }

        i++;
      }

      if (qtd != 0)
      {
        {
          printf("Maximo produto %d %d %d.\n", idp, ide, qtd);
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    }
  }

}

void l()
{
  int i = 0;
  Produto sistemaaux[10000];
  initprod(sistemaaux);
  while ((i < 10000) && (sistemaprod[i].idp != (-1)))
  {
    sistemaaux[i].idp = sistemaprod[i].idp;
    memcpy(sistemaaux[i].desc, sistemaprod[i].desc, strlen(sistemaprod[i].desc) + 1);
    sistemaaux[i].preco = sistemaprod[i].preco;
    sistemaaux[i].peso = sistemaprod[i].peso;
    sistemaaux[i].stock = sistemaprod[i].stock;
    i++;
  }

  mergesort(sistemaaux, 0, i - 1);
  i = 0;
  printf("Produtos\n");
  while ((i < 10000) && (sistemaaux[i].idp != (-1)))
  {
    printf("* %s %d %d\n", sistemaaux[i].desc, sistemaaux[i].preco, sistemaaux[i].stock);
    i++;
  }

}

void L()
{
  int ide;
  int i = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (existeEnc(ide))
  {
    {
      while ((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1)))
      {
        i++;
      }

      quicksort(sistemaenc[ide].vetor, 0, i - 1);
      i = 0;
      printf("Encomenda %d\n", ide);
      while ((i < 200) && (sistemaenc[ide].vetor[i].idp != (-1)))
      {
        if (sistemaenc[ide].vetor[i].stock != 0)
        {
          {
            printf("* %s %d %d\n", sistemaenc[ide].vetor[i].desc, sistemaenc[ide].vetor[i].preco, sistemaenc[ide].vetor[i].stock);
          }
        }
        else
        {
          
        }

        i++;
      }

    }
  }
  else
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }

}

int main()
{
  int c;
  initprod(sistemaprod);
  initenc();
  while ((c = getchar()) != EOF)
  {
    if (c == 'a')
    {
      {
        a();
      }
    }
    else
    {
      
    }

    if (c == 'q')
    {
      {
        q();
      }
    }
    else
    {
      
    }

    if (c == 'N')
    {
      {
        N();
      }
    }
    else
    {
      
    }

    if (c == 'A')
    {
      {
        A();
      }
    }
    else
    {
      
    }

    if (c == 'r')
    {
      {
        r();
      }
    }
    else
    {
      
    }

    if (c == 'R')
    {
      {
        R();
      }
    }
    else
    {
      
    }

    if (c == 'C')
    {
      {
        C();
      }
    }
    else
    {
      
    }

    if (c == 'p')
    {
      {
        p();
      }
    }
    else
    {
      
    }

    if (c == 'E')
    {
      {
        E();
      }
    }
    else
    {
      
    }

    if (c == 'm')
    {
      {
        m();
      }
    }
    else
    {
      
    }

    if (c == 'l')
    {
      {
        l();
      }
    }
    else
    {
      
    }

    if (c == 'L')
    {
      {
        L();
      }
    }
    else
    {
      
    }

    if (c == 'x')
    {
      {
        exit(0);
      }
    }
    else
    {
      
    }

  }

  return 0;
}

