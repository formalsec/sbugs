/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>


typedef struct produto
{
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
  int id;
} produto;
typedef struct encomenda
{
  produto produtos[10000];
  int peso;
  int id;
  int lastP;
} encomenda;
produto armazem[10000];
encomenda encomendas[500];
int lastA = -1;
int lastE = -1;
int find(int idp, int ide)
{
  int i;
  for (i = 0; i <= encomendas[ide].lastP; i++)
  {
    if (encomendas[ide].produtos[i].id == idp)
    {
      {
        return i;
      }
    }
    else
    {
      
    }

  }

  return -1;
}

int newPosPE(int idp, int ide)
{
  int i;
  int j;
  for (i = 0; i <= encomendas[ide].lastP; i++)
  {
    if (strcmp(armazem[idp].descricao, encomendas[ide].produtos[i].descricao) < 0)
    {
      {
        for (j = encomendas[ide].lastP; j >= i; j--)
        {
          encomendas[ide].produtos[j + 1] = encomendas[ide].produtos[j];
        }

        encomendas[ide].lastP++;
        return i;
      }
    }
    else
    {
      
    }

  }

  encomendas[ide].lastP++;
  return encomendas[ide].lastP;
}

void copy(produto *arr)
{
  int i;
  for (i = 0; i <= lastA; i++)
  {
    arr[i] = armazem[i];
  }

}

void heapify(produto *arr, int n, int i)
{
  int largest = i;
  int l = (2 * i) + 1;
  int r = (2 * i) + 2;
  produto temp;
  if ((l < n) && ((arr[l].preco > arr[largest].preco) || ((arr[l].preco == arr[largest].preco) && (arr[l].id > arr[largest].id))))
  {
    {
      largest = l;
    }
  }
  else
  {
    
  }

  if ((r < n) && ((arr[r].preco > arr[largest].preco) || ((arr[r].preco == arr[largest].preco) && (arr[r].id > arr[largest].id))))
  {
    {
      largest = r;
    }
  }
  else
  {
    
  }

  if (largest != i)
  {
    {
      temp = arr[i];
      arr[i] = arr[largest];
      arr[largest] = temp;
      heapify(arr, n, largest);
    }
  }
  else
  {
    
  }

}

void heapSort(produto *arr, int n)
{
  int i;
  produto temp;
  for (i = (n / 2) - 1; i >= 0; i--)
  {
    heapify(arr, n, i);
  }

  for (i = n - 1; i > 0; i--)
  {
    temp = arr[0];
    arr[0] = arr[i];
    arr[i] = temp;
    heapify(arr, i, 0);
  }

}

void add()
{
  char input[100];
  char description[63];
  int price;
  int weight;
  int qtd;
  fgets(input, sizeof(input), stdin);
  strcpy(description, strtok(input, ":"));
  price = atoi(strtok(0, ":"));
  weight = atoi(strtok(0, ":"));
  qtd = atoi(strtok(0, ":"));
  strcpy(armazem[++lastA].descricao, description);
  armazem[lastA].preco = price;
  armazem[lastA].peso = weight;
  armazem[lastA].quantidade = qtd;
  armazem[lastA].id = lastA;
  printf("Novo produto %d.\n", lastA);
}

void addStock()
{
  int idp;
  int qtd;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (2 == 2)
  {
    idp = new_sym_var(sizeof(int) * 8);
    qtd = new_sym_var(sizeof(int) * 8);
    {
      if (idp > lastA)
      {
        {
          printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
        }
      }
      else
      {
        {
          armazem[idp].quantidade += qtd;
        }
      }

    }
  }
  else
  {
    
  }

}

void novaE()
{
  lastE++;
  encomendas[lastE].id = lastE;
  encomendas[lastE].lastP = -1;
  printf("Nova encomenda %d.\n", lastE);
}

void addToE()
{
  int posPE;
  int ide;
  int idp;
  int qtd;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (3 == 3)
  {
    ide = new_sym_var(sizeof(int) * 8);
    idp = new_sym_var(sizeof(int) * 8);
    qtd = new_sym_var(sizeof(int) * 8);
    {
      if (idp > lastA)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        }
      }
      else
      {
        if (ide > lastE)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
          }
        }
        else
        {
          if (armazem[idp].quantidade < qtd)
          {
            {
              printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
            }
          }
          else
          {
            if ((encomendas[ide].peso + (armazem[idp].peso * qtd)) > 200)
            {
              {
                printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
              }
            }
            else
            {
              {
                armazem[idp].quantidade -= qtd;
                encomendas[ide].peso += armazem[idp].peso * qtd;
                if ((posPE = find(idp, ide)) != (-1))
                {
                  {
                    encomendas[ide].produtos[posPE].quantidade += qtd;
                  }
                }
                else
                {
                  {
                    posPE = newPosPE(idp, ide);
                    strcpy(encomendas[ide].produtos[posPE].descricao, armazem[idp].descricao);
                    encomendas[ide].produtos[posPE].preco = armazem[idp].preco;
                    encomendas[ide].produtos[posPE].peso = armazem[idp].peso;
                    encomendas[ide].produtos[posPE].quantidade = qtd;
                    encomendas[ide].produtos[posPE].id = armazem[idp].id;
                  }
                }

              }
            }

          }

        }

      }

    }
  }
  else
  {
    
  }

}

void removeFromA()
{
  int idp;
  int qtd;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (2 == 2)
  {
    idp = new_sym_var(sizeof(int) * 8);
    qtd = new_sym_var(sizeof(int) * 8);
    {
      if (idp > lastA)
      {
        {
          printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
        }
      }
      else
      {
        if (armazem[idp].quantidade < qtd)
        {
          {
            printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
          }
        }
        else
        {
          {
            armazem[idp].quantidade -= qtd;
          }
        }

      }

    }
  }
  else
  {
    
  }

}

void removeFromE()
{
  int posPE;
  int ide;
  int idp;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (2 == 2)
  {
    ide = new_sym_var(sizeof(int) * 8);
    idp = new_sym_var(sizeof(int) * 8);
    {
      if (ide > lastE)
      {
        {
          printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
        }
      }
      else
      {
        if (idp > lastA)
        {
          {
            printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
          }
        }
        else
        {
          if ((posPE = find(idp, ide)) != (-1))
          {
            {
              armazem[idp].quantidade += encomendas[ide].produtos[posPE].quantidade;
              encomendas[ide].peso -= encomendas[ide].produtos[posPE].quantidade * encomendas[ide].produtos[posPE].peso;
              encomendas[ide].produtos[posPE].quantidade = 0;
            }
          }
          else
          {
            
          }

        }

      }

    }
  }
  else
  {
    
  }

}

void totalPrice()
{
  int ide;
  int sum = 0;
  int i;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (1 == 1)
  {
    ide = new_sym_var(sizeof(int) * 8);
    {
      if (ide > lastE)
      {
        {
          printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
        }
      }
      else
      {
        {
          for (i = 0; i <= encomendas[ide].lastP; i++)
          {
            sum += encomendas[ide].produtos[i].preco * encomendas[ide].produtos[i].quantidade;
          }

          printf("Custo da encomenda %d %d.\n", ide, sum);
        }
      }

    }
  }
  else
  {
    
  }

}

void changePrice()
{
  int ide;
  int posPE;
  int idp;
  int price;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (2 == 2)
  {
    idp = new_sym_var(sizeof(int) * 8);
    price = new_sym_var(sizeof(int) * 8);
    {
      if (idp > lastA)
      {
        {
          printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
        }
      }
      else
      {
        {
          armazem[idp].preco = price;
          for (ide = 0; ide <= lastE; ide++)
          {
            if ((posPE = find(idp, ide)) != (-1))
            {
              {
                encomendas[ide].produtos[posPE].preco = price;
              }
            }
            else
            {
              
            }

          }

        }
      }

    }
  }
  else
  {
    
  }

}

void showPInE()
{
  int posPE;
  int ide;
  int idp;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (2 == 2)
  {
    ide = new_sym_var(sizeof(int) * 8);
    idp = new_sym_var(sizeof(int) * 8);
    {
      if (ide > lastE)
      {
        {
          printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
        }
      }
      else
      {
        if (idp > lastA)
        {
          {
            printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
          }
        }
        else
        {
          if ((posPE = find(idp, ide)) != (-1))
          {
            {
              printf("%s %d.\n", armazem[idp].descricao, encomendas[ide].produtos[posPE].quantidade);
            }
          }
          else
          {
            {
              printf("%s 0.\n", armazem[idp].descricao);
            }
          }

        }

      }

    }
  }
  else
  {
    
  }

}

void eWithMostP()
{
  int ide;
  int max = 0;
  int posPE;
  int posE;
  int idp;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (1 == 1)
  {
    idp = new_sym_var(sizeof(int) * 8);
    {
      if (idp > lastA)
      {
        {
          printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
        }
      }
      else
      {
        {
          for (ide = 0; ide <= lastE; ide++)
          {
            if ((posPE = find(idp, ide)) != (-1))
            {
              {
                if (encomendas[ide].produtos[posPE].quantidade > max)
                {
                  {
                    max = encomendas[ide].produtos[posPE].quantidade;
                    posE = ide;
                  }
                }
                else
                {
                  
                }

              }
            }
            else
            {
              
            }

          }

          if (max != 0)
          {
            {
              printf("Maximo produto %d %d %d.\n", idp, encomendas[posE].id, max);
            }
          }
          else
          {
            
          }

        }
      }

    }
  }
  else
  {
    
  }

}

void printA()
{
  int i;
  produto *sortedArmazem = (produto *) malloc(10000 * (sizeof(produto)));
  copy(sortedArmazem);
  heapSort(sortedArmazem, lastA + 1);
  printf("Produtos\n");
  for (i = 0; i <= lastA; i++)
  {
    printf("* %s %d %d\n", sortedArmazem[i].descricao, sortedArmazem[i].preco, sortedArmazem[i].quantidade);
  }

  free(sortedArmazem);
}

void printE()
{
  int i;
  int ide;
  char input[100];
  fgets(input, sizeof(input), stdin);
  if (1 == 1)
  {
    ide = new_sym_var(sizeof(int) * 8);
    {
      if (ide > lastE)
      {
        {
          printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
        }
      }
      else
      {
        {
          printf("Encomenda %d\n", ide);
          for (i = 0; i <= encomendas[ide].lastP; i++)
          {
            if (encomendas[ide].produtos[i].quantidade > 0)
            {
              {
                printf("* %s %d %d\n", encomendas[ide].produtos[i].descricao, encomendas[ide].produtos[i].preco, encomendas[ide].produtos[i].quantidade);
              }
            }
            else
            {
              
            }

          }

        }
      }

    }
  }
  else
  {
    
  }

}

int main()
{
  char comand = getchar();
  while (comand != 'x')
  {
    getchar();
    if (comand == 'a')
    {
      {
        add();
      }
    }
    else
    {
      if (comand == 'q')
      {
        {
          addStock();
        }
      }
      else
      {
        if (comand == 'N')
        {
          {
            novaE();
          }
        }
        else
        {
          if (comand == 'A')
          {
            {
              addToE();
            }
          }
          else
          {
            if (comand == 'r')
            {
              {
                removeFromA();
              }
            }
            else
            {
              if (comand == 'R')
              {
                {
                  removeFromE();
                }
              }
              else
              {
                if (comand == 'C')
                {
                  {
                    totalPrice();
                  }
                }
                else
                {
                  if (comand == 'p')
                  {
                    {
                      changePrice();
                    }
                  }
                  else
                  {
                    if (comand == 'E')
                    {
                      {
                        showPInE();
                      }
                    }
                    else
                    {
                      if (comand == 'm')
                      {
                        {
                          eWithMostP();
                        }
                      }
                      else
                      {
                        if (comand == 'l')
                        {
                          {
                            printA();
                          }
                        }
                        else
                        {
                          if (comand == 'L')
                          {
                            {
                              printE();
                            }
                          }
                          else
                          {
                            
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

    comand = getchar();
  }

  return 0;
}

