/*File generated by PreProcessor.py*/


#include <stdio.h>


int i = -1;
int j = -1;
int k = 0;
typedef struct product
{
  int pid;
  char description[63];
  int price;
  int weight;
  int stock;
} Product;
typedef struct delivery
{
  Product list[189];
  int did;
  int total_weight;
} Delivery;
void createProduct(Product p[9999 + 1])
{
  Product a;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a.description[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a.description[10 - 1] = '\0';
  a.price = new_sym_var(sizeof(int) * 8);
  a.weight = new_sym_var(sizeof(int) * 8);
  a.stock = new_sym_var(sizeof(int) * 8);
  i++;
  if (i <= 9999)
  {
    a.pid = i;
    p[i] = a;
    printf("Novo produto %d.\n", a.pid);
  }
  else
  {
    
  }

}

void addStock(Product p[9999 + 1], int pid, int qtd)
{
  if (pid > i)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", pid);
  }
  else
  {
    p[pid].stock = p[pid].stock + qtd;
  }

}

void createDelivery(Delivery d[499 + 1])
{
  Delivery b;
  j++;
  if (j <= 499)
  {
    b.did = j;
    d[j] = b;
    d[j].total_weight = 0;
    printf("Nova encomenda %d.\n", d[j].did);
  }
  else
  {
    
  }

}

void addStockToDelivery(Delivery d[499 + 1], Product p[9999 + 1], int eid, int pid, int qtd)
{
  if (eid > j)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", pid, eid);
  }
  else
  {
    if (pid > i)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", pid, eid);
    }
    else
    {
      if ((p[pid].stock - qtd) < 0)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", pid, eid);
      }
      else
      {
        if ((d[eid].total_weight + (qtd * p[pid].weight)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", pid, eid);
        }
        else
        {
          p[pid].stock -= qtd;
          d[eid].total_weight += p[pid].weight * qtd;
          d[eid].list[pid].stock += qtd;
          d[eid].list[pid].price = p[pid].price;
          k++;
        }

      }

    }

  }

}

void removeStock(Product p[9999 + 1], int pid, int qtd)
{
  if (pid > i)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", pid);
  }
  else
  {
    int a = p[pid].stock - qtd;
    if (a < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, pid);
    }
    else
    {
      p[pid].stock = a;
    }

  }

}

void removeProductFromDelivery(Product p[9999 + 1], Delivery d[499 + 1], int eid, int pid)
{
  if (eid > j)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", pid, eid);
  }
  else
  {
    if (pid > i)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", pid, eid);
    }
    else
    {
      d[eid].total_weight -= d[eid].list[pid].stock * p[pid].weight;
      p[pid].stock += d[eid].list[pid].stock;
      d[eid].list[pid].stock = 0;
    }

  }

}

void calculateDeliveryPrice(Delivery d[499 + 1], int eid)
{
  int x;
  int total_p = 0;
  if (eid > j)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", eid);
  }
  else
  {
    for (x = 0; x <= i; x++)
    {
      total_p += d[eid].list[x].price * d[eid].list[x].stock;
    }

    printf("Custo da encomenda %d %d.\n", eid, total_p);
  }

}

void changePrice(Product p[9999 + 1], Delivery d[499 + 1], int pid, int new_price)
{
  int x;
  if (pid > i)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", pid);
  }
  else
  {
    p[pid].price = new_price;
    for (x = 0; x <= j; x++)
    {
      d[x].list[pid].price = new_price;
    }

  }

}

void returnDescriptionAndStock(Product p[9999 + 1], Delivery d[499 + 1], int pid, int eid)
{
  if (eid > j)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", eid);
  }
  else
  {
    if (pid > i)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", pid);
    }
    else
    {
      printf("%s %d.\n", p[pid].description, d[eid].list[pid].stock);
    }

  }

}

void findHighestProductStock(Delivery d[499 + 1], int pid)
{
  int x;
  int did;
  int qtt;
  int h_stock = 0;
  if (pid > i)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", pid);
  }
  else
  {
    if ((j >= 0) && (k > 0))
    {
      for (x = 0; x <= j; x++)
      {
        if (h_stock < d[x].list[pid].stock)
        {
          h_stock = d[x].list[pid].stock;
          did = x;
          qtt = d[x].list[pid].stock;
        }
        else
        {
          continue;
        }

      }

      if (h_stock != 0)
      {
        printf("Maximo produto %d %d %d.\n", pid, did, qtt);
      }
      else
      {
        
      }

    }
    else
    {
      
    }

  }

}

void listProducts(Product p[9999 + 1])
{
  int x;
  int y = 0;
  int price = 1;
  printf("Produtos\n");
  while (y <= i)
  {
    for (x = 0; x <= i; x++)
    {
      if (p[x].price == price)
      {
        printf("* %s %d %d\n", p[x].description, p[x].price, p[x].stock);
        y++;
      }
      else
      {
        continue;
      }

    }

    price++;
  }

}

void listProductsInDelivery(Product p[9999 + 1], Delivery d[499 + 1], int eid)
{
  char a = 'a';
  int x;
  if (eid > j)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", eid);
  }
  else
  {
    printf("Encomenda %d\n", eid);
    while (a <= 'z')
    {
      for (x = 0; x <= i; x++)
      {
        if ((p[x].description[0] == a) && (d[eid].list[x].stock != 0))
        {
          printf("* %s %d %d\n", p[x].description, d[eid].list[x].price, d[eid].list[x].stock);
        }
        else
        {
          continue;
        }

      }

      a++;
    }

  }

}

int main()
{
  Product products[9999];
  Delivery deliveries[499];
  char c;
  int eid;
  int pid;
  int p;
  int qtd;
  c = new_sym_var(sizeof(char) * 8);
  while (c != 'x')
  {
    switch (c)
    {
      case 'a':
        createProduct(products);
        break;

      case 'q':
        pid = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        addStock(products, pid, qtd);
        break;

      case 'N':
        createDelivery(deliveries);
        break;

      case 'A':
        eid = new_sym_var(sizeof(int) * 8);
        pid = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        addStockToDelivery(deliveries, products, eid, pid, qtd);
        break;

      case 'r':
        pid = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        removeStock(products, pid, qtd);
        break;

      case 'R':
        eid = new_sym_var(sizeof(int) * 8);
        pid = new_sym_var(sizeof(int) * 8);
        removeProductFromDelivery(products, deliveries, eid, pid);
        break;

      case 'C':
        eid = new_sym_var(sizeof(int) * 8);
        calculateDeliveryPrice(deliveries, eid);
        break;

      case 'p':
        pid = new_sym_var(sizeof(int) * 8);
        p = new_sym_var(sizeof(int) * 8);
        changePrice(products, deliveries, pid, p);
        break;

      case 'E':
        eid = new_sym_var(sizeof(int) * 8);
        pid = new_sym_var(sizeof(int) * 8);
        returnDescriptionAndStock(products, deliveries, pid, eid);
        break;

      case 'm':
        pid = new_sym_var(sizeof(int) * 8);
        findHighestProductStock(deliveries, pid);
        break;

      case 'l':
        listProducts(products);
        break;

      case 'L':
        eid = new_sym_var(sizeof(int) * 8);
        listProductsInDelivery(products, deliveries, eid);
        break;

    }

    c = new_sym_var(sizeof(char) * 8);
  }

  return 0;
}

