/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct 
{
  int id;
  int check;
  int preco;
  int peso;
  int stock;
  char descricao[64];
} struc;
typedef struct 
{
  int id;
  int peso;
  int check;
  struc produto[10000];
} encom;
struc produtos[10000];
encom encomendas[500];
int main()
{
  char d;
  int a;
  int b;
  int c;
  int i = 0;
  int e = 0;
  int count = 0;
  do
  {
    switch (d = getchar())
    {
      case 'a':
      {
        getchar();
        for (int produtos_index = 0; produtos_index < 10; produtos_index++)
        {
          produtos[i].descricao[produtos_index] = new_sym_var(sizeof(char) * 8);
        }

        produtos[i].descricao[10 - 1] = '\0';
        produtos[i].preco = new_sym_var(sizeof(int) * 8);
        produtos[i].peso = new_sym_var(sizeof(int) * 8);
        produtos[i].stock = new_sym_var(sizeof(int) * 8);
        printf("Novo produto %d.\n", i);
        produtos[i].check = 1;
        produtos[i].id = i;
        count += 1;
        i++;
        break;
      }

      case 'q':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        if (produtos[a].check)
        {
          {
            produtos[a].stock += b;
          }
        }
        else
        {
          printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", a);
        }

        break;
      }

      case 'N':
      {
        printf("Nova encomenda %d.\n", e);
        encomendas[e].check = 1;
        encomendas[e].id = e;
        e++;
        break;
      }

      case 'A':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        c = new_sym_var(sizeof(int) * 8);
        if (encomendas[a].check)
        {
          {
            if (produtos[b].check)
            {
              {
                if (c <= produtos[b].stock)
                {
                  {
                    encomendas[a].peso += produtos[b].peso * c;
                    if (encomendas[a].peso <= 200)
                    {
                      {
                        strcpy(encomendas[a].produto[b].descricao, produtos[b].descricao);
                        encomendas[a].produto[b].preco = produtos[b].preco;
                        encomendas[a].produto[b].peso = produtos[b].peso;
                        encomendas[a].produto[b].id = b;
                        encomendas[a].produto[b].stock += c;
                        produtos[b].stock -= c;
                        encomendas[a].produto[b].check = 1;
                      }
                    }
                    else
                    {
                      {
                        encomendas[a].peso -= produtos[b].peso * c;
                        printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", b, a);
                      }
                    }

                  }
                }
                else
                {
                  printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", b, a);
                }

              }
            }
            else
            {
              printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", b, a);
            }

          }
        }
        else
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", b, a);
        }

        break;
      }

      case 'r':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        if (produtos[a].check)
        {
          {
            if ((produtos[a].stock - b) < 0)
            {
              {
                printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", b, a);
              }
            }
            else
            {
              produtos[a].stock = produtos[a].stock - b;
            }

          }
        }
        else
        {
          printf("Impossivel remover stock do produto %d. Produto inexistente.\n", a);
        }

        break;
      }

      case 'R':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        if (encomendas[a].check)
        {
          {
            if (produtos[b].check)
            {
              {
                encomendas[a].produto[b].check = 0;
                produtos[b].stock += encomendas[a].produto[b].stock;
                encomendas[a].peso -= produtos[b].peso * encomendas[a].produto[b].stock;
                encomendas[a].produto[b].stock = 0;
              }
            }
            else
            {
              printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", b, a);
            }

          }
        }
        else
        {
          printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", b, a);
        }

        break;
      }

      case 'C':
      {
        a = new_sym_var(sizeof(int) * 8);
        if (encomendas[a].check)
        {
          {
            int j;
            int custo = 0;
            for (j = 0; j < 10000; j++)
            {
              custo += produtos[j].preco * encomendas[a].produto[j].stock;
            }

            printf("Custo da encomenda %d %d.\n", a, custo);
          }
        }
        else
        {
          printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", a);
        }

        break;
      }

      case 'p':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        if (produtos[a].check)
        {
          {
            produtos[a].preco = b;
          }
        }
        else
        {
          printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", a);
        }

        break;
      }

      case 'E':
      {
        a = new_sym_var(sizeof(int) * 8);
        b = new_sym_var(sizeof(int) * 8);
        if (encomendas[a].check)
        {
          {
            if (produtos[b].check)
            {
              {
                printf("%s %d.\n", produtos[b].descricao, encomendas[a].produto[b].stock);
              }
            }
            else
            {
              printf("Impossivel listar produto %d. Produto inexistente.\n", b);
            }

          }
        }
        else
        {
          printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", a);
        }

        break;
      }

      case 'm':
      {
        int l;
        int o;
        int maior = 0;
        a = new_sym_var(sizeof(int) * 8);
        if (produtos[a].check)
        {
          {
            for (l = 0; l < 500; l++)
            {
              if (encomendas[l].produto[a].check)
              {
                if (encomendas[l].produto[a].stock > maior)
                {
                  {
                    maior = encomendas[l].produto[a].stock;
                    o = encomendas[l].id;
                  }
                }
                else
                {
                  
                }

              }
              else
              {
                
              }

            }

            if (maior == 0)
            {
              {
                break;
              }
            }
            else
            {
              printf("Maximo produto %d %d %d.\n", a, o, maior);
            }

          }
        }
        else
        {
          printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", a);
        }

        break;
      }

      case 'l':
      {
        struc temp;
        struc arr[10000];
        int i;
        int j;
        for (i = 0; produtos[i].check != 0; i++)
        {
          arr[i].check = 1;
          strcpy(arr[i].descricao, produtos[i].descricao);
          arr[i].id = produtos[i].id;
          arr[i].stock = produtos[i].stock;
          arr[i].preco = produtos[i].preco;
          arr[i].peso = produtos[i].peso;
        }

        for (i = 1; i < count; i++)
          for (j = 0; j < (count - i); j++)
        {
          if (arr[j].preco > arr[j + 1].preco)
          {
            {
              temp = arr[j];
              arr[j] = arr[j + 1];
              arr[j + 1] = temp;
            }
          }
          else
          {
            
          }

        }


        printf("Produtos\n");
        for (i = 0; i < count; i++)
        {
          printf("* %s %d %d\n", arr[i].descricao, arr[i].preco, arr[i].stock);
        }

        break;
      }

      case 'L':
      {
        struc temp;
        struc arr[10000];
        int i;
        int j;
        a = new_sym_var(sizeof(int) * 8);
        if (encomendas[a].check)
        {
          {
            for (j = 0; j != 10000; j++)
            {
              arr[j].check = encomendas[a].produto[j].check;
              strcpy(arr[j].descricao, encomendas[a].produto[j].descricao);
              arr[j].id = encomendas[a].produto[j].id;
              arr[j].peso = encomendas[a].produto[j].peso;
              arr[j].preco = encomendas[a].produto[j].preco;
              arr[j].stock = encomendas[a].produto[j].stock;
            }

            for (i = 1; i < count; i++)
              for (j = 0; j < (count - i); j++)
            {
              if ((strcmp(arr[j].descricao, arr[j + 1].descricao) > 0) || (strlen(arr[j].descricao) == 0))
              {
                {
                  temp = arr[j];
                  arr[j] = arr[j + 1];
                  arr[j + 1] = temp;
                }
              }
              else
              {
                
              }

            }


            printf("Encomenda %d\n", a);
            for (i = 0; arr[i].check != 0; i++)
            {
              printf("* %s %d %d\n", arr[i].descricao, arr[i].preco, encomendas[a].produto[arr[i].id].stock);
            }

          }
        }
        else
        {
          printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", a);
        }

        break;
      }

    }

  }
  while (d != 'x');
  return 0;
}

