/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  char desc[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct 
{
  produto ve[200];
  int prodstot;
  int pesotot;
} encomenda;
void a(int idplivre, produto v[])
{
  int preco;
  int peso;
  int qtd;
  char desc[63] = {'0'};
  for (int desc_index = 0; desc_index < 10; desc_index++)
  {
    desc[desc_index] = new_sym_var(sizeof(char) * 8);
  }

  desc[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  getchar();
  strcpy(v[idplivre].desc, desc);
  v[idplivre].preco = preco;
  v[idplivre].peso = peso;
  v[idplivre].qtd = qtd;
  printf("Novo produto %d.\n", idplivre);
}

void q(int idplivre, produto v[])
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idp < idplivre)
  {
    v[idp].qtd += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

}

void A(encomenda e[], produto v[], int idelivre, int idplivre)
{
  int ide;
  int idp;
  int qtd;
  int i;
  int existe = 0;
  int indice;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  getchar();
  if (ide >= idelivre)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= idplivre)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (v[idp].qtd < qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((e[ide].pesotot + (v[idp].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          {
            for (i = 0; i < e[ide].prodstot; i++)
              if (strcmp(e[ide].ve[i].desc, v[idp].desc) == 0)
            {
              {
                existe = 1;
                indice = i;
              }
            }
            else
            {
              
            }


            if (existe)
            {
              e[ide].ve[indice].qtd += qtd;
            }
            else
            {
              {
                e[ide].ve[e[ide].prodstot] = v[idp];
                e[ide].ve[e[ide].prodstot].qtd = qtd;
                e[ide].prodstot++;
              }
            }

            e[ide].pesotot += v[idp].peso * qtd;
            v[idp].qtd -= qtd;
          }
        }

      }

    }

  }

}

void r(produto v[], int idplivre)
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idp >= idplivre)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (v[idp].qtd < qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      v[idp].qtd -= qtd;
    }

  }

}

void R(encomenda e[], produto v[], int idelivre, int idplivre)
{
  int ide;
  int idp;
  int i;
  int indice;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idelivre <= ide)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idplivre <= idp)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      {
        for (i = 0; i < e[ide].prodstot; i++)
          if (strcmp(e[ide].ve[i].desc, v[idp].desc) == 0)
        {
          {
            indice = i;
            e[ide].pesotot -= e[ide].ve[indice].qtd * e[ide].ve[indice].peso;
            v[idp].qtd += e[ide].ve[indice].qtd;
            while (indice < (e[ide].prodstot - 1))
            {
              e[ide].ve[indice] = e[ide].ve[indice + 1];
              indice++;
            }

            e[ide].prodstot--;
          }
        }
        else
        {
          
        }


      }
    }

  }

}

void C(encomenda e[], int idelivre)
{
  int ide;
  int precotot = 0;
  int i = 0;
  ide = new_sym_var(sizeof(int) * 8);
  getchar();
  if (ide >= idelivre)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    {
      while (i < e[ide].prodstot)
      {
        precotot += e[ide].ve[i].qtd * e[ide].ve[i].preco;
        i++;
      }

      printf("Custo da encomenda %d %d.\n", ide, precotot);
    }
  }

}

void p(encomenda e[], produto v[], int idelivre, int idplivre)
{
  int idp;
  int preco;
  int i;
  int j;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idplivre <= idp)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    {
      v[idp].preco = preco;
      for (i = 0; i < idelivre; i++)
        for (j = 0; j < e[i].prodstot; j++)
        if (strcmp(v[idp].desc, e[i].ve[j].desc) == 0)
      {
        e[i].ve[j].preco = preco;
      }
      else
      {
        
      }



    }
  }

}

void E(encomenda e[], produto v[], int idelivre, int idplivre)
{
  int ide;
  int idp;
  int i;
  int qtd = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idelivre <= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idplivre <= idp)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      {
        for (i = 0; i < e[ide].prodstot; i++)
          if (strcmp(e[ide].ve[i].desc, v[idp].desc) == 0)
        {
          qtd = e[ide].ve[i].qtd;
        }
        else
        {
          
        }


        printf("%s %d.\n", v[idp].desc, qtd);
      }
    }

  }

}

void m(encomenda e[], produto v[], int idelivre, int idplivre)
{
  int idp;
  int idemin;
  int contador1;
  int contador2;
  int qtdmax = 0;
  idp = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idplivre <= idp)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (idelivre > 0)
    {
      {
        for (contador1 = 0; contador1 < idelivre; contador1++)
          for (contador2 = 0; contador2 < e[contador1].prodstot; contador2++)
          if (strcmp(e[contador1].ve[contador2].desc, v[idp].desc) == 0)
        {
          if (e[contador1].ve[contador2].qtd > qtdmax)
          {
            {
              qtdmax = e[contador1].ve[contador2].qtd;
              idemin = contador1;
            }
          }
          else
          {
            
          }

        }
        else
        {
          
        }



        if (qtdmax > 0)
        {
          printf("Maximo produto %d %d %d.\n", idp, idemin, qtdmax);
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

}

void l(produto v[], int idplivre)
{
  int j;
  int i;
  int contador;
  produto p;
  for (i = 0; i < idplivre; i++)
    for (j = 0; j < ((idplivre - 1) - i); j++)
    if (v[j].preco > v[j + 1].preco)
  {
    {
      p = v[j];
      v[j] = v[j + 1];
      v[j + 1] = p;
    }
  }
  else
  {
    
  }



  printf("Produtos\n");
  for (contador = 0; contador < idplivre; contador++)
    printf("* %s %d %d\n", v[contador].desc, v[contador].preco, v[contador].qtd);

}

void L(encomenda e[], int idelivre)
{
  int ide;
  int i;
  int j;
  int feito;
  int cont;
  produto t;
  ide = new_sym_var(sizeof(int) * 8);
  getchar();
  if (idelivre <= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    {
      for (i = 0; i < (e[ide].prodstot - 1); i++)
      {
        feito = 1;
        for (j = 0; j < ((e[ide].prodstot - 1) + (0 - i)); j++)
          if (strcmp(e[ide].ve[j].desc, e[ide].ve[j + 1].desc) > 0)
        {
          {
            t = e[ide].ve[j];
            e[ide].ve[j] = e[ide].ve[j + 1];
            e[ide].ve[j + 1] = t;
            feito = 0;
          }
        }
        else
        {
          
        }


        if (feito)
        {
          break;
        }
        else
        {
          
        }

      }

      printf("Encomenda %d\n", ide);
      for (cont = 0; cont < e[ide].prodstot; cont++)
        printf("* %s %d %d\n", e[ide].ve[cont].desc, e[ide].ve[cont].preco, e[ide].ve[cont].qtd);

    }
  }

}

int main()
{
  char cmd;
  int idplivre = 0;
  int idelivre = 0;
  produto v[10000];
  encomenda e[500];
  while (cmd = getchar())
  {
    getchar();
    switch (cmd)
    {
      case 'a':
        a(idplivre, v);
        idplivre++;
        break;

      case 'q':
        q(idplivre, v);
        break;

      case 'N':
        printf("Nova encomenda %d.\n", idelivre);
        e[idelivre].pesotot = 0;
        e[idelivre].prodstot = 0;
        idelivre++;
        break;

      case 'A':
        A(e, v, idelivre, idplivre);
        break;

      case 'r':
        r(v, idplivre);
        break;

      case 'R':
        R(e, v, idelivre, idplivre);
        break;

      case 'C':
        C(e, idelivre);
        break;

      case 'p':
        p(e, v, idelivre, idplivre);
        break;

      case 'E':
        E(e, v, idelivre, idplivre);
        break;

      case 'm':
        m(e, v, idelivre, idplivre);
        break;

      case 'l':
        l(v, idplivre);
        break;

      case 'L':
        L(e, idelivre);
        break;

      case 'x':
        return 0;

    }

  }

  return 0;
}

