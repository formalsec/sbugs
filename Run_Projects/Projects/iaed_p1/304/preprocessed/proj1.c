/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  int identificador;
  char descricao[63];
  int preco;
  int peso;
  int stock;
} produto;
typedef struct 
{
  int prod_in_encomenda[200][3];
  int id_encomenda;
  int var_existente;
} encomenda;
produto lista_produtos[10000];
int idp;
encomenda lista_encomendas[500];
int idp_enc;
void cria_produto()
{
  for (int lista_produtos_index = 0; lista_produtos_index < 10; lista_produtos_index++)
  {
    lista_produtos[idp].descricao[lista_produtos_index] = new_sym_var(sizeof(char) * 8);
  }

  lista_produtos[idp].descricao[10 - 1] = '\0';
  lista_produtos[idp].preco = new_sym_var(sizeof(int) * 8);
  lista_produtos[idp].peso = new_sym_var(sizeof(int) * 8);
  lista_produtos[idp].stock = new_sym_var(sizeof(int) * 8);
  lista_produtos[idp].identificador = idp;
  printf("Novo produto %d.\n", lista_produtos[idp].identificador);
  idp += 1;
}

void aumenta_stock()
{
  int i;
  int a;
  int qtd;
  i = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  for (a = 0; (lista_produtos[a].identificador != i) && (a < idp); a++)
    a = a;

  if (lista_produtos[a].preco != 0)
  {
    lista_produtos[a].stock += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", i);
  }

}

void cria_encomenda()
{
  lista_encomendas[idp_enc].id_encomenda = idp_enc;
  lista_encomendas[idp_enc].var_existente = 1;
  printf("Nova encomenda %d.\n", lista_encomendas[idp_enc].id_encomenda);
  idp_enc += 1;
}

void adiciona_prod_a_encomenda()
{
  int i;
  int n;
  int q;
  int a;
  int b;
  int c;
  int d;
  int soma = 0;
  int num_prod;
  int e;
  i = new_sym_var(sizeof(int) * 8);
  n = new_sym_var(sizeof(int) * 8);
  q = new_sym_var(sizeof(int) * 8);
  for (a = 0; (lista_produtos[a].identificador != n) && (a < idp); a++)
    a = a;

  for (b = 0; (lista_encomendas[b].id_encomenda != i) && (b < idp_enc); b++)
    b = b;

  if (lista_produtos[a].preco == 0)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", n, i);
  }
  else
  {
    if (q > lista_produtos[a].stock)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", n, i);
    }
    else
    {
      if (lista_encomendas[b].var_existente != 1)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", n, i);
      }
      else
      {
        for (c = 0; (lista_encomendas[b].prod_in_encomenda[c][0] != lista_produtos[a].identificador) && (lista_encomendas[b].prod_in_encomenda[c][2] == 1); c++)
          c = c;

        if ((lista_encomendas[b].prod_in_encomenda[c][0] == lista_produtos[a].identificador) && (lista_encomendas[b].prod_in_encomenda[c][2] == 1))
        {
          lista_encomendas[b].prod_in_encomenda[c][1] += q;
          for (d = 0; d <= 200; d++)
          {
            num_prod = lista_encomendas[b].prod_in_encomenda[d][0];
            for (e = 0; e < idp; e++)
            {
              if (lista_produtos[e].identificador == num_prod)
              {
                soma += lista_encomendas[b].prod_in_encomenda[d][1] * lista_produtos[e].peso;
              }
              else
              {
                
              }

            }

          }

          if (soma > 200)
          {
            lista_encomendas[b].prod_in_encomenda[c][1] -= q;
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", n, i);
          }
          else
          {
            lista_produtos[a].stock -= q;
          }

        }
        else
        {
          lista_encomendas[b].prod_in_encomenda[c][0] = lista_produtos[a].identificador;
          lista_encomendas[b].prod_in_encomenda[c][1] = q;
          for (d = 0; d <= 200; d++)
          {
            num_prod = lista_encomendas[b].prod_in_encomenda[d][0];
            for (e = 0; e < idp; e++)
            {
              if (lista_produtos[e].identificador == num_prod)
              {
                soma += lista_encomendas[b].prod_in_encomenda[d][1] * lista_produtos[e].peso;
              }
              else
              {
                
              }

            }

          }

          if (soma <= 200)
          {
            lista_encomendas[b].prod_in_encomenda[c][2] = 1;
            lista_produtos[a].stock -= q;
          }
          else
          {
            lista_encomendas[b].prod_in_encomenda[c][0] = 0;
            lista_encomendas[b].prod_in_encomenda[c][1] = 0;
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", n, i);
          }

        }

      }

    }

  }

}

void remove_stock_produto()
{
  int i;
  int a;
  int q;
  int e;
  int b;
  int soma_stock = 0;
  i = new_sym_var(sizeof(int) * 8);
  q = new_sym_var(sizeof(int) * 8);
  for (a = 0; (lista_produtos[a].identificador != i) && (a < idp); a++)
  {
    a = a;
  }

  for (e = 0; e < 500; e++)
  {
    for (b = 0; b < 200; b++)
    {
      if (lista_encomendas[e].prod_in_encomenda[b][0] == a)
      {
        soma_stock += lista_encomendas[e].prod_in_encomenda[b][1];
      }
      else
      {
        
      }

    }

  }

  if (lista_produtos[a].preco == 0)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", i);
  }
  else
  {
    if ((lista_produtos[a].stock - q) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", q, i);
    }
    else
    {
      lista_produtos[a].stock -= q;
    }

  }

}

void altera_preco_produto()
{
  int i;
  int a;
  int p;
  i = new_sym_var(sizeof(int) * 8);
  p = new_sym_var(sizeof(int) * 8);
  for (a = 0; (lista_produtos[a].identificador != i) && (a < idp); a++)
  {
    a = a;
  }

  if (lista_produtos[a].preco == 0)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", i);
  }
  else
  {
    lista_produtos[a].preco = p;
  }

}

void custo_encomenda()
{
  int i;
  int m;
  int c;
  int l;
  int a;
  int id_preco;
  int soma = 0;
  int valor_id[200];
  i = new_sym_var(sizeof(int) * 8);
  for (c = 0; (lista_encomendas[c].id_encomenda != i) && (c < idp_enc); c++)
    c = c;

  if (lista_encomendas[c].var_existente != 1)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", i);
  }
  else
  {
    for (m = 0; (m < 200) && (lista_encomendas[c].prod_in_encomenda[m][2] == 1); m++)
      valor_id[m] = lista_encomendas[c].prod_in_encomenda[m][0];

    for (l = 0; l < 200; l++)
    {
      id_preco = valor_id[l];
      for (a = 0; a < idp; a++)
      {
        if (lista_produtos[a].identificador == id_preco)
        {
          soma += lista_produtos[a].preco * lista_encomendas[c].prod_in_encomenda[l][1];
        }
        else
        {
          
        }

      }

    }

    printf("Custo da encomenda %d %d.\n", lista_encomendas[c].id_encomenda, soma);
  }

}

void desc_stock_prod_in_encomenda()
{
  int i;
  int n;
  int c;
  int a;
  int d;
  i = new_sym_var(sizeof(int) * 8);
  n = new_sym_var(sizeof(int) * 8);
  for (c = 0; (lista_encomendas[c].id_encomenda != i) && (c < idp_enc); c++)
    c = c;

  for (a = 0; (lista_produtos[a].identificador != n) && (a < idp); a++)
    a = a;

  for (d = 0; (lista_encomendas[c].prod_in_encomenda[d][0] != n) && (d < 200); d++)
    d = d;

  if (lista_encomendas[c].var_existente != 1)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", i);
  }
  else
  {
    if (lista_produtos[a].identificador != n)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", n);
    }
    else
    {
      printf("%s %d.\n", lista_produtos[a].descricao, lista_encomendas[c].prod_in_encomenda[d][1]);
    }

  }

}

void remove_produto_encomenda()
{
  int i;
  int n;
  int a;
  int c;
  int quant;
  int b;
  int e;
  i = new_sym_var(sizeof(int) * 8);
  n = new_sym_var(sizeof(int) * 8);
  for (c = 0; (lista_encomendas[c].id_encomenda != i) && (c < idp_enc); c++)
    c = c;

  for (a = 0; (lista_produtos[a].identificador != n) && (a < idp); a++)
    a = a;

  if (lista_encomendas[c].var_existente != 1)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", n, i);
  }
  else
  {
    if (lista_produtos[a].preco == 0)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", n, i);
    }
    else
    {
      for (b = 0; lista_encomendas[c].prod_in_encomenda[b][0] != n; b++)
        b = b;

      quant = lista_encomendas[c].prod_in_encomenda[b][1];
      lista_encomendas[c].prod_in_encomenda[b][1] = 0;
      lista_encomendas[c].prod_in_encomenda[b][0] = 0;
      lista_encomendas[c].prod_in_encomenda[b][2] = 0;
      lista_produtos[a].stock += quant;
      for (e = b; e < 500; e++)
      {
        lista_encomendas[c].prod_in_encomenda[e][0] = lista_encomendas[c].prod_in_encomenda[e + 1][0];
        lista_encomendas[c].prod_in_encomenda[e][1] = lista_encomendas[c].prod_in_encomenda[e + 1][1];
        lista_encomendas[c].prod_in_encomenda[e][2] = lista_encomendas[c].prod_in_encomenda[e + 1][2];
      }

    }

  }

  lista_encomendas[c].var_existente = 1;
}

void identificador_prod_ocorre_mais()
{
  int n;
  int a;
  int e;
  int i;
  int max = 0;
  int v;
  n = new_sym_var(sizeof(int) * 8);
  for (a = 0; (lista_produtos[a].identificador != n) && (a < idp); a++)
    a = a;

  if (lista_produtos[a].preco == 0)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", n);
  }
  else
  {
    for (e = 0; lista_encomendas[e].var_existente == 1; e++)
    {
      for (i = 0; lista_encomendas[e].prod_in_encomenda[i][0] != lista_produtos[a].identificador; i++)
        i = i;

      if ((lista_encomendas[e].prod_in_encomenda[i][0] == lista_produtos[a].identificador) && (lista_encomendas[e].prod_in_encomenda[i][2] == 1))
      {
        if (lista_encomendas[e].prod_in_encomenda[i][1] > max)
        {
          v = lista_encomendas[e].id_encomenda;
          max = lista_encomendas[e].prod_in_encomenda[i][1];
        }
        else
        {
          if (lista_encomendas[e].prod_in_encomenda[i][1] == max)
          {
            if (lista_encomendas[e].id_encomenda < v)
            {
              v = lista_encomendas[e].id_encomenda;
              max = lista_encomendas[e].prod_in_encomenda[i][1];
            }
            else
            {
              
            }

          }
          else
          {
            
          }

        }

      }
      else
      {
        
      }

    }

    if ((v < idp_enc) && (max > 0))
    {
      printf("Maximo produto %d %d %d.\n", n, v, max);
    }
    else
    {
      
    }

  }

}

void prod_ord_alfabetica()
{
  int i;
  int c;
  int d;
  int a;
  int m;
  int j;
  char str[200][63];
  char temp[63];
  int v_final[200][2];
  int vector[2];
  i = new_sym_var(sizeof(int) * 8);
  for (c = 0; (lista_encomendas[c].id_encomenda != i) && (c < idp_enc); c++)
    c = c;

  if (lista_encomendas[c].var_existente != 1)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", i);
  }
  else
  {
    for (d = 0; lista_encomendas[c].prod_in_encomenda[d][2] == 1; d++)
    {
      for (a = 0; lista_produtos[a].identificador != lista_encomendas[c].prod_in_encomenda[d][0]; a++)
        a = a;

      strcpy(str[d], lista_produtos[a].descricao);
      v_final[d][0] = lista_produtos[a].preco;
      v_final[d][1] = lista_encomendas[c].prod_in_encomenda[d][1];
    }

    for (m = 1; m < 200; m++)
    {
      for (j = 1; j < 200; j++)
      {
        if (strcmp(str[j - 1], str[j]) > 0)
        {
          strcpy(temp, str[j - 1]);
          vector[0] = v_final[j - 1][0];
          vector[1] = v_final[j - 1][1];
          strcpy(str[j - 1], str[j]);
          v_final[j - 1][0] = v_final[j][0];
          v_final[j - 1][1] = v_final[j][1];
          strcpy(str[j], temp);
          v_final[j][0] = vector[0];
          v_final[j][1] = vector[1];
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", i);
    for (m = 0; m < 200; m++)
    {
      if (v_final[m][0] != 0)
      {
        printf("* %s %d %d\n", str[m], v_final[m][0], v_final[m][1]);
      }
      else
      {
        
      }

    }

    for (m = 0; m < 200; m++)
      v_final[m][0] = 0;

  }

}

void prod_ord_preco()
{
  int a;
  int i;
  int j;
  int v;
  int x;
  int precos[10000];
  int ident[10000];
  for (a = 0; a < idp; a++)
  {
    precos[a] = lista_produtos[a].preco;
    ident[a] = lista_produtos[a].identificador;
  }

  for (i = 0; i < idp; ++i)
  {
    for (j = i + 1; j < idp; ++j)
    {
      if (precos[i] > precos[j])
      {
        v = precos[i];
        x = ident[i];
        precos[i] = precos[j];
        ident[i] = ident[j];
        precos[j] = v;
        ident[j] = x;
      }
      else
      {
        
      }

    }

  }

  printf("Produtos\n");
  for (i = 0; i < idp; i++)
  {
    for (a = 0; lista_produtos[a].identificador != ident[i]; a++)
      a = a;

    printf("* %s %d %d\n", lista_produtos[a].descricao, precos[i], lista_produtos[a].stock);
  }

}

int main()
{
  char comando;
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        cria_produto();
        break;

      case 'q':
        aumenta_stock();
        break;

      case 'N':
        cria_encomenda();
        break;

      case 'A':
        adiciona_prod_a_encomenda();
        break;

      case 'r':
        remove_stock_produto();
        break;

      case 'R':
        remove_produto_encomenda();
        break;

      case 'C':
        custo_encomenda();
        break;

      case 'p':
        altera_preco_produto();
        break;

      case 'E':
        desc_stock_prod_in_encomenda();
        break;

      case 'm':
        identificador_prod_ocorre_mais();
        break;

      case 'l':
        prod_ord_preco();
        break;

      case 'L':
        prod_ord_alfabetica();
        break;

    }

  }

  return 0;
}

