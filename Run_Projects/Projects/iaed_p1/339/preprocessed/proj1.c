/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


int numProduto = 0;
int numEnc = 0;
typedef struct produto
{
  int identificador;
  int preco;
  int peso;
  int quantidade;
  char descricao[63];
} Produto;
Produto sistemaPro[10000] = {0};
typedef struct encomenda
{
  int identificador;
  int peso;
  Produto produtos[200];
} Encomenda;
Encomenda sistemaEnc[500] = {0};
void listaProdutos()
{
  int i;
  int a = 0;
  int b = 0;
  int c = 0;
  int d = 0;
  int e = 0;
  int max_ind = 1;
  int max_desc = 1;
  int max_preco = 1;
  int max_peso = 1;
  int max_quant = 1;
  int number;
  int len_str;
  int contador = 0;
  for (i = 0; i < numProduto; ++i)
  {
    len_str = strlen(sistemaPro[i].descricao);
    if (len_str > max_desc)
    {
      max_desc = len_str;
    }
    else
    {
      
    }

    while (a < 4)
    {
      if (a == 0)
      {
        number = sistemaPro[i].identificador;
      }
      else
      {
        
      }

      if (a == 1)
      {
        number = sistemaPro[i].preco;
      }
      else
      {
        
      }

      if (a == 2)
      {
        number = sistemaPro[i].peso;
      }
      else
      {
        
      }

      if (a == 3)
      {
        number = sistemaPro[i].quantidade;
      }
      else
      {
        
      }

      while (number != 0)
      {
        number = number / 10;
        contador++;
      }

      if (a == 0)
      {
        if (contador > max_ind)
        {
          max_ind = contador;
        }
        else
        {
          
        }

        contador = 0;
      }
      else
      {
        if (a == 1)
        {
          if (contador > max_preco)
          {
            max_preco = contador;
          }
          else
          {
            
          }

          contador = 0;
        }
        else
        {
          if (a == 2)
          {
            if (contador > max_peso)
            {
              max_peso = contador;
            }
            else
            {
              
            }

            contador = 0;
          }
          else
          {
            if (a == 3)
            {
              if (contador > max_quant)
              {
                max_quant = contador;
              }
              else
              {
                
              }

              contador = 0;
            }
            else
            {
              
            }

          }

        }

      }

      a++;
    }

    a = 0;
  }

  for (i = 0; i < numProduto; ++i)
  {
    printf("\n| %d\t", i);
    while (a < max_ind)
    {
      printf(" ");
      a++;
    }

    a = 0;
    if (strlen(sistemaPro[i].descricao) < 5)
    {
      printf("| %s\t\t", sistemaPro[i].descricao);
    }
    else
    {
      printf("| %s\t", sistemaPro[i].descricao);
    }

    while (b < max_desc)
    {
      printf(" ");
      b++;
    }

    b = 0;
    printf("| %d\t", sistemaPro[i].preco);
    while (c < max_preco)
    {
      printf(" ");
      c++;
    }

    c = 0;
    printf("| %d\t", sistemaPro[i].peso);
    while (d < max_peso)
    {
      printf(" ");
      d++;
    }

    d = 0;
    printf("| %d\t", sistemaPro[i].quantidade);
    while (e < max_quant)
    {
      printf(" ");
      e++;
    }

    e = 0;
    printf("|\n");
  }

  return;
}

void listaEncomenda()
{
  int idEnc_Lst;
  int i = 0;
  idEnc_Lst = new_sym_var(sizeof(int) * 8);
  if (!strcmp(sistemaEnc[idEnc_Lst].produtos[i].descricao, ""))
  {
    printf("Nao existem produtos na encomenda.\n");
    return;
  }
  else
  {
    
  }

  printf("Encomenda %d:\nPeso total: %d\n", idEnc_Lst, sistemaEnc[idEnc_Lst].peso);
  while (i < 200)
  {
    if (!strcmp(sistemaEnc[idEnc_Lst].produtos[i].descricao, ""))
    {
      break;
    }
    else
    {
      
    }

    printf("%d: %s:%d:%d:%d\n", sistemaEnc[idEnc_Lst].produtos[i].identificador, sistemaEnc[idEnc_Lst].produtos[i].descricao, sistemaEnc[idEnc_Lst].produtos[i].preco, sistemaEnc[idEnc_Lst].produtos[i].peso, sistemaEnc[idEnc_Lst].produtos[i].quantidade);
    i++;
  }

  return;
}

void adicionaProduto()
{
  sistemaPro[numProduto].identificador = numProduto;
  for (int sistemaPro_index = 0; sistemaPro_index < 10; sistemaPro_index++)
  {
    sistemaPro[numProduto].descricao[sistemaPro_index] = new_sym_var(sizeof(char) * 8);
  }

  sistemaPro[numProduto].descricao[10 - 1] = '\0';
  sistemaPro[numProduto].preco = new_sym_var(sizeof(int) * 8);
  sistemaPro[numProduto].peso = new_sym_var(sizeof(int) * 8);
  sistemaPro[numProduto].quantidade = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", numProduto);
  numProduto++;
  return;
}

void stock(int a)
{
  int idStock = 0;
  int quantidadeStock = 0;
  idStock = new_sym_var(sizeof(int) * 8);
  quantidadeStock = new_sym_var(sizeof(int) * 8);
  if (idStock < numProduto)
  {
    if (a)
    {
      sistemaPro[idStock].quantidade += quantidadeStock;
    }
    else
    {
      if (quantidadeStock <= sistemaPro[idStock].quantidade)
      {
        sistemaPro[idStock].quantidade -= quantidadeStock;
      }
      else
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidadeStock, idStock);
      }

    }

  }
  else
  {
    if (a)
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idStock);
    }
    else
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idStock);
    }

  }

  return;
}

void criaEncomenda()
{
  sistemaEnc[numEnc].identificador = numEnc;
  printf("Nova encomenda %d.\n", numEnc);
  numEnc++;
  return;
}

void adicionaEncomenda()
{
  int idPro_Ad = 0;
  int idEnc_Ad = 0;
  int quantidadeAd = 0;
  int i;
  int pesoTotal;
  idEnc_Ad = new_sym_var(sizeof(int) * 8);
  idPro_Ad = new_sym_var(sizeof(int) * 8);
  quantidadeAd = new_sym_var(sizeof(int) * 8);
  pesoTotal = sistemaEnc[idEnc_Ad].peso + (sistemaPro[idPro_Ad].peso * quantidadeAd);
  if (idEnc_Ad < numEnc)
  {
    if (idPro_Ad < numProduto)
    {
      if (quantidadeAd <= sistemaPro[idPro_Ad].quantidade)
      {
        if (pesoTotal <= 200)
        {
          for (i = 0; i < 200; ++i)
          {
            if (!strcmp(sistemaEnc[idEnc_Ad].produtos[i].descricao, ""))
            {
              sistemaEnc[idEnc_Ad].peso += sistemaPro[idPro_Ad].peso * quantidadeAd;
              sistemaEnc[idEnc_Ad].produtos[i].identificador = idPro_Ad;
              sistemaEnc[idEnc_Ad].produtos[i].preco = sistemaPro[idPro_Ad].preco;
              sistemaEnc[idEnc_Ad].produtos[i].peso = sistemaPro[idPro_Ad].peso;
              sistemaEnc[idEnc_Ad].produtos[i].quantidade = quantidadeAd;
              sistemaPro[idPro_Ad].quantidade -= quantidadeAd;
              strcpy(sistemaEnc[idEnc_Ad].produtos[i].descricao, sistemaPro[idPro_Ad].descricao);
              break;
            }
            else
            {
              if ((!strcmp(sistemaPro[idPro_Ad].descricao, sistemaEnc[idEnc_Ad].produtos[i].descricao)) && (idPro_Ad == sistemaEnc[idEnc_Ad].produtos[i].identificador))
              {
                sistemaEnc[idEnc_Ad].peso += sistemaPro[idPro_Ad].peso * quantidadeAd;
                sistemaEnc[idEnc_Ad].produtos[i].quantidade += quantidadeAd;
                sistemaPro[idPro_Ad].quantidade -= quantidadeAd;
                break;
              }
              else
              {
                
              }

            }

          }

        }
        else
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idPro_Ad, idEnc_Ad);
        }

      }
      else
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idPro_Ad, idEnc_Ad);
      }

    }
    else
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idPro_Ad, idEnc_Ad);
    }

  }
  else
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idPro_Ad, idEnc_Ad);
  }

  return;
}

void removeProduto()
{
  int idPro_Rm = 0;
  int idEnc_Rm = 0;
  int i;
  idEnc_Rm = new_sym_var(sizeof(int) * 8);
  idPro_Rm = new_sym_var(sizeof(int) * 8);
  if (idEnc_Rm < numEnc)
  {
    if (idPro_Rm < numProduto)
    {
      for (i = 0; i < 200; ++i)
      {
        if ((!strcmp(sistemaPro[idPro_Rm].descricao, sistemaEnc[idEnc_Rm].produtos[i].descricao)) && (idPro_Rm == sistemaEnc[idEnc_Rm].produtos[i].identificador))
        {
          sistemaEnc[idEnc_Rm].peso -= sistemaEnc[idEnc_Rm].produtos[i].peso * sistemaEnc[idEnc_Rm].produtos[i].quantidade;
          sistemaPro[idPro_Rm].quantidade += sistemaEnc[idEnc_Rm].produtos[i].quantidade;
          while (i < 200)
          {
            if (!strcmp(sistemaEnc[idEnc_Rm].produtos[i].descricao, ""))
            {
              break;
            }
            else
            {
              
            }

            sistemaEnc[idEnc_Rm].produtos[i] = sistemaEnc[idEnc_Rm].produtos[i + 1];
            i++;
          }

          return;
        }
        else
        {
          
        }

      }

    }
    else
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idPro_Rm, idEnc_Rm);
    }

  }
  else
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idPro_Rm, idEnc_Rm);
  }

  return;
}

void calculaTotal()
{
  int idEnc_Cal = 0;
  int precoTotal = 0;
  int i;
  idEnc_Cal = new_sym_var(sizeof(int) * 8);
  if (idEnc_Cal < numEnc)
  {
    for (i = 0; i < 200; ++i)
    {
      if (!strcmp(sistemaEnc[idEnc_Cal].produtos[i].descricao, ""))
      {
        break;
      }
      else
      {
        
      }

      precoTotal += sistemaEnc[idEnc_Cal].produtos[i].preco * sistemaEnc[idEnc_Cal].produtos[i].quantidade;
    }

    printf("Custo da encomenda %d %d.\n", idEnc_Cal, precoTotal);
  }
  else
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", idEnc_Cal);
  }

  return;
}

void alteraPreco()
{
  int idPro_Alt = 0;
  int novoPreco = 0;
  int i;
  int j;
  idPro_Alt = new_sym_var(sizeof(int) * 8);
  novoPreco = new_sym_var(sizeof(int) * 8);
  if (idPro_Alt < numProduto)
  {
    sistemaPro[idPro_Alt].preco = novoPreco;
    for (i = 0; i < numEnc; ++i)
    {
      for (j = 0; j < 200; ++j)
      {
        if (!strcmp(sistemaEnc[i].produtos[j].descricao, ""))
        {
          break;
        }
        else
        {
          
        }

        if (idPro_Alt == sistemaEnc[i].produtos[j].identificador)
        {
          sistemaEnc[i].produtos[j].preco = novoPreco;
          break;
        }
        else
        {
          
        }

      }

    }

  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idPro_Alt);
  }

  return;
}

void mostraProduto()
{
  int idEnc_Um = 0;
  int idPro_Um = 0;
  int i;
  idEnc_Um = new_sym_var(sizeof(int) * 8);
  idPro_Um = new_sym_var(sizeof(int) * 8);
  if (idEnc_Um < numEnc)
  {
    if (idPro_Um < numProduto)
    {
      for (i = 0; i < 200; ++i)
      {
        if (!strcmp(sistemaEnc[idEnc_Um].produtos[i].descricao, ""))
        {
          printf("%s 0.\n", sistemaPro[idPro_Um].descricao);
          break;
        }
        else
        {
          
        }

        if (idPro_Um == sistemaEnc[idEnc_Um].produtos[i].identificador)
        {
          printf("%s %d.\n", sistemaEnc[idEnc_Um].produtos[i].descricao, sistemaEnc[idEnc_Um].produtos[i].quantidade);
          break;
        }
        else
        {
          
        }

      }

    }
    else
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idPro_Um);
    }

  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", idEnc_Um);
  }

  return;
}

void maxOcorrencia()
{
  int idPro_Dois = 0;
  int maxQnt = 0;
  int maxEnc = 0;
  int contador;
  int i;
  int j;
  idPro_Dois = new_sym_var(sizeof(int) * 8);
  if (idPro_Dois < numProduto)
  {
    for (i = 0; i < numEnc; ++i)
    {
      contador = 0;
      for (j = 0; j < 200; ++j)
      {
        if (!strcmp(sistemaEnc[i].produtos[j].descricao, ""))
        {
          break;
        }
        else
        {
          
        }

        if (idPro_Dois == sistemaEnc[i].produtos[j].identificador)
        {
          contador += sistemaEnc[i].produtos[j].quantidade;
        }
        else
        {
          
        }

      }

      if (contador >= maxQnt)
      {
        if (contador == maxQnt)
        {
          if (i < maxEnc)
          {
            maxEnc = i;
          }
          else
          {
            
          }

        }
        else
        {
          maxQnt = contador;
          maxEnc = i;
        }

      }
      else
      {
        
      }

    }

    if (maxQnt && (maxEnc < numEnc))
    {
      printf("Maximo produto %d %d %d.\n", idPro_Dois, maxEnc, maxQnt);
    }
    else
    {
      
    }

  }
  else
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idPro_Dois);
  }

  return;
}

void merge(Produto aux[], Produto a[], int l, int m, int r, int tipo)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
  {
    aux[i - 1] = a[i - 1];
  }

  for (j = m; j < r; j++)
  {
    aux[(r + m) - j] = a[j + 1];
  }

  if (tipo)
  {
    for (k = l; k <= r; k++)
    {
      if (strcmp(aux[j].descricao, aux[i].descricao) < 0)
      {
        a[k] = aux[j--];
      }
      else
      {
        a[k] = aux[i++];
      }

    }

  }
  else
  {
    for (k = l; k <= r; k++)
    {
      if (aux[j].preco < aux[i].preco)
      {
        a[k] = aux[j--];
      }
      else
      {
        if (aux[j].preco == aux[i].preco)
        {
          if (aux[j].identificador < aux[i].identificador)
          {
            a[k] = aux[j--];
          }
          else
          {
            a[k] = aux[i++];
          }

        }
        else
        {
          a[k] = aux[i++];
        }

      }

    }

  }

}

void mergesort(Produto aux[], Produto a[], int l, int r, int tipo)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort(aux, a, l, m, tipo);
  mergesort(aux, a, m + 1, r, tipo);
  merge(aux, a, l, m, r, tipo);
}

void sortProdutos()
{
  int i;
  Produto newArray[10000];
  Produto aux[10000];
  for (i = 0; i < numProduto; ++i)
  {
    newArray[i] = sistemaPro[i];
  }

  mergesort(aux, newArray, 0, numProduto - 1, 0);
  printf("Produtos\n");
  for (i = 0; i < numProduto; ++i)
  {
    printf("* %s %d %d\n", newArray[i].descricao, newArray[i].preco, newArray[i].quantidade);
  }

}

void sortEncomenda()
{
  int i;
  int idEnc_Sort = 0;
  int a = 0;
  Produto newArray[200];
  Produto aux[200];
  idEnc_Sort = new_sym_var(sizeof(int) * 8);
  if (idEnc_Sort >= numEnc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", idEnc_Sort);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; ++i)
  {
    if (!strcmp(sistemaEnc[idEnc_Sort].produtos[i].descricao, ""))
    {
      break;
    }
    else
    {
      
    }

    newArray[i] = sistemaEnc[idEnc_Sort].produtos[i];
    a = i;
  }

  if (!strcmp(sistemaEnc[idEnc_Sort].produtos[0].descricao, ""))
  {
    printf("Encomenda %d\n", idEnc_Sort);
    return;
  }
  else
  {
    
  }

  printf("Encomenda %d\n", idEnc_Sort);
  mergesort(aux, newArray, 0, a, 1);
  for (i = 0; i <= a; ++i)
  {
    printf("* %s %d %d\n", newArray[i].descricao, newArray[i].preco, newArray[i].quantidade);
  }

}

int main()
{
  char c;
  while (1)
  {
    switch (c = getchar())
    {
      case 'k':
        listaProdutos();
        break;

      case 'a':
        adicionaProduto();
        break;
        ;

      case 'q':
        stock(1);
        break;

      case 'N':
        criaEncomenda();
        break;

      case 'K':
        listaEncomenda();
        break;

      case 'A':
        adicionaEncomenda();
        break;

      case 'r':
        stock(0);
        break;

      case 'R':
        removeProduto();
        break;

      case 'C':
        calculaTotal();
        break;

      case 'p':
        alteraPreco();
        break;

      case 'E':
        mostraProduto();
        break;

      case 'm':
        maxOcorrencia();
        break;

      case 'l':
        sortProdutos();
        break;

      case 'L':
        sortEncomenda();
        break;

      case 'x':
        return 0;

      case '\n':
        break;

      default:
        printf("Este comando n?o existe.\n");
        break;

    }

  }

  return 0;
}

