/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>


typedef struct product
{
  int id;
  char desc[63];
  int price;
  int weight;
  int amount;
} product;
typedef struct delivery
{
  int totalWeight;
  int totalProd;
  int products[500][2];
} delivery;
int counterProd = 0;
int counterDel = 0;
product prodList[10000];
delivery delList[500];
int end = 0;
void processInput(char input[])
{
  int idtemp;
  int sum;
  int i;
  int ide;
  int idp;
  switch (input[0])
  {
    case 'a':
      strcpy(prodList[counterProd].desc, strtok(input + 2, ":"));
      prodList[counterProd].price = atoi(strtok(0, ":"));
      prodList[counterProd].weight = atoi(strtok(0, ":"));
      prodList[counterProd].amount = atoi(strtok(0, ":"));
      printf("Novo produto %d.\n", counterProd);
      prodList[counterProd].id = counterProd;
      counterProd++;
      break;

    case 'q':
    {
      idtemp = atoi(strtok(input + 2, ":"));
      sum = atoi(strtok(0, ":"));
      if (!(idtemp < counterProd))
      {
        printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idtemp);
        break;
      }
      else
      {
        
      }

      prodList[idtemp].amount += sum;
      break;
    }

    case 'N':
    {
      delList[counterDel].totalWeight = 0;
      delList[counterDel].totalProd = 0;
      for (i = 0; i < 500; i++)
      {
        delList[counterDel].products[i][0] = -1;
        delList[counterDel].products[i][1] = -1;
      }

      if (counterDel < 500)
      {
        counterDel++;
      }
      else
      {
        printf("Impossivel adicionar mais encomendas.\n");
      }

      printf("Nova encomenda %d.\n", counterDel - 1);
      break;
    }

    case 'A':
    {
      int qtd;
      int weight;
      int soloweight;
      ide = atoi(strtok(input + 2, ":"));
      idp = atoi(strtok(0, ":"));
      qtd = atoi(strtok(0, ":"));
      if (!(ide < counterDel))
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      if (!(idp < counterProd))
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      if (prodList[idp].amount < qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      soloweight = prodList[idp].weight * qtd;
      weight = soloweight + delList[ide].totalWeight;
      if (weight > 200)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      prodList[idp].amount -= qtd;
      delList[ide].totalWeight = weight;
      delList[ide].totalProd++;
      for (i = 0; i < 500; i++)
      {
        if (delList[ide].products[i][0] == idp)
        {
          delList[ide].products[i][1] += qtd;
          break;
        }
        else
        {
          
        }

        if (delList[ide].products[i][0] == (-1))
        {
          delList[ide].products[i][0] = idp;
          delList[ide].products[i][1] = qtd;
          break;
        }
        else
        {
          
        }

      }

      break;
    }

    case 'r':
    {
      int quant;
      int temp;
      idp = atoi(strtok(input + 2, ":"));
      quant = atoi(strtok(0, ":"));
      if (!(idp < counterProd))
      {
        printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
        break;
      }
      else
      {
        
      }

      temp = prodList[idp].amount - quant;
      if (temp < 0)
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quant, idp);
        break;
      }
      else
      {
        
      }

      prodList[idp].amount = temp;
      break;
    }

    case 'R':
    {
      int j;
      int tempid;
      j = -1;
      ide = atoi(strtok(input + 2, ":"));
      idp = atoi(strtok(0, ":"));
      if (!(ide < counterDel))
      {
        printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      if (!(idp < counterProd))
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
        break;
      }
      else
      {
        
      }

      for (i = 0; i < 500; i++)
      {
        if (delList[ide].products[i][0] == (-1))
        {
          break;
        }
        else
        {
          
        }

        if (delList[ide].products[i][0] == idp)
        {
          j = i;
          prodList[idp].amount += delList[ide].products[i][1];
          break;
        }
        else
        {
          
        }

      }

      if (j != (-1))
      {
        tempid = delList[ide].products[j][0];
        delList[ide].totalWeight -= prodList[tempid].weight * delList[ide].products[j][1];
        for (i = j; i < 500; i++)
        {
          if (i == 199)
          {
            delList[ide].products[i][0] = -1;
            delList[ide].products[i][1] = -1;
          }
          else
          {
            delList[ide].products[i][0] = delList[ide].products[i + 1][0];
            delList[ide].products[i][1] = delList[ide].products[i + 1][1];
          }

        }

      }
      else
      {
        
      }

      break;
    }

    case 'C':
    {
      int num;
      int calc;
      calc = 0;
      ide = atoi(strtok(input + 2, ":"));
      if (!(ide < counterDel))
      {
        printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
        break;
      }
      else
      {
        
      }

      for (i = 0; i < 500; i++)
      {
        num = delList[ide].products[i][0];
        if (num != (-1))
        {
          calc += delList[ide].products[i][1] * prodList[num].price;
        }
        else
        {
          break;
        }

      }

      printf("Custo da encomenda %d %d.\n", ide, calc);
      break;
    }

    case 'p':
    {
      int price;
      idp = atoi(strtok(input + 2, ":"));
      price = atoi(strtok(0, ":"));
      if (!(idp < counterProd))
      {
        printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
        break;
      }
      else
      {
        
      }

      prodList[idp].price = price;
      break;
    }

    case 'E':
    {
      int t;
      t = -1;
      ide = atoi(strtok(input + 2, ":"));
      idp = atoi(strtok(0, ":"));
      if (!(ide < counterDel))
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
        break;
      }
      else
      {
        
      }

      if (!(idp < counterProd))
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
        break;
      }
      else
      {
        
      }

      for (i = 0; i < 500; i++)
      {
        if (delList[ide].products[i][0] == (-1))
        {
          break;
        }
        else
        {
          
        }

        if (delList[ide].products[i][0] == idp)
        {
          t = i;
          break;
        }
        else
        {
          
        }

      }

      if (t == (-1))
      {
        printf("%s 0.\n", prodList[idp].desc);
      }
      else
      {
        printf("%s %d.\n", prodList[idp].desc, delList[ide].products[t][1]);
      }

      break;
    }

    case 'm':
    {
      int qua;
      int j;
      int finalid;
      int enc;
      qua = 0;
      finalid = -1;
      idp = atoi(strtok(input + 2, ":"));
      if (!(idp < counterProd))
      {
        printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
        break;
      }
      else
      {
        
      }

      for (i = 0; i < counterDel; i++)
      {
        for (j = 0; j < 500; j++)
        {
          if (delList[i].products[j][0] == (-1))
          {
            break;
          }
          else
          {
            
          }

          if ((delList[i].products[j][0] == idp) && (delList[i].products[j][1] > qua))
          {
            qua = delList[i].products[j][1];
            finalid = delList[i].products[j][0];
            enc = i;
            break;
          }
          else
          {
            
          }

        }

      }

      if (!(finalid == (-1)))
      {
        printf("Maximo produto %d %d %d.\n", finalid, enc, qua);
      }
      else
      {
        
      }

      break;
    }

    case 'l':
    {
      int pass;
      product link;
      product *obj;
      obj = (product *) malloc((sizeof(product)) * counterProd);
      pass = 0;
      for (i = 0; i < counterProd; i++)
      {
        obj[i] = prodList[i];
      }

      while (pass == 0)
      {
        pass = 1;
        for (i = 0; i < (counterProd - 1); i++)
        {
          if (obj[i].price > obj[i + 1].price)
          {
            link = obj[i];
            obj[i] = obj[i + 1];
            obj[i + 1] = link;
            pass = 0;
          }
          else
          {
            
          }

        }

      }

      printf("Produtos\n");
      for (i = 0; i < counterProd; i++)
      {
        printf("* %s %d %d\n", obj[i].desc, obj[i].price, obj[i].amount);
      }

      free(obj);
      break;
    }

    case 'L':
    {
      int tempID;
      int skip;
      int pass;
      int arrSize;
      int tempPrice;
      int tempQuant;
      int tempr;
      char tempDesc[63];
      int *price;
      int *quantity;
      char **desc;
      price = (int *) malloc((sizeof(int)) * 500);
      quantity = (int *) malloc((sizeof(int)) * 500);
      desc = (char **) malloc(500 * (sizeof(char *)));
      for (i = 0; i < 500; i++)
      {
        desc[i] = (char *) malloc(63 * (sizeof(char)));
      }

      ide = atoi(strtok(input + 2, ":"));
      if (!(ide < counterDel))
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
        break;
      }
      else
      {
        
      }

      for (i = 0; i < 500; i++)
      {
        tempr = delList[ide].products[i][0];
        if (tempr > (-1))
        {
          tempID = delList[ide].products[i][0];
          price[i] = prodList[tempID].price;
          quantity[i] = delList[ide].products[i][1];
          strcpy(desc[i], prodList[tempID].desc);
          arrSize = i + 1;
        }
        else
        {
          break;
        }

      }

      pass = 0;
      skip = 0;
      if (delList[ide].products[0][0] == (-1))
      {
        skip = 1;
        pass = 1;
      }
      else
      {
        
      }

      while (pass == 0)
      {
        pass = 1;
        for (i = 0; i < arrSize; i++)
        {
          if ((i + 1) == arrSize)
          {
            break;
          }
          else
          {
            
          }

          if (strcmp(desc[i], desc[i + 1]) > 0)
          {
            strcpy(tempDesc, desc[i]);
            tempPrice = price[i];
            tempQuant = quantity[i];
            strcpy(desc[i], desc[i + 1]);
            price[i] = price[i + 1];
            quantity[i] = quantity[i + 1];
            strcpy(desc[i + 1], tempDesc);
            price[i + 1] = tempPrice;
            quantity[i + 1] = tempQuant;
            pass = 0;
          }
          else
          {
            
          }

        }

      }

      printf("Encomenda %d\n", ide);
      if (skip == 0)
      {
        for (i = 0; i < arrSize; i++)
        {
          printf("* %s %d %d\n", desc[i], price[i], quantity[i]);
        }

      }
      else
      {
        
      }

      for (i = 0; i < 500; i++)
      {
        free(desc[i]);
      }

      free(desc);
      free(quantity);
      free(price);
      break;
    }

    case 'x':
      end = 1;

  }

}

int main()
{
  do
  {
    char input[500];
    fgets(input, 499, stdin);
    processInput(input);
  }
  while (end == 0);
  return 0;
}

