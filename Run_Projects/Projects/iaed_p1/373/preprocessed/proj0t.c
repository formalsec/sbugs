/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int iden;
  char desc[62];
  int preco;
  int peso;
  int quan;
} prod;
typedef struct prodenc
{
  int iden;
  int quan;
} prod_enc;
typedef struct encomenda
{
  int id;
  int N;
  prod_enc conjunto[200];
} enc;
prod sistema[9999];
enc encomendas[499];
prod aux[9999];
int iden;
int id;
int obtanha_preco(int iden1)
{
  int i;
  int l;
  for (i = 0; i < iden; i++)
  {
    if (sistema[i].iden == iden1)
    {
      l = sistema[i].preco;
    }
    else
    {
      
    }

  }

  return l;
}

int obtanha_indreco(int id1, int iden1)
{
  int j;
  int c = 0;
  for (j = 0; j < encomendas[id1].N; j++)
  {
    if (encomendas[id1].conjunto[j].iden != iden1)
    {
      c++;
    }
    else
    {
      break;
    }

  }

  return c;
}

int soma_pesos(enc E)
{
  int soma = 0;
  int i;
  for (i = 0; i < E.N; i++)
  {
    soma += sistema[E.conjunto[i].iden].peso * E.conjunto[i].quan;
  }

  return soma;
}

int verfiqua_prod(int iden1)
{
  int i;
  int c = 0;
  for (i = 0; i < iden; i++)
  {
    if (sistema[i].iden == iden1)
    {
      c = 1;
    }
    else
    {
      
    }

  }

  return c;
}

int verfiqua_enc(int id1)
{
  int i;
  int c = 0;
  for (i = 0; i < id; i++)
  {
    if (encomendas[i].id == id1)
    {
      c = 1;
    }
    else
    {
      
    }

  }

  return c;
}

int verfiqua_pro_enc(int id1, int iden1)
{
  int c = 0;
  int j;
  for (j = 0; j < encomendas[id1].N; j++)
  {
    if (encomendas[id1].conjunto[j].iden == iden1)
    {
      c = 1;
    }
    else
    {
      
    }

  }

  return c;
}

void comando_a()
{
  for (int sistema_index = 0; sistema_index < 10; sistema_index++)
  {
    sistema[iden].desc[sistema_index] = new_sym_var(sizeof(char) * 8);
  }

  sistema[iden].desc[10 - 1] = '\0';
  sistema[iden].preco = new_sym_var(sizeof(int) * 8);
  sistema[iden].peso = new_sym_var(sizeof(int) * 8);
  sistema[iden].quan = new_sym_var(sizeof(int) * 8);
  sistema[iden].iden = iden;
  printf("Novo produto %d.\n", iden++);
}

void comando_q()
{
  int quan;
  int iden1;
  iden1 = new_sym_var(sizeof(int) * 8);
  quan = new_sym_var(sizeof(int) * 8);
  if (verfiqua_prod(iden1))
  {
    sistema[iden1].quan += quan;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", iden1);
  }

}

void comando_N()
{
  encomendas[id].id = id;
  printf("Nova encomenda %d.\n", id);
  id++;
}

void comando_A()
{
  int id1;
  int iden1;
  int quan;
  int j;
  int c = 0;
  int k = 1;
  int i;
  id1 = new_sym_var(sizeof(int) * 8);
  iden1 = new_sym_var(sizeof(int) * 8);
  quan = new_sym_var(sizeof(int) * 8);
  if (verfiqua_enc(id1))
  {
    if (verfiqua_prod(iden1))
    {
      if ((sistema[iden1].quan - quan) >= 0)
      {
        if ((soma_pesos(encomendas[id1]) + (sistema[iden1].peso * quan)) <= 200)
        {
          for (j = 0; j < (encomendas[id1].N + 1); j++)
          {
            if ((encomendas[id1].conjunto[j].iden == iden1) && iden1)
            {
              c = encomendas[id1].conjunto[j].iden;
              encomendas[id1].conjunto[j].quan += quan;
              sistema[iden1].quan -= quan;
            }
            else
            {
              
            }

          }

          if ((c != iden1) && iden1)
          {
            encomendas[id1].conjunto[encomendas[id1].N].iden = iden1;
            encomendas[id1].conjunto[encomendas[id1].N].quan = quan;
            sistema[iden1].quan -= quan;
            encomendas[id1].N++;
          }
          else
          {
            
          }

          if (iden1 == 0)
          {
            for (i = 0; i < encomendas[id1].N; i++)
            {
              if ((encomendas[id1].conjunto[i].iden == iden1) && encomendas[id1].N)
              {
                k = encomendas[id1].conjunto[j].iden;
                encomendas[id1].conjunto[i].quan += quan;
                sistema[iden1].quan -= quan;
              }
              else
              {
                
              }

            }

            if (k != iden1)
            {
              encomendas[id1].conjunto[encomendas[id1].N].iden = iden1;
              encomendas[id1].conjunto[encomendas[id1].N].quan = quan;
              sistema[iden1].quan -= quan;
              encomendas[id1].N++;
            }
            else
            {
              
            }

          }
          else
          {
            
          }

        }
        else
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", iden1, id1);
        }

      }
      else
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", iden1, id1);
      }

    }
    else
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", iden1, id1);
    }

  }
  else
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", iden1, id1);
  }

}

void comando_r()
{
  int iden1;
  int quan;
  iden1 = new_sym_var(sizeof(int) * 8);
  quan = new_sym_var(sizeof(int) * 8);
  if (verfiqua_prod(iden1))
  {
    if ((sistema[iden1].quan - quan) >= 0)
    {
      sistema[iden1].quan -= quan;
    }
    else
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quan, iden1);
    }

  }
  else
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", iden1);
  }

}

void comando_R()
{
  int iden1;
  int id1;
  int j;
  int c;
  id1 = new_sym_var(sizeof(int) * 8);
  iden1 = new_sym_var(sizeof(int) * 8);
  if (verfiqua_enc(id1))
  {
    if (verfiqua_prod(iden1))
    {
      for (j = 0; j < encomendas[id1].N; j++)
      {
        if (encomendas[id1].conjunto[j].iden == iden1)
        {
          c = j;
        }
        else
        {
          
        }

      }

      sistema[iden1].quan += encomendas[id1].conjunto[c].quan;
      encomendas[id1].conjunto[c].quan = 0;
    }
    else
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", iden1, id1);
    }

  }
  else
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", iden1, id1);
  }

}

void comando_c()
{
  int id1;
  int soma = 0;
  int j;
  id1 = new_sym_var(sizeof(int) * 8);
  if (verfiqua_enc(id1))
  {
    for (j = 0; j < encomendas[id1].N; j++)
      soma += sistema[encomendas[id1].conjunto[j].iden].preco * encomendas[id1].conjunto[j].quan;

    printf("Custo da encomenda %d %d.\n", id1, soma);
  }
  else
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", id1);
  }

}

void comando_p()
{
  int iden1;
  int preco;
  iden1 = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (verfiqua_prod(iden1))
  {
    sistema[iden1].preco = preco;
  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", iden1);
  }

}

void comando_E()
{
  int iden1;
  int id1;
  int i = 0;
  id1 = new_sym_var(sizeof(int) * 8);
  iden1 = new_sym_var(sizeof(int) * 8);
  if (verfiqua_enc(id1))
  {
    if (verfiqua_prod(iden1))
    {
      if (verfiqua_pro_enc(id1, iden1))
      {
        printf("%s %d.\n", sistema[iden1].desc, encomendas[id1].conjunto[obtanha_indreco(id1, iden1)].quan);
      }
      else
      {
        printf("%s %d.\n", sistema[iden1].desc, i);
      }

    }
    else
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", iden1);
    }

  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id1);
  }

}

void comando_m()
{
  int iden1;
  int max = 0;
  int i;
  int e;
  iden1 = new_sym_var(sizeof(int) * 8);
  if (verfiqua_prod(iden1))
  {
    for (i = 0; i < id; i++)
    {
      if (verfiqua_pro_enc(i, iden1) && encomendas[i].conjunto[obtanha_indreco(i, iden1)].quan)
      {
        if (encomendas[i].conjunto[obtanha_indreco(i, iden1)].quan > max)
        {
          max = encomendas[i].conjunto[obtanha_indreco(i, iden1)].quan;
          e = encomendas[i].id;
        }
        else
        {
          if ((encomendas[i].conjunto[obtanha_indreco(i, iden1)].quan == max) && encomendas[i].conjunto[obtanha_indreco(i, iden1)].quan)
          {
            if (encomendas[i].id < e)
            {
              e = encomendas[i].id;
            }
            else
            {
              
            }

          }
          else
          {
            
          }

        }

      }
      else
      {
        
      }

    }

    if (max)
    {
      printf("Maximo produto %d %d %d.\n", iden1, e, max);
    }
    else
    {
      
    }

  }
  else
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", iden1);
  }

}

int less(int j, int i)
{
  if (j < i)
  {
    return 1;
  }
  else
  {
    return 0;
  }

}

void merge(prod a[], int l, int m, int r)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < r; j++)
    aux[(r + m) - j] = a[j + 1];

  for (k = l; k <= r; k++)
  {
    if (less(aux[j].preco, aux[i].preco) || ((aux[j].preco == aux[i].preco) && (aux[j].iden < aux[i].iden)))
    {
      a[k] = aux[j--];
    }
    else
    {
      a[k] = aux[i++];
    }

  }

}

void mergesort(prod a[], int l, int r)
{
  int m = (l + r) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, l, m);
  mergesort(a, m + 1, r);
  merge(a, l, m, r);
}

void comando_l()
{
  int c;
  int i;
  prod sistema1[9999];
  for (i = 0; i < iden; i++)
    sistema1[i] = sistema[i];

  mergesort(sistema1, 0, iden - 1);
  printf("Produtos\n");
  for (c = 0; c < iden; c++)
  {
    printf("* %s %d %d\n", sistema1[c].desc, sistema1[c].preco, sistema1[c].quan);
  }

}

void comando_L()
{
  int i;
  int j;
  int id1;
  int e;
  id1 = new_sym_var(sizeof(int) * 8);
  if (verfiqua_enc(id1))
  {
    for (i = 0; i < encomendas[id1].N; i++)
    {
      int min = i;
      prod_enc aux;
      for (j = i + 1; j < encomendas[id1].N; j++)
      {
        if (strcmp(sistema[encomendas[id1].conjunto[j].iden].desc, sistema[encomendas[id1].conjunto[min].iden].desc) < 0)
        {
          min = j;
        }
        else
        {
          
        }

      }

      aux = encomendas[id1].conjunto[i];
      encomendas[id1].conjunto[i] = encomendas[id1].conjunto[min];
      encomendas[id1].conjunto[min] = aux;
    }

    printf("Encomenda %d\n", id1);
    for (e = 0; e < encomendas[id1].N; e++)
    {
      if (encomendas[id1].conjunto[e].quan)
      {
        printf("* %s %d %d\n", sistema[encomendas[id1].conjunto[e].iden].desc, sistema[encomendas[id1].conjunto[e].iden].preco, encomendas[id1].conjunto[e].quan);
      }
      else
      {
        
      }

    }

  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id1);
  }

}

int main()
{
  char c;
  int termina = 1;
  while (((c = getchar()) != EOF) && termina)
  {
    switch (c)
    {
      case 'a':
        comando_a();
        break;

      case 'q':
        comando_q();
        break;

      case 'N':
        comando_N();
        break;

      case 'A':
        comando_A();
        break;

      case 'r':
        comando_r();
        break;

      case 'R':
        comando_R();
        break;

      case 'C':
        comando_c();
        break;

      case 'p':
        comando_p();
        break;

      case 'E':
        comando_E();
        break;

      case 'm':
        comando_m();
        break;

      case 'l':
        comando_l();
        break;

      case 'L':
        comando_L();
        break;

      case 'x':
        termina = 0;
        break;

    }

  }

  return 0;
}

