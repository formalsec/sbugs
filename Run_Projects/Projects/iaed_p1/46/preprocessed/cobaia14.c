/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct 
{
  char descricao[64];
  int idp;
  int preco;
  int peso;
  int stock;
} produto;
typedef struct 
{
  int ide;
  int peso_total;
  produto produto_e[200];
} encomenda;
produto p[10000];
encomenda e[500];
int get_string(char c[])
{
  char ch;
  int i = 0;
  while ((((ch = getchar()) != ':') && (ch != '\0')) && (ch != '\n'))
  {
    c[i++] = ch;
  }

  c[i] = '\0';
  return 0;
}

int get_int()
{
  char ch;
  int i = 0;
  while ((((ch = getchar()) != ':') && (ch != '\0')) && (ch != '\n'))
  {
    i = (i * 10) + (ch - '0');
  }

  return i;
}

int existe_produto(int idp)
{
  int i;
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == idp)
    {
      return i;
    }
    else
    {
      
    }

  }

  return -1;
}

int existe_encomenda(int ide)
{
  int i;
  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == ide)
    {
      return i;
    }
    else
    {
      
    }

  }

  return -1;
}

int existe_stock(int qntd, produto p)
{
  if (p.stock >= qntd)
  {
    return 1;
  }
  else
  {
    
  }

  return -1;
}

int encomenda_tem_produto(encomenda e, int idp)
{
  int i;
  for (i = 0; i < 200; i++)
  {
    if (e.produto_e[i].idp == idp)
    {
      return i;
    }
    else
    {
      
    }

  }

  return -1;
}

int ultrapassa_peso(encomenda e, produto p, int qtd)
{
  int peso_inicial;
  peso_inicial = e.peso_total;
  if ((peso_inicial + (p.peso * qtd)) > 200)
  {
    return -1;
  }
  else
  {
    
  }

  return 1;
}

int compara_precos(produto p1, produto p2)
{
  if (p1.preco > p2.preco)
  {
    return 1;
  }
  else
  {
    if (p1.preco == p2.preco)
    {
      {
        if (p1.idp > p2.idp)
        {
          return 1;
        }
        else
        {
          return 0;
        }

      }
    }
    else
    {
      return 0;
    }

  }

}

void ordena_preco()
{
  produto aux;
  int troca = 2;
  int k;
  while (troca != 0)
  {
    troca = 0;
    for (k = 1; k < 1000; k++)
    {
      if (p[k].stock == (-1))
      {
        break;
      }
      else
      {
        
      }

      if (compara_precos(p[k - 1], p[k]) == 1)
      {
        {
          aux = p[k - 1];
          p[k - 1] = p[k];
          p[k] = aux;
          troca = 1;
        }
      }
      else
      {
        
      }

    }

  }

}

int compara_alfa(char c1[], char c2[])
{
  int i;
  for (i = 0; i < 64; i++)
  {
    int x = c1[i];
    int y = c2[i];
    if (c1[i] == ' ')
    {
      return 0;
    }
    else
    {
      if (c2[i] == ' ')
      {
        return 1;
      }
      else
      {
        if (x > y)
        {
          return 1;
        }
        else
        {
          if (x < y)
          {
            return 0;
          }
          else
          {
            
          }

        }

      }

    }

  }

  return 0;
}

void ordena_alfa(int ide)
{
  int troca = 2;
  int k;
  produto aux;
  while (troca != 0)
  {
    troca = 0;
    for (k = 1; k < 200; k++)
    {
      if (e[ide].produto_e[k].idp == (-1))
      {
        {
          troca = 0;
        }
      }
      else
      {
        
      }

      if (compara_alfa(e[ide].produto_e[k - 1].descricao, e[ide].produto_e[k].descricao) == 1)
      {
        {
          aux = e[ide].produto_e[k - 1];
          e[ide].produto_e[k - 1] = e[ide].produto_e[k];
          e[ide].produto_e[k] = aux;
          troca = 1;
        }
      }
      else
      {
        
      }

    }

  }

}

void adiciona_produto(int idp)
{
  produto p1;
  int i;
  get_string(p1.descricao);
  p1.preco = get_int();
  p1.peso = get_int();
  p1.stock = get_int();
  p1.idp = idp;
  for (i = 0; i < 10000; i++)
  {
    if (p[i].stock == (-1))
    {
      {
        p[i] = p1;
        printf("%s %d%s\n", "Novo produto", p1.idp, ".");
        break;
      }
    }
    else
    {
      
    }

  }

}

void adiciona_stock()
{
  int id;
  int qtd;
  int numero_produto;
  id = get_int();
  qtd = get_int();
  numero_produto = existe_produto(id);
  if (numero_produto == (-1))
  {
    {
      printf("%s %d %s\n", "Impossivel adicionar produto", id, "ao stock. Produto inexistente.");
      return;
    }
  }
  else
  {
    {
      p[numero_produto].stock = p[numero_produto].stock + qtd;
    }
  }

}

void remove_stock()
{
  int idp;
  int qtd;
  int numero_produto;
  numero_produto = 0;
  idp = get_int();
  qtd = get_int();
  numero_produto = existe_produto(idp);
  if (numero_produto == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel remover stock do produto", idp, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (existe_stock(qtd, p[idp]) == (-1))
  {
    {
      printf("%s %d %s %d %s\n", "Impossivel remover", qtd, "unidades do produto", idp, "do stock. Quantidade insuficiente.");
      return;
    }
  }
  else
  {
    
  }

  p[idp].stock = p[idp].stock - qtd;
}

void altera_preco()
{
  int idp;
  int preco;
  int j;
  int i;
  idp = get_int();
  preco = get_int();
  if (existe_produto(idp) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel alterar preco do produto", idp, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  p[idp].preco = preco;
  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      {
        break;
      }
    }
    else
    {
      
    }

    for (j = 0; j < 200; j++)
    {
      if (e[i].produto_e[j].idp == idp)
      {
        e[i].produto_e[j].preco = preco;
      }
      else
      {
        
      }

    }

  }

}

void lista_produtos_preco()
{
  int i;
  ordena_preco(p);
  printf("Produtos\n");
  for (i = 0; i < 10000; i++)
  {
    if (p[i].stock == (-1))
    {
      break;
    }
    else
    {
      {
        printf("%s %s %d %d\n", "*", p[i].descricao, p[i].preco, p[i].stock);
      }
    }

  }

}

void nova_encomenda(int ide)
{
  int j;
  e[ide].ide = ide;
  for (j = 0; j < 200; j++)
  {
    e[ide].produto_e[j].idp = -1;
  }

  printf("%s %d%s\n", "Nova encomenda", ide, ".");
}

void adiciona_produto_encomenda()
{
  int ide;
  int idp;
  int qntd;
  int aux;
  int i;
  ide = get_int();
  idp = get_int();
  qntd = get_int();
  if (existe_encomenda(ide) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel adicionar produto", idp, "a encomenda", ide, ". Encomenda inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto(idp) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel adicionar produto", idp, "a encomenda", ide, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (existe_stock(qntd, p[idp]) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel adicionar produto", idp, "a encomenda", ide, ". Quantidade em stock insuficiente.");
      return;
    }
  }
  else
  {
    
  }

  if (ultrapassa_peso(e[ide], p[idp], qntd) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel adicionar produto", idp, "a encomenda", ide, ". Peso da encomenda excede o maximo de 200.");
      return;
    }
  }
  else
  {
    
  }

  aux = encomenda_tem_produto(e[ide], idp);
  if (aux != (-1))
  {
    {
      e[ide].produto_e[aux].stock = e[ide].produto_e[aux].stock + qntd;
      p[idp].stock = p[idp].stock - qntd;
      e[ide].peso_total = e[ide].peso_total + (p[idp].peso * qntd);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (e[ide].produto_e[i].idp == (-1))
    {
      {
        e[ide].produto_e[i] = p[idp];
        e[ide].produto_e[i].idp = idp;
        e[ide].produto_e[i].stock = qntd;
        p[idp].stock = p[idp].stock - qntd;
        e[ide].peso_total = e[ide].peso_total + (p[idp].peso * qntd);
        return;
      }
    }
    else
    {
      
    }

  }

}

void remove_produto_encomenda()
{
  int ide;
  int idp;
  int i;
  ide = get_int();
  idp = get_int();
  i = encomenda_tem_produto(e[ide], idp);
  if (existe_encomenda(ide) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel remover produto", idp, "a encomenda", ide, ". Encomenda inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto(idp) == (-1))
  {
    {
      printf("%s %d %s %d%s\n", "Impossivel remover produto", idp, "a encomenda", ide, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (i != (-1))
  {
    {
      p[idp].stock = p[idp].stock + e[ide].produto_e[i].stock;
      e[ide].produto_e[i].idp = -1;
      e[ide].peso_total = e[ide].peso_total - (e[ide].produto_e[i].stock * p[idp].peso);
      e[ide].produto_e[i].stock = 0;
    }
  }
  else
  {
    
  }

}

void onde_ha_mais()
{
  int idp;
  int i;
  int j;
  int max;
  int id_enco_final;
  idp = get_int();
  max = 0;
  id_enco_final = 0;
  if (existe_produto(idp) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel listar maximo do produto", idp, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 500; i++)
  {
    for (j = 0; j < 200; j++)
    {
      if ((e[i].produto_e[j].idp == idp) && (e[i].produto_e[j].stock > max))
      {
        {
          max = e[i].produto_e[j].stock;
          id_enco_final = e[i].ide;
          break;
        }
      }
      else
      {
        
      }

    }

  }

  if (max != 0)
  {
    printf("%s %d %d %d.\n", "Maximo produto", idp, id_enco_final, max);
  }
  else
  {
    
  }

}

void lista_desc_qtd_produto_encomenda()
{
  int ide;
  int idp;
  int i;
  int aux;
  ide = get_int();
  idp = get_int();
  if (existe_encomenda(ide) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel listar encomenda", ide, ". Encomenda inexistente.");
      return;
    }
  }
  else
  {
    
  }

  if (existe_produto(idp) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel listar produto", idp, ". Produto inexistente.");
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (e[ide].produto_e[i].idp == idp)
    {
      aux = i;
    }
    else
    {
      
    }

  }

  if (e[ide].produto_e[aux].stock == (-1))
  {
    printf("%s 0.\n", p[idp].descricao);
  }
  else
  {
    printf("%s %d.\n", p[idp].descricao, e[ide].produto_e[aux].stock);
  }

}

void calcula_custo_encomenda()
{
  int ide;
  int i;
  int aux;
  int total;
  ide = get_int();
  total = 0;
  aux = 0;
  if (existe_encomenda(ide) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel calcular custo da encomenda", ide, ". Encomenda inexistente.");
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 1500; i++)
  {
    aux = encomenda_tem_produto(e[ide], i);
    if (aux != (-1))
    {
      {
        total = total + (e[ide].produto_e[aux].stock * e[ide].produto_e[aux].preco);
      }
    }
    else
    {
      
    }

  }

  printf("%s %d% d%s\n", "Custo da encomenda", ide, total, ".");
}

void lista_produtos_alfa()
{
  int i = 0;
  int ide;
  ide = get_int();
  if (existe_encomenda(ide) == (-1))
  {
    {
      printf("%s %d%s\n", "Impossivel listar encomenda", ide, ". Encomenda inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ordena_alfa(ide);
  printf("%s %d\n", "Encomenda", ide);
  for (i = 0; i < 200; i++)
  {
    if (((e[ide].produto_e[i].preco != 0) && (e[ide].produto_e[i].stock != 0)) && (e[ide].produto_e[i].idp != (-1)))
    {
      {
        printf("* %s %d %d\n", e[ide].produto_e[i].descricao, e[ide].produto_e[i].preco, e[ide].produto_e[i].stock);
      }
    }
    else
    {
      
    }

  }

}

int main()
{
  int i;
  int idp = 0;
  int ide = 0;
  char comando = 'y';
  produto p0;
  encomenda e0;
  strcpy(p0.descricao, " ");
  p0.idp = -1;
  p0.preco = 0;
  p0.peso = 0;
  p0.stock = -1;
  for (i = 0; i < 10000; i++)
  {
    p[i] = p0;
  }

  e0.ide = -1;
  e0.peso_total = 0;
  for (i = 0; i < 200; i++)
  {
    e0.produto_e[i] = p0;
  }

  for (i = 0; i < 500; i++)
  {
    e[i] = e0;
  }

  while (comando != 'x')
  {
    switch (comando = getchar())
    {
      case 'a':
        getchar();
        adiciona_produto(idp);
        idp++;
        break;

      case 'q':
        getchar();
        adiciona_stock();
        break;

      case 'r':
        getchar();
        remove_stock();
        break;

      case 'p':
        getchar();
        altera_preco();
        break;

      case 'l':
        lista_produtos_preco();
        break;

      case 'L':
        getchar();
        lista_produtos_alfa();
        break;

      case 'N':
        nova_encomenda(ide);
        ide++;
        break;

      case 'A':
        getchar();
        adiciona_produto_encomenda();
        break;

      case 'R':
        getchar();
        remove_produto_encomenda();
        break;

      case 'E':
        getchar();
        lista_desc_qtd_produto_encomenda();
        break;

      case 'C':
        getchar();
        calcula_custo_encomenda();
        break;

      case 'm':
        getchar();
        onde_ha_mais();
        break;

      case 'x':
        break;

    }

  }

  return 0;
}

