/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  char descr[63];
  int preco;
  int peso;
  int qtd;
  int idp;
} prod;
int total_prod;
int total_enc;
prod stock[10000];
int encomendas[500][10000];
int peso_enc(int ide)
{
  int idp;
  int peso_total = 0;
  for (idp = 0; idp < total_prod; idp++)
    peso_total += stock[idp].peso * encomendas[ide][idp];

  return peso_total;
}

int ordem_alfabetica(char s1[63], char s2[63])
{
  int i = 0;
  while ((s1[i] == s2[i]) && (i < 63))
    i++;

  if (s1[i] < s2[i])
  {
    return 1;
  }
  else
  {
    
  }

  return 0;
}

void comando_a()
{
  getchar();
  for (int stock_index = 0; stock_index < 10; stock_index++)
  {
    stock[total_prod].descr[stock_index] = new_sym_var(sizeof(char) * 8);
  }

  stock[total_prod].descr[10 - 1] = '\0';
  stock[total_prod].preco = new_sym_var(sizeof(int) * 8);
  stock[total_prod].peso = new_sym_var(sizeof(int) * 8);
  stock[total_prod].qtd = new_sym_var(sizeof(int) * 8);
  stock[total_prod].idp = total_prod;
  printf("Novo produto %d.\n", total_prod++);
}

void comando_q()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= total_prod)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    stock[idp].qtd += qtd;
  }

}

void comando_N()
{
  int idp;
  for (idp = 0; idp < 10000; idp++)
    encomendas[total_enc][idp] = 0;

  printf("Nova encomenda %d.\n", total_enc++);
}

void comando_A()
{
  int idp;
  int ide;
  int qtd;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= total_enc)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= total_prod)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if ((stock[idp].qtd - qtd) < 0)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((peso_enc(ide) + (stock[idp].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          encomendas[ide][idp] += qtd;
          stock[idp].qtd -= qtd;
        }

      }

    }

  }

}

void comando_r()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= total_prod)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if ((stock[idp].qtd - qtd) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      stock[idp].qtd -= qtd;
    }

  }

}

void comando_R()
{
  int idp;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= total_enc)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= total_prod)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      stock[idp].qtd += encomendas[ide][idp];
      encomendas[ide][idp] = 0;
    }

  }

}

void comando_C()
{
  int idp;
  int ide;
  int custo_total = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= total_enc)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (idp = 0; idp < total_prod; idp++)
      custo_total += stock[idp].preco * encomendas[ide][idp];

    printf("Custo da encomenda %d %d.\n", ide, custo_total);
  }

}

void comando_p()
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= total_prod)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    stock[idp].preco = preco;
  }

}

void comando_E()
{
  int idp;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= total_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= total_prod)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      printf("%s %d.\n", stock[idp].descr, encomendas[ide][idp]);
    }

  }

}

void comando_m()
{
  int idp;
  int ide;
  int maior;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= total_prod)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    maior = 0;
    for (ide = 1; ide < total_enc; ide++)
      if (encomendas[ide][idp] > encomendas[maior][idp])
    {
      maior = ide;
    }
    else
    {
      
    }


    if ((total_enc > 0) && (encomendas[maior][idp] > 0))
    {
      printf("Maximo produto %d %d %d.\n", idp, maior, encomendas[maior][idp]);
    }
    else
    {
      
    }

  }

}

void merge(prod v[], int left, int m, int right, char comando)
{
  int i;
  int j;
  int k;
  prod aux[10000];
  for (i = m + 1; i > left; i--)
    aux[i - 1] = v[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = v[j + 1];

  for (k = left; k <= right; k++)
  {
    if (((comando == 'l') && ((aux[j].preco < aux[i].preco) || ((aux[j].preco == aux[i].preco) && (aux[j].idp < aux[i].idp)))) || ((comando == 'L') && ordem_alfabetica(aux[j].descr, aux[i].descr)))
    {
      v[k] = aux[j--];
    }
    else
    {
      v[k] = aux[i++];
    }

  }

}

void mergesort(prod v[], int left, int right, char comando)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(v, left, m, comando);
  mergesort(v, m + 1, right, comando);
  merge(v, left, m, right, comando);
}

void comando_l()
{
  int i;
  prod prod_ordenados[10000];
  for (i = 0; i < total_prod; i++)
    prod_ordenados[i] = stock[i];

  mergesort(prod_ordenados, 0, total_prod - 1, 'l');
  printf("Produtos\n");
  for (i = 0; i < total_prod; i++)
    printf("* %s %d %d\n", prod_ordenados[i].descr, prod_ordenados[i].preco, prod_ordenados[i].qtd);

}

void comando_L()
{
  int ide;
  int i;
  int j = 0;
  prod enc_ordenada[200];
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= total_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < total_prod; i++)
    {
      if (encomendas[ide][i] != 0)
      {
        enc_ordenada[j] = stock[i];
        enc_ordenada[j].qtd = encomendas[ide][i];
        j++;
      }
      else
      {
        
      }

    }

    mergesort(enc_ordenada, 0, j - 1, 'L');
    printf("Encomenda %d\n", ide);
    for (i = 0; i <= (j - 1); i++)
      printf("* %s %d %d\n", enc_ordenada[i].descr, enc_ordenada[i].preco, enc_ordenada[i].qtd);

  }

}

int main()
{
  char c;
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
        comando_a();
        break;

      case 'q':
        comando_q();
        break;

      case 'N':
        comando_N();
        break;

      case 'A':
        comando_A();
        break;

      case 'r':
        comando_r();
        break;

      case 'R':
        comando_R();
        break;

      case 'C':
        comando_C();
        break;

      case 'p':
        comando_p();
        break;

      case 'E':
        comando_E();
        break;

      case 'm':
        comando_m();
        break;

      case 'l':
        comando_l();
        break;

      case 'L':
        comando_L();
        break;

    }

    getchar();
  }

  return 0;
}

