/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "comandos.h"


int ganhou(int val1, int val2)
{
  if (val1 > val2)
  {
    {
      return 1;
    }
  }
  else
  {
    if (val2 > val1)
    {
      {
        return 2;
      }
    }
    else
    {
      {
        return 0;
      }
    }

  }

}

void adiciona_jogo(int NL, jogo *tabela_hash[1000], equipa *tabela_hash_equipa[1000], node_lista **inicio, node_lista **fim)
{
  jogo *novo_jogo = (jogo *) malloc(sizeof(jogo));
  char str1[1024];
  char str2[1024];
  char str3[1024];
  int score1;
  int score2;
  for (int str1_index = 0; str1_index < 10; str1_index++)
  {
    str1[str1_index] = new_sym_var(sizeof(char) * 8);
  }

  str1[10 - 1] = '\0';
  for (int str2_index = 0; str2_index < 10; str2_index++)
  {
    str2[str2_index] = new_sym_var(sizeof(char) * 8);
  }

  str2[10 - 1] = '\0';
  for (int str3_index = 0; str3_index < 10; str3_index++)
  {
    str3[str3_index] = new_sym_var(sizeof(char) * 8);
  }

  str3[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  novo_jogo->nome = (char *) malloc((strlen(str1) + 1) * (sizeof(char)));
  novo_jogo->equipa1 = (char *) malloc((strlen(str2) + 1) * (sizeof(char)));
  novo_jogo->equipa2 = (char *) malloc((strlen(str3) + 1) * (sizeof(char)));
  novo_jogo->score1 = score1;
  novo_jogo->score2 = score2;
  strcpy(novo_jogo->nome, str1);
  strcpy(novo_jogo->equipa1, str2);
  strcpy(novo_jogo->equipa2, str3);
  if (procura_tabela(novo_jogo->nome, tabela_hash) != 0)
  {
    {
      printf("%d Jogo existente.\n", NL);
      free(novo_jogo->nome);
      free(novo_jogo->equipa1);
      free(novo_jogo->equipa2);
      free(novo_jogo);
    }
  }
  else
  {
    {
      equipa *equipa1 = procura_tabela_equipa(novo_jogo->equipa1, tabela_hash_equipa);
      equipa *equipa2 = procura_tabela_equipa(novo_jogo->equipa2, tabela_hash_equipa);
      if ((equipa1 == 0) || (equipa2 == 0))
      {
        {
          printf("%d Equipa inexistente.\n", NL);
          free(novo_jogo->nome);
          free(novo_jogo->equipa1);
          free(novo_jogo->equipa2);
          free(novo_jogo);
        }
      }
      else
      {
        {
          inserir_tabela(novo_jogo, tabela_hash);
          insere_fim_lista(novo_jogo->nome, inicio, fim);
          if (ganhou(novo_jogo->score1, novo_jogo->score2) == 1)
          {
            {
              equipa1->ganhos = equipa1->ganhos + 1;
            }
          }
          else
          {
            if (ganhou(novo_jogo->score1, novo_jogo->score2) == 2)
            {
              {
                equipa2->ganhos = equipa2->ganhos + 1;
              }
            }
            else
            {
              
            }

          }

        }
      }

    }
  }

}

void adiciona_equipa(int NL, equipa *tabela_hash_equipa[1000])
{
  equipa *nova_equipa = malloc(sizeof(*nova_equipa));
  char str1[1024];
  for (int str1_index = 0; str1_index < 10; str1_index++)
  {
    str1[str1_index] = new_sym_var(sizeof(char) * 8);
  }

  str1[10 - 1] = '\0';
  nova_equipa->nome = (char *) malloc((strlen(str1) + 1) * (sizeof(char)));
  strcpy(nova_equipa->nome, str1);
  if (procura_tabela_equipa(nova_equipa->nome, tabela_hash_equipa) != 0)
  {
    {
      printf("%d Equipa existente.\n", NL);
      free(nova_equipa->nome);
      free(nova_equipa);
    }
  }
  else
  {
    {
      inserir_tabela_equipa(nova_equipa, tabela_hash_equipa);
      nova_equipa->ganhos = 0;
    }
  }

}

void lista_jogos(int NL, jogo *tabela_hash[1000], node_lista **inicio)
{
  node_lista *aux = *inicio;
  while (aux != 0)
  {
    jogo *el = procura_tabela(aux->nome, tabela_hash);
    if (el != 0)
    {
      {
        printf("%d %s %s %s %d %d\n", NL, el->nome, el->equipa1, el->equipa2, el->score1, el->score2);
      }
    }
    else
    {
      
    }

    aux = aux->next;
  }

}

void procura_jogo(int NL, jogo *tabela_hash[1000])
{
  char nome[1024];
  jogo *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = procura_tabela(nome, tabela_hash);
  if (aux != 0)
  {
    {
      printf("%d %s %s %s %d %d\n", NL, aux->nome, aux->equipa1, aux->equipa2, aux->score1, aux->score2);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", NL);
    }
  }

}

void procura_equipa(int NL, equipa *tabela_hash_equipa[1000])
{
  char nome[1024];
  equipa *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = procura_tabela_equipa(nome, tabela_hash_equipa);
  if (aux != 0)
  {
    {
      printf("%d %s %d\n", NL, aux->nome, aux->ganhos);
    }
  }
  else
  {
    {
      printf("%d Equipa inexistente.\n", NL);
    }
  }

}

void apaga_jogo(int NL, jogo *tabela_hash[1000], equipa *tabela_hash_equipa[1000], node_lista **inicio, node_lista **fim)
{
  char nome[1024];
  jogo *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = procura_tabela(nome, tabela_hash);
  if (aux != 0)
  {
    {
      if (ganhou(aux->score1, aux->score2) == 1)
      {
        {
          equipa *equipa1 = procura_tabela_equipa(aux->equipa1, tabela_hash_equipa);
          equipa1->ganhos = equipa1->ganhos - 1;
        }
      }
      else
      {
        if (ganhou(aux->score1, aux->score2) == 2)
        {
          {
            equipa *equipa2 = procura_tabela_equipa(aux->equipa2, tabela_hash_equipa);
            equipa2->ganhos = equipa2->ganhos - 1;
          }
        }
        else
        {
          
        }

      }

      remove_el_lista(aux->nome, inicio, fim);
      apaga_tabela(aux->nome, tabela_hash);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", NL);
    }
  }

}

void altera_score(int NL, jogo *tabela_hash[1000], equipa *tabela_hash_equipa[1000])
{
  char nome[1024];
  int novo_score1;
  int novo_score2;
  jogo *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  novo_score1 = new_sym_var(sizeof(int) * 8);
  novo_score2 = new_sym_var(sizeof(int) * 8);
  aux = procura_tabela(nome, tabela_hash);
  if (aux != 0)
  {
    {
      equipa *equipa1;
      equipa *equipa2;
      equipa1 = procura_tabela_equipa(aux->equipa1, tabela_hash_equipa);
      equipa2 = procura_tabela_equipa(aux->equipa2, tabela_hash_equipa);
      if (aux->score1 == aux->score2)
      {
        {
          if (ganhou(novo_score1, novo_score2) == 2)
          {
            {
              equipa2->ganhos = equipa2->ganhos + 1;
            }
          }
          else
          {
            if (ganhou(novo_score1, novo_score2) == 1)
            {
              {
                equipa1->ganhos = equipa1->ganhos + 1;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        if (novo_score1 == novo_score2)
        {
          {
            if (ganhou(aux->score1, aux->score2) == 2)
            {
              {
                equipa2->ganhos = equipa2->ganhos - 1;
              }
            }
            else
            {
              if (ganhou(aux->score1, aux->score2) == 1)
              {
                {
                  equipa1->ganhos = equipa1->ganhos - 1;
                }
              }
              else
              {
                
              }

            }

          }
        }
        else
        {
          if ((ganhou(aux->score1, aux->score2) == 1) && (ganhou(novo_score1, novo_score2) == 2))
          {
            {
              equipa1->ganhos = equipa1->ganhos - 1;
              equipa2->ganhos = equipa2->ganhos + 1;
            }
          }
          else
          {
            if ((ganhou(aux->score1, aux->score2) == 2) && (ganhou(novo_score1, novo_score2) == 1))
            {
              {
                equipa2->ganhos = equipa2->ganhos - 1;
                equipa1->ganhos = equipa1->ganhos + 1;
              }
            }
            else
            {
              
            }

          }

        }

      }

      aux->score1 = novo_score1;
      aux->score2 = novo_score2;
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", NL);
    }
  }

}

int compara(const void *a, const void *b)
{
  const char **pa = (const char **) a;
  const char **pb = (const char **) b;
  return strcmp(*pa, *pb);
}

void equipas_mais_jogos(int NL, equipa *tabela_hash_equipa[1000])
{
  int maior = 0;
  char *melhores[10];
  int i;
  int j = 0;
  int k;
  for (i = 0; i < 1000; i++)
  {
    equipa *aux = tabela_hash_equipa[i];
    while (aux != 0)
    {
      if (aux->ganhos > maior)
      {
        {
          maior = aux->ganhos;
          melhores[0] = aux->nome;
          j = 1;
        }
      }
      else
      {
        if (aux->ganhos == maior)
        {
          {
            melhores[j] = aux->nome;
            j = j + 1;
          }
        }
        else
        {
          
        }

      }

      aux = aux->next;
    }

  }

  if (j != 0)
  {
    {
      printf("%d Melhores %d\n", NL, maior);
      qsort(melhores, j, sizeof(char *), compara);
      for (k = 0; k < j; ++k)
      {
        printf("%d * %s\n", NL, melhores[k]);
      }

    }
  }
  else
  {
    
  }

}

