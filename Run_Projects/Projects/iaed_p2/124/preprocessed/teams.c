/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "teams.h"


tLink tInsert_begin(tLink head, pTeam team)
{
  tLink new = (tLink) malloc(sizeof(struct tNode));
  if (head != 0)
  {
    head->prev = new;
  }
  else
  {
    
  }

  new->team = team;
  new->next = head;
  new->prev = 0;
  return new;
}

tLink tRemove(tLink head, char *name)
{
  tLink aux;
  for (aux = head; aux != 0; aux = aux->next)
  {
    if (strcmp(aux->team->name, name) == 0)
    {
      if (aux->prev != 0)
      {
        aux->prev->next = aux->next;
      }
      else
      {
        
      }

      if (aux->next != 0)
      {
        aux->next->prev = aux->prev;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

  }

  free(aux->team->name);
  free(aux->team);
  free(aux);
  return head;
}

pTeam tSearch(tLink head, char *name)
{
  tLink aux;
  for (aux = head; aux != 0; aux = aux->next)
  {
    if (strcmp(aux->team->name, name) == 0)
    {
      return aux->team;
    }
    else
    {
      
    }

  }

  return 0;
}

int tHash(char *v)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
    h = ((a * h) + (*v)) % 1009;

  return h;
}

tLink *tInit(tLink *hash)
{
  int i;
  hash = (tLink *) malloc(1009 * (sizeof(tLink)));
  for (i = 0; i < 1009; i++)
    hash[i] = 0;

  return hash;
}

pTeam tHTsearch(tLink *hash, char *name)
{
  int i = tHash(name);
  return tSearch(hash[i], name);
}

void tHTinsert(tLink *hash, pTeam team)
{
  int i = tHash(team->name);
  hash[i] = tInsert_begin(hash[i], team);
}

void tHTdelete(tLink *hash, char *name)
{
  int i = tHash(name);
  hash[i] = tRemove(hash[i], name);
}

int max_wins(tLink *hashTeam)
{
  int max = 0;
  int i;
  tLink aux;
  for (i = 0; i != 1009; i++)
  {
    aux = hashTeam[i];
    while (aux != 0)
    {
      if (aux->team->wins > max)
      {
        max = aux->team->wins;
      }
      else
      {
        
      }

      aux = aux->next;
    }

  }

  return max;
}

tLink alphInsert(tLink tHead, pTeam team)
{
  tLink new;
  tLink aux = tHead;
  new = (tLink) malloc(sizeof(struct tNode));
  new->team = team;
  if (tHead == 0)
  {
    new->next = tHead;
    new->prev = 0;
    return new;
  }
  else
  {
    
  }

  while ((strcmp(aux->team->name, new->team->name) < 0) && (aux->next != 0))
    aux = aux->next;

  if ((aux->next == 0) && (strcmp(aux->team->name, new->team->name) < 0))
  {
    aux->next = new;
    new->prev = aux;
    new->next = 0;
  }
  else
  {
    new->prev = aux->prev;
    if (aux->prev != 0)
    {
      aux->prev->next = new;
    }
    else
    {
      
    }

    aux->prev = new;
    new->next = aux;
    if (tHead == aux)
    {
      tHead = new;
    }
    else
    {
      
    }

  }

  return tHead;
}

void freeTeam(pTeam t)
{
  free(t->name);
  free(t);
}

