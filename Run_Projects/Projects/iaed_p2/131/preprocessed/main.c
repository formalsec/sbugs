/*File generated by PreProcessor.py*/


#include "equipas.h"
#include "jogos.h"


void funcaoa(Hash_Jogo *HashTableJogo, Hash *HashTableEquipas, int nl, list *ponteiro_lista_unica)
{
  char palavra1[1024];
  char palavra2[1024];
  char palavra3[1024];
  int a;
  int b;
  link x;
  link z;
  linkjogo y;
  for (int palavra1_index = 0; palavra1_index < 10; palavra1_index++)
  {
    palavra1[palavra1_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra1[10 - 1] = '\0';
  for (int palavra2_index = 0; palavra2_index < 10; palavra2_index++)
  {
    palavra2[palavra2_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra2[10 - 1] = '\0';
  for (int palavra3_index = 0; palavra3_index < 10; palavra3_index++)
  {
    palavra3[palavra3_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra3[10 - 1] = '\0';
  a = new_sym_var(sizeof(int) * 8);
  b = new_sym_var(sizeof(int) * 8);
  y = STsearch_jogo(HashTableJogo, palavra1, 13009);
  if (y != 0)
  {
    {
      printf("%d Jogo existente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  x = STsearch(HashTableEquipas, palavra2, 10001);
  if (x == 0)
  {
    {
      printf("%d Equipa inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  z = STsearch(HashTableEquipas, palavra3, 10001);
  if (z == 0)
  {
    {
      printf("%d Equipa inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  STinsert_jogo(HashTableEquipas, HashTableJogo, palavra1, palavra2, palavra3, a, b, 10001, 13009);
  add_last(ponteiro_lista_unica, palavra1, HashTableJogo, 13009);
  if (a > b)
  {
    {
      x->equipa->vitorias++;
    }
  }
  else
  {
    if (a < b)
    {
      {
        z->equipa->vitorias++;
      }
    }
    else
    {
      
    }

  }

}

void funcaol(list *ponteiro_lista_unica, int nl)
{
  linkordenado *y;
  y = ponteiro_lista_unica->head;
  while (y != 0)
  {
    printf("%d %s %s %s %d %d\n", nl, y->jogo->name, y->jogo->equipa1->name, y->jogo->equipa2->name, y->jogo->score1, y->jogo->score2);
    y = y->nextLista;
  }

}

void funcaop(Hash_Jogo *HashTableJogo, int nl)
{
  char palavra1[1024];
  linkjogo y;
  for (int palavra1_index = 0; palavra1_index < 10; palavra1_index++)
  {
    palavra1[palavra1_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra1[10 - 1] = '\0';
  y = STsearch_jogo(HashTableJogo, palavra1, 13009);
  if (y == 0)
  {
    {
      printf("%d Jogo inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  printf("%d %s %s %s %d %d\n", nl, palavra1, y->jogo->equipa1->name, y->jogo->equipa2->name, y->jogo->score1, y->jogo->score2);
}

void funcaor(Hash_Jogo *HashTableJogo, int m_jogo, int nl, list *ponteiro_lista_unica)
{
  linkjogo y;
  linkjogo yantes;
  linkjogo ydepois;
  linkjogo *heads;
  int i;
  char palavra1[1024];
  for (int palavra1_index = 0; palavra1_index < 10; palavra1_index++)
  {
    palavra1[palavra1_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra1[10 - 1] = '\0';
  heads = HashTableJogo->heads;
  i = hashU(palavra1, m_jogo);
  y = STsearch_jogo(HashTableJogo, palavra1, m_jogo);
  if (y == 0)
  {
    {
      printf("%d Jogo inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  if (y->jogo->score1 > y->jogo->score2)
  {
    {
      y->jogo->equipa1->vitorias--;
    }
  }
  else
  {
    if (y->jogo->score1 < y->jogo->score2)
    {
      {
        y->jogo->equipa2->vitorias--;
      }
    }
    else
    {
      
    }

  }

  if ((y->previousHash == 0) && (y->nextHash != 0))
  {
    {
      ydepois = y->nextHash;
      ydepois->previousHash = 0;
      heads[i] = ydepois;
    }
  }
  else
  {
    if ((y->previousHash != 0) && (y->nextHash == 0))
    {
      {
        yantes = y->previousHash;
        yantes->nextHash = 0;
      }
    }
    else
    {
      if ((y->previousHash == 0) && (y->nextHash == 0))
      {
        {
          heads[i] = 0;
        }
      }
      else
      {
        {
          yantes = y->previousHash;
          ydepois = y->nextHash;
          yantes->nextHash = ydepois;
          ydepois->previousHash = yantes;
        }
      }

    }

  }

  procurar_ordenado(ponteiro_lista_unica, y);
  free(y->jogo->name);
  free(y->jogo);
  free(y);
}

void funcaos(Hash_Jogo *HashTableJogo, Hash *HashTableEquipas, int nl)
{
  char palavra1[1024];
  linkjogo y;
  link x;
  link z;
  int a;
  int b;
  for (int palavra1_index = 0; palavra1_index < 10; palavra1_index++)
  {
    palavra1[palavra1_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra1[10 - 1] = '\0';
  a = new_sym_var(sizeof(int) * 8);
  b = new_sym_var(sizeof(int) * 8);
  y = STsearch_jogo(HashTableJogo, palavra1, 13009);
  if (y == 0)
  {
    {
      printf("%d Jogo inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  if ((y->jogo->score1 > y->jogo->score2) && (a <= b))
  {
    {
      x = STsearch(HashTableEquipas, y->jogo->equipa1->name, 10001);
      x->equipa->vitorias--;
      if ((y->jogo->score1 > y->jogo->score2) && (a < b))
      {
        {
          z = STsearch(HashTableEquipas, y->jogo->equipa2->name, 10001);
          z->equipa->vitorias++;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    if ((y->jogo->score1 < y->jogo->score2) && (a >= b))
    {
      {
        z = STsearch(HashTableEquipas, y->jogo->equipa2->name, 10001);
        z->equipa->vitorias--;
        if (a > b)
        {
          {
            x = STsearch(HashTableEquipas, y->jogo->equipa1->name, 10001);
            x->equipa->vitorias++;
          }
        }
        else
        {
          
        }

      }
    }
    else
    {
      if (y->jogo->score1 == y->jogo->score2)
      {
        {
          if (a < b)
          {
            {
              z = STsearch(HashTableEquipas, y->jogo->equipa2->name, 10001);
              z->equipa->vitorias++;
            }
          }
          else
          {
            if (a > b)
            {
              {
                x = STsearch(HashTableEquipas, y->jogo->equipa1->name, 10001);
                x->equipa->vitorias++;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        
      }

    }

  }

  y->jogo->score1 = a;
  y->jogo->score2 = b;
}

void funcaoA(Hash *HashTableEquipas, int nl)
{
  char palavra[1024];
  link x;
  for (int palavra_index = 0; palavra_index < 10; palavra_index++)
  {
    palavra[palavra_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra[10 - 1] = '\0';
  x = STsearch(HashTableEquipas, palavra, 10001);
  if (x != 0)
  {
    {
      printf("%d Equipa existente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  STinsert(HashTableEquipas, palavra, 10001);
}

void funcaoP(Hash *HashTableEquipas, int nl)
{
  char palavra[1024];
  link x;
  for (int palavra_index = 0; palavra_index < 10; palavra_index++)
  {
    palavra[palavra_index] = new_sym_var(sizeof(char) * 8);
  }

  palavra[10 - 1] = '\0';
  x = STsearch(HashTableEquipas, palavra, 10001);
  if (x == 0)
  {
    {
      printf("%d Equipa inexistente.\n", nl);
      nl++;
      return;
    }
  }
  else
  {
    
  }

  printf("%d %s %d\n", nl, x->equipa->name, x->equipa->vitorias);
}

void funcaog(Hash *HashTable, int m, int nl)
{
  link *heads = HashTable->heads;
  link t;
  link *array;
  int x = 0;
  int v = 0;
  int contador = 0;
  array = malloc(sizeof(link));
  while (x < m)
  {
    for (t = heads[x]; t != 0; t = t->next)
    {
      if (t->equipa->vitorias > v)
      {
        {
          v = t->equipa->vitorias;
          free(array);
          array = malloc(sizeof(link));
          array[0] = t;
          contador = 1;
        }
      }
      else
      {
        if (t->equipa->vitorias == v)
        {
          {
            contador++;
            array = realloc((void *) array, (sizeof(link)) * contador);
            array[contador - 1] = t;
          }
        }
        else
        {
          
        }

      }

    }

    x++;
  }

  qsort(array, contador, sizeof(struct node *), comparator);
  if (contador != 0)
  {
    {
      printf("%d Melhores %d\n", nl, array[0]->equipa->vitorias);
    }
  }
  else
  {
    
  }

  for (x = 0; x < contador; x++)
  {
    printf("%d * %s\n", nl, array[x]->equipa->name);
  }

  free(array);
}

void funcaox(Hash *HashTableEquipas, Hash_Jogo *HashTableJogo, list *ponteiro_lista_unica)
{
  STdelete(HashTableEquipas, 10001);
  STdeletejogos(HashTableJogo, 13009);
  free_lista(ponteiro_lista_unica);
}

int main()
{
  char c;
  int nl = 1;
  list *ponteiro_lista_unica;
  Hash *HashTableEquipas;
  Hash_Jogo *HashTableJogo;
  ponteiro_lista_unica = STinit_Lista_ordenada();
  HashTableEquipas = STinit(10001);
  HashTableJogo = STinit_jogos(13009);
  for (;;)
  {
    switch (c = getchar())
    {
      case 'a':
        funcaoa(HashTableJogo, HashTableEquipas, nl, ponteiro_lista_unica);
        nl++;
        break;

      case 'l':
        funcaol(ponteiro_lista_unica, nl);
        nl++;
        break;

      case 'p':
        funcaop(HashTableJogo, nl);
        nl++;
        break;

      case 'r':
        funcaor(HashTableJogo, 13009, nl, ponteiro_lista_unica);
        ++nl;
        break;

      case 's':
        funcaos(HashTableJogo, HashTableEquipas, nl);
        nl++;
        break;

      case 'A':
        funcaoA(HashTableEquipas, nl);
        nl++;
        break;

      case 'P':
        funcaoP(HashTableEquipas, nl);
        nl++;
        break;

      case 'g':
        funcaog(HashTableEquipas, 10001, nl);
        nl++;
        break;

      case 'x':
        funcaox(HashTableEquipas, HashTableJogo, ponteiro_lista_unica);
        return 0;

    }

  }

  return 0;
}

