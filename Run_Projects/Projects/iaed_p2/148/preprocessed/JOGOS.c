/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "JOGOS.h"


ItemJ novoJogo(char *nome, char *equipa1, char *equipa2, int score1, int score2)
{
  ItemJ novo = (ItemJ) malloc(sizeof(struct Jogo));
  novo->nome = (char *) malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(novo->nome, nome);
  novo->equipa1 = (char *) malloc((sizeof(char)) * (strlen(equipa1) + 1));
  strcpy(novo->equipa1, equipa1);
  novo->equipa2 = (char *) malloc((sizeof(char)) * (strlen(equipa2) + 1));
  strcpy(novo->equipa2, equipa2);
  novo->score1 = score1;
  novo->score2 = score2;
  return novo;
}

void freeJogo(ItemJ a)
{
  free(a->equipa2);
  free(a->equipa1);
  free(a->nome);
  free(a);
}

void imprimeJogo(int nl, ItemJ a)
{
  printf("%d %s %s %s %d %d\n", nl, a->nome, a->equipa1, a->equipa2, a->score1, a->score2);
}

int funcao_hashJ(char *v)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
    h = ((a * h) + (*v)) % 997;

  return h;
}

int chave(char *nome)
{
  return funcao_hashJ(nome);
}

void iniciaJ(linkJ headsJ[])
{
  int i;
  for (i = 0; i < 997; i++)
  {
    headsJ[i] = 0;
  }

}

void inserirJ(ItemJ item, linkJ headsJ[])
{
  int i = funcao_hashJ(item->nome);
  headsJ[i] = inserir_inicioJ(headsJ[i], item);
}

linkJ inserir_inicioJ(linkJ head, ItemJ a)
{
  linkJ x = (linkJ) malloc(sizeof(struct nodeJ));
  x->item = a;
  x->next = head;
  return x;
}

ItemJ procura_nome(char *nome, linkJ headsJ[])
{
  int i = funcao_hashJ(nome);
  return procura_lista_nome(headsJ[i], nome);
}

ItemJ procura_lista_nome(linkJ head, char *nome)
{
  linkJ t;
  for (t = head; t != 0; t = t->next)
  {
    if (strcmp(t->item->nome, nome) == 0)
    {
      {
        return t->item;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

lista *cria_lista()
{
  lista *l = malloc(sizeof(lista));
  l->primeiro = (l->ultimo = 0);
  return l;
}

void inserir_fim(lista *l, ItemJ jogo)
{
  linkL n = malloc(sizeof(struct nodeL));
  n->item = jogo;
  n->next = 0;
  n->prev = l->primeiro;
  if (l->ultimo)
  {
    {
      l->ultimo->next = n;
    }
  }
  else
  {
    l->primeiro = n;
  }

  l->ultimo = n;
}

void imprime_jogos(int nl, lista *l)
{
  linkL n;
  for (n = l->primeiro; n; n = n->next)
    imprimeJogo(nl, n->item);

}

void apaga_jogo(linkJ headsJ[], lista *l, char *nome, int i)
{
  int comp;
  linkJ t;
  linkJ prev;
  linkL n = l->primeiro;
  for (t = headsJ[i], prev = 0; t != 0; prev = t, t = t->next)
  {
    if (strcmp(t->item->nome, nome) == 0)
    {
      {
        if (t == headsJ[i])
        {
          headsJ[i] = t->next;
        }
        else
        {
          prev->next = t->next;
        }

        break;
      }
    }
    else
    {
      
    }

  }

  for (; n && ((comp = strcmp(n->item->nome, nome)) != 0); n = n->next)
    ;

  if (n && (!comp))
  {
    {
      if (n->prev)
      {
        n->prev->next = n->next;
      }
      else
      {
        l->primeiro = n->next;
      }

      if (n->next)
      {
        n->next->prev = n->prev;
      }
      else
      {
        l->ultimo = n->prev;
      }

    }
  }
  else
  {
    
  }

  freeJogo(t->item);
  free(t);
  free(n);
}

void sair_jogos(lista *l, linkJ headsJ[])
{
  linkJ t;
  linkJ aux;
  int i;
  for (i = 0; i < 997; i++)
  {
    for (t = headsJ[i]; t != 0;)
    {
      aux = t;
      t = t->next;
      apaga_jogo(headsJ, l, aux->item->nome, i);
    }

  }

  free(l);
}

