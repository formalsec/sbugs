/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "Projeto2.h"


void adic_equipa(equipa_pont *tabela_hash, int nl)
{
  int indice;
  char buffer[1024];
  equipa_pont equipa_adici;
  equipa_pont i;
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[10 - 1] = '\0';
  indice = hash(buffer, 2131);
  for (i = tabela_hash[indice]; i != 0; i = i->prox_equipa)
  {
    if (strcmp(i->nome_equipa, buffer) == 0)
    {
      {
        printf("%d Equipa existente.\n", nl);
        return;
      }
    }
    else
    {
      
    }

  }

  equipa_adici = (equipa_pont) malloc(sizeof(struct equipa));
  equipa_adici->nome_equipa = (char *) malloc((sizeof(char)) * (strlen(buffer) + 1));
  strcpy(equipa_adici->nome_equipa, buffer);
  equipa_adici->vitorias = (int *) malloc(sizeof(int));
  *equipa_adici->vitorias = 0;
  equipa_adici->prox_equipa = tabela_hash[indice];
  tabela_hash[indice] = equipa_adici;
}

void procura_equipa(equipa_pont *tabela_hash_equipas, int nl)
{
  char nome[1024];
  int indice;
  equipa_pont i;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  indice = hash(nome, 2131);
  for (i = tabela_hash_equipas[indice]; i != 0; i = i->prox_equipa)
  {
    if (strcmp(nome, i->nome_equipa) == 0)
    {
      {
        printf("%d %s %d\n", nl, i->nome_equipa, *i->vitorias);
        return;
      }
    }
    else
    {
      
    }

  }

  printf("%d Equipa inexistente.\n", nl);
}

int cstring_cmp(const void *a, const void *b)
{
  const char **ia = (const char **) a;
  const char **ib = (const char **) b;
  return strcmp(*ia, *ib);
}

int descobre_max_vit(equipa_pont *tabela_hash_equipas, int *tamanho)
{
  int indice;
  int max_vitorias = 0;
  equipa_pont e;
  for (indice = 0; indice < 2131; indice++)
  {
    for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
    {
      if ((*e->vitorias) > max_vitorias)
      {
        {
          max_vitorias = *e->vitorias;
          *tamanho = 1;
        }
      }
      else
      {
        if ((*e->vitorias) == max_vitorias)
        {
          {
            (*tamanho)++;
          }
        }
        else
        {
          
        }

      }

    }

  }

  return max_vitorias;
}

void mais_vencedoras(equipa_pont *tabela_hash_equipas, int nl)
{
  int indice;
  int max_vitorias = 0;
  int indice_array = 0;
  int tamanho = 0;
  equipa_pont e;
  char **array;
  max_vitorias = descobre_max_vit(tabela_hash_equipas, &tamanho);
  if (tamanho == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  array = (char **) malloc((sizeof(char *)) * tamanho);
  for (indice = 0; indice < 2131; indice++)
  {
    for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
    {
      if ((*e->vitorias) == max_vitorias)
      {
        {
          array[indice_array] = e->nome_equipa;
          indice_array++;
        }
      }
      else
      {
        
      }

    }

  }

  qsort(array, tamanho, sizeof(char *), cstring_cmp);
  printf("%d Melhores %d\n", nl, max_vitorias);
  for (indice = 0; indice < indice_array; indice++)
  {
    printf("%d * %s\n", nl, array[indice]);
  }

  free(array);
}

