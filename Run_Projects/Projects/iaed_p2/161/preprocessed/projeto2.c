/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include "tabela_equipas.h"
#include "tabela_jogos.h"


void adiciona_jogo(lista *lista_jogos, pTabela_jogos tabela_jogos, pTabela_equipas tabela_equipas, unsigned int Num_Linha)
{
  char buffer[3][1024];
  unsigned int score[2];
  pJogo novo_jogo;
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[0][buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[0][10 - 1] = '\0';
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[1][buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[1][10 - 1] = '\0';
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[2][buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[2][10 - 1] = '\0';
  score[0] = new_sym_var(sizeof(unsigned int) * 8);
  score[1] = new_sym_var(sizeof(unsigned int) * 8);
  if (procura_jogo_tabela(tabela_jogos, buffer[0]) != 0)
  {
    printf("%u Jogo existente.\n", Num_Linha);
    return;
  }
  else
  {
    
  }

  if ((procura_equipa_tabela(tabela_equipas, buffer[1]) == 0) || (procura_equipa_tabela(tabela_equipas, buffer[2]) == 0))
  {
    printf("%u Equipa inexistente.\n", Num_Linha);
    return;
  }
  else
  {
    
  }

  novo_jogo = cria_jogo(buffer[0], buffer[1], buffer[2], score);
  adiciona_jogo_lista(lista_jogos, novo_jogo);
  adiciona_jogo_tabela(tabela_jogos, novo_jogo);
  if (score[0] > score[1])
  {
    altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, buffer[1]), 1);
  }
  else
  {
    if (score[0] < score[1])
    {
      altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, buffer[2]), 1);
    }
    else
    {
      
    }

  }

  return;
}

void lista_todos_jogos(lista *lista_jogos, unsigned int Num_Linha)
{
  print_lista_jogos(lista_jogos, Num_Linha);
  return;
}

void procura_jogo(pTabela_jogos tabela_jogos, unsigned int Num_Linha)
{
  char nome_jogo[1024];
  pJogo jogo;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  jogo = procura_jogo_tabela(tabela_jogos, nome_jogo);
  if (jogo == 0)
  {
    printf("%u Jogo inexistente.\n", Num_Linha);
  }
  else
  {
    print_jogo(jogo, Num_Linha);
  }

  return;
}

void adiciona_equipa(pTabela_equipas tabela_equipas, unsigned int Num_Linha)
{
  char buffer[1024];
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[10 - 1] = '\0';
  if (procura_equipa_tabela(tabela_equipas, buffer) != 0)
  {
    printf("%u Equipa existente.\n", Num_Linha);
  }
  else
  {
    adiciona_equipa_tabela(tabela_equipas, cria_equipa(buffer));
  }

  return;
}

void procura_equipa(pTabela_equipas tabela_equipas, unsigned int Num_Linha)
{
  char nome_equipa[1024];
  pEquipa equipa;
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  equipa = procura_equipa_tabela(tabela_equipas, nome_equipa);
  if (equipa == 0)
  {
    printf("%u Equipa inexistente.\n", Num_Linha);
  }
  else
  {
    print_equipa(equipa, Num_Linha);
  }

  return;
}

void apaga_jogo(pTabela_jogos tabela_jogos, lista *lista_jogos, pTabela_equipas tabela_equipas, unsigned int Num_Linha)
{
  char nome_jogo[1024];
  pJogo jogo;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  if ((jogo = remove_jogo_tabela(tabela_jogos, nome_jogo)) == 0)
  {
    printf("%u Jogo inexistente.\n", Num_Linha);
    return;
  }
  else
  {
    
  }

  remove_jogo_lista(lista_jogos, nome_jogo);
  if (obtem_vencedor_jogo(jogo) != 0)
  {
    altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, obtem_vencedor_jogo(jogo)), -1);
  }
  else
  {
    
  }

  free_jogo(jogo);
  return;
}

void altera_pontuacao(pTabela_jogos tabela_jogos, pTabela_equipas tabela_equipas, unsigned int Num_Linha)
{
  char nome_jogo[1024];
  unsigned int novo_score[2];
  char *vencedor_anterior;
  char *vencedor_atual;
  pJogo jogo;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  novo_score[0] = new_sym_var(sizeof(unsigned int) * 8);
  novo_score[1] = new_sym_var(sizeof(unsigned int) * 8);
  if ((jogo = procura_jogo_tabela(tabela_jogos, nome_jogo)) == 0)
  {
    printf("%u Jogo inexistente.\n", Num_Linha);
    return;
  }
  else
  {
    
  }

  vencedor_anterior = obtem_vencedor_jogo(jogo);
  altera_score_jogo(jogo, novo_score);
  vencedor_atual = obtem_vencedor_jogo(jogo);
  if ((vencedor_anterior != 0) && (vencedor_atual != 0))
  {
    if (strcmp(vencedor_anterior, vencedor_atual) != 0)
    {
      altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, vencedor_anterior), -1);
      altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, vencedor_atual), 1);
    }
    else
    {
      
    }

  }
  else
  {
    if (vencedor_atual != 0)
    {
      altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, vencedor_atual), 1);
    }
    else
    {
      if (vencedor_anterior != 0)
      {
        altera_vitorias_equipa(procura_equipa_tabela(tabela_equipas, vencedor_anterior), -1);
      }
      else
      {
        
      }

    }

  }

  return;
}

int main()
{
  char comando;
  lista *lista_jogos;
  pTabela_jogos tabela_jogos;
  pTabela_equipas tabela_equipas;
  unsigned int Num_Linha = 1;
  lista_jogos = inicializa_lista_jogos();
  tabela_jogos = inicializa_tabela_jogos(31);
  tabela_equipas = inicializa_tabela_equipas(31);
  while ((comando = getchar()) != 'x')
    switch (comando)
  {
    case 'a':
      adiciona_jogo(lista_jogos, tabela_jogos, tabela_equipas, Num_Linha++);
      break;

    case 'l':
      lista_todos_jogos(lista_jogos, Num_Linha++);
      break;

    case 'p':
      procura_jogo(tabela_jogos, Num_Linha++);
      break;

    case 'r':
      apaga_jogo(tabela_jogos, lista_jogos, tabela_equipas, Num_Linha++);
      break;

    case 's':
      altera_pontuacao(tabela_jogos, tabela_equipas, Num_Linha++);
      break;

    case 'A':
      adiciona_equipa(tabela_equipas, Num_Linha++);
      break;

    case 'P':
      procura_equipa(tabela_equipas, Num_Linha++);
      break;

    case 'g':
      print_melhores_equipas(tabela_equipas, Num_Linha++);
      break;

  }


  destroi_tabela_equipas(tabela_equipas);
  destroi_tabela_jogos(tabela_jogos);
  destroi_lista_jogos(lista_jogos);
  return 0;
}

