/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "equipas.h"
#include "constants.h"


Team createTeam(char *name)
{
  Team newTeam;
  int len;
  int i = 0;
  len = strlen(name);
  newTeam.name = malloc(len + (1 * (sizeof(char))));
  if (!newTeam.name)
  {
    {
      perror("createTeam Failed malloc");
    }
  }
  else
  {
    
  }

  while ((name[i] != '\0') && (i < len))
  {
    newTeam.name[i] = name[i];
    i++;
  }

  newTeam.name[i] = '\0';
  newTeam.victories = 0;
  return newTeam;
}

int isTeam(char *name, Team team)
{
  int len;
  int len2;
  int i;
  len = strlen(name);
  len2 = strlen(team.name);
  if (len == len2)
  {
    {
      for (i = 0; i < len; i++)
      {
        if (name[i] != team.name[i])
        {
          {
            return 0;
          }
        }
        else
        {
          
        }

      }

      return 1;
    }
  }
  else
  {
    
  }

  return 0;
}

void addVictory(Teams *teamsList, char *team)
{
  while (teamsList->nextTeam != 0)
  {
    if (isTeam(team, teamsList->team))
    {
      {
        break;
      }
    }
    else
    {
      
    }

    teamsList = teamsList->nextTeam;
  }

  teamsList->team.victories++;
}

void removeVictory(Teams *teamsList, char *team)
{
  while (teamsList->nextTeam != 0)
  {
    if (isTeam(team, teamsList->team))
    {
      {
        break;
      }
    }
    else
    {
      
    }

    teamsList = teamsList->nextTeam;
  }

  teamsList->team.victories--;
}

Teams *createTeams(char *name)
{
  Teams *new;
  new = malloc(sizeof(Teams));
  if (!new)
  {
    {
      perror("createTeams Failed malloc");
    }
  }
  else
  {
    
  }

  new->team = createTeam(name);
  new->nextTeam = 0;
  return new;
}

int addTeam(char *name, Teams *teamsList)
{
  Team test;
  test = searchTeam(teamsList, name);
  if (isTeam("NULL123", test) == 1)
  {
    {
      while (teamsList->nextTeam != 0)
      {
        teamsList = teamsList->nextTeam;
      }

      teamsList->nextTeam = createTeams(name);
      freeTeam(test);
      return 1;
    }
  }
  else
  {
    
  }

  return 0;
}

Team searchTeam(Teams *teamsList, char *name)
{
  if (teamsList == 0)
  {
    {
      return createTeam("NULL123");
    }
  }
  else
  {
    
  }

  while (teamsList->nextTeam != 0)
  {
    if (isTeam(name, teamsList->team) == 1)
    {
      {
        return teamsList->team;
      }
    }
    else
    {
      
    }

    teamsList = teamsList->nextTeam;
  }

  if (isTeam(name, teamsList->team) == 1)
  {
    {
      return teamsList->team;
    }
  }
  else
  {
    
  }

  return createTeam("NULL123");
}

void freeTeams(Teams *teamsList)
{
  if (teamsList != 0)
  {
    {
      Teams *next;
      while (teamsList->nextTeam != 0)
      {
        next = teamsList->nextTeam;
        teamsList->nextTeam = next->nextTeam;
        freeTeam(next->team);
        free(next);
      }

      freeTeam(teamsList->team);
      free(teamsList);
    }
  }
  else
  {
    
  }

}

void printTeam(Teams *teamsList, char *name, int commandNumber)
{
  Team team;
  if (teamsList != 0)
  {
    {
      team = searchTeam(teamsList, name);
      if (isTeam("NULL123", team) == 0)
      {
        {
          fprintf(outputFile, "%d %s %d\n", commandNumber, name, team.victories);
        }
      }
      else
      {
        {
          freeTeam(team);
          fprintf(outputFile, "%d Equipa inexistente.\n", commandNumber);
        }
      }

    }
  }
  else
  {
    {
      fprintf(outputFile, "%d Equipa inexistente.\n", commandNumber);
    }
  }

}

int nameComp(char *c1, char *c2)
{
  int lenght;
  int i;
  if (strcmp(c1, c2) < 0)
  {
    {
      lenght = strlen(c1);
    }
  }
  else
  {
    {
      lenght = strlen(c2);
    }
  }

  for (i = 0; i < lenght; i++)
  {
    if (c1[i] < c2[i])
    {
      {
        return -1;
      }
    }
    else
    {
      if (c1[i] > c2[i])
      {
        {
          return 1;
        }
      }
      else
      {
        
      }

    }

  }

  return 0;
}

void sort(char **list, int size)
{
  int i;
  int j;
  int temp;
  char string[1024];
  for (i = 0; i < (size - 1); i++)
  {
    temp = i;
    for (j = i + 1; j <= (size - 1); j++)
    {
      if (nameComp(list[j], list[temp]) == (-1))
      {
        {
          temp = j;
        }
      }
      else
      {
        
      }

    }

    strcpy(string, list[i]);
    strcpy(list[i], list[temp]);
    strcpy(list[temp], string);
  }

}

void printBest(Teams *teamsList, int commandNumber)
{
  int max = 0;
  int num = 0;
  int i = 0;
  int j;
  char **list;
  Teams *move;
  if (teamsList != 0)
  {
    {
      move = teamsList;
      while (move->nextTeam != 0)
      {
        if (move->team.victories > max)
        {
          {
            max = move->team.victories;
            num = 0;
          }
        }
        else
        {
          if (move->team.victories == max)
          {
            {
              num++;
            }
          }
          else
          {
            
          }

        }

        move = move->nextTeam;
      }

      if (move->team.victories > max)
      {
        {
          max = move->team.victories;
        }
      }
      else
      {
        if (move->team.victories == max)
        {
          {
            num++;
          }
        }
        else
        {
          
        }

      }

      list = malloc(num * (sizeof(char *)));
      while (teamsList->nextTeam != 0)
      {
        if (teamsList->team.victories == max)
        {
          {
            list[i] = malloc(1024 * (sizeof(char)));
            strcpy(list[i], teamsList->team.name);
            i++;
          }
        }
        else
        {
          
        }

        teamsList = teamsList->nextTeam;
      }

      if (teamsList->team.victories == max)
      {
        {
          list[i] = malloc(1024 * (sizeof(char)));
          strcpy(list[i], teamsList->team.name);
          i++;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  sort(list, i);
  fprintf(outputFile, "%d Melhores %d\n", commandNumber, max);
  for (j = 0; j < i; j++)
  {
    fprintf(outputFile, "%d * %s\n", commandNumber, list[j]);
    free(list[j]);
  }

  free(list);
}

void freeTeam(Team team)
{
  free(team.name);
}

