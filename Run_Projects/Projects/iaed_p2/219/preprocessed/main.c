/*File generated by PreProcessor.py*/


#include "main.h"


int cont = 0;
int main()
{
  lista_equipas *l_equipas = cria_lista_equipas();
  lista_jogos *l_jogos = cria_lista_jogos();
  char comando;
  Initequipa();
  Initjogo();
  do
  {
    comando = le_comandos(l_equipas, l_jogos);
  }
  while (comando != 'x');
  free_equipas(l_equipas);
  free_jogos(l_jogos);
  ApagaHashEquipa();
  ApagaHashJogo();
  return 0;
}

char le_comandos(lista_equipas *l_equipas, lista_jogos *l_jogos)
{
  char comando;
  char res[5][3071];
  char *arg1;
  char *arg2;
  char *arg3;
  char *arg4;
  char *arg5;
  comando = new_sym_var(sizeof(char) * 8);
  switch (comando)
  {
    case 'a':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[1][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[1][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[2][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[2][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[3][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[3][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[4][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[4][10 - 1] = '\0';
      arg1 = res[0];
      arg2 = res[1];
      arg3 = res[2];
      arg4 = res[3];
      arg5 = res[4];
      comando_a(l_jogos, arg1, arg2, arg3, arg4, arg5);
      break;

    case 'A':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      arg1 = res[0];
      comando_A(l_equipas, arg1);
      break;

    case 'l':
      cont++;
      comando_l(l_jogos);
      break;

    case 'p':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      arg1 = res[0];
      comando_p(arg1);
      break;

    case 's':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[1][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[1][10 - 1] = '\0';
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[2][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[2][10 - 1] = '\0';
      arg1 = res[0];
      arg2 = res[1];
      arg3 = res[2];
      comando_s(arg1, arg2, arg3);
      break;

    case 'r':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      arg1 = res[0];
      comando_r(l_jogos, arg1);
      break;

    case 'P':
      cont++;
      for (int res_index = 0; res_index < 10; res_index++)
    {
      res[0][res_index] = new_sym_var(sizeof(char) * 8);
    }

      res[0][10 - 1] = '\0';
      arg1 = res[0];
      comando_P(arg1);
      break;

    case 'g':
      cont++;
      comando_g(l_equipas);
      break;

    case 'x':

    default:
      break;

  }

  return comando;
}

void comando_a(lista_jogos *listaj, char *nome, char *equipa1, char *equipa2, char *score1, char *score2)
{
  int s1;
  int s2;
  equipa *auxequipa;
  jogo *novo_jogo = cria_jogo();
  if (STsearchJogo(nome) == 0)
  {
    {
      if ((STsearchEquipa(equipa1) != 0) && (STsearchEquipa(equipa2) != 0))
      {
        {
          preenche_jogo(novo_jogo, nome, equipa1, equipa2, score1, score2);
          adiciona_jogo(novo_jogo, listaj);
          STinsertJogo(novo_jogo);
          s1 = new_sym_var(sizeof(int) * 8);
          s2 = new_sym_var(sizeof(int) * 8);
          if (s1 > s2)
          {
            {
              auxequipa = STsearchEquipa(equipa1);
              auxequipa->ganhos++;
            }
          }
          else
          {
            if (s2 > s1)
            {
              {
                auxequipa = STsearchEquipa(equipa2);
                auxequipa->ganhos++;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        {
          printf("%d Equipa inexistente.\n", cont);
        }
      }

    }
  }
  else
  {
    {
      printf("%d Jogo existente.\n", cont);
      free(novo_jogo);
    }
  }

}

void comando_A(lista_equipas *listae, char *nome)
{
  equipa *novo_equipa = cria_equipa();
  if (STsearchEquipa(nome) == 0)
  {
    {
      preenche_equipa(novo_equipa, nome);
      adiciona_equipa(novo_equipa, listae);
      STinsertEquipa(novo_equipa);
    }
  }
  else
  {
    {
      printf("%d Equipa existente.\n", cont);
      free(novo_equipa);
    }
  }

}

void comando_l(lista_jogos *listaj)
{
  jogo *auxjogo = listaj->last;
  while (auxjogo != 0)
  {
    printf("%d %s %s %s %s %s\n", cont, auxjogo->nome, auxjogo->equipa1, auxjogo->equipa2, auxjogo->score1, auxjogo->score2);
    auxjogo = auxjogo->jogo_anterior;
  }

}

void comando_p(char *nome)
{
  jogo *auxjogo;
  if (STsearchJogo(nome) != 0)
  {
    {
      auxjogo = STsearchJogo(nome);
      printf("%d %s %s %s %s %s\n", cont, auxjogo->nome, auxjogo->equipa1, auxjogo->equipa2, auxjogo->score1, auxjogo->score2);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", cont);
    }
  }

}

void comando_P(char *nome)
{
  equipa *auxequipa;
  if (STsearchEquipa(nome) != 0)
  {
    {
      auxequipa = STsearchEquipa(nome);
      printf("%d %s %d\n", cont, auxequipa->nome, auxequipa->ganhos);
    }
  }
  else
  {
    {
      printf("%d Equipa inexistente.\n", cont);
    }
  }

}

void comando_s(char *nome, char *novo_s1, char *novo_s2)
{
  int ant1;
  int ant2;
  int novo1;
  int novo2;
  jogo *auxjogo;
  equipa *auxequipa;
  novo1 = new_sym_var(sizeof(int) * 8);
  novo2 = new_sym_var(sizeof(int) * 8);
  if (STsearchJogo(nome) != 0)
  {
    {
      auxjogo = STsearchJogo(nome);
      ant1 = new_sym_var(sizeof(int) * 8);
      ant2 = new_sym_var(sizeof(int) * 8);
      if (ant1 > ant2)
      {
        {
          if (novo2 > novo1)
          {
            {
              auxequipa = STsearchEquipa(auxjogo->equipa1);
              auxequipa->ganhos--;
              auxequipa = STsearchEquipa(auxjogo->equipa2);
              auxequipa->ganhos++;
            }
          }
          else
          {
            if (novo2 == novo1)
            {
              {
                auxequipa = STsearchEquipa(auxjogo->equipa1);
                auxequipa->ganhos--;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        if (ant2 > ant1)
        {
          {
            if (novo1 > novo2)
            {
              {
                auxequipa = STsearchEquipa(auxjogo->equipa2);
                auxequipa->ganhos--;
                auxequipa = STsearchEquipa(auxjogo->equipa1);
                auxequipa->ganhos++;
              }
            }
            else
            {
              if (novo2 == novo1)
              {
                {
                  auxequipa = STsearchEquipa(auxjogo->equipa2);
                  auxequipa->ganhos--;
                }
              }
              else
              {
                
              }

            }

          }
        }
        else
        {
          if (ant1 == ant2)
          {
            {
              if (novo1 > novo2)
              {
                {
                  auxequipa = STsearchEquipa(auxjogo->equipa1);
                  auxequipa->ganhos++;
                }
              }
              else
              {
                if (novo2 > novo1)
                {
                  {
                    auxequipa = STsearchEquipa(auxjogo->equipa2);
                    auxequipa->ganhos++;
                  }
                }
                else
                {
                  
                }

              }

            }
          }
          else
          {
            
          }

        }

      }

      free(auxjogo->score1);
      free(auxjogo->score2);
      auxjogo->score1 = malloc(((sizeof(char)) * strlen(novo_s1)) + 1);
      auxjogo->score2 = malloc(((sizeof(char)) * strlen(novo_s2)) + 1);
      strcpy(auxjogo->score1, novo_s1);
      strcpy(auxjogo->score2, novo_s2);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", cont);
    }
  }

}

void comando_r(lista_jogos *listaj, char *nome)
{
  jogo *auxjogo;
  equipa *auxequipa;
  int s1;
  int s2;
  if (STsearchJogo(nome) != 0)
  {
    {
      auxjogo = STsearchJogo(nome);
      s1 = new_sym_var(sizeof(int) * 8);
      s2 = new_sym_var(sizeof(int) * 8);
      if (s1 > s2)
      {
        {
          auxequipa = STsearchEquipa(auxjogo->equipa1);
          auxequipa->ganhos--;
        }
      }
      else
      {
        if (s2 < s1)
        {
          {
            auxequipa = STsearchEquipa(auxjogo->equipa2);
            auxequipa->ganhos--;
          }
        }
        else
        {
          
        }

      }

      retira_jogo(listaj, auxjogo);
      STdelete(nome);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", cont);
    }
  }

}

int comando_g(lista_equipas *listae)
{
  equipa *auxequipa = listae->last;
  int ganhostotal = 0;
  while (auxequipa != 0)
  {
    if (auxequipa->ganhos > ganhostotal)
    {
      {
        ganhostotal = auxequipa->ganhos;
      }
    }
    else
    {
      
    }

    auxequipa = auxequipa->equipa_anterior;
  }

  if (listae->num_equipas == 0)
  {
    {
      return -1;
    }
  }
  else
  {
    {
      printf("%d Melhores %d\n", cont, ganhostotal);
    }
  }

  aux_g(listae, ganhostotal);
  return 0;
}

void aux_g(lista_equipas *listae, int ganhostotal)
{
  equipa *auxequipa = listae->last;
  while (auxequipa != 0)
  {
    if (auxequipa->ganhos == ganhostotal)
    {
      {
        printf("%d * %s\n", cont, auxequipa->nome);
      }
    }
    else
    {
      
    }

    auxequipa = auxequipa->equipa_anterior;
  }

}

