/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "equipa.h"
#include "jogos.h"


int main()
{
  int nl = 1;
  int pt1;
  int pt2;
  int temp_1;
  int temp_2;
  int max;
  char comando;
  char buffer[1023];
  char nome1[1023];
  char nome2[1023];
  char *nome_equipa;
  char *nome_jogo;
  char *nome_1;
  char *nome_2;
  htable_entrada_t **htable_equipas;
  htable_entrada_jogo_t **htable_jogos;
  lista_intruduzidos_t *cabeca = 0;
  lista_equipas_intruduzidas_t *cabeca_remove = 0;
  htable_entrada_jogo_t *t = malloc(sizeof(htable_entrada_jogo_t));
  htable_entrada_t *eq = malloc(sizeof(htable_entrada_t));
  htable_equipas = cria_hashtable();
  htable_jogos = cria_hashtable_jogo();
  comando = getchar();
  while (comando != 'x')
  {
    switch (comando)
    {
      case 'a':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        for (int nome1_index = 0; nome1_index < 10; nome1_index++)
      {
        nome1[nome1_index] = new_sym_var(sizeof(char) * 8);
      }

        nome1[10 - 1] = '\0';
        for (int nome2_index = 0; nome2_index < 10; nome2_index++)
      {
        nome2[nome2_index] = new_sym_var(sizeof(char) * 8);
      }

        nome2[10 - 1] = '\0';
        pt1 = new_sym_var(sizeof(int) * 8);
        pt2 = new_sym_var(sizeof(int) * 8);
        nome_jogo = malloc((sizeof(char)) * (strlen(buffer) + 1));
        nome_1 = malloc((sizeof(char)) * (strlen(nome1) + 1));
        nome_2 = malloc((sizeof(char)) * (strlen(nome2) + 1));
        strcpy(nome_jogo, buffer);
        strcpy(nome_1, nome1);
        strcpy(nome_2, nome2);
        if (encontra_jogo(htable_jogos, nome_jogo) != 0)
      {
        printf("%d Jogo existente.\n", nl);
      }
      else
      {
        if ((encontra_equipa(htable_equipas, nome_1) == 0) || (encontra_equipa(htable_equipas, nome_2) == 0))
        {
          printf("%d Equipa inexistente.\n", nl);
        }
        else
        {
          adiciona_jogo_a_hashtable(htable_jogos, &cabeca, nome_jogo, nome_1, nome_2, pt1, pt2);
          t->jogo = encontra_jogo(htable_jogos, nome_jogo);
          if (t->jogo->pts_1 > t->jogo->pts_2)
          {
            eq->equipa = encontra_equipa(htable_equipas, t->jogo->eq1);
            eq->equipa->numero_de_jogos += 1;
          }
          else
          {
            if (t->jogo->pts_2 > t->jogo->pts_1)
            {
              eq->equipa = encontra_equipa(htable_equipas, t->jogo->eq2);
              eq->equipa->numero_de_jogos += 1;
            }
            else
            {
              
            }

          }

        }

      }

        nl += 1;
        free(nome_jogo);
        free(nome_1);
        free(nome_2);
        break;

      case 'l':
        imprime_lista(cabeca, nl);
        nl += 1;
        break;

      case 'p':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        nome_jogo = malloc((sizeof(char)) * (strlen(buffer) + 1));
        strcpy(nome_jogo, buffer);
        if (encontra_jogo(htable_jogos, nome_jogo) == 0)
      {
        printf("%d Jogo inexistente.\n", nl);
      }
      else
      {
        printf("%d %s", nl, nome_jogo);
        printf(" %s", encontra_jogo(htable_jogos, nome_jogo)->eq1);
        printf(" %s", encontra_jogo(htable_jogos, nome_jogo)->eq2);
        printf(" %d", encontra_jogo(htable_jogos, nome_jogo)->pts_1);
        printf(" %d\n", encontra_jogo(htable_jogos, nome_jogo)->pts_2);
      }

        nl += 1;
        free(nome_jogo);
        break;

      case 'r':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        nome_jogo = malloc((sizeof(char)) * (strlen(buffer) + 1));
        strcpy(nome_jogo, buffer);
        if (encontra_jogo(htable_jogos, nome_jogo) == 0)
      {
        printf("%d Jogo inexistente.\n", nl);
      }
      else
      {
        if (encontra_jogo(htable_jogos, nome_jogo)->pts_1 > encontra_jogo(htable_jogos, nome_jogo)->pts_2)
        {
          encontra_equipa(htable_equipas, encontra_jogo(htable_jogos, nome_jogo)->eq1)->numero_de_jogos -= 1;
        }
        else
        {
          if (encontra_jogo(htable_jogos, nome_jogo)->pts_1 < encontra_jogo(htable_jogos, nome_jogo)->pts_2)
          {
            encontra_equipa(htable_equipas, encontra_jogo(htable_jogos, nome_jogo)->eq2)->numero_de_jogos -= 1;
          }
          else
          {
            
          }

        }

        retira_da_lista(&cabeca, nome_jogo);
        remove_jogo(htable_jogos, nome_jogo);
      }

        nl += 1;
        free(nome_jogo);
        break;

      case 's':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        pt1 = new_sym_var(sizeof(int) * 8);
        pt2 = new_sym_var(sizeof(int) * 8);
        nome_jogo = malloc((sizeof(char)) * (strlen(buffer) + 1));
        strcpy(nome_jogo, buffer);
        if (encontra_jogo(htable_jogos, nome_jogo) == 0)
      {
        printf("%d Jogo inexistente.\n", nl);
      }
      else
      {
        temp_1 = encontra_jogo(htable_jogos, nome_jogo)->pts_1;
        temp_2 = encontra_jogo(htable_jogos, nome_jogo)->pts_2;
        t->jogo = encontra_jogo(htable_jogos, nome_jogo);
        t->jogo->pts_1 = pt1;
        t->jogo->pts_2 = pt2;
        if ((pt1 > pt2) && (temp_1 < temp_2))
        {
          encontra_equipa(htable_equipas, t->jogo->eq1)->numero_de_jogos += 1;
          encontra_equipa(htable_equipas, t->jogo->eq2)->numero_de_jogos -= 1;
        }
        else
        {
          
        }

        if ((pt1 > pt2) && (temp_1 == temp_2))
        {
          encontra_equipa(htable_equipas, t->jogo->eq1)->numero_de_jogos += 1;
        }
        else
        {
          if ((pt1 < pt2) && (temp_1 > temp_2))
          {
            encontra_equipa(htable_equipas, t->jogo->eq2)->numero_de_jogos += 1;
            encontra_equipa(htable_equipas, t->jogo->eq1)->numero_de_jogos -= 1;
          }
          else
          {
            if ((pt1 < pt2) && (temp_1 == temp_2))
            {
              encontra_equipa(htable_equipas, t->jogo->eq2)->numero_de_jogos += 1;
            }
            else
            {
              if ((pt1 == pt2) && (temp_1 > temp_2))
              {
                encontra_equipa(htable_equipas, t->jogo->eq1)->numero_de_jogos -= 1;
              }
              else
              {
                if ((pt1 == pt2) && (temp_1 < temp_2))
                {
                  encontra_equipa(htable_equipas, t->jogo->eq2)->numero_de_jogos -= 1;
                }
                else
                {
                  
                }

              }

            }

          }

        }

      }

        nl += 1;
        free(nome_jogo);
        break;

      case 'A':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        nome_equipa = malloc((sizeof(char)) * (strlen(buffer) + 1));
        strcpy(nome_equipa, buffer);
        if (encontra_equipa(htable_equipas, nome_equipa) != 0)
      {
        printf("%d Equipa existente.\n", nl);
      }
      else
      {
        adiciona_equipa_a_hashtable(htable_equipas, &cabeca_remove, nome_equipa);
      }

        nl += 1;
        free(nome_equipa);
        break;

      case 'P':
        for (int buffer_index = 0; buffer_index < 10; buffer_index++)
      {
        buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
      }

        buffer[10 - 1] = '\0';
        nome_equipa = malloc((sizeof(char)) * (strlen(buffer) + 1));
        strcpy(nome_equipa, buffer);
        if (encontra_equipa(htable_equipas, nome_equipa) == 0)
      {
        printf("%d Equipa inexistente.\n", nl);
      }
      else
      {
        printf("%d %s %d\n", nl, nome_equipa, encontra_equipa(htable_equipas, nome_equipa)->numero_de_jogos);
      }

        nl += 1;
        free(nome_equipa);
        break;

      case 'g':
        max = max_jogos_ganhos(cabeca_remove);
        imprime_melhores_equipas(cabeca_remove, max, nl);
        nl += 1;
        break;

    }

    comando = getchar();
  }

  free(t);
  free(eq);
  destroi_lista(cabeca);
  destroi_lista_equipas(cabeca_remove);
  destroi_hashtable(htable_equipas);
  destroi_hashtable_jogo(htable_jogos);
  return 0;
}

