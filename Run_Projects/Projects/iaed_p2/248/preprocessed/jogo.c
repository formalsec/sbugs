/*File generated by PreProcessor.py*/


#include "jogo.h"


Jogo *cria_jogo(char *nome, char *equipa1, char *equipa2, int pontuacao1, int pontuacao2)
{
  Jogo *jogo = (Jogo *) malloc(sizeof(Jogo));
  jogo->pontuacao_1 = pontuacao1;
  jogo->pontuacao_2 = pontuacao2;
  jogo->nome = (char *) malloc((1 + strlen(nome)) * (sizeof(char)));
  strcpy(jogo->nome, nome);
  jogo->equipa_1 = (char *) malloc((1 + strlen(equipa1)) * (sizeof(char)));
  strcpy(jogo->equipa_1, equipa1);
  jogo->equipa_2 = (char *) malloc((1 + strlen(equipa2)) * (sizeof(char)));
  strcpy(jogo->equipa_2, equipa2);
  return jogo;
}

void altera_pontucao_jogo(Jogo *jogo, int pontuacao1, int pontuacao2)
{
  jogo->pontuacao_1 = pontuacao1;
  jogo->pontuacao_2 = pontuacao2;
}

void liberta_jogo(Jogo *jogo)
{
  free(jogo->nome);
  free(jogo->equipa_1);
  free(jogo->equipa_2);
  free(jogo);
}

Lista_jogo *cria_lista_jogo(void)
{
  Lista_jogo *lista = (Lista_jogo *) malloc(sizeof(Lista_jogo));
  lista->head = 0;
  lista->tail = 0;
  return lista;
}

void adiciona_lista_jogo(Lista_jogo *lista, Jogo *jogo)
{
  Node_jogo *node = (Node_jogo *) malloc(sizeof(Node_jogo));
  node->jogo = jogo;
  if ((lista->head == 0) && (lista->tail == 0))
  {
    {
      node->previous = 0;
      node->next = 0;
      lista->head = node;
      lista->tail = node;
    }
  }
  else
  {
    {
      node->previous = lista->tail;
      node->next = 0;
      lista->tail->next = node;
      lista->tail = node;
    }
  }

}

Node_jogo *procura_lista_jogo(Lista_jogo *lista, char *jogo)
{
  Node_jogo *node_inicio = lista->head;
  Node_jogo *node_fim = lista->tail;
  while ((node_inicio != node_fim) && (node_fim->next != node_inicio))
  {
    if (strcmp(node_inicio->jogo->nome, jogo) == 0)
    {
      {
        return node_inicio;
      }
    }
    else
    {
      if (strcmp(node_fim->jogo->nome, jogo) == 0)
      {
        {
          return node_fim;
        }
      }
      else
      {
        
      }

    }

    node_inicio = node_inicio->next;
    node_fim = node_fim->previous;
  }

  if ((node_inicio == node_fim) && (node_inicio != 0))
  {
    {
      if (strcmp(node_inicio->jogo->nome, jogo) == 0)
      {
        {
          return node_inicio;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  return 0;
}

void remove_lista_jogo(Lista_jogo *lista, Jogo *jogo)
{
  Node_jogo *node;
  node = procura_lista_jogo(lista, jogo->nome);
  if (node != 0)
  {
    {
      if ((node == lista->head) && (node == lista->tail))
      {
        {
          lista->head = 0;
          lista->tail = 0;
        }
      }
      else
      {
        {
          if (node == lista->head)
          {
            {
              node->next->previous = 0;
              lista->head = node->next;
            }
          }
          else
          {
            if (node == lista->tail)
            {
              {
                node->previous->next = 0;
                lista->tail = node->previous;
              }
            }
            else
            {
              {
                node->previous->next = node->next;
                node->next->previous = node->previous;
              }
            }

          }

        }
      }

      free(node);
    }
  }
  else
  {
    
  }

}

void imprime_lista_jogo(Lista_jogo *lista, int linha_input)
{
  Node_jogo *node = lista->head;
  while (node != 0)
  {
    printf("%d %s %s %s %d %d\n", linha_input, node->jogo->nome, node->jogo->equipa_1, node->jogo->equipa_2, node->jogo->pontuacao_1, node->jogo->pontuacao_2);
    node = node->next;
  }

}

void liberta_lista_jogo(Lista_jogo *lista)
{
  Node_jogo *node = lista->head;
  Node_jogo *aux;
  while (node != 0)
  {
    aux = node->next;
    liberta_jogo(node->jogo);
    free(node);
    node = aux;
  }

  free(lista);
}

Hashtable_jogo *cria_hashtable_jogo(int tamanho)
{
  int i = 0;
  Hashtable_jogo *hashtable = (Hashtable_jogo *) malloc(sizeof(Hashtable_jogo));
  hashtable->tamanho = tamanho;
  hashtable->tabela = (Lista_jogo **) malloc((sizeof(Lista_jogo *)) * tamanho);
  for (; i < tamanho; i++)
  {
    *(hashtable->tabela + i) = 0;
  }

  return hashtable;
}

void adiciona_hashtable_jogo(Hashtable_jogo *hashtable, Jogo *jogo)
{
  int i = hash_jogo(jogo->nome, hashtable->tamanho);
  if ((*(hashtable->tabela + i)) == 0)
  {
    {
      *(hashtable->tabela + i) = cria_lista_jogo();
    }
  }
  else
  {
    
  }

  adiciona_lista_jogo(*(hashtable->tabela + i), jogo);
}

Jogo *procura_hashtable_jogo(Hashtable_jogo *hashtable, char *chave)
{
  int i = hash_jogo(chave, hashtable->tamanho);
  if ((*(hashtable->tabela + i)) != 0)
  {
    {
      Node_jogo *node = procura_lista_jogo(*(hashtable->tabela + i), chave);
      if (node != 0)
      {
        {
          return node->jogo;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  return 0;
}

Jogo *remove_hashtable_jogo(Hashtable_jogo *hashtable, char *chave)
{
  int i = hash_jogo(chave, hashtable->tamanho);
  Jogo *jogo = procura_lista_jogo(*(hashtable->tabela + i), chave)->jogo;
  if (jogo != 0)
  {
    {
      remove_lista_jogo(*(hashtable->tabela + i), jogo);
    }
  }
  else
  {
    
  }

  if ((*(hashtable->tabela + i))->head == 0)
  {
    {
      free(*(hashtable->tabela + i));
      *(hashtable->tabela + i) = 0;
    }
  }
  else
  {
    
  }

  return jogo;
}

void liberta_hashtable_jogo(Hashtable_jogo *hashtable)
{
  int i = 0;
  for (; i < hashtable->tamanho; i++)
  {
    if ((*(hashtable->tabela + i)) != 0)
    {
      {
        Node_jogo *node = (*(hashtable->tabela + i))->head;
        Node_jogo *aux;
        while (node != 0)
        {
          aux = node->next;
          free(node);
          node = aux;
        }

        free(*(hashtable->tabela + i));
      }
    }
    else
    {
      
    }

  }

  free(hashtable->tabela);
  free(hashtable);
}

int hash_jogo(char *chave, int tamanho)
{
  int i = 0;
  int x = 31415;
  int y = 27183;
  for (; (*chave) != '\0'; chave++, x = (x * y) % (tamanho - 1))
  {
    i = ((x * i) + (*chave)) % tamanho;
  }

  return i;
}

