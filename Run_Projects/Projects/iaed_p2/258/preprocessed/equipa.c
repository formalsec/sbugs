/*File generated by PreProcessor.py*/


#include "equipa.h"
#include <stdlib.h>
#include <stdio.h>
#include <string.h>


int hashequipa(char nome[1024])
{
  int hash = 712364078;
  int n = 0;
  while (nome[n] != '\0')
  {
    hash *= nome[n];
    n++;
  }

  if (hash < 0)
  {
    {
      return -hash;
    }
  }
  else
  {
    {
      return hash;
    }
  }

}

void adicionaequipa(struct TodasEquipas *equipas, int num_comandos)
{
  char nome[1024];
  int nomehash;
  int nome_len;
  struct Equipa *equipa;
  struct Equipa *equipa_cur;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  nomehash = hashequipa(nome) % 1000;
  equipa_cur = equipas->elementos[nomehash];
  while (equipa_cur != 0)
  {
    if (strncmp(nome, equipa_cur->nome, 1024) == 0)
    {
      {
        printf("%d Equipa existente.\n", num_comandos);
        return;
      }
    }
    else
    {
      
    }

    if (equipa_cur->next == 0)
    {
      {
        break;
      }
    }
    else
    {
      
    }

    equipa_cur = equipa_cur->next;
  }

  equipa = malloc(1 * (sizeof(struct Equipa)));
  nome_len = strlen(nome);
  equipa->nome = malloc(nome_len + 1);
  strcpy(equipa->nome, nome);
  equipa->jogos_ganhos = 0;
  equipa->next = 0;
  if (equipa_cur == 0)
  {
    {
      equipas->elementos[nomehash] = equipa;
    }
  }
  else
  {
    {
      equipa_cur->next = equipa;
    }
  }

  equipas->vetor = realloc(equipas->vetor, (equipas->num_equipas + 1) * (sizeof(struct Equipa *)));
  equipas->vetor[equipas->num_equipas] = equipa;
  equipas->num_equipas += 1;
}

void procuraequipa(struct TodasEquipas *equipas, int num_comandos)
{
  struct Equipa *equipa_cur;
  int nomehash;
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  nomehash = hashequipa(nome) % 1000;
  equipa_cur = equipas->elementos[nomehash];
  while (equipa_cur != 0)
  {
    if (strcmp(equipa_cur->nome, nome) == 0)
    {
      {
        printf("%d %s %d\n", num_comandos, equipa_cur->nome, equipa_cur->jogos_ganhos);
        return;
      }
    }
    else
    {
      
    }

    equipa_cur = equipa_cur->next;
  }

  printf("%d Equipa inexistente.\n", num_comandos);
}

int equipas_cmp(const void *a, const void *b)
{
  const struct Equipa *arg1 = *((const struct Equipa **) a);
  const struct Equipa *arg2 = *((const struct Equipa **) b);
  if (arg1->jogos_ganhos < arg2->jogos_ganhos)
  {
    return 1;
  }
  else
  {
    
  }

  if (arg1->jogos_ganhos > arg2->jogos_ganhos)
  {
    return -1;
  }
  else
  {
    
  }

  return strncmp(arg1->nome, arg2->nome, 1024);
}

void encontravitoriosos(struct TodasEquipas *equipas, int num_comandos)
{
  int n;
  int jogos_ganhos_max;
  struct Equipa *equipa;
  if (equipas->vetor == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  qsort(equipas->vetor, equipas->num_equipas, sizeof(struct Equipa *), equipas_cmp);
  jogos_ganhos_max = equipas->vetor[0]->jogos_ganhos;
  printf("%d Melhores %d\n", num_comandos, jogos_ganhos_max);
  for (n = 0; n < equipas->num_equipas; n++)
  {
    equipa = equipas->vetor[n];
    if (equipa->jogos_ganhos < jogos_ganhos_max)
    {
      {
        return;
      }
    }
    else
    {
      
    }

    printf("%d * %s\n", num_comandos, equipa->nome);
  }

}

