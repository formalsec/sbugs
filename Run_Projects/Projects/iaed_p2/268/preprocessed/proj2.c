/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "proj2.h"


equipa inicio_equipas = 0;
static jogo *inicio_jogos;
int ordem_equipa;
int linha_comando;
int numero_jogos_total;
int procura_indice_tabela_dispersao(char *v)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
    h = ((a * h) + (*v)) % 127;

  return h;
}

void inicializa_tabla_dispersao()
{
  int i;
  inicio_jogos = (jogo *) malloc(127 * (sizeof(jogo)));
  for (i = 0; i < 127; i++)
    inicio_jogos[i] = 0;

}

jogo criar_jogo(char *nomejogo, char *nome_equipa1, char *nome_equipa2, int pontos1, int pontos2)
{
  jogo novo_jogo = (jogo) malloc(sizeof(struct fila));
  novo_jogo->nome_jogo = (char *) malloc((sizeof(char)) * 1024);
  strcpy(novo_jogo->nome_jogo, nomejogo);
  novo_jogo->equipa1 = (char *) malloc((sizeof(char)) * 1024);
  strcpy(novo_jogo->equipa1, nome_equipa1);
  novo_jogo->equipa2 = (char *) malloc((sizeof(char)) * 1024);
  strcpy(novo_jogo->equipa2, nome_equipa2);
  novo_jogo->pontos_1 = pontos1;
  novo_jogo->pontos_2 = pontos2;
  novo_jogo->proximo = 0;
  numero_jogos_total++;
  novo_jogo->ordem_entrada_jogo = numero_jogos_total;
  return novo_jogo;
}

jogo insere_jogo_lista(jogo *inicio_jogos, int i, char *nomejogo, char *nome_equipa1, char *nome_equipa2, int pontos1, int pontos2)
{
  jogo p;
  jogo j = criar_jogo(nomejogo, nome_equipa1, nome_equipa2, pontos1, pontos2);
  p = inicio_jogos[i];
  j->proximo = p;
  inicio_jogos[i] = j;
  return inicio_jogos[i];
}

equipa criar_equipa(char *nome)
{
  equipa nova_equipa = (equipa) malloc(sizeof(struct lista));
  ordem_equipa++;
  nova_equipa->ordem_entrada = ordem_equipa;
  nova_equipa->nome_equipa = (char *) malloc((sizeof(char)) * 1024);
  strcpy(nova_equipa->nome_equipa, nome);
  nova_equipa->numero_jogos_ganhos = 0;
  nova_equipa->proximo = 0;
  return nova_equipa;
}

int muda_numero_jogos_ganhos(char *nome_equipa1, char *nome_equipa2, int pontos1, int pontos2)
{
  equipa p;
  if (pontos1 > pontos2)
  {
    {
      for (p = inicio_equipas; p != 0; p = p->proximo)
        if (strcmp(p->nome_equipa, nome_equipa1) == 0)
      {
        p->numero_jogos_ganhos += 1;
      }
      else
      {
        
      }


    }
  }
  else
  {
    if (pontos1 < pontos2)
    {
      {
        for (p = inicio_equipas; p != 0; p = p->proximo)
          if (strcmp(p->nome_equipa, nome_equipa2) == 0)
        {
          p->numero_jogos_ganhos += 1;
        }
        else
        {
          
        }


      }
    }
    else
    {
      
    }

  }

  return 0;
}

jogo remove_jogo_lista(int i, char *nome)
{
  jogo j;
  jogo anterior;
  equipa p;
  for (j = inicio_jogos[i], anterior = 0; j != 0; anterior = j, j = j->proximo)
  {
    if (strcmp(j->nome_jogo, nome) == 0)
    {
      {
        if (j == inicio_jogos[i])
        {
          inicio_jogos[i] = j->proximo;
        }
        else
        {
          anterior->proximo = j->proximo;
        }

        if (j->pontos_1 > j->pontos_2)
        {
          {
            for (p = inicio_equipas; p != 0; p = p->proximo)
              if (strcmp(j->equipa1, p->nome_equipa) == 0)
            {
              p->numero_jogos_ganhos -= 1;
            }
            else
            {
              
            }


          }
        }
        else
        {
          if (j->pontos_1 < j->pontos_2)
          {
            {
              for (p = inicio_equipas; p != 0; p = p->proximo)
                if (strcmp(j->equipa2, p->nome_equipa) == 0)
              {
                p->numero_jogos_ganhos -= 1;
              }
              else
              {
                
              }


            }
          }
          else
          {
            
          }

        }

        free(j->nome_jogo);
        free(j);
      }
    }
    else
    {
      
    }

  }

  return inicio_jogos[i];
}

podio adiciona_podio(char *nome)
{
  podio novo = (podio) malloc(sizeof(struct pilha));
  novo->nome_equipa_podio = (char *) malloc((sizeof(char)) * 1024);
  strcpy(novo->nome_equipa_podio, nome);
  novo->proximo = 0;
  return novo;
}

void adiciona_novo_jogo()
{
  char vector[1024];
  char *nomejogo = vector;
  int pontos1;
  int pontos2;
  char vetor1[1024];
  char vetor2[1024];
  char *nome_equipa1 = vetor1;
  char *nome_equipa2 = vetor2;
  int i;
  int controlo_existe_equipa1 = 0;
  int controlo_existe_equipa2 = 0;
  int existe_nome_jogo = 0;
  equipa p = inicio_equipas;
  jogo j;
  for (int nomejogo_index = 0; nomejogo_index < 10; nomejogo_index++)
  {
    nomejogo[nomejogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nomejogo[10 - 1] = '\0';
  for (int nome_equipa1_index = 0; nome_equipa1_index < 10; nome_equipa1_index++)
  {
    nome_equipa1[nome_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa1[10 - 1] = '\0';
  for (int nome_equipa2_index = 0; nome_equipa2_index < 10; nome_equipa2_index++)
  {
    nome_equipa2[nome_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa2[10 - 1] = '\0';
  pontos1 = new_sym_var(sizeof(int) * 8);
  pontos2 = new_sym_var(sizeof(int) * 8);
  i = procura_indice_tabela_dispersao(nomejogo);
  if (p == 0)
  {
    printf("%d Equipa inexistente.\n", linha_comando);
  }
  else
  {
    {
      for (j = inicio_jogos[i]; j != 0; j = j->proximo)
        if (strcmp(j->nome_jogo, nomejogo) == 0)
      {
        existe_nome_jogo++;
      }
      else
      {
        
      }


      if (existe_nome_jogo != 0)
      {
        printf("%d Jogo existente.\n", linha_comando);
      }
      else
      {
        {
          for (p = inicio_equipas; p != 0; p = p->proximo)
          {
            if (strcmp(p->nome_equipa, nome_equipa1) == 0)
            {
              controlo_existe_equipa1++;
            }
            else
            {
              if (strcmp(p->nome_equipa, nome_equipa2) == 0)
              {
                controlo_existe_equipa2++;
              }
              else
              {
                
              }

            }

          }

          if ((controlo_existe_equipa1 == 0) || (controlo_existe_equipa2 == 0))
          {
            printf("%d Equipa inexistente.\n", linha_comando);
          }
          else
          {
            {
              inicio_jogos[i] = insere_jogo_lista(inicio_jogos, i, nomejogo, nome_equipa1, nome_equipa2, pontos1, pontos2);
              muda_numero_jogos_ganhos(nome_equipa1, nome_equipa2, pontos1, pontos2);
            }
          }

        }
      }

    }
  }

}

void procura_jogo()
{
  char vetor[1024];
  char *nome = vetor;
  int i;
  int existe_nome_jogo = 0;
  jogo j;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  i = procura_indice_tabela_dispersao(nome);
  if (inicio_jogos[i] == 0)
  {
    printf("%d Jogo inexistente.\n", linha_comando);
  }
  else
  {
    {
      for (j = inicio_jogos[i]; j != 0; j = j->proximo)
        if (strcmp(j->nome_jogo, nome) == 0)
      {
        {
          printf("%d %s %s %s %d %d\n", linha_comando, j->nome_jogo, j->equipa1, j->equipa2, j->pontos_1, j->pontos_2);
          existe_nome_jogo++;
        }
      }
      else
      {
        
      }


      if (existe_nome_jogo == 0)
      {
        printf("%d Jogo inexistente.\n", linha_comando);
      }
      else
      {
        
      }

    }
  }

}

void altera_resultado_jogo()
{
  char vetor[1024];
  char *nome = vetor;
  int pontos1;
  int pontos2;
  int i;
  int existe_nome_jogo = 0;
  jogo j;
  equipa p;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  pontos1 = new_sym_var(sizeof(int) * 8);
  pontos2 = new_sym_var(sizeof(int) * 8);
  i = procura_indice_tabela_dispersao(nome);
  if (inicio_jogos[i] == 0)
  {
    printf("%d Jogo inexistente.\n", linha_comando);
  }
  else
  {
    {
      for (j = inicio_jogos[i]; j != 0; j = j->proximo)
        if (strcmp(j->nome_jogo, nome) == 0)
      {
        {
          existe_nome_jogo++;
          if (j->pontos_1 < j->pontos_2)
          {
            {
              if (pontos1 > pontos2)
              {
                for (p = inicio_equipas; p != 0; p = p->proximo)
                {
                  if (strcmp(p->nome_equipa, j->equipa1) == 0)
                  {
                    p->numero_jogos_ganhos += 1;
                  }
                  else
                  {
                    if (strcmp(p->nome_equipa, j->equipa2) == 0)
                    {
                      p->numero_jogos_ganhos -= 1;
                    }
                    else
                    {
                      
                    }

                  }

                }

              }
              else
              {
                if (pontos1 == pontos2)
                {
                  for (p = inicio_equipas; p != 0; p = p->proximo)
                    if (strcmp(p->nome_equipa, j->equipa2) == 0)
                  {
                    p->numero_jogos_ganhos -= 1;
                  }
                  else
                  {
                    
                  }


                }
                else
                {
                  
                }

              }

            }
          }
          else
          {
            if (j->pontos_1 > j->pontos_2)
            {
              {
                if (pontos1 < pontos2)
                {
                  for (p = inicio_equipas; p != 0; p = p->proximo)
                  {
                    if (strcmp(p->nome_equipa, j->equipa1) == 0)
                    {
                      p->numero_jogos_ganhos -= 1;
                    }
                    else
                    {
                      if (strcmp(p->nome_equipa, j->equipa2) == 0)
                      {
                        p->numero_jogos_ganhos += 1;
                      }
                      else
                      {
                        
                      }

                    }

                  }

                }
                else
                {
                  if (pontos1 == pontos2)
                  {
                    for (p = inicio_equipas; p != 0; p = p->proximo)
                      if (strcmp(p->nome_equipa, j->equipa1) == 0)
                    {
                      p->numero_jogos_ganhos -= 1;
                    }
                    else
                    {
                      
                    }


                  }
                  else
                  {
                    
                  }

                }

              }
            }
            else
            {
              
            }

          }

          j->pontos_1 = pontos1;
          j->pontos_2 = pontos2;
        }
      }
      else
      {
        
      }


      if (existe_nome_jogo == 0)
      {
        printf("%d Jogo inexistente.\n", linha_comando);
      }
      else
      {
        
      }

    }
  }

}

void apaga_jogo()
{
  char vetor[1024];
  char *nome = vetor;
  int i;
  int existe_nome_jogo = 0;
  jogo j;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  i = procura_indice_tabela_dispersao(nome);
  if (inicio_jogos[i] == 0)
  {
    printf("%d Jogo inexistente.\n", linha_comando);
  }
  else
  {
    {
      for (j = inicio_jogos[i]; j != 0; j = j->proximo)
        if (strcmp(j->nome_jogo, nome) == 0)
      {
        existe_nome_jogo++;
      }
      else
      {
        
      }


      if (existe_nome_jogo != 0)
      {
        {
          inicio_jogos[i] = remove_jogo_lista(i, nome);
        }
      }
      else
      {
        printf("%d Jogo inexistente.\n", linha_comando);
      }

    }
  }

}

void podio_equipas()
{
  int max_jogos_ganhos = 0;
  char vetor[1024];
  char *nome = vetor;
  int numero_elementos = 0;
  equipa p;
  podio l;
  podio lista_podio = 0;
  for (p = inicio_equipas; p != 0; p = p->proximo)
    if (p->numero_jogos_ganhos > max_jogos_ganhos)
  {
    max_jogos_ganhos = p->numero_jogos_ganhos;
  }
  else
  {
    
  }


  if (max_jogos_ganhos >= 0)
  {
    {
      for (p = inicio_equipas; p != 0; p = p->proximo)
        if (p->numero_jogos_ganhos == max_jogos_ganhos)
      {
        {
          strcpy(nome, p->nome_equipa);
          if (lista_podio == 0)
          {
            {
              lista_podio = adiciona_podio(nome);
              numero_elementos++;
            }
          }
          else
          {
            {
              l = lista_podio;
              while (l->proximo != 0)
                l = l->proximo;

              l->proximo = adiciona_podio(nome);
              numero_elementos++;
            }
          }

        }
      }
      else
      {
        
      }


      printf("%d Melhores %d\n", linha_comando, max_jogos_ganhos);
      for (l = lista_podio; l != 0; l = l->proximo)
      {
        printf("%d * %s\n", linha_comando, l->nome_equipa_podio);
      }

    }
  }
  else
  {
    
  }

}

void lista_todos_jogos()
{
  int inicio = 1;
  int i;
  int nao_existe = 0;
  jogo j;
  if (numero_jogos_total > 0)
  {
    {
      while (inicio <= numero_jogos_total)
      {
        for (i = 0; i < 127; i++)
          for (j = inicio_jogos[i]; j != 0; j = j->proximo)
          if (j->ordem_entrada_jogo == inicio)
        {
          {
            printf("%d %s %s %s %d %d\n", linha_comando, j->nome_jogo, j->equipa1, j->equipa2, j->pontos_1, j->pontos_2);
            inicio++;
            nao_existe = 0;
          }
        }
        else
        {
          nao_existe = 1;
        }



        if (nao_existe == 1)
        {
          inicio++;
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    
  }

}

void adiciona_equipa()
{
  int existe_equipa = 0;
  char vetor[1024];
  char *nome = vetor;
  equipa p = inicio_equipas;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (inicio_equipas == 0)
  {
    inicio_equipas = criar_equipa(nome);
  }
  else
  {
    {
      p = inicio_equipas;
      if (strcmp(p->nome_equipa, nome) == 0)
      {
        existe_equipa++;
      }
      else
      {
        {
          while (p->proximo != 0)
          {
            if (strcmp(p->nome_equipa, nome) == 0)
            {
              existe_equipa++;
            }
            else
            {
              
            }

            p = p->proximo;
            if (strcmp(p->nome_equipa, nome) == 0)
            {
              existe_equipa++;
            }
            else
            {
              
            }

          }

        }
      }

      if (existe_equipa == 0)
      {
        p->proximo = criar_equipa(nome);
      }
      else
      {
        printf("%d Equipa existente.\n", linha_comando);
      }

    }
  }

}

void procura_equipa()
{
  char vetor[1024];
  char *nome = vetor;
  int controlo = 0;
  equipa p;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (p = inicio_equipas; p != 0; p = p->proximo)
    if (strcmp(p->nome_equipa, nome) == 0)
  {
    {
      printf("%d %s %d\n", linha_comando, p->nome_equipa, p->numero_jogos_ganhos);
      controlo++;
    }
  }
  else
  {
    
  }


  if (controlo == 0)
  {
    printf("%d Equipa inexistente.\n", linha_comando);
  }
  else
  {
    
  }

}

int main()
{
  char comando;
  inicializa_tabla_dispersao();
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        linha_comando++;
        adiciona_novo_jogo();
        break;

      case 'A':
        linha_comando++;
        adiciona_equipa();
        break;

      case 'l':
        linha_comando++;
        lista_todos_jogos();
        break;

      case 'p':
        linha_comando++;
        procura_jogo();
        break;

      case 'P':
        linha_comando++;
        procura_equipa();
        break;

      case 'r':
        linha_comando++;
        apaga_jogo();
        break;

      case 's':
        linha_comando++;
        altera_resultado_jogo();
        break;

      case 'g':
        linha_comando++;
        podio_equipas();
        break;

    }

  }

  return 0;
}

