/*File generated by PreProcessor.py*/


#include "jogo.h"
#include <stdio.h>
#include <stdlib.h>
#include "hash.h"
#include <string.h>


void adiciona_jogo(struct Jogos *jogos, struct Equipas *equipas, int comandos_total)
{
  char nome[1024];
  char equipa1_nome[1024];
  char equipa2_nome[1024];
  int golos1;
  int golos2;
  int hash_nome;
  int hash_equipa1;
  int hash_equipa2;
  struct Jogo *jogo;
  struct Jogo *novo_jogo;
  struct Equipa *equipa1;
  struct Equipa *equipa2;
  int nome_length;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_nome_index = 0; equipa1_nome_index < 10; equipa1_nome_index++)
  {
    equipa1_nome[equipa1_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1_nome[10 - 1] = '\0';
  for (int equipa2_nome_index = 0; equipa2_nome_index < 10; equipa2_nome_index++)
  {
    equipa2_nome[equipa2_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2_nome[10 - 1] = '\0';
  golos1 = new_sym_var(sizeof(int) * 8);
  golos2 = new_sym_var(sizeof(int) * 8);
  hash_nome = hash_str(nome);
  jogo = jogos->gavetas[hash_nome % 1024];
  while (jogo != 0)
  {
    if (strcmp(nome, jogo->nome) == 0)
    {
      {
        printf("%d Jogo existente.\n", comandos_total);
        return;
      }
    }
    else
    {
      
    }

    if (jogo->next_jogo == 0)
    {
      {
        break;
      }
    }
    else
    {
      
    }

    jogo = jogo->next_jogo;
  }

  hash_equipa1 = hash_str(equipa1_nome);
  equipa1 = equipas->gavetas[hash_equipa1 % 1024];
  while (equipa1 != 0)
  {
    if (strcmp(equipa1_nome, equipa1->nome) == 0)
    {
      {
        break;
      }
    }
    else
    {
      
    }

    equipa1 = equipa1->next_equipa;
  }

  hash_equipa2 = hash_str(equipa2_nome);
  equipa2 = equipas->gavetas[hash_equipa2 % 1024];
  while (equipa2 != 0)
  {
    if (strcmp(equipa2_nome, equipa2->nome) == 0)
    {
      {
        break;
      }
    }
    else
    {
      
    }

    equipa2 = equipa2->next_equipa;
  }

  if ((equipa1 == 0) || (equipa2 == 0))
  {
    {
      printf("%d Equipa inexistente.\n", comandos_total);
      return;
    }
  }
  else
  {
    
  }

  if (golos1 > golos2)
  {
    {
      equipa1->wins++;
    }
  }
  else
  {
    
  }

  if (golos1 < golos2)
  {
    {
      equipa2->wins++;
    }
  }
  else
  {
    
  }

  novo_jogo = malloc(sizeof(struct Jogo));
  nome_length = strlen(nome);
  novo_jogo->nome = malloc((sizeof(char)) * (nome_length + 1));
  strcpy(novo_jogo->nome, nome);
  novo_jogo->equipa1 = equipa1;
  novo_jogo->equipa2 = equipa2;
  novo_jogo->golos1 = golos1;
  novo_jogo->golos2 = golos2;
  novo_jogo->next_jogo = 0;
  jogos->ordem = realloc(jogos->ordem, (jogos->njogos + 1) * (sizeof(struct Jogo)));
  jogos->ordem[jogos->njogos] = novo_jogo;
  jogos->njogos += 1;
  if (jogo != 0)
  {
    {
      jogo->next_jogo = novo_jogo;
    }
  }
  else
  {
    {
      jogos->gavetas[hash_nome % 1024] = novo_jogo;
    }
  }

}

void procura_jogo(struct Jogos *jogos, int comandos_total)
{
  char nome[1024];
  int hash;
  struct Jogo *jogo;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  hash = hash_str(nome);
  jogo = jogos->gavetas[hash % 1024];
  while (jogo != 0)
  {
    if (strcmp(nome, jogo->nome) == 0)
    {
      {
        printf("%d %s %s %s %d %d\n", comandos_total, jogo->nome, jogo->equipa1->nome, jogo->equipa2->nome, jogo->golos1, jogo->golos2);
        return;
      }
    }
    else
    {
      
    }

    jogo = jogo->next_jogo;
  }

  printf("%d Jogo inexistente.\n", comandos_total);
}

void lista_jogos(struct Jogos *jogos, int comandos_total)
{
  int n;
  for (n = 0; n < jogos->njogos; n++)
  {
    printf("%d %s %s %s %d %d\n", comandos_total, jogos->ordem[n]->nome, jogos->ordem[n]->equipa1->nome, jogos->ordem[n]->equipa2->nome, jogos->ordem[n]->golos1, jogos->ordem[n]->golos2);
  }

}

void apaga_jogos(struct Jogos *jogos, int comandos_total)
{
  char nome[1024];
  int hash;
  int n;
  int i;
  struct Jogo *jogo;
  struct Jogo *ultimo_jogo = 0;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  hash = hash_str(nome);
  jogo = jogos->gavetas[hash % 1024];
  while (jogo != 0)
  {
    if (strcmp(nome, jogo->nome) == 0)
    {
      {
        if (jogo->golos1 > jogo->golos2)
        {
          {
            jogo->equipa1->wins -= 1;
          }
        }
        else
        {
          
        }

        if (jogo->golos1 < jogo->golos2)
        {
          {
            jogo->equipa2->wins -= 1;
          }
        }
        else
        {
          
        }

        for (n = 0; n < jogos->njogos; n++)
        {
          if (jogo == jogos->ordem[n])
          {
            {
              for (i = n + 1; i < jogos->njogos; i++)
              {
                jogos->ordem[i - 1] = jogos->ordem[i];
              }

              jogos->njogos -= 1;
              break;
            }
          }
          else
          {
            
          }

        }

        if (ultimo_jogo == 0)
        {
          {
            jogos->gavetas[hash % 1024] = jogo->next_jogo;
          }
        }
        else
        {
          {
            ultimo_jogo->next_jogo = jogo->next_jogo;
          }
        }

        free(jogo->nome);
        free(jogo);
        return;
      }
    }
    else
    {
      
    }

    ultimo_jogo = jogo;
    jogo = jogo->next_jogo;
  }

  printf("%d Jogo inexistente.\n", comandos_total);
}

void muda_jogos(struct Jogos *jogos, int comandos_total)
{
  char nome[1024];
  int hash;
  struct Jogo *jogo;
  int golos1;
  int golos2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  golos1 = new_sym_var(sizeof(int) * 8);
  golos2 = new_sym_var(sizeof(int) * 8);
  hash = hash_str(nome);
  jogo = jogos->gavetas[hash % 1024];
  while (jogo != 0)
  {
    if (strcmp(nome, jogo->nome) == 0)
    {
      {
        if (golos1 > golos2)
        {
          {
            jogo->equipa1->wins += 1;
          }
        }
        else
        {
          
        }

        if (golos1 < golos2)
        {
          {
            jogo->equipa2->wins += 1;
          }
        }
        else
        {
          
        }

        if (jogo->golos1 > jogo->golos2)
        {
          {
            jogo->equipa1->wins -= 1;
          }
        }
        else
        {
          
        }

        if (jogo->golos1 < jogo->golos2)
        {
          {
            jogo->equipa2->wins -= 1;
          }
        }
        else
        {
          
        }

        jogo->golos1 = golos1;
        jogo->golos2 = golos2;
        return;
      }
    }
    else
    {
      
    }

    jogo = jogo->next_jogo;
  }

  printf("%d Jogo inexistente.\n", comandos_total);
}

