/*File generated by PreProcessor.py*/


#include "hashtable.h" /* atraves deste include, acesso os ficheiros Jogo.h, equipas.h e hashtable.h */
#include <string.h>
#include <stdlib.h>
#include <stdio.h>


unsigned hash(char *nome, int tamanho_Hashtable)
{
  unsigned indice = 0;
  unsigned a = 127;
  for (; (*nome) != '\0'; nome++)
  {
    indice = ((a * indice) + (*nome)) % tamanho_Hashtable;
  }

  return indice;
}

int procura_indice(Jogo *Hashtable, char *nome, int tamanho_Hashtable)
{
  int indice;
  indice = hash(nome, tamanho_Hashtable);
  while (Hashtable[indice] != 0)
  {
    if (strcmp(Hashtable[indice]->Nome, nome) == 0)
    {
      return indice;
    }
    else
    {
      indice = (indice + 1) % tamanho_Hashtable;
    }

  }

  return -1;
}

Jogo *inicializa(int tamanho_hashtable)
{
  Jogo *HashTable;
  int indice;
  HashTable = malloc(tamanho_hashtable * (sizeof(Jogo)));
  for (indice = 0; indice < tamanho_hashtable; indice++)
  {
    HashTable[indice] = 0;
  }

  return HashTable;
}

Jogo *insere(Jogo jogo, Jogo *Hashtable, int Tamanho_HashTable)
{
  int indice = hash(jogo->Nome, Tamanho_HashTable);
  while (Hashtable[indice] != 0)
  {
    indice = (indice + 1) % Tamanho_HashTable;
  }

  Hashtable[indice] = jogo;
  return Hashtable;
}

Jogo *apaga_jogo(Jogo *HashTable, char *nome, int tamanho_Hashtable)
{
  int indice;
  int indice2;
  Jogo jogo;
  indice = procura_indice(HashTable, nome, tamanho_Hashtable);
  free(HashTable[indice]->Nome);
  free(HashTable[indice]->Equipa_Casa);
  free(HashTable[indice]->Equipa_Fora);
  free(HashTable[indice]);
  HashTable[indice] = 0;
  for (indice2 = (indice + 1) % tamanho_Hashtable; HashTable[indice2] != 0; indice2 = (indice2 + 1) % tamanho_Hashtable)
  {
    jogo = HashTable[indice2];
    HashTable[indice2] = 0;
    insere(jogo, HashTable, tamanho_Hashtable);
  }

  return HashTable;
}

Jogo *altera_score(char *nome, Jogo *Hashtable, int tamanho_Hashtable)
{
  int indice;
  int novo_score_equipa_casa;
  int novo_score_equipa_fora;
  novo_score_equipa_casa = new_sym_var(sizeof(int) * 8);
  novo_score_equipa_fora = new_sym_var(sizeof(int) * 8);
  indice = procura_indice(Hashtable, nome, tamanho_Hashtable);
  Hashtable[indice]->Score_Equipa_Casa = novo_score_equipa_casa;
  Hashtable[indice]->Score_Equipa_Fora = novo_score_equipa_fora;
  return Hashtable;
}

Equipa *inicializa_equipas(int tamanho_Hashtable)
{
  Equipa *Hashtable;
  int i;
  Hashtable = malloc(tamanho_Hashtable * (sizeof(Equipa)));
  for (i = 0; i < tamanho_Hashtable; i++)
  {
    Hashtable[i] = 0;
  }

  return Hashtable;
}

Equipa *insere_equipa(Equipa equipa, Equipa *Hashtable, int Tamanho_HashTable)
{
  int Indice = hash(equipa->Nome, Tamanho_HashTable);
  while (Hashtable[Indice] != 0)
  {
    Indice = (Indice + 1) % Tamanho_HashTable;
  }

  Hashtable[Indice] = equipa;
  return Hashtable;
}

Equipa *atribui_vitoria(Equipa *Hashtable, char *equipa1, char *equipa2, int score1, int score2, int tamanho_Hashtable)
{
  int Indice;
  if (score1 > score2)
  {
    Indice = procura_indice_equipas(Hashtable, equipa1, tamanho_Hashtable);
    Hashtable[Indice]->Vitorias++;
    return Hashtable;
  }
  else
  {
    
  }

  if (score2 > score1)
  {
    Indice = procura_indice_equipas(Hashtable, equipa2, tamanho_Hashtable);
    Hashtable[Indice]->Vitorias++;
    return Hashtable;
  }
  else
  {
    
  }

  return Hashtable;
}

Equipa *retira_vitoria(Equipa *Hashtable, char *equipa1, char *equipa2, int score1, int score2, int tamanho_Hashtable)
{
  int Indice;
  if (score1 > score2)
  {
    Indice = procura_indice_equipas(Hashtable, equipa1, tamanho_Hashtable);
    Hashtable[Indice]->Vitorias--;
    return Hashtable;
  }
  else
  {
    
  }

  if (score2 > score1)
  {
    Indice = procura_indice_equipas(Hashtable, equipa2, tamanho_Hashtable);
    Hashtable[Indice]->Vitorias--;
    return Hashtable;
  }
  else
  {
    
  }

  return Hashtable;
}

