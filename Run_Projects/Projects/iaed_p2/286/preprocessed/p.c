/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "comandos_estruturas.h"


int main()
{
  jogos *htjogos[10073];
  equipas *ht[10073];
  int num = 1;
  jogos *head = 0;
  equipas *head_e = 0;
  char caracter = getchar();
  while (caracter != 'x')
  {
    switch (caracter)
    {
      case 'a':
        head = comando_a(htjogos, ht, num, head, head_e);
        num++;
        break;

      case 'A':
        head_e = comando_A(ht, num, head_e);
        num++;
        break;

      case 'l':
        comando_l(num, head);
        num++;
        break;

      case 'p':
        comando_p(htjogos, num);
        num++;
        break;

      case 'P':
        comando_P(ht, num);
        num++;
        break;

      case 'r':
        head = comando_r(htjogos, ht, num, head, head_e);
        num++;
        break;

      case 's':
        comando_s(htjogos, ht, num, head, head_e);
        num++;
        break;

      case 'g':
        comando_g(num, head_e);
        num++;
        break;

    }

    caracter = getchar();
  }

  dar_free_equipas(head_e);
  dar_free_jogos(head);
  procura_free(htjogos, ht);
  return 0;
}

jogos *comando_a(jogos **htjogos, equipas **ht, int num, jogos *head, equipas *head_e)
{
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  int score1;
  int score2;
  int i1;
  int i2;
  int final;
  jogos *jogo;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = novo_jogo(nome, equipa1, equipa2, score1, score2);
  i1 = HTprocura(ht, equipa1);
  i2 = HTprocura(ht, equipa2);
  final = HTprocurajogo(htjogos, nome);
  if (final == 0)
  {
    {
      if ((i1 == 1) && (i2 == 1))
      {
        {
          HTinserejogo(htjogos, jogo);
          head = insere_fim_jogos(head, jogo);
          if (score1 > score2)
          {
            {
              HT_soma_vitoria(ht, equipa1);
              soma_vitoria(head_e, equipa1);
              return head;
            }
          }
          else
          {
            if (score2 > score1)
            {
              {
                HT_soma_vitoria(ht, equipa2);
                soma_vitoria(head_e, equipa2);
                return head;
              }
            }
            else
            {
              {
                return head;
              }
            }

          }

        }
      }
      else
      {
        {
          printf("%d Equipa inexistente.\n", num);
          free(jogo->nome);
          free(jogo->equipa1);
          free(jogo->equipa2);
          free(jogo);
        }
      }

    }
  }
  else
  {
    {
      printf("%d Jogo existente.\n", num);
      free(jogo->nome);
      free(jogo->equipa1);
      free(jogo->equipa2);
      free(jogo);
    }
  }

  return head;
}

equipas *comando_A(equipas **ht, int num, equipas *head_e)
{
  char nome[1024];
  int i;
  equipas *eq;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  eq = nova_equipa(nome);
  i = HTprocura(ht, nome);
  if (i == 1)
  {
    {
      printf("%d Equipa existente.\n", num);
      free(eq->nome_equipa);
      free(eq);
      return head_e;
    }
  }
  else
  {
    {
      HTinsere_equipa(ht, eq);
      head_e = insere_fim_equipas(head_e, eq);
      return head_e;
    }
  }

}

void comando_l(int num, jogos *head)
{
  jogos *t;
  for (t = head; t != 0; t = t->next)
  {
    printf("%d %s %s %s %d %d\n", num, t->nome, t->equipa1, t->equipa2, t->score1, t->score2);
  }

}

void comando_p(jogos **htjogos, int num)
{
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  HTprocura_p(htjogos, nome, num);
}

void comando_P(equipas **ht, int num)
{
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  procura_equipa_P(ht, nome, num);
}

jogos *comando_r(jogos **htjogos, equipas **ht, int num, jogos *head, equipas *head_e)
{
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  HT_elimina_jogo(htjogos, ht, nome, num);
  head = elimina_jogo_lista(head, nome, head_e);
  return head;
}

void comando_s(jogos **htjogos, equipas **ht, int num, jogos *head, equipas *head_e)
{
  int score1;
  int score2;
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  HT_altera_score(htjogos, ht, nome, score1, score2, num, head, head_e);
}

void comando_g(int num, equipas *head_e)
{
  int num_equipas;
  int max_vitorias;
  int i;
  char **nome;
  char **aux;
  int *v = malloc((sizeof(int)) * 2);
  v = maior_numero_vitorias(head_e, v);
  num_equipas = v[0];
  max_vitorias = v[1];
  free(v);
  aux = malloc((sizeof(char *)) * num_equipas);
  if (num_equipas == 0)
  {
    {
      free(aux);
      return;
    }
  }
  else
  {
    
  }

  nome = maior_equipas(head_e, num_equipas, max_vitorias);
  mergesort(nome, aux, 0, num_equipas - 1);
  free(aux);
  printf("%d Melhores %d\n", num, max_vitorias);
  for (i = 0; i < num_equipas; i++)
  {
    printf("%d * %s\n", num, nome[i]);
  }

  free(nome);
}

