/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include "game.h"


ent *htGame_create()
{
  int i;
  ent *ht = malloc((sizeof(ent)) * 1);
  ordListsize = 0;
  ht->entries = malloc((sizeof(game *)) * 100000);
  for (i = 0; i < 100000; i++)
  {
    ht->entries[i] = 0;
  }

  return ht;
}

void printGames(int num)
{
  int i;
  for (i = ordListsize - 1; i >= 0; i--)
  {
    printf("%d %s %s %s %d %d\n", num, ordGameList[i].name, ordGameList[i].team[0]->name, ordGameList[i].team[1]->name, ordGameList[i].score[0], ordGameList[i].score[1]);
  }

}

game *htGame_search(ent *ht_g, char *name)
{
  int index;
  game *test;
  game *p;
  index = hash(name);
  test = ht_g->entries[index];
  if (test == 0)
  {
    return 0;
  }
  else
  {
    
  }

  while (test != 0)
  {
    if ((strcmp(test->name, name) == 0) && (test->score[0] != (-1)))
    {
      {
        return test;
      }
    }
    else
    {
      
    }

    p = test;
    test = p->next;
  }

  return 0;
}

game *alloc(char *name, team *team1, team *team2, int score[2])
{
  game *test = malloc(sizeof(game));
  test->name = malloc(strlen(name) + 1);
  strcpy(test->name, name);
  test->score[0] = score[0];
  test->score[1] = score[1];
  test->team[0] = team1;
  test->team[1] = team2;
  test->next = 0;
  return test;
}

void ordListadd(game g)
{
  int i;
  ordListsize++;
  ordGameList = realloc(ordGameList, (sizeof(game)) * ordListsize);
  if (ordListsize > 1)
  {
    {
      for (i = ordListsize - 1; i > 0; i--)
      {
        ordGameList[i] = ordGameList[i - 1];
      }

    }
  }
  else
  {
    
  }

  ordGameList[0] = g;
}

void ordListremove(game g)
{
  int i;
  int j;
  for (i = 0; i < ordListsize; i++)
  {
    if (strcmp(ordGameList[i].name, g.name) == 0)
    {
      {
        if (!(i == (ordListsize - 1)))
        {
          {
            for (j = i; j < (ordListsize - 1); j++)
            {
              ordGameList[j] = ordGameList[j + 1];
            }

          }
        }
        else
        {
          
        }

        ordListsize--;
        ordGameList = realloc(ordGameList, (sizeof(game)) * ordListsize);
        break;
      }
    }
    else
    {
      
    }

  }

}

void htGame_change(game *g, int score1, int score2)
{
  int i;
  if ((g->score[0] > g->score[1]) && (score1 < score2))
  {
    {
      removebestTeam(g->team[0]);
      g->team[1]->wins++;
      addbestTeam(g->team[1]);
    }
  }
  else
  {
    if ((g->score[0] == g->score[1]) && (score1 < score2))
    {
      {
        g->team[1]->wins++;
        addbestTeam(g->team[1]);
      }
    }
    else
    {
      if ((g->score[0] < g->score[1]) && (score1 > score2))
      {
        {
          removebestTeam(g->team[1]);
          g->team[0]->wins++;
          addbestTeam(g->team[0]);
        }
      }
      else
      {
        if ((g->score[0] == g->score[1]) && (score1 > score2))
        {
          {
            g->team[0]->wins++;
            addbestTeam(g->team[0]);
          }
        }
        else
        {
          if ((g->score[0] > g->score[1]) && (score1 == score2))
          {
            {
              removebestTeam(g->team[0]);
            }
          }
          else
          {
            if ((g->score[0] < g->score[1]) && (score1 == score2))
            {
              {
                removebestTeam(g->team[1]);
              }
            }
            else
            {
              
            }

          }

        }

      }

    }

  }

  g->score[0] = score1;
  g->score[1] = score2;
  for (i = 0; i < ordListsize; i++)
  {
    if (strcmp(ordGameList[i].name, g->name) == 0)
    {
      {
        ordGameList[i].score[0] = score1;
        ordGameList[i].score[1] = score2;
        break;
      }
    }
    else
    {
      
    }

  }

}

int htGame_insert(ent *ht_g, tent *ht_t, char *name, char *team1, char *team2, int score[2])
{
  int index;
  game *test;
  game *p;
  game *check;
  team *t1;
  team *t2;
  check = htGame_search(ht_g, name);
  t1 = htTeam_search(ht_t, team1);
  t2 = htTeam_search(ht_t, team2);
  if (check != 0)
  {
    return 0;
  }
  else
  {
    
  }

  if ((!t1) || (!t2))
  {
    return -1;
  }
  else
  {
    
  }

  index = hash(name);
  test = ht_g->entries[index];
  if (test == 0)
  {
    {
      ht_g->entries[index] = alloc(name, t1, t2, score);
      ordListadd(*ht_g->entries[index]);
      if (score[0] > score[1])
      {
        {
          t1->wins++;
          addbestTeam(t1);
        }
      }
      else
      {
        
      }

      if (score[0] < score[1])
      {
        {
          t2->wins++;
          addbestTeam(t2);
        }
      }
      else
      {
        
      }

      return 1;
    }
  }
  else
  {
    
  }

  while ((test != 0) && (test->name != 0))
  {
    p = test;
    test = p->next;
  }

  p->next = alloc(name, t1, t2, score);
  ordListadd(*p->next);
  if (score[0] > score[1])
  {
    {
      t1->wins++;
      addbestTeam(t1);
    }
  }
  else
  {
    
  }

  if (score[0] < score[1])
  {
    {
      t2->wins++;
      addbestTeam(t2);
    }
  }
  else
  {
    
  }

  return 1;
}

void htGame_delete(ent *ht_g, char *name)
{
  int index;
  game *test;
  game *p;
  index = hash(name);
  if (strcmp(ht_g->entries[index]->name, name) == 0)
  {
    {
      test = ht_g->entries[index];
      if (test->score[0] > test->score[1])
      {
        {
          removebestTeam(test->team[0]);
        }
      }
      else
      {
        
      }

      if (test->score[0] < test->score[1])
      {
        {
          removebestTeam(test->team[1]);
        }
      }
      else
      {
        
      }

      ordListremove(*test);
      ht_g->entries[index] = ht_g->entries[index]->next;
      free(test->name);
      free(test);
      return;
    }
  }
  else
  {
    
  }

  for (test = ht_g->entries[index]; test->next != 0; test = test->next)
  {
    p = test->next;
    if (strcmp(p->name, name) == 0)
    {
      {
        test->next = p->next;
        if (p->score[0] > p->score[1])
        {
          {
            removebestTeam(p->team[0]);
          }
        }
        else
        {
          
        }

        if (p->score[0] < p->score[1])
        {
          {
            removebestTeam(p->team[1]);
          }
        }
        else
        {
          
        }

        ordListremove(*p);
        free(p->name);
        free(p);
        break;
      }
    }
    else
    {
      
    }

  }

}

