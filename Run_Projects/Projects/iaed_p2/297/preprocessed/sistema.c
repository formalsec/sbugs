/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include "sistema.h"


char rd_ws(void)
{
  const int wesp = getchar();
  assert(!(((wesp != ' ') && (wesp != '\n')) && (wesp != EOF)));
  return wesp;
}

int rd_cmd(void)
{
  const int c = getchar();
  rd_ws();
  return c;
}

sistema *inic_sistema(void)
{
  sistema *s = malloc(sizeof(sistema));
  s->tb_j = inic_jogos(1013);
  s->tb_e = inic_equipas(1013);
  s->l = inic_lista();
  return s;
}

void cmd_a(size_t count, sistema *s)
{
  char buf1[1023];
  char buf2[1023];
  char buf3[1023];
  size_t s1;
  size_t s2;
  int h1;
  int h2;
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  for (int buf2_index = 0; buf2_index < 10; buf2_index++)
  {
    buf2[buf2_index] = new_sym_var(sizeof(char) * 8);
  }

  buf2[10 - 1] = '\0';
  for (int buf3_index = 0; buf3_index < 10; buf3_index++)
  {
    buf3[buf3_index] = new_sym_var(sizeof(char) * 8);
  }

  buf3[10 - 1] = '\0';
  s1 = new_sym_var(sizeof(size_t) * 8);
  s2 = new_sym_var(sizeof(size_t) * 8);
  if (procura_j(buf1, s->tb_j) != (-1))
  {
    {
      printf("%lu Jogo existente.\n", count);
      return;
    }
  }
  else
  {
    
  }

  h1 = procura_e(buf2, s->tb_e);
  h2 = procura_e(buf3, s->tb_e);
  if ((h1 == (-1)) || (h2 == (-1)))
  {
    printf("%lu Equipa inexistente.\n", count);
  }
  else
  {
    {
      if ((!strcmp(buf2, buf3)) == 0)
      {
        {
          jogo *j = make_jogo(buf1, buf2, buf3, s1, s2);
          s->tb_j = insere_j(j, s->tb_j);
          if (s1 > s2)
          {
            s->tb_e->tb[h1]->vitorias++;
          }
          else
          {
            
          }

          if (s1 < s2)
          {
            s->tb_e->tb[h2]->vitorias++;
          }
          else
          {
            
          }

          push_last(j, s->l);
        }
      }
      else
      {
        
      }

    }
  }

}

void cmd_A(size_t count, sistema *s)
{
  char buf1[1023];
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  if (procura_e(buf1, s->tb_e) != (-1))
  {
    printf("%lu Equipa existente.\n", count);
  }
  else
  {
    s->tb_e = insere_e(0, buf1, s->tb_e);
  }

}

void cmd_p(size_t count, sistema *s)
{
  char buf1[1023];
  int h;
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  h = procura_j(buf1, s->tb_j);
  if (h != (-1))
  {
    printf("%lu %s %s %s %lu %lu\n", count, buf1, s->tb_j->tb[h]->equipa1, s->tb_j->tb[h]->equipa2, s->tb_j->tb[h]->score1, s->tb_j->tb[h]->score2);
  }
  else
  {
    printf("%lu Jogo inexistente.\n", count);
  }

}

void cmd_P(size_t count, sistema *s)
{
  char buf1[1023];
  int h;
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  h = procura_e(buf1, s->tb_e);
  if (h != (-1))
  {
    printf("%lu %s %lu\n", count, buf1, s->tb_e->tb[h]->vitorias);
  }
  else
  {
    printf("%lu Equipa inexistente.\n", count);
  }

}

void atualiza_score(int h, size_t s1, size_t s2, sistema *s)
{
  node *n = procura_l(s->tb_j->tb[h]->nome, s->l);
  n->jogo->score1 = s1;
  n->jogo->score2 = s2;
  s->tb_j->tb[h]->score1 = s1;
  s->tb_j->tb[h]->score2 = s2;
}

void cmd_s(size_t count, sistema *s)
{
  char buf1[1023];
  size_t s1;
  size_t s2;
  int h;
  int he1;
  int he2;
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  s1 = new_sym_var(sizeof(size_t) * 8);
  s2 = new_sym_var(sizeof(size_t) * 8);
  h = procura_j(buf1, s->tb_j);
  if (h != (-1))
  {
    {
      he1 = procura_e(s->tb_j->tb[h]->equipa1, s->tb_e);
      he2 = procura_e(s->tb_j->tb[h]->equipa2, s->tb_e);
      if ((s1 < s2) && (s->tb_j->tb[h]->score1 >= s->tb_j->tb[h]->score2))
      {
        {
          if (s->tb_j->tb[h]->score1 > s->tb_j->tb[h]->score2)
          {
            s->tb_e->tb[he1]->vitorias--;
          }
          else
          {
            
          }

          s->tb_e->tb[he2]->vitorias++;
        }
      }
      else
      {
        
      }

      if ((s1 == s2) && (s->tb_j->tb[h]->score1 != s->tb_j->tb[h]->score2))
      {
        {
          if (s->tb_j->tb[h]->score1 > s->tb_j->tb[h]->score2)
          {
            s->tb_e->tb[he1]->vitorias--;
          }
          else
          {
            s->tb_e->tb[he2]->vitorias--;
          }

        }
      }
      else
      {
        
      }

      if ((s1 > s2) && (s->tb_j->tb[h]->score1 <= s->tb_j->tb[h]->score2))
      {
        {
          if (s->tb_j->tb[h]->score1 < s->tb_j->tb[h]->score2)
          {
            s->tb_e->tb[he2]->vitorias--;
          }
          else
          {
            
          }

          s->tb_e->tb[he1]->vitorias++;
        }
      }
      else
      {
        
      }

      atualiza_score(h, s1, s2, s);
    }
  }
  else
  {
    printf("%lu Jogo inexistente.\n", count);
  }

}

void cmd_l(size_t count, sistema *s)
{
  node *tmp;
  for (tmp = s->l->head; tmp; tmp = tmp->next)
    printf("%lu %s %s %s %lu %lu\n", count, tmp->jogo->nome, tmp->jogo->equipa1, tmp->jogo->equipa2, tmp->jogo->score1, tmp->jogo->score2);

}

void cmd_r(size_t count, sistema *s)
{
  char buf1[1023];
  int h;
  int he1;
  int he2;
  for (int buf1_index = 0; buf1_index < 10; buf1_index++)
  {
    buf1[buf1_index] = new_sym_var(sizeof(char) * 8);
  }

  buf1[10 - 1] = '\0';
  h = procura_j(buf1, s->tb_j);
  if (h == (-1))
  {
    printf("%lu Jogo inexistente.\n", count);
  }
  else
  {
    {
      node *n = procura_l(buf1, s->l);
      he1 = procura_e(s->tb_j->tb[h]->equipa1, s->tb_e);
      he2 = procura_e(s->tb_j->tb[h]->equipa2, s->tb_e);
      if (s->tb_j->tb[h]->score1 > s->tb_j->tb[h]->score2)
      {
        s->tb_e->tb[he1]->vitorias--;
      }
      else
      {
        
      }

      if (s->tb_j->tb[h]->score1 < s->tb_j->tb[h]->score2)
      {
        s->tb_e->tb[he2]->vitorias--;
      }
      else
      {
        
      }

      remove_jogo(h, s->tb_j);
      remove_node(n, s->l);
    }
  }

}

void cmd_g(size_t count, sistema *s)
{
  char **melhores;
  size_t i;
  size_t max;
  size_t n;
  if (s->tb_e->sz == 0)
  {
    return;
  }
  else
  {
    
  }

  max = max_vitorias(s->tb_e);
  n = n_strings(max, s->tb_e);
  melhores = encontra_melhores(n, max, s->tb_e);
  printf("%lu Melhores %lu\n", count, max);
  for (i = 0; i < n; i++)
  {
    printf("%lu * %s\n", count, melhores[i]);
    free(melhores[i]);
  }

  free(melhores);
}

void free_sistema(sistema *s)
{
  free_lista(s->l);
  free_jogos(s->tb_j);
  free_equipas(s->tb_e);
  free(s);
}

