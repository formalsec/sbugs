/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <string.h>
#include "games.h"
#include "teams.h"


game *new_game(char *g_name, char *name_t1, char *name_t2, int score1, int score2)
{
  game *p_g = malloc(sizeof(game));
  p_g->g_name = string_alloc(g_name);
  p_g->name_t1 = string_alloc(name_t1);
  p_g->name_t2 = string_alloc(name_t2);
  p_g->score1 = score1;
  p_g->score2 = score2;
  return p_g;
}

void free_game(game *p_g)
{
  free(p_g->g_name);
  free(p_g->name_t1);
  free(p_g->name_t2);
  free(p_g);
}

dlist_games *mk_dlist_games()
{
  dlist_games *dl = malloc(sizeof(dlist_games));
  dl->head = 0;
  dl->last = 0;
  return dl;
}

void free_node_dlist_games(node_dlist_games *n_dl)
{
  if (n_dl->other != 0)
  {
    free_game(n_dl->p_g);
  }
  else
  {
    
  }

  free(n_dl);
}

void free_dlist_games(dlist_games *dl)
{
  node_dlist_games *n_dl = dl->head;
  node_dlist_games *next;
  while (n_dl != 0)
  {
    next = n_dl->next;
    free_node_dlist_games(n_dl);
    n_dl = next;
  }

  free(dl);
}

void rm_node_dlist_games(dlist_games *dl, node_dlist_games *n_dl)
{
  if (n_dl->prev == 0)
  {
    dl->head = n_dl->next;
  }
  else
  {
    n_dl->prev->next = n_dl->next;
  }

  if (n_dl->next == 0)
  {
    dl->last = n_dl->prev;
  }
  else
  {
    n_dl->next->prev = n_dl->prev;
  }

  free_node_dlist_games(n_dl);
}

node_dlist_games *addlast_dlist_games(dlist_games *dl, game *p_g)
{
  node_dlist_games *n_dl = malloc(sizeof(node_dlist_games));
  n_dl->prev = dl->last;
  n_dl->next = 0;
  n_dl->other = 0;
  n_dl->p_g = p_g;
  if (dl->last != 0)
  {
    dl->last->next = n_dl;
  }
  else
  {
    dl->head = n_dl;
  }

  dl->last = n_dl;
  return n_dl;
}

dlist_games **init_hasht_games()
{
  int i;
  dlist_games **hasht_g = malloc((sizeof(dlist_games *)) * 1500);
  for (i = 0; i < 1500; i++)
    hasht_g[i] = mk_dlist_games();

  return hasht_g;
}

dlist_games *init_dlist_games()
{
  dlist_games *dl_g = mk_dlist_games();
  return dl_g;
}

void insert_hasht_g(dlist_games **hasht_g, game *p_g, node_dlist_games *other)
{
  int h = hashf(p_g->g_name);
  node_dlist_games *n_dl = addlast_dlist_games(hasht_g[h], p_g);
  n_dl->other = other;
}

node_dlist_games *search_hasht_g(dlist_games **hasht_g, char *g_name)
{
  int h = hashf(g_name);
  node_dlist_games *n_dl = hasht_g[h]->head;
  while (n_dl != 0)
  {
    if (!strcmp(n_dl->p_g->g_name, g_name))
    {
      return n_dl;
    }
    else
    {
      
    }

    n_dl = n_dl->next;
  }

  return 0;
}

void free_games(dlist_games **hasht_g, dlist_games *dl_g)
{
  int i;
  for (i = 0; i < 1500; i++)
    free_dlist_games(hasht_g[i]);

  free_dlist_games(dl_g);
  free(hasht_g);
}

