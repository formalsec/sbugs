/*File generated by PreProcessor.py*/


#include "equipas.h"


HashNoEquipas *EquipaJaAdicionada(HashTableEquipas *HTE, int hash, char *nome)
{
  HashNoEquipas *aux = HTE->listasequi[hash];
  for (; aux; aux = aux->proxequipah)
  {
    if (!strcmp(aux->dadosequipa->equipa, nome))
    {
      {
        return aux;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

NoSimplesEquipas *AdicionarEquipa(int *contacomandos, HashTableEquipas *HTE, NoSimplesEquipas *listaequipas)
{
  char bufferequipa[1023 + 1];
  int hashbuffer;
  NoSimplesEquipas *nova;
  getchar();
  for (int bufferequipa_index = 0; bufferequipa_index < (1023 + 1); bufferequipa_index++)
  {
    bufferequipa[bufferequipa_index] = new_sym_var(sizeof(char) * 8);
  }

  bufferequipa[(1023 + 1) - 1] = '\0';
  hashbuffer = Hash(bufferequipa, HTE->capacidade);
  if (EquipaJaAdicionada(HTE, hashbuffer, bufferequipa) != 0)
  {
    {
      printf("%d Equipa existente.\n", *contacomandos);
      (*contacomandos)++;
      return listaequipas;
    }
  }
  else
  {
    {
      nova = malloc(sizeof(NoSimplesEquipas));
      nova->equipa = malloc((sizeof(char)) * (strlen(bufferequipa) + 1));
      strcpy(nova->equipa, bufferequipa);
      nova->proxequipa = listaequipas;
      nova->vitorias = 0;
      listaequipas = nova;
      AdicionarHTEquipas(HTE, hashbuffer, nova);
      (*contacomandos)++;
      return listaequipas;
    }
  }

}

void ProcuraEquipa(int *contacomandos, HashTableEquipas *HTE)
{
  int hashbuffer;
  char buffer[1023 + 1];
  HashNoEquipas *aux;
  getchar();
  for (int buffer_index = 0; buffer_index < (1023 + 1); buffer_index++)
  {
    buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[(1023 + 1) - 1] = '\0';
  hashbuffer = Hash(buffer, HTE->capacidade);
  aux = EquipaJaAdicionada(HTE, hashbuffer, buffer);
  if (aux)
  {
    {
      printf("%d %s %d\n", *contacomandos, buffer, aux->dadosequipa->vitorias);
      (*contacomandos)++;
      return;
    }
  }
  else
  {
    
  }

  printf("%d Equipa inexistente.\n", *contacomandos);
  (*contacomandos)++;
}

int ComparaStrings(const void *str1, const void *str2)
{
  return strcmp(*((char * const *) str1), *((char * const *) str2));
}

int *EncontraMaiorNVitorias(NoSimplesEquipas *equipas)
{
  int vitoriasmax = 0;
  int maiorescount = 0;
  int *maxecountmax = malloc(2 * (sizeof(int)));
  NoSimplesEquipas *aux;
  for (aux = equipas; aux; aux = aux->proxequipa)
  {
    if (aux->vitorias > vitoriasmax)
    {
      {
        vitoriasmax = aux->vitorias;
        maiorescount = 1;
      }
    }
    else
    {
      if (aux->vitorias == vitoriasmax)
      {
        {
          maiorescount++;
        }
      }
      else
      {
        
      }

    }

  }

  *maxecountmax = vitoriasmax;
  *(maxecountmax + 1) = maiorescount;
  return maxecountmax;
}

void ListaMaisVitorias(int *contacomandos, NoSimplesEquipas *equipas)
{
  int *auxmax = EncontraMaiorNVitorias(equipas);
  int vitoriasmax = auxmax[0];
  int maiorescount = auxmax[1];
  int count;
  char **maiores = malloc(maiorescount * (sizeof(char *)));
  NoSimplesEquipas *aux;
  if (maiorescount == 0)
  {
    {
      (*contacomandos)++;
      free(auxmax);
      free(maiores);
      return;
    }
  }
  else
  {
    
  }

  for (aux = equipas, count = 0; count < maiorescount; aux = aux->proxequipa)
  {
    if (aux->vitorias == vitoriasmax)
    {
      {
        maiores[count] = aux->equipa;
        count++;
      }
    }
    else
    {
      
    }

  }

  qsort(maiores, maiorescount, sizeof(char *), ComparaStrings);
  printf("%d Melhores %d\n", *contacomandos, vitoriasmax);
  for (count = 0; count < maiorescount; count++)
  {
    printf("%d * %s\n", *contacomandos, maiores[count]);
  }

  (*contacomandos)++;
  free(auxmax);
  free(maiores);
}

void ApagarEquipas(NoSimplesEquipas *equipas)
{
  NoSimplesEquipas *aux;
  while (equipas)
  {
    aux = equipas;
    equipas = equipas->proxequipa;
    free(aux->equipa);
    free(aux);
  }

}

