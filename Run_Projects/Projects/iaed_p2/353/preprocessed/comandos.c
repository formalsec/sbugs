/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "comandos.h"


void novaEquipa(ht_equipas *hashtable, int NL)
{
  char nome_equipa[1024];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  ht_set_equipas(hashtable, nome_equipa, NL);
}

void procuraEquipa(ht_equipas *hashtable, int NL)
{
  char nome_equipa[1024];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  ht_search_equipas(hashtable, nome_equipa, NL);
}

void novoJogo(ht_jogo *hashtable, ll_jogos **ll_head, ht_equipas *hashtable_equipas, int NL)
{
  char nome_jogo[1024];
  char equipa1[1024];
  char equipa2[1024];
  int score1;
  int score2;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  ht_set(hashtable, ll_head, hashtable_equipas, nome_jogo, equipa1, equipa2, score1, score2, NL);
}

void procuraJogo(ht_jogo *hashtable, int NL)
{
  char nome_jogo[1024];
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  ht_search(hashtable, nome_jogo, NL);
}

void apagaJogo(ht_jogo *hashtable, ll_jogos **ll_head, ht_equipas *hashtable_equipas, int NL)
{
  char nome_jogo[1024];
  link_jogo *jogo;
  link_equipa *equipa;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  jogo = st_search_jogo(hashtable, nome_jogo);
  if (jogo != 0)
  {
    if (jogo->score1 > jogo->score2)
    {
      equipa = st_search(hashtable_equipas, jogo->equipa1);
      equipa->nr_vitorias--;
    }
    else
    {
      
    }

    if (jogo->score1 < jogo->score2)
    {
      equipa = st_search(hashtable_equipas, jogo->equipa2);
      equipa->nr_vitorias--;
    }
    else
    {
      
    }

  }
  else
  {
    
  }

  deleteNode(ll_head, jogo);
  ht_del(hashtable, nome_jogo, NL);
}

void alteraScore(ht_jogo *hashtable, ht_equipas *hashtable_equipas, int NL)
{
  char nome_jogo[1024];
  int score1;
  int score2;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  ht_change(hashtable, hashtable_equipas, nome_jogo, score1, score2, NL);
}

void tabScoresEquipas(ht_equipas *hashtable_equipas, int NL)
{
  link_equipa *x;
  link_equipa *y;
  int i;
  int j;
  int e;
  int contador = 0;
  char *vetor[2000];
  unsigned int mais_vitorias = 0;
  for (i = 0; i < 1553; i++)
  {
    x = hashtable_equipas->entries[i];
    while (x != 0)
    {
      contador++;
      if (x->nr_vitorias > mais_vitorias)
      {
        mais_vitorias = x->nr_vitorias;
      }
      else
      {
        
      }

      x = x->next;
    }

  }

  if (contador == 0)
  {
    return;
  }
  else
  {
    
  }

  for (i = 0, e = 0; i < 1553; i++)
  {
    y = hashtable_equipas->entries[i];
    while (y != 0)
    {
      if (y->nr_vitorias == mais_vitorias)
      {
        vetor[e] = y->nome;
        e++;
      }
      else
      {
        
      }

      y = y->next;
    }

  }

  qsort(vetor, e, sizeof(char *), compara_nomes);
  printf("%d Melhores %d\n", NL, mais_vitorias);
  for (j = 0; j < e; j++)
  {
    printf("%d * %s\n", NL, vetor[j]);
  }

}

int compara_nomes(const void *a, const void *b)
{
  char **nomeA = (char **) a;
  char **nomeB = (char **) b;
  return strcmp(*nomeA, *nomeB);
}

void listaJogos(ll_jogos *ll_head, int NL)
{
  while (ll_head != 0)
  {
    printf("%d %s %s %s %d %d\n", NL, ll_head->jogo->nome, ll_head->jogo->equipa1, ll_head->jogo->equipa2, ll_head->jogo->score1, ll_head->jogo->score2);
    ll_head = ll_head->next;
  }

}

void free_hashtable(ht_jogo *hashtable)
{
  int i = 0;
  link_jogo *x;
  link_jogo *y;
  for (; i < 1553; i++)
  {
    x = hashtable->links[i];
    while (x != 0)
    {
      y = x;
      x = x->next;
      free(y->equipa1);
      free(y->equipa2);
      free(y->nome);
      free(y);
    }

  }

  free(hashtable->links);
  free(hashtable);
}

void free_hashtable_equipas(ht_equipas *hashtable_equipas)
{
  int i = 0;
  link_equipa *x;
  link_equipa *y;
  for (; i < 1553; i++)
  {
    x = hashtable_equipas->entries[i];
    while (x != 0)
    {
      y = x;
      x = x->next;
      free(y->nome);
      free(y);
    }

  }

  free(hashtable_equipas->entries);
  free(hashtable_equipas);
}

