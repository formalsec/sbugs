/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "equipa.h"
#include "interface.h"


void InitSecondHT(ItemSecondHT **headsEquipa, int capacidadeE)
{
  int i;
  for (i = 0; i < capacidadeE; i++)
    headsEquipa[i] = 0;

}

ItemSecondHT *inserirInicioListaE(ItemSecondHT *head, char *nome)
{
  ItemSecondHT *temporario = malloc(sizeof(ItemSecondHT));
  temporario->equipa = malloc(sizeof(equipa));
  temporario->equipa->nome = (char *) malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(temporario->equipa->nome, nome);
  temporario->equipa->vitorias = 0;
  temporario->next = head;
  return temporario;
}

linkEquipa *procuraElemento(ItemSecondHT *head, char *key)
{
  while (head != 0)
  {
    if (strcmp(head->equipa->nome, key) == 0)
    {
      {
        return head;
      }
    }
    else
    {
      
    }

    head = head->next;
  }

  return 0;
}

equipa *HTProcurarElementoS(char *nome, ItemSecondHT **headsEquipa, int capacidadeE)
{
  linkEquipa *elemento;
  int i;
  i = hash(nome, capacidadeE);
  elemento = procuraElemento(headsEquipa[i], nome);
  if (elemento == 0)
  {
    return 0;
  }
  else
  {
    
  }

  return elemento->equipa;
}

int compararElemento(const void *a, const void *b)
{
  equipa **e1;
  equipa **e2;
  e1 = (equipa **) a;
  e2 = (equipa **) b;
  return strcmp((*e1)->nome, (*e2)->nome);
}

void imprimirEquipas(equipa **arrayV, int elementos, int linha)
{
  int i;
  qsort(arrayV, elementos, sizeof(equipa *), compararElemento);
  for (i = 0; i < elementos; i++)
  {
    printf("%d * %s\n", linha, arrayV[i]->nome);
  }

  free(arrayV);
}

void HTencontraEquipasVencedoras(ItemSecondHT **headsEquipa, int capacidadeE, int linha)
{
  int max = 0;
  int elementos = 0;
  int i;
  linkEquipa *tempHead;
  equipa **arrayV = 0;
  equipa **temporario;
  for (i = 0; i < capacidadeE; i++)
  {
    tempHead = headsEquipa[i];
    while (headsEquipa[i] != 0)
    {
      if (headsEquipa[i]->equipa->vitorias > max)
      {
        {
          elementos = 0;
          temporario = arrayV;
          free(temporario);
          arrayV = 0;
          max = headsEquipa[i]->equipa->vitorias;
        }
      }
      else
      {
        
      }

      if (headsEquipa[i]->equipa->vitorias == max)
      {
        {
          elementos++;
          arrayV = (equipa **) realloc(arrayV, (sizeof(equipa *)) * elementos);
          arrayV[elementos - 1] = headsEquipa[i]->equipa;
        }
      }
      else
      {
        
      }

      headsEquipa[i] = headsEquipa[i]->next;
    }

    headsEquipa[i] = tempHead;
  }

  if (elementos > 0)
  {
    {
      printf("%d Melhores %d\n", linha, max);
      imprimirEquipas(arrayV, elementos, linha);
    }
  }
  else
  {
    
  }

}

int HTInserirElementoS(char *nome, ItemSecondHT **headsEquipa, int capacidadeE)
{
  int i;
  if (HTProcurarElementoS(nome, headsEquipa, capacidadeE) != 0)
  {
    return 0;
  }
  else
  {
    
  }

  i = hash(nome, capacidadeE);
  headsEquipa[i] = inserirInicioListaE(headsEquipa[i], nome);
  return 1;
}

void freeEquipa(equipa *e)
{
  free(e->nome);
  free(e);
}

void freeAllEquipa(ItemSecondHT **headsEquipa, int capacidadeE)
{
  linkEquipa *temp;
  int i;
  for (i = 0; i < capacidadeE; i++)
  {
    while (headsEquipa[i] != 0)
    {
      temp = headsEquipa[i];
      freeEquipa(temp->equipa);
      headsEquipa[i] = headsEquipa[i]->next;
      free(temp);
    }

  }

  free(headsEquipa);
}

