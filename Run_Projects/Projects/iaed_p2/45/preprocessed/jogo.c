/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "jogo.h"
#include "struct.h"
#include "interface.h"


void HTInitFirst(ItemFirstHT **headsJogo, lista *listaJ, int capacidadeJ)
{
  int i;
  listaJ->head = 0;
  listaJ->last = 0;
  for (i = 0; i < capacidadeJ; i++)
    headsJogo[i] = 0;

}

void adicionarUltimoLista(lista *listaJ, jogo *nJogo)
{
  ItemList *no = malloc(sizeof(ItemList));
  if (listaJ->head == 0)
  {
    {
      listaJ->head = no;
      no->previous = 0;
    }
  }
  else
  {
    {
      no->previous = listaJ->last;
      listaJ->last->next = no;
    }
  }

  no->next = 0;
  no->jogo = nJogo;
  listaJ->last = no;
}

ItemFirstHT *inicializarItem(char *nome, equipa *e1, equipa *e2, int s1, int s2)
{
  ItemFirstHT *temporario = (ItemFirstHT *) malloc(sizeof(ItemFirstHT));
  temporario->jogo = (jogo *) malloc(sizeof(jogo));
  temporario->jogo->nome = (char *) malloc((strlen(nome) + 1) * (sizeof(char)));
  strcpy(temporario->jogo->nome, nome);
  temporario->jogo->pEquipa = e1;
  temporario->jogo->sEquipa = e2;
  temporario->jogo->pScore = s1;
  temporario->jogo->sScore = s2;
  temporario->previous = 0;
  return temporario;
}

void HTInserirElementoF(char *nome, int score1, int score2, int capacidadeJ, ItemFirstHT **headsJogo, lista *listaJ, equipa *e1, equipa *e2)
{
  int i = hash(nome, capacidadeJ);
  ItemFirstHT *temporario = inicializarItem(nome, e1, e2, score1, score2);
  adicionarUltimoLista(listaJ, temporario->jogo);
  if (score1 > score2)
  {
    e1->vitorias += 1;
  }
  else
  {
    if (score1 < score2)
    {
      e2->vitorias += 1;
    }
    else
    {
      
    }

  }

  temporario->next = headsJogo[i];
  if (headsJogo[i] != 0)
  {
    headsJogo[i]->previous = temporario;
  }
  else
  {
    
  }

  headsJogo[i] = temporario;
}

ItemFirstHT *procurarElemento(ItemFirstHT *head, char *key)
{
  while (head != 0)
  {
    if (strcmp(head->jogo->nome, key) == 0)
    {
      {
        return head;
      }
    }
    else
    {
      
    }

    head = head->next;
  }

  return 0;
}

jogo *HTProcurarElementoF(char *key, int capacidadeJ, ItemFirstHT **headsJogo)
{
  ItemFirstHT *head;
  int i = hash(key, capacidadeJ);
  head = procurarElemento(headsJogo[i], key);
  if (head == 0)
  {
    return 0;
  }
  else
  {
    
  }

  return head->jogo;
}

void HTListarElementos(int linha, lista *listaJ)
{
  ItemList *head = listaJ->head;
  while (head != 0)
  {
    imprimirJogo(head->jogo, linha);
    head = head->next;
  }

}

void alterarPontuacaoIgual(jogo *nJogo, int score1, int score2)
{
  if ((score1 == score2) && (nJogo->pScore > nJogo->sScore))
  {
    nJogo->pEquipa->vitorias -= 1;
  }
  else
  {
    if ((score1 == score2) && (nJogo->pScore < nJogo->sScore))
    {
      nJogo->sEquipa->vitorias -= 1;
    }
    else
    {
      
    }

  }

}

void alterarPontuacaoP(jogo *nJogo, int score1, int score2)
{
  if ((score1 < score2) && (nJogo->pScore > nJogo->sScore))
  {
    {
      nJogo->pEquipa->vitorias -= 1;
      nJogo->sEquipa->vitorias += 1;
    }
  }
  else
  {
    if ((score1 < score2) && (nJogo->pScore == nJogo->sScore))
    {
      nJogo->sEquipa->vitorias += 1;
    }
    else
    {
      
    }

  }

}

void alterarPontuacaoS(jogo *nJogo, int score1, int score2)
{
  if ((score1 > score2) && (nJogo->pScore < nJogo->sScore))
  {
    {
      nJogo->pEquipa->vitorias += 1;
      nJogo->sEquipa->vitorias -= 1;
    }
  }
  else
  {
    if ((score1 > score2) && (nJogo->pScore == nJogo->sScore))
    {
      nJogo->pEquipa->vitorias += 1;
    }
    else
    {
      
    }

  }

}

int HTAlterarPontuacao(char *nomeJogo, int score1, int score2, int capacidadeJ, ItemFirstHT **headsJogo)
{
  jogo *nJogo = HTProcurarElementoF(nomeJogo, capacidadeJ, headsJogo);
  if (nJogo == 0)
  {
    return 0;
  }
  else
  {
    
  }

  alterarPontuacaoP(nJogo, score1, score2);
  alterarPontuacaoS(nJogo, score1, score2);
  alterarPontuacaoIgual(nJogo, score1, score2);
  nJogo->pScore = score1;
  nJogo->sScore = score2;
  return 1;
}

void removerElementoHT(ItemFirstHT *head, int pos, ItemFirstHT **headsJogo)
{
  if ((head->next == 0) && (head->previous == 0))
  {
    headsJogo[pos] = 0;
  }
  else
  {
    if (head->next == 0)
    {
      {
        head->previous->next = 0;
      }
    }
    else
    {
      if (head->previous == 0)
      {
        {
          headsJogo[pos] = head->next;
          head->next->previous = 0;
        }
      }
      else
      {
        {
          head->previous->next = head->next;
          head->next->previous = head->previous;
        }
      }

    }

  }

}

void removerElementoLista(lista *listaJ, jogo *jogo)
{
  ItemList *head = listaJ->head;
  while (head != 0)
  {
    if (head->jogo == jogo)
    {
      {
        if ((head->next == 0) && (head->previous == 0))
        {
          {
            listaJ->head = 0;
          }
        }
        else
        {
          if (head->next == 0)
          {
            {
              head->previous->next = 0;
              listaJ->last = head->previous;
            }
          }
          else
          {
            if (head->previous == 0)
            {
              {
                listaJ->head = head->next;
                head->next->previous = 0;
              }
            }
            else
            {
              {
                head->previous->next = head->next;
                head->next->previous = head->previous;
              }
            }

          }

        }

        freeJogo(head->jogo);
        free(head);
        head = 0;
        break;
      }
    }
    else
    {
      
    }

    head = head->next;
  }

}

int HTRemoverElemento(ItemFirstHT **headsJogo, int capacidadeJ, char *nomeJogo, lista *listaJ)
{
  int i = hash(nomeJogo, capacidadeJ);
  ItemFirstHT *head = procurarElemento(headsJogo[i], nomeJogo);
  if (head != 0)
  {
    {
      if (head->jogo->pScore > head->jogo->sScore)
      {
        head->jogo->pEquipa->vitorias -= 1;
      }
      else
      {
        if (head->jogo->pScore < head->jogo->sScore)
        {
          head->jogo->sEquipa->vitorias -= 1;
        }
        else
        {
          
        }

      }

      removerElementoHT(head, i, headsJogo);
      removerElementoLista(listaJ, head->jogo);
      free(head);
      head = 0;
      return 1;
    }
  }
  else
  {
    
  }

  return 0;
}

void freeLista(lista *listaJ)
{
  ItemList *head = listaJ->head;
  ItemList *temp;
  while (head != 0)
  {
    temp = head;
    head = head->next;
    free(temp);
  }

  free(listaJ);
}

void freeJogo(jogo *fJogo)
{
  free(fJogo->nome);
  free(fJogo);
}

void freeAllJogo(ItemFirstHT **headsJogo, int capacidadeJ, lista *listaJ)
{
  ItemFirstHT *temp;
  int i;
  freeLista(listaJ);
  for (i = 0; i < capacidadeJ; i++)
  {
    while (headsJogo[i] != 0)
    {
      temp = headsJogo[i];
      freeJogo(temp->jogo);
      headsJogo[i] = headsJogo[i]->next;
      free(temp);
    }

  }

  free(headsJogo);
}

