/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "proj2.h"


int main()
{
  char command;
  Hash_equipa hash_eq;
  Hash_jogo hash_jg;
  Dados dados = {0};
  cabeca = 0;
  HT_Equipas_Init(401, &hash_eq);
  HT_Jogos_Init(401, &hash_jg);
  while (1)
  {
    command = getchar();
    switch (command)
    {
      case 'a':
        dados.NL++;
        func_a(&hash_jg, &hash_eq, dados.NL);
        break;

      case 'A':
        dados.NL++;
        func_A(&hash_eq, dados.NL);
        break;

      case 'l':
        dados.NL++;
        func_l(dados.NL);
        break;

      case 'p':
        dados.NL++;
        func_p(&hash_jg, dados.NL);
        break;

      case 'P':
        dados.NL++;
        func_P(&hash_eq, dados.NL);
        break;

      case 'r':
        dados.NL++;
        func_r(&hash_jg, &hash_eq, dados.NL);
        break;

      case 's':
        dados.NL++;
        func_s(&hash_jg, &hash_eq, dados.NL);
        break;

      case 'g':
        dados.NL++;
        func_g(&hash_eq, dados.NL);
        break;

      case 'x':
        clean_memory(&hash_eq, &hash_jg);
        return 0;

      default:
        printf("ERRO: Comando desconhecido\n");

    }

    getchar();
  }

  return 1;
}

void func_a(Hash_jogo *hash_jg, Hash_equipa *hash_eq, int NL)
{
  char nome_jogo[1024];
  char equipa_1[1024];
  char equipa_2[1024];
  int pontuacao_1;
  int pontuacao_2;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int equipa_1_index = 0; equipa_1_index < 10; equipa_1_index++)
  {
    equipa_1[equipa_1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa_1[10 - 1] = '\0';
  for (int equipa_2_index = 0; equipa_2_index < 10; equipa_2_index++)
  {
    equipa_2[equipa_2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa_2[10 - 1] = '\0';
  pontuacao_1 = new_sym_var(sizeof(int) * 8);
  pontuacao_2 = new_sym_var(sizeof(int) * 8);
  HT_Jogos_Insert(nome_jogo, equipa_1, equipa_2, pontuacao_1, pontuacao_2, hash_jg, hash_eq, NL);
}

void func_A(Hash_equipa *hash_eq, int NL)
{
  char nome_equipa[1024];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  HT_Equipas_Insert(nome_equipa, hash_eq, NL);
}

void func_l(int NL)
{
  imprimeLista(NL);
}

void func_p(Hash_jogo *hash_jg, int NL)
{
  char nome_jogo[1024];
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  printJogo(hash_jg, nome_jogo, NL);
}

void func_P(Hash_equipa *hash_eq, int NL)
{
  char nome_equipa[1024];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  if (HT_Get_Equipa(hash_eq, nome_equipa, 0) != 0)
  {
    printEquipa(hash_eq, nome_equipa, NL);
  }
  else
  {
    printf("%d Equipa inexistente.\n", NL);
  }

}

void func_r(Hash_jogo *hash_jg, Hash_equipa *hash_eq, int NL)
{
  char nome_jogo[1024];
  Jogo *jogo = 0;
  Equipa *equipa = 0;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  if (HT_Get_Jogo(hash_jg, nome_jogo, &jogo) == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    if (jogo->pontuacao_1 > jogo->pontuacao_2)
    {
      HT_Get_Equipa(hash_eq, jogo->equipa_1, &equipa);
      equipa->vitorias -= 1;
    }
    else
    {
      if (jogo->pontuacao_1 < jogo->pontuacao_2)
      {
        HT_Get_Equipa(hash_eq, jogo->equipa_2, &equipa);
        equipa->vitorias -= 1;
      }
      else
      {
        
      }

    }

    remocao(jogo);
    HT_Jogo_Delete(jogo, hash_jg);
  }

}

void func_s(Hash_jogo *hash_jg, Hash_equipa *hash_eq, int NL)
{
  char nome_jogo[1024];
  int pontuacao_1;
  int pontuacao_2;
  Jogo *jogo = 0;
  Equipa *equipa = 0;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  pontuacao_1 = new_sym_var(sizeof(int) * 8);
  pontuacao_2 = new_sym_var(sizeof(int) * 8);
  if (HT_Get_Jogo(hash_jg, nome_jogo, &jogo) == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    if (jogo->pontuacao_1 > jogo->pontuacao_2)
    {
      HT_Get_Equipa(hash_eq, jogo->equipa_1, &equipa);
      equipa->vitorias -= 1;
    }
    else
    {
      if (jogo->pontuacao_1 < jogo->pontuacao_2)
      {
        HT_Get_Equipa(hash_eq, jogo->equipa_2, &equipa);
        equipa->vitorias -= 1;
      }
      else
      {
        
      }

    }

    jogo->pontuacao_1 = pontuacao_1;
    jogo->pontuacao_2 = pontuacao_2;
    if (jogo->pontuacao_1 > jogo->pontuacao_2)
    {
      HT_Get_Equipa(hash_eq, jogo->equipa_1, &equipa);
      equipa->vitorias += 1;
    }
    else
    {
      if (jogo->pontuacao_1 < jogo->pontuacao_2)
      {
        HT_Get_Equipa(hash_eq, jogo->equipa_2, &equipa);
        equipa->vitorias += 1;
      }
      else
      {
        
      }

    }

  }

}

void func_g(Hash_equipa *hash_eq, int NL)
{
  seleciona_equipas(hash_eq, NL);
}

char *strdup(const char *src)
{
  char *dst = malloc(strlen(src) + 1);
  if (dst == 0)
  {
    return 0;
  }
  else
  {
    
  }

  strcpy(dst, src);
  return dst;
}

int calc_hash(char *v, int M)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
    h = ((a * h) + (*v)) % M;

  return h;
}

void clean_memory(Hash_equipa *hash_eq, Hash_jogo *hash_jg)
{
  HT_Equipas_Delete(hash_eq);
  HT_Jogos_Delete(hash_jg);
  deleteCabeca(&cabeca);
}

