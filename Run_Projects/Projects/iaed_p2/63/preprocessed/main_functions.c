/*File generated by PreProcessor.py*/


#include "main_functions.h"


void init_program(node_games **head_games, node_teams **head_teams, node_games **games_table, node_teams **teams_table)
{
  int i = 0;
  *head_games = 0;
  *head_teams = 0;
  while (i < 1993)
  {
    games_table[i] = 0;
    teams_table[i] = 0;
    i++;
  }

}

void add_game(node_games **head_games, node_games **games_table, node_teams **teams_table, int l_count)
{
  game new_game;
  node_games node_new_game;
  node_games *p_node_new_game;
  node_teams *winner;
  int fail_game = 0;
  int fail_team = 0;
  new_game = create_game(teams_table);
  node_new_game = create_node_game(new_game);
  p_node_new_game = &node_new_game;
  if (in_table_games(games_table, p_node_new_game) != 0)
  {
    {
      fail_game = 1;
    }
  }
  else
  {
    
  }

  if (get_t1(p_node_new_game) == 0)
  {
    {
      fail_team = 1;
    }
  }
  else
  {
    
  }

  if (get_t2(p_node_new_game) == 0)
  {
    {
      fail_team = 1;
    }
  }
  else
  {
    
  }

  if (fail_game)
  {
    {
      destroy_game(new_game);
      printf("%d Jogo existente.\n", l_count);
      return;
    }
  }
  else
  {
    
  }

  if (fail_team)
  {
    {
      destroy_game(new_game);
      printf("%d Equipa inexistente.\n", l_count);
      return;
    }
  }
  else
  {
    
  }

  winner = get_winner(p_node_new_game);
  if (winner != 0)
  {
    {
      give_win(winner);
    }
  }
  else
  {
    
  }

  *head_games = push_game(*head_games, new_game);
  insert_game(games_table, *head_games);
}

void search_game(node_games **games_table, int l_count)
{
  node_games *game_found;
  game_found = find_game(games_table);
  if (game_found == 0)
  {
    {
      printf("%d Jogo inexistente.\n", l_count);
    }
  }
  else
  {
    {
      printf("%d %s %s %s %d %d\n", l_count, get_game_name(game_found), get_name_t1(game_found), get_name_t2(game_found), get_score1(game_found), get_score2(game_found));
    }
  }

}

void add_team(node_teams **head_teams, node_teams **teams_table, int l_count)
{
  team new_team;
  node_teams node_new_team;
  node_teams *p_node_new_team;
  new_team = create_team();
  node_new_team = create_node_team(new_team);
  p_node_new_team = &node_new_team;
  if (in_table_teams(teams_table, p_node_new_team) != 0)
  {
    {
      destroy_team(new_team);
      printf("%d Equipa existente.\n", l_count);
      return;
    }
  }
  else
  {
    
  }

  *head_teams = push_team(*head_teams, new_team);
  insert_team(teams_table, *head_teams);
}

void search_team(node_teams **teams_table, int l_count)
{
  node_teams *t_found;
  t_found = find_team(teams_table);
  if (t_found != 0)
  {
    {
      printf("%d %s %d\n", l_count, get_team_name(t_found), get_wins(t_found));
      return;
    }
  }
  else
  {
    {
      printf("%d Equipa inexistente.\n", l_count);
    }
  }

}

void list_games(node_games **head_games, int l_count)
{
  print_games_in_order(*head_games, l_count);
}

void delete_game(node_games **head_games, node_games **games_table, int l_count)
{
  node_games *game_found;
  node_teams *winner;
  game_found = find_game(games_table);
  if (game_found == 0)
  {
    {
      printf("%d Jogo inexistente.\n", l_count);
      return;
    }
  }
  else
  {
    
  }

  delete_swaps(head_games, games_table, game_found);
  winner = get_winner(game_found);
  if (winner != 0)
  {
    {
      take_win(winner);
    }
  }
  else
  {
    
  }

  free_game(game_found);
}

void change_score(node_games **games_table, int l_count)
{
  node_games *game_found;
  node_teams *new_winner;
  node_teams *old_winner;
  int new_score1;
  int new_score2;
  game_found = find_game(games_table);
  new_score1 = read_score();
  new_score2 = read_score();
  if (game_found == 0)
  {
    {
      printf("%d Jogo inexistente.\n", l_count);
      return;
    }
  }
  else
  {
    
  }

  old_winner = get_winner(game_found);
  apply_score(game_found, new_score1, new_score2);
  new_winner = get_winner(game_found);
  if (old_winner != new_winner)
  {
    {
      if (old_winner != 0)
      {
        {
          take_win(old_winner);
        }
      }
      else
      {
        
      }

      if (new_winner != 0)
      {
        {
          give_win(new_winner);
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

}

void list_most_wins(node_teams **head_teams, int l_count)
{
  node_teams **winners;
  node_teams *tmp;
  int i = 0;
  int max_wins = 0;
  int teams_count = 0;
  if ((*head_teams) == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  tmp = *head_teams;
  while (tmp != 0)
  {
    int n_wins;
    n_wins = get_wins(tmp);
    if (n_wins == max_wins)
    {
      {
        teams_count++;
      }
    }
    else
    {
      if (n_wins > max_wins)
      {
        {
          max_wins = n_wins;
          teams_count = 1;
        }
      }
      else
      {
        
      }

    }

    tmp = get_prev_team(tmp);
  }

  winners = malloc((sizeof(node_teams *)) * teams_count);
  tmp = *head_teams;
  while (tmp != 0)
  {
    if (get_wins(tmp) == max_wins)
    {
      {
        winners[i] = tmp;
        i++;
      }
    }
    else
    {
      
    }

    tmp = get_prev_team(tmp);
  }

  qsort(winners, teams_count, sizeof(node_teams *), compare_names);
  printf("%d Melhores %d\n", l_count, max_wins);
  for (i = 0; i < teams_count; i++)
  {
    printf("%d * %s\n", l_count, get_team_name(winners[i]));
  }

  free(winners);
}

void end_program(node_games **head_games, node_teams **head_teams)
{
  destroy_games(*head_games);
  destroy_teams(*head_teams);
}

