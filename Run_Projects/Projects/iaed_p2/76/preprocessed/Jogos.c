/*File generated by PreProcessor.py*/


#include "Jogos.h"
#include "Equipas.h"
#include "Misc.h"


jogo *cria_jogo(char *nome, equipa *eq_casa, equipa *eq_fora, int golos_casa, int golos_fora)
{
  jogo *novo_jogo = (jogo *) malloc(sizeof(jogo));
  novo_jogo->nome = (char *) malloc(strlen(nome) + 1);
  strcpy(novo_jogo->nome, nome);
  novo_jogo->eq_casa = eq_casa;
  novo_jogo->eq_fora = eq_fora;
  novo_jogo->golos_casa = golos_casa;
  novo_jogo->golos_fora = golos_fora;
  atribui_vitoria(eq_casa, eq_fora, golos_casa, golos_fora);
  return novo_jogo;
}

lista_jogos *cria_lst_jogos()
{
  lista_jogos *novo = malloc(sizeof(lista_jogos));
  novo->inicio = (novo->fim = 0);
  return novo;
}

void insere_fim_jogo(lista_jogos *l, jogo *novo_jogo)
{
  node_jogo *n = (node_jogo *) malloc(sizeof(node_jogo));
  n->prox = 0;
  n->ant = l->fim;
  n->jogo = novo_jogo;
  if (l->fim)
  {
    l->fim->prox = n;
  }
  else
  {
    
  }

  l->fim = n;
  if (!l->inicio)
  {
    l->inicio = n;
  }
  else
  {
    
  }

}

void remove_jogo_lst(lista_jogos *l, char *nome)
{
  node_jogo *aux1 = l->inicio;
  while (aux1)
  {
    if (!strcmp(aux1->jogo->nome, nome))
    {
      {
        node_jogo *aux2 = aux1;
        if (l->inicio == l->fim)
        {
          l->inicio = (l->fim = 0);
        }
        else
        {
          if (aux1 == l->inicio)
          {
            {
              l->inicio = l->inicio->prox;
              aux1->prox->ant = 0;
            }
          }
          else
          {
            if (aux1 == l->fim)
            {
              {
                l->fim = l->fim->ant;
                aux1->ant->prox = 0;
              }
            }
            else
            {
              {
                aux1->ant->prox = aux1->prox;
                aux1->prox->ant = aux1->ant;
              }
            }

          }

        }

        free(aux2);
        break;
      }
    }
    else
    {
      
    }

    aux1 = aux1->prox;
  }

}

void destroi_lst_jogos(lista_jogos *l)
{
  while (l->fim)
  {
    node_jogo *aux = l->fim->ant;
    free(l->fim);
    l->fim = aux;
  }

  free(l);
}

jogo **insere_jogo_h(jogo **h_jogos, jogo *novo_jogo, int *cont_jogos, int *tam_h_jogos)
{
  int i = hash(novo_jogo->nome, *tam_h_jogos);
  while (h_jogos[i])
    i = (i + 1) % (*tam_h_jogos);

  h_jogos[i] = novo_jogo;
  if ((*cont_jogos) > ((*tam_h_jogos) / 2))
  {
    h_jogos = expande_h_jogos(h_jogos, cont_jogos, tam_h_jogos);
  }
  else
  {
    
  }

  return h_jogos;
}

jogo **expande_h_jogos(jogo **h_jogos, int *cont_jogos, int *tam_h_jogos)
{
  int j;
  int novo_tam_h_jogos = 2 * (*tam_h_jogos);
  jogo **aux = (jogo **) calloc(novo_tam_h_jogos, sizeof(jogo *));
  for (j = 0; j < (*tam_h_jogos); j++)
    if (h_jogos[j])
  {
    insere_jogo_h(aux, h_jogos[j], cont_jogos, &novo_tam_h_jogos);
  }
  else
  {
    
  }


  free(h_jogos);
  *tam_h_jogos = novo_tam_h_jogos;
  return aux;
}

jogo *procura_jogo_h(char *nome, jogo **h_jogos, int tam_h_jogos)
{
  int i = hash(nome, tam_h_jogos);
  for (; h_jogos[i]; i = (i + 1) % tam_h_jogos)
    if (!strcmp(h_jogos[i]->nome, nome))
  {
    return h_jogos[i];
  }
  else
  {
    
  }


  return 0;
}

void destroi_h_jogos(jogo **h_jogos, int tam_h_jogos)
{
  int i;
  for (i = 0; i < tam_h_jogos; i++)
    if (h_jogos[i])
  {
    {
      free(h_jogos[i]->nome);
      free(h_jogos[i]);
    }
  }
  else
  {
    
  }


  free(h_jogos);
}

