/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>


typedef struct node
{
  int adj;
  struct node *next;
} node;
node **adjList;
int numV;
int numE;
int *vertices;
int processInput();
void addNode(node **list, int vertex, int adj);
void freeList(node **list);
void printVertices();
void dfsVisit(node **list, int vertex, int *colors, int *parent, node **update);
void updateVertex(int vertex, int *parent, node **update);
int main()
{
  int i;
  processInput();
  int colors[numV];
  int parent[numV];
  for (i = 0; i < numV; i++)
  {
    colors[i] = 0;
    parent[i] = -1;
  }

  node **updateList = malloc(numV * (sizeof(node *)));
  for (i = 0; i < numV; i++)
  {
    updateList[i] = 0;
  }

  for (i = 0; i < numV; i++)
  {
    if (colors[i] == 0)
    {
      dfsVisit(adjList, i, colors, parent, updateList);
    }
    else
    {
      
    }

  }

  printVertices();
  free(vertices);
  freeList(adjList);
  freeList(updateList);
  return 0;
}

int processInput()
{
  int i;
  char buffer[64];
  fgets(buffer, 64, stdin);
  numV = new_sym_var(sizeof(int) * 8);
  numE = new_sym_var(sizeof(int) * 8);
  vertices = malloc(numV * (sizeof(int)));
  for (i = 0; i < numV; i++)
  {
    fgets(buffer, 64, stdin);
    vertices[i] = new_sym_var(sizeof(int) * 8);
  }

  adjList = malloc(numV * (sizeof(node *)));
  for (i = 0; i < numV; i++)
  {
    adjList[i] = 0;
  }

  for (i = 0; i < numE; i++)
  {
    int vertex;
    int adj;
    fgets(buffer, 64, stdin);
    vertex = new_sym_var(sizeof(int) * 8);
    adj = new_sym_var(sizeof(int) * 8);
    addNode(adjList, vertex - 1, adj - 1);
  }

  return 0;
}

void addNode(node **list, int vertex, int adj)
{
  if (list[vertex] == 0)
  {
    list[vertex] = malloc(sizeof(node));
    list[vertex]->adj = adj;
    list[vertex]->next = 0;
  }
  else
  {
    node *n = malloc(sizeof(node));
    n->next = list[vertex];
    n->adj = adj;
    list[vertex] = n;
  }

}

void freeList(node **list)
{
  int i;
  for (i = 0; i < numV; i++)
  {
    if (list[i] != 0)
    {
      node *n = list[i];
      node *temp = n->next;
      free(n);
      while (temp != 0)
      {
        n = temp;
        temp = n->next;
        free(n);
      }

    }
    else
    {
      
    }

  }

  free(list);
}

void printVertices()
{
  int i;
  for (i = 0; i < numV; i++)
  {
    printf("%d\n", vertices[i]);
  }

}

void dfsVisit(node **list, int vertex, int *colors, int *parent, node **update)
{
  colors[vertex] = 1;
  node *adj = list[vertex];
  while (adj != 0)
  {
    if (colors[adj->adj] == 0)
    {
      parent[adj->adj] = vertex;
      dfsVisit(list, adj->adj, colors, parent, update);
    }
    else
    {
      addNode(update, adj->adj, vertex);
    }

    if (vertices[vertex] < vertices[adj->adj])
    {
      vertices[vertex] = vertices[adj->adj];
    }
    else
    {
      
    }

    adj = adj->next;
  }

  node *updtAdj = update[vertex];
  while (updtAdj != 0)
  {
    if (vertices[updtAdj->adj] < vertices[vertex])
    {
      vertices[updtAdj->adj] = vertices[vertex];
      updateVertex(updtAdj->adj, parent, update);
    }
    else
    {
      
    }

    updtAdj = updtAdj->next;
  }

  colors[vertex] = 2;
}

void updateVertex(int vertex, int *parent, node **update)
{
  node *adj = update[vertex];
  while (adj != 0)
  {
    if (vertices[adj->adj] < vertices[vertex])
    {
      vertices[adj->adj] = vertices[vertex];
      updateVertex(adj->adj, parent, update);
    }
    else
    {
      
    }

    adj = adj->next;
  }

  if ((parent[vertex] >= 0) && (vertices[parent[vertex]] < vertices[vertex]))
  {
    vertices[parent[vertex]] = vertices[vertex];
    updateVertex(parent[vertex], parent, update);
  }
  else
  {
    
  }

}

