/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>


typedef struct node
{
  int n;
  struct node *next;
} *Node;
typedef struct vertice
{
  int id;
  int low;
  int d;
  int CFL;
  Node first;
  Node tail;
  struct vertice *down;
} *Vertice;
Vertice stackHead;
int *vStack;
Vertice *GruposInternos;
int visitados = 0;
int grupos = 0;
int notaMaior = 0;
int numInternos;
int sccAtual = 0;
int *initvStack(int N);
void Push(Vertice v, int *vStack);
Vertice Pop(int *vStack);
void SCC_Tarjan(Vertice *amigos, int N, int *vStack);
void Tarjan_Visit(Vertice *amigos, int casa, int *vStack);
Vertice InsFimLista(Vertice head, int newID);
Node newNode(int n);
Vertice newVertex(int id);
Vertice *novaListaDeAmigos(int N);
Vertice novaListaAdj(Vertice head, Vertice *amigos, int **Matrix, int idAmigos);
void imprimeGrafo(Vertice *amigos, int numVer);
void imprimeVertice(Vertice v);
void debugImprimeAmigos(Vertice *amigos, int lenAmigos);
int main()
{
  int N;
  int P;
  int i;
  int a;
  int b;
  Vertice *friends;
  if (2 == 2)
  {
    N = new_sym_var(sizeof(int) * 8);
    P = new_sym_var(sizeof(int) * 8);
  }
  else
  {
    
  }

  ;
  friends = novaListaDeAmigos(N);
  stackHead = (Vertice) malloc(sizeof(struct vertice));
  vStack = initvStack(N);
  for (i = 0; i < P; i++)
  {
    if (2 == 2)
    {
      a = new_sym_var(sizeof(int) * 8);
      b = new_sym_var(sizeof(int) * 8);
    }
    else
    {
      
    }

    ;
    InsFimLista(friends[a - 1], b);
  }

  SCC_Tarjan(friends, N, vStack);
  printf("%d\n%d\n%d\n", grupos, notaMaior, numInternos);
  return 0;
}

void SCC_Tarjan(Vertice *amigos, int N, int *vStack)
{
  int i;
  int *sccRegistados;
  Node aux;
  for (i = 0; i < N; i++)
  {
    if (amigos[i]->d == (-1))
    {
      Tarjan_Visit(amigos, i, vStack);
    }
    else
    {
      
    }

  }

  sccRegistados = (int *) malloc((sizeof(int)) * grupos);
  for (i = 0; i < grupos; i++)
  {
    sccRegistados[i] = 0;
  }

  for (i = 0; i < N; i++)
  {
    for (aux = amigos[i]->first; aux != 0; aux = aux->next)
    {
      if (sccRegistados[amigos[i]->CFL] == 0)
      {
        if (amigos[i]->CFL != amigos[aux->n]->CFL)
        {
          sccRegistados[amigos[i]->CFL] = 1;
          numInternos--;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  numInternos = numInternos + grupos;
}

void Tarjan_Visit(Vertice *amigos, int casa, int *vStack)
{
  Vertice v = amigos[casa];
  Vertice popped;
  Node aux;
  int notaAtual;
  v->d = visitados;
  v->low = visitados;
  visitados++;
  Push(v, vStack);
  for (aux = v->first; aux != 0; aux = aux->next)
  {
    if (amigos[aux->n]->d == (-1))
    {
      Tarjan_Visit(amigos, amigos[aux->n]->id, vStack);
      if (amigos[aux->n]->low < v->low)
      {
        v->low = amigos[aux->n]->low;
      }
      else
      {
        
      }

    }
    else
    {
      if (vStack[aux->n] == 1)
      {
        if (amigos[aux->n]->d < v->low)
        {
          v->low = amigos[aux->n]->low;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  if (v->d == v->low)
  {
    notaAtual = 0;
    do
    {
      popped = Pop(vStack);
      popped->CFL = sccAtual;
      notaAtual++;
    }
    while (popped->id != v->id);
    sccAtual++;
    if (notaAtual >= notaMaior)
    {
      notaMaior = notaAtual;
    }
    else
    {
      
    }

    grupos++;
  }
  else
  {
    
  }

}

void Push(Vertice v, int *vStack)
{
  v->down = stackHead;
  stackHead = v;
  vStack[v->id] = 1;
}

Vertice Pop(int *vStack)
{
  Vertice taken;
  if (stackHead == 0)
  {
    return 0;
  }
  else
  {
    
  }

  taken = stackHead;
  stackHead = stackHead->down;
  vStack[taken->id] = 0;
  return taken;
}

Vertice newVertex(int id)
{
  Vertice v = (Vertice) malloc(sizeof(struct vertice));
  v->id = id;
  v->low = -1;
  v->d = -1;
  v->first = 0;
  v->tail = 0;
  return v;
}

Node newNode(int id)
{
  Node novo = (Node) malloc(sizeof(struct node));
  novo->n = id - 1;
  novo->next = 0;
  return novo;
}

Vertice *novaListaDeAmigos(int N)
{
  int i;
  Vertice *amigos = (Vertice *) malloc(N * (sizeof(struct vertice)));
  for (i = 0; i < N; i++)
  {
    amigos[i] = newVertex(i);
  }

  return amigos;
}

Vertice InsFimLista(Vertice v, int newID)
{
  Node new = newNode(newID);
  if (v->tail == 0)
  {
    v->first = new;
    v->tail = new;
    return v;
  }
  else
  {
    
  }

  v->tail->next = new;
  v->tail = new;
  return v;
}

int *initvStack(int N)
{
  int i;
  int *vet = (int *) malloc((sizeof(int)) * N);
  for (i = 0; i < N; i++)
  {
    vet[i] = 0;
  }

  return vet;
}

