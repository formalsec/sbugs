/*File generated by PreProcessor.py*/


#include <stdio.h>
#include<stdlib.h>


typedef struct stack
{
  int val;
  struct stack *next;
} stack;
typedef struct node
{
  struct node *prox;
  int valorProx;
} node;
void inserir(int u, int v);
void DFS(int at, int numAlunos);
int findScc(int numAlunos);
void push();
int pop();
node **adjList;
int *notasAlunos;
int *tempoDescoberta;
int *low;
int *onStack;
int temp = 0;
stack *head;
int main()
{
  int numAlunos;
  int numRelacoes;
  int n;
  int m;
  int i = 0;
  numAlunos = new_sym_var(sizeof(int) * 8);
  numRelacoes = new_sym_var(sizeof(int) * 8);
  notasAlunos = malloc((sizeof(int)) * numAlunos);
  adjList = malloc((sizeof(node)) * numAlunos);
  tempoDescoberta = malloc((sizeof(int)) * numAlunos);
  low = malloc((sizeof(int)) * numAlunos);
  onStack = malloc((sizeof(int)) * numAlunos);
  head = 0;
  for (i = 0; i < numAlunos; i++)
  {
    adjList[i] = 0;
    tempoDescoberta[i] = -1;
    low[i] = -1;
    onStack[i] = 0;
    n = new_sym_var(sizeof(int) * 8);
    notasAlunos[i] = n;
  }

  for (i = 0; i < numRelacoes; i++)
  {
    n = new_sym_var(sizeof(int) * 8);
    m = new_sym_var(sizeof(int) * 8);
    inserir(n - 1, m - 1);
  }

  findScc(numAlunos);
  for (i = 0; i < numAlunos; i++)
    printf("%d\n", notasAlunos[i]);

  return 0;
}

void inserir(int u, int v)
{
  node *aux;
  node *new;
  new = (node *) malloc(sizeof(node));
  new->valorProx = v;
  new->prox = 0;
  if (adjList[u] == 0)
  {
    adjList[u] = new;
  }
  else
  {
    aux = adjList[u];
    while (aux->prox != 0)
      aux = aux->prox;

    aux->prox = new;
  }

}

int findScc(int numAlunos)
{
  int i;
  for (i = 0; i < numAlunos; i++)
  {
    if (tempoDescoberta[i] == (-1))
    {
      DFS(i, numAlunos);
    }
    else
    {
      
    }

  }

  return *low;
}

void DFS(int at, int numAlunos)
{
  int to;
  int varPop;
  int max = 0;
  struct node *n;
  push(at);
  onStack[at] = 1;
  tempoDescoberta[at] = temp;
  low[at] = temp;
  temp++;
  n = adjList[at];
  while (n != 0)
  {
    to = n->valorProx;
    if (tempoDescoberta[to] == (-1))
    {
      DFS(to, numAlunos);
    }
    else
    {
      
    }

    if (onStack[to])
    {
      low[at] = (low[at] < low[to]) ? (low[at]) : (low[to]);
      notasAlunos[at] = (notasAlunos[at] < notasAlunos[to]) ? (notasAlunos[to]) : (notasAlunos[at]);
    }
    else
    {
      notasAlunos[at] = (notasAlunos[at] < notasAlunos[to]) ? (notasAlunos[to]) : (notasAlunos[at]);
    }

    n = n->prox;
  }

  max = notasAlunos[at];
  if (tempoDescoberta[at] == low[at])
  {
    while (1)
    {
      varPop = pop();
      onStack[varPop] = 0;
      low[varPop] = tempoDescoberta[at];
      notasAlunos[varPop] = max;
      if (varPop == at)
      {
        break;
      }
      else
      {
        
      }

    }

  }
  else
  {
    
  }

}

void push(int at)
{
  stack *aux = malloc(sizeof(stack));
  if (head == 0)
  {
    head = aux;
    head->next = 0;
    head->val = at;
    return;
  }
  else
  {
    
  }

  aux->next = head;
  aux->val = at;
  head = aux;
}

int pop()
{
  int i = head->val;
  head = head->next;
  return i;
}

