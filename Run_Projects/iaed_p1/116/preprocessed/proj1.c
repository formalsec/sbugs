/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct 
{
  int idp;
  char descricao[64];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct 
{
  int ide;
  produto produt[20];
  int pesoe;
  int precoe;
} encomenda;
void colocarProdutosVazio(produto p[]);
void colocarEncomendasVazias(encomenda e[]);
void adicionaProduto(produto p[]);
void adicionaStock(produto p[]);
void criaEncomenda(encomenda e[]);
void adicionaProdutoAEncomenda(produto p[], encomenda e[]);
void removeStock(produto p[]);
void removeProduto(produto p[], encomenda e[]);
void calculaCustoEncomenda(encomenda e[]);
void alteraPreco(produto p[], encomenda e[]);
void listaDescricaoQuantidade(encomenda e[]);
void listaMaximoProduto(produto p[], encomenda e[]);
void listaProdutos(produto p[]);
void listaProdutosEncomenda(encomenda e[]);
int main()
{
  char entrada;
  int i;
  produto prod[10000];
  encomenda enc[500];
  colocarProdutosVazio(prod);
  colocarEncomendasVazias(enc);
  while (1)
  {
    entrada = getchar();
    switch (entrada)
    {
      case 'a':
        getchar();
        adicionaProduto(prod);
        break;

      case 'q':
        getchar();
        adicionaStock(prod);
        break;

      case 'N':
        criaEncomenda(enc);
        break;

      case 'A':
        getchar();
        adicionaProdutoAEncomenda(prod, enc);
        break;

      case 'r':
        getchar();
        removeStock(prod);
        break;

      case 'R':
        getchar();
        removeProduto(prod, enc);
        break;

      case 'C':
        getchar();
        calculaCustoEncomenda(enc);
        break;

      case 'p':
        getchar();
        alteraPreco(prod, enc);
        break;

      case 'E':
        getchar();
        listaDescricaoQuantidade(enc);
        break;

      case 'm':
        getchar();
        listaMaximoProduto(prod, enc);
        break;

      case 'l':
        listaProdutos(prod);
        break;

      case 'L':
        getchar();
        listaProdutosEncomenda(enc);
        break;

      case 'z':
        for (i = 0; prod[i].idp > (-1); i++)
      {
        printf("%d|%s|%d|%d|%d\n", prod[i].idp, prod[i].descricao, prod[i].preco, prod[i].peso, prod[i].qtd);
      }

        break;

      case 'Z':
        for (i = 0; enc[i].ide > (-1); i++)
      {
        printf("%d|%d|%d\n", enc[i].ide, enc[i].precoe, enc[i].pesoe);
      }

        break;

      case 'x':
        return 0;

    }

  }

  return -1;
}

void colocarProdutosVazio(produto p[])
{
  int i;
  for (i = 0; i < 10000; i++)
  {
    p[i].idp = -1;
    p[i].qtd = 0;
  }

}

void colocarEncomendasVazias(encomenda e[])
{
  int i;
  int j;
  for (i = 0; i < 500; i++)
  {
    e[i].ide = -1;
    for (j = 0; j < 10000; j++)
    {
      e[i].produt[j].idp = -1;
      e[i].produt[j].qtd = 0;
    }

  }

}

void adicionaProduto(produto p[])
{
  int i = 0;
  int contador = 0;
  char c;
  char caracteres[64];
  produto p1;
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if ((contador == 0) && (c != ':'))
    {
      {
        p1.descricao[i] = c;
        i++;
      }
    }
    else
    {
      if (c == ':')
      {
        {
          switch (contador)
          {
            case 1:
              p1.preco = atoi(caracteres);
              break;

            case 2:
              p1.peso = atoi(caracteres);
              break;

            case 3:
              p1.qtd = atoi(caracteres);
              break;

          }

          contador++;
          i = 0;
        }
      }
      else
      {
        {
          caracteres[i] = c;
          i++;
        }
      }

    }

  }

  p1.qtd = atoi(caracteres);
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        p1.idp = i;
        p[i] = p1;
        break;
      }
    }
    else
    {
      
    }

  }

}

void adicionaStock(produto p[])
{
  int i = 0;
  int identidade;
  int quantidade;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        identidade = atoi(caracteres);
        i = 0;
      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  quantidade = atoi(caracteres);
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        printf("Impossivel adicionar produto %d ao stock. Produto inexistente.", identidade);
        return;
      }
    }
    else
    {
      if (identidade == p[i].idp)
      {
        {
          p[i].qtd += quantidade;
          break;
        }
      }
      else
      {
        
      }

    }

  }

}

void criaEncomenda(encomenda e[])
{
  int i;
  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      {
        e[i].ide = i;
        e[i].pesoe = 0;
        e[i].precoe = 0;
        break;
      }
    }
    else
    {
      
    }

  }

}

void adicionaProdutoAEncomenda(produto p[], encomenda e[])
{
  int i = 0;
  int j;
  int k;
  int contador = 0;
  int id_enc;
  int id_prod;
  int quant;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        i = 0;
        contador++;
        switch (contador)
        {
          case 1:
            id_enc = atoi(caracteres);
            break;

          case 2:
            id_prod = atoi(caracteres);
            break;

        }

      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  quant = atoi(caracteres);
  if (id_enc >= 500)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.", id_enc, id_prod);
      return;
    }
  }
  else
  {
    
  }

  if (id_prod >= 10000)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.", id_enc, id_prod);
      return;
    }
  }
  else
  {
    
  }

  for (j = 0; j < 500; j++)
  {
    if (e[j].ide == (-1))
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.", id_enc, id_prod);
        return;
      }
    }
    else
    {
      if (e[j].ide == id_enc)
      {
        break;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.", id_enc, id_prod);
        return;
      }
    }
    else
    {
      if (p[i].idp == id_prod)
      {
        {
          if (p[i].qtd < quant)
          {
            {
              printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.", id_enc, id_prod);
              return;
            }
          }
          else
          {
            if (((p[i].qtd * p[i].peso) + e[j].pesoe) > 20)
            {
              {
                printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.", id_enc, id_prod);
                return;
              }
            }
            else
            {
              {
                e[j].pesoe += quant * p[i].peso;
                e[j].precoe += quant * p[i].preco;
                for (k = 0; k < 20; k++)
                {
                  if (e[j].produt[k].idp == id_prod)
                  {
                    {
                      e[j].produt[k].qtd += quant;
                      break;
                    }
                  }
                  else
                  {
                    {
                      e[j].produt[k].idp = p[i].idp;
                      strcpy(p[i].descricao, e[j].produt[k].descricao);
                      e[j].produt[k].preco = p[i].preco;
                      e[j].produt[k].peso = p[i].peso;
                      e[j].produt[k].qtd = quant;
                      break;
                    }
                  }

                }

                p[i].qtd -= quant;
                return;
              }
            }

          }

        }
      }
      else
      {
        
      }

    }

  }

}

void removeStock(produto p[])
{
  int i;
  int identidade;
  int quantidade;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        identidade = atoi(caracteres);
        i = 0;
      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  quantidade = atoi(caracteres);
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        printf("Impossivel remover produto %d ao stock. Produto inexistente.", identidade);
        return;
      }
    }
    else
    {
      if (identidade == p[i].idp)
      {
        {
          if (p[i].qtd < quantidade)
          {
            {
              printf("Impossivel remover produto %d ao stock. Quantidade insuficiente.", identidade);
              return;
            }
          }
          else
          {
            p[i].qtd -= quantidade;
          }

          break;
        }
      }
      else
      {
        
      }

    }

  }

}

void removeProduto(produto p[], encomenda e[])
{
  int i = 0;
  int j;
  int k;
  int m;
  int id_prod;
  int id_enc;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        id_prod = atoi(caracteres);
        i = 0;
      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  id_enc = atoi(caracteres);
  if (id_enc >= 500)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.", id_enc, id_prod);
      return;
    }
  }
  else
  {
    
  }

  if (id_prod >= 10000)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.", id_enc, id_prod);
      return;
    }
  }
  else
  {
    
  }

  for (k = 0; k < 10000; k++)
  {
    if (p[k].idp == id_prod)
    {
      break;
    }
    else
    {
      if (p[k].idp == (-1))
      {
        {
          printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.", id_enc, id_prod);
          return;
        }
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.", id_enc, id_prod);
        return;
      }
    }
    else
    {
      if (e[i].ide == id_enc)
      {
        {
          for (j = 0; j < 20; j++)
          {
            if (e[i].produt[j].idp == id_prod)
            {
              {
                e[i].pesoe -= e[i].produt[j].peso * e[i].produt[j].qtd;
                e[i].precoe -= e[i].produt[j].preco * e[i].produt[j].qtd;
                p[k].qtd += e[i].produt[j].qtd;
                for (m = j; (m < (20 - 1)) && (e[i].produt[m].idp != (-1)); m++)
                {
                  e[i].produt[m] = e[i].produt[m + 1];
                }

                e[i].produt[20 - 1].idp = -1;
                return;
              }
            }
            else
            {
              
            }

          }

          printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.", id_enc, id_prod);
          return;
        }
      }
      else
      {
        
      }

    }

  }

}

void calculaCustoEncomenda(encomenda e[])
{
  int i = 0;
  int id_enc;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    caracteres[i] = c;
    i++;
  }

  id_enc = atoi(caracteres);
  if (id_enc >= 500)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.", id_enc);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      {
        printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.", id_enc);
        return;
      }
    }
    else
    {
      if (e[i].ide == id_enc)
      {
        {
          printf("Custo da encomenda %d %d.", id_enc, e[i].precoe);
          return;
        }
      }
      else
      {
        
      }

    }

  }

}

void alteraPreco(produto p[], encomenda e[])
{
  int i = 0;
  int j;
  int id_prod;
  int novo_preco;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        id_prod = atoi(caracteres);
        i = 0;
      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  novo_preco = atoi(caracteres);
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        printf("Impossivel alterar preco do produto %d. Produto inexistente.", id_prod);
        return;
      }
    }
    else
    {
      if (p[i].idp == id_prod)
      {
        {
          p[i].preco = novo_preco;
          return;
        }
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      break;
    }
    else
    {
      
    }

    for (j = 0; j < 20; j++)
    {
      if (e[i].produt[j].idp == (-1))
      {
        break;
      }
      else
      {
        if (p[i].idp == id_prod)
        {
          p[i].preco = novo_preco;
        }
        else
        {
          
        }

      }

    }

  }

}

void listaDescricaoQuantidade(encomenda e[])
{
  int i = 0;
  int j;
  int id_prod;
  int id_enc;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    if (c == ':')
    {
      {
        id_enc = atoi(caracteres);
        i = 0;
      }
    }
    else
    {
      {
        caracteres[i] = c;
        i++;
      }
    }

  }

  id_prod = atoi(caracteres);
  for (i = 0; i < 500; i++)
  {
    if (e[i].ide == (-1))
    {
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.", id_enc);
        return;
      }
    }
    else
    {
      if (e[i].ide == id_enc)
      {
        {
          for (j = 0; j < 20; j++)
          {
            if (e[i].produt[j].idp == (-1))
            {
              {
                printf("Impossivel listar produto %d. Produto inexistente.", id_prod);
                return;
              }
            }
            else
            {
              if (e[i].produt[j].idp == id_prod)
              {
                {
                  printf("%s %d.", e[i].produt[j].descricao, e[i].produt[j].qtd);
                  return;
                }
              }
              else
              {
                
              }

            }

          }

        }
      }
      else
      {
        
      }

    }

  }

}

void listaMaximoProduto(produto p[], encomenda e[])
{
  int i = 0;
  int j;
  int max = 0;
  int enc_max = -1;
  int id_prod;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    caracteres[i] = c;
    i++;
  }

  id_prod = atoi(caracteres);
  for (i = 0; i < 10000; i++)
  {
    if (p[i].idp == (-1))
    {
      {
        printf("Impossivel listar maximo do produto %d. Produto inexistente.", id_prod);
        return;
      }
    }
    else
    {
      if (p[i].idp == id_prod)
      {
        break;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < 500; i++)
  {
    for (j = 0; j < 20; j++)
    {
      if (e[i].produt[j].idp == (-1))
      {
        break;
      }
      else
      {
        if (e[i].produt[j].idp == id_prod)
        {
          {
            if (max < e[i].produt[j].qtd)
            {
              {
                max = e[i].produt[j].qtd;
                enc_max = e[i].ide;
              }
            }
            else
            {
              
            }

            break;
          }
        }
        else
        {
          
        }

      }

    }

  }

  if (max > 0)
  {
    printf("Maximo produto %d %d %d.", id_prod, enc_max, max);
  }
  else
  {
    
  }

}

void quickSort1(produto arr[], int inicio, int fim);
void listaProdutos(produto p[])
{
  int k;
  int n = 0;
  for (k = 0; k < 10000; k++)
  {
    if (p[k].idp == (-1))
    {
      {
        n = k - 1;
        break;
      }
    }
    else
    {
      
    }

  }

  quickSort1(p, 0, n);
  printf("Produtos\n");
  for (k = 0; k <= n; k++)
  {
    printf("%s %d %d\n", p[k].descricao, p[k].preco, p[k].qtd);
  }

}

void quickSort1(produto arr[], int inicio, int fim)
{
  int i = inicio;
  int j = fim;
  produto pivot = arr[(inicio + fim) / 2];
  produto troca;
  while (i <= j)
  {
    while ((arr[i].preco < pivot.preco) || ((arr[i].preco == pivot.preco) && (arr[i].idp < pivot.idp)))
      i++;

    while ((arr[i].preco > pivot.preco) || ((arr[i].preco == pivot.preco) && (arr[i].idp > pivot.idp)))
      j--;

    if (i <= j)
    {
      {
        troca = arr[i];
        arr[i] = arr[j];
        arr[j] = troca;
        i++;
        j--;
      }
    }
    else
    {
      
    }

  }

  if (inicio < j)
  {
    quickSort1(arr, inicio, j);
  }
  else
  {
    
  }

  if (i < fim)
  {
    quickSort1(arr, i, fim);
  }
  else
  {
    
  }

}

void quickSort2(produto arr[], int inicio, int fim);
void listaProdutosEncomenda(encomenda e[])
{
  int k = 0;
  int m;
  int n = 20;
  int id_enc;
  char c;
  char caracteres[64];
  while (((c = getchar()) != EOF) && (c != '\n'))
  {
    caracteres[k] = c;
    k++;
  }

  id_enc = atoi(caracteres);
  for (k = 0; k < 500; k++)
  {
    if (e[k].ide == (-1))
    {
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente", id_enc);
        return;
      }
    }
    else
    {
      if (e[k].ide == id_enc)
      {
        {
          for (m = 0; m < 20; m++)
          {
            if (e[k].produt[m].idp == (-1))
            {
              {
                n = m - 1;
                break;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        
      }

    }

  }

  quickSort2(e[k].produt, 0, n);
  printf("Encomenda %d\n", id_enc);
  for (k = 0; k <= n; k++)
  {
    printf("* %s %d %d\n", e[k].produt[m].descricao, e[k].produt[m].preco, e[k].produt[m].qtd);
  }

}

void quickSort2(produto arr[], int inicio, int fim)
{
  int i = inicio;
  int j = fim;
  produto pivot = arr[(inicio + fim) / 2];
  produto troca;
  while (i <= j)
  {
    while (arr[i].descricao < pivot.descricao)
      i++;

    while (arr[i].descricao > pivot.descricao)
      j--;

    if (i <= j)
    {
      {
        troca = arr[i];
        arr[i] = arr[j];
        arr[j] = troca;
        i++;
        j--;
      }
    }
    else
    {
      
    }

  }

  if (inicio < j)
  {
    quickSort2(arr, inicio, j);
  }
  else
  {
    
  }

  if (i < fim)
  {
    quickSort2(arr, i, fim);
  }
  else
  {
    
  }

}

