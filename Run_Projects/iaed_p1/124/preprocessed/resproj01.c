/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int identP;
  char descricao[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct item
{
  int identP;
  int qtd;
} item;
typedef struct encomenda
{
  item prod[10000];
  int identE;
  int peso;
} encomenda;
int idp = 0;
int ide = 0;
produto prod[10000];
encomenda encom[500];
int comparadorProdutos(int a, int b)
{
  return prod[a].preco <= prod[b].preco;
}

int comparadorProdutosEncomenda(int a, int b)
{
  return strcmp(prod[a].descricao, prod[b].descricao) <= 0;
}

void AdicionaProduto()
{
  for (int prod_index = 0; prod_index < 10; prod_index++)
  {
    prod[idp].descricao[prod_index] = new_sym_var(sizeof(char) * 8);
  }

  prod[idp].descricao[10 - 1] = '\0';
  prod[idp].preco = new_sym_var(sizeof(int) * 8);
  prod[idp].peso = new_sym_var(sizeof(int) * 8);
  prod[idp].qtd = new_sym_var(sizeof(int) * 8);
  prod[idp].identP = idp;
  printf("Novo produto %d.\n", prod[idp].identP);
  idp++;
}

void AdicionaStock()
{
  int identificadorP;
  int quantidade;
  identificadorP = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (identificadorP >= idp)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", identificadorP);
    }
  }
  else
  {
    {
      prod[identificadorP].qtd += quantidade;
    }
  }

}

void CriaEncomenda()
{
  encom[ide].identE = ide;
  printf("Nova encomenda %d.\n", ide);
  ide++;
}

void AdicionaProdutoEncomenda()
{
  int identificadorP;
  int identificadorE;
  int quantidade;
  int peso;
  identificadorE = new_sym_var(sizeof(int) * 8);
  identificadorP = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  peso = prod[identificadorP].peso * quantidade;
  if (identificadorE >= ide)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", identificadorP, identificadorE);
    }
  }
  else
  {
    if (identificadorP >= idp)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", identificadorP, identificadorE);
      }
    }
    else
    {
      if (prod[identificadorP].qtd < quantidade)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", identificadorP, identificadorE);
        }
      }
      else
      {
        if ((peso + encom[identificadorE].peso) > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", identificadorP, identificadorE);
          }
        }
        else
        {
          {
            encom[identificadorE].peso += peso;
            encom[identificadorE].prod[identificadorP].qtd += quantidade;
            prod[identificadorP].qtd -= quantidade;
            encom[identificadorE].prod[identificadorP].identP = identificadorP;
          }
        }

      }

    }

  }

}

void RemoveStock()
{
  int identificadorP;
  int quantidade;
  identificadorP = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (identificadorP >= idp)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", identificadorP);
    }
  }
  else
  {
    {
      if (prod[identificadorP].qtd >= quantidade)
      {
        {
          prod[identificadorP].qtd -= quantidade;
        }
      }
      else
      {
        {
          printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidade, identificadorP);
        }
      }

    }
  }

}

void RemoveProdutoEncomenda()
{
  int identificadorE;
  int identificadorP;
  int peso;
  identificadorE = new_sym_var(sizeof(int) * 8);
  identificadorP = new_sym_var(sizeof(int) * 8);
  if (identificadorE >= ide)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", identificadorP, identificadorE);
    }
  }
  else
  {
    if (identificadorP >= idp)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", identificadorP, identificadorE);
      }
    }
    else
    {
      {
        peso = prod[identificadorP].peso * encom[identificadorE].prod[identificadorP].qtd;
        encom[identificadorE].peso -= peso;
        prod[identificadorP].qtd += encom[identificadorE].prod[identificadorP].qtd;
        encom[identificadorE].prod[identificadorP].qtd = 0;
      }
    }

  }

}

void CalculaCusto()
{
  int i;
  int custo = 0;
  int identificadorE;
  identificadorE = new_sym_var(sizeof(int) * 8);
  if (identificadorE >= ide)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", identificadorE);
    }
  }
  else
  {
    {
      for (i = 0; i < idp; i++)
        custo += prod[i].preco * encom[identificadorE].prod[i].qtd;

      printf("Custo da encomenda %d %d.\n", identificadorE, custo);
    }
  }

}

void AlteraPreco()
{
  int identificadorP;
  int preco;
  identificadorP = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (identificadorP >= idp)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", identificadorP);
    }
  }
  else
  {
    {
      prod[identificadorP].preco = preco;
    }
  }

}

void DescricaoQuantidade()
{
  int identificadorP;
  int identificadorE;
  identificadorE = new_sym_var(sizeof(int) * 8);
  identificadorP = new_sym_var(sizeof(int) * 8);
  if (identificadorE >= ide)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", identificadorE);
    }
  }
  else
  {
    if (identificadorP >= idp)
    {
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", identificadorP);
      }
    }
    else
    {
      {
        printf("%s %d.\n", prod[identificadorP].descricao, encom[identificadorE].prod[identificadorP].qtd);
      }
    }

  }

}

void MaiorOcurrencia()
{
  int i;
  int encomenda;
  int quantidade = 0;
  int identificadorP;
  identificadorP = new_sym_var(sizeof(int) * 8);
  if (identificadorP >= idp)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", identificadorP);
    }
  }
  else
  {
    {
      for (i = 0; i < ide; i++)
      {
        if (encom[i].prod[identificadorP].qtd > quantidade)
        {
          {
            quantidade = encom[i].prod[identificadorP].qtd;
            encomenda = i;
          }
        }
        else
        {
          
        }

      }

      if (quantidade != 0)
      {
        printf("Maximo produto %d %d %d.\n", identificadorP, encomenda, quantidade);
      }
      else
      {
        
      }

    }
  }

}

void mergeSort(int p[10000], int aux[10000], int i, int f, char c)
{
  int m;
  int j;
  int k;
  int l;
  int comparador;
  if ((f - i) < 1)
  {
    return;
  }
  else
  {
    
  }

  m = (i + f) / 2;
  mergeSort(aux, p, i, m, c);
  mergeSort(aux, p, m + 1, f, c);
  k = i;
  l = m + 1;
  for (j = i; j <= f; j++)
  {
    if ((l > f) || (k > f))
    {
      {
        comparador = 0;
      }
    }
    else
    {
      if (c == 'P')
      {
        {
          comparador = comparadorProdutos(p[k], p[l]);
        }
      }
      else
      {
        {
          comparador = comparadorProdutosEncomenda(p[k], p[l]);
        }
      }

    }

    if ((k <= m) && ((l > f) || comparador))
    {
      {
        aux[j] = p[k];
        k++;
      }
    }
    else
    {
      {
        aux[j] = p[l];
        l++;
      }
    }

  }

}

void ListaPreco()
{
  int i;
  int aux[10000];
  int produtos[10000];
  for (i = 0; i < 10000; i++)
  {
    produtos[i] = i;
  }

  for (i = 0; i < 10000; i++)
  {
    aux[i] = produtos[i];
  }

  mergeSort(aux, produtos, 0, idp - 1, 'P');
  printf("Produtos\n");
  for (i = 0; i < idp; i++)
  {
    printf("* %s %d %d\n", prod[produtos[i]].descricao, prod[produtos[i]].preco, prod[produtos[i]].qtd);
  }

}

void ListaEncomenda()
{
  int identificadorE;
  int i;
  int j = 0;
  int produtos[10000];
  int aux[10000];
  identificadorE = new_sym_var(sizeof(int) * 8);
  if (identificadorE >= ide)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", identificadorE);
    }
  }
  else
  {
    {
      for (i = 0; i < idp; i++)
      {
        produtos[i] = -1;
        if (encom[identificadorE].prod[i].qtd > 0)
        {
          {
            produtos[j++] = encom[identificadorE].prod[i].identP;
          }
        }
        else
        {
          
        }

      }

      for (i = 0; i < j; i++)
      {
        aux[i] = produtos[i];
      }

      mergeSort(aux, produtos, 0, j - 1, 'E');
      printf("Encomenda %d\n", identificadorE);
      for (i = 0; i < j; i++)
      {
        printf("* %s %d %d\n", prod[produtos[i]].descricao, prod[produtos[i]].preco, encom[identificadorE].prod[produtos[i]].qtd);
      }

    }
  }

}

int main()
{
  int car;
  while (car = getchar())
  {
    switch (car)
    {
      case 'a':
        AdicionaProduto();
        break;

      case 'q':
        AdicionaStock();
        break;

      case 'N':
        CriaEncomenda();
        break;

      case 'A':
        AdicionaProdutoEncomenda();
        break;

      case 'r':
        RemoveStock();
        break;

      case 'R':
        RemoveProdutoEncomenda();
        break;

      case 'C':
        CalculaCusto();
        break;

      case 'p':
        AlteraPreco();
        break;

      case 'E':
        DescricaoQuantidade();
        break;

      case 'm':
        MaiorOcurrencia();
        break;

      case 'l':
        ListaPreco();
        break;

      case 'L':
        ListaEncomenda();
        break;

      case 'x':
        return 0;

    }

    getchar();
  }

  return 0;
}

