/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int idp;
  char des[63];
  int preco;
  int peso;
  int qtd;
} Produto;
typedef struct encomenda
{
  int ide;
  int pesoTotal;
  int itens[10000];
  int quantidades[10000];
  int contagem;
} Encomenda;
int indice_p = 0;
Produto lista_p[10000];
int indice_e = 0;
Encomenda lista_e[500];
int acharProdE(int idp, int ide)
{
  int i;
  for (i = 0; i < lista_e[ide].contagem; i++)
  {
    if (idp == lista_e[ide].itens[i])
    {
      {
        return i;
      }
    }
    else
    {
      
    }

  }

  return -1;
}

void mostra_itens()
{
  int y;
  for (y = 0; y < indice_p; y++)
  {
    printf("[%d] %s / %d / %d / %d \n", y, lista_p[y].des, lista_p[y].preco, lista_p[y].peso, lista_p[y].qtd);
  }

}

void mostra_encomendas()
{
  int ide;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  printf("[%d]", ide);
  for (i = 0; i < lista_e[ide].contagem; i++)
  {
    printf(" %d:%d /", lista_e[ide].itens[i], lista_e[ide].quantidades[i]);
  }

  printf("    peso total: %d\n", lista_e[ide].pesoTotal);
}

void addProd()
{
  Produto item;
  int preco;
  int peso;
  int qtd;
  for (int item_index = 0; item_index < 10; item_index++)
  {
    item.des[item_index] = new_sym_var(sizeof(char) * 8);
  }

  item.des[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  item.preco = preco;
  item.peso = peso;
  item.qtd = qtd;
  item.idp = indice_p;
  lista_p[indice_p] = item;
  printf("Novo produto %d.\n", indice_p);
  indice_p++;
}

void addStock()
{
  int idp;
  int qtd_add;
  idp = new_sym_var(sizeof(int) * 8);
  qtd_add = new_sym_var(sizeof(int) * 8);
  if (idp >= indice_p)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      lista_p[idp].qtd += qtd_add;
    }
  }

}

void novaE()
{
  Encomenda E;
  E.ide = indice_e;
  E.pesoTotal = 0;
  E.contagem = 0;
  lista_e[indice_e] = E;
  printf("Nova encomenda %d.\n", indice_e);
  indice_e++;
}

void addProdE()
{
  int contador;
  int ide;
  int idp;
  int qtd;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (indice_e <= ide)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (indice_p <= idp)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (qtd > lista_p[idp].qtd)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (((qtd * lista_p[idp].peso) + lista_e[ide].pesoTotal) > 200)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  contador = acharProdE(idp, ide);
  if (contador != (-1))
  {
    {
      lista_e[ide].quantidades[contador] += qtd;
      lista_p[idp].qtd -= qtd;
      lista_e[ide].pesoTotal += qtd * lista_p[idp].peso;
    }
  }
  else
  {
    {
      lista_e[ide].itens[lista_e[ide].contagem] = idp;
      lista_e[ide].quantidades[lista_e[ide].contagem] = qtd;
      lista_p[idp].qtd -= qtd;
      lista_e[ide].pesoTotal += qtd * lista_p[idp].peso;
      lista_e[ide].contagem++;
    }
  }

}

void remStock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= indice_p)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if ((lista_p[idp].qtd - qtd) < 0)
  {
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      return;
    }
  }
  else
  {
    
  }

  lista_p[idp].qtd -= qtd;
}

void remProdE()
{
  int ide;
  int idp;
  int i;
  int posicao;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (indice_e <= ide)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (indice_p <= idp)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  posicao = acharProdE(idp, ide);
  if (posicao == (-1))
  {
    {
      return;
    }
  }
  else
  {
    
  }

  lista_p[idp].qtd += lista_e[ide].quantidades[posicao];
  lista_e[ide].pesoTotal -= lista_e[ide].quantidades[posicao] * lista_p[idp].peso;
  for (i = posicao; i < (lista_e[ide].contagem - 1); i++)
  {
    lista_e[ide].itens[i] = lista_e[ide].itens[i + 1];
    lista_e[ide].quantidades[i] = lista_e[ide].quantidades[i + 1];
  }

  lista_e[ide].contagem -= 1;
}

void calculaPreco()
{
  int total = 0;
  int ide;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= indice_e)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < lista_e[ide].contagem; i++)
  {
    total += lista_e[ide].quantidades[i] * lista_p[lista_e[ide].itens[i]].preco;
  }

  printf("Custo da encomenda %d %d.\n", ide, total);
}

void alteraPreco()
{
  int idp;
  int novoPreco;
  idp = new_sym_var(sizeof(int) * 8);
  novoPreco = new_sym_var(sizeof(int) * 8);
  if (indice_p <= idp)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  lista_p[idp].preco = novoPreco;
}

void infoProdE()
{
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (indice_e <= ide)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  if (indice_p <= idp)
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if (acharProdE(idp, ide) == (-1))
  {
    {
      printf("%s %d.\n", lista_p[idp].des, 0);
      return;
    }
  }
  else
  {
    
  }

  printf("%s %d.\n", lista_p[idp].des, lista_e[ide].quantidades[acharProdE(idp, ide)]);
}

void EncomProdQtd()
{
  int idp;
  int maiorQtd = 0;
  int ideCorrespondente = -1;
  int i;
  int e;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= indice_p)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if (indice_e == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < indice_e; i++)
  {
    e = acharProdE(idp, i);
    if ((e > (-1)) && (lista_e[i].quantidades[e] > maiorQtd))
    {
      {
        maiorQtd = lista_e[i].quantidades[e];
        ideCorrespondente = lista_e[i].ide;
      }
    }
    else
    {
      
    }

  }

  if (maiorQtd > 0)
  {
    {
      printf("Maximo produto %d %d %d.\n", idp, ideCorrespondente, maiorQtd);
    }
  }
  else
  {
    
  }

}

void organizaPrecos()
{
  Produto ordenar[10000];
  int i;
  int e;
  int id_menor;
  Produto copia;
  printf("Produtos\n");
  for (i = 0; i < indice_p; i++)
  {
    ordenar[i] = lista_p[i];
  }

  for (i = 0; i < indice_p; i++)
  {
    id_menor = i;
    for (e = i + 1; e < indice_p; e++)
    {
      if (ordenar[id_menor].preco > ordenar[e].preco)
      {
        {
          id_menor = e;
        }
      }
      else
      {
        
      }

      if ((ordenar[id_menor].preco == ordenar[e].preco) && (ordenar[id_menor].idp > ordenar[e].idp))
      {
        {
          id_menor = e;
        }
      }
      else
      {
        
      }

    }

    copia = ordenar[id_menor];
    ordenar[id_menor] = ordenar[i];
    ordenar[i] = copia;
  }

  for (i = 0; i < indice_p; i++)
  {
    printf("* %s %d %d\n", ordenar[i].des, ordenar[i].preco, ordenar[i].qtd);
  }

}

void organizaDesE()
{
  int ide;
  int ordenar[10000];
  int i;
  int e;
  int reg;
  ide = new_sym_var(sizeof(int) * 8);
  if (indice_e > ide)
  {
    {
      printf("Encomenda %d\n", ide);
    }
  }
  else
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }

  for (i = 0; i < lista_e[ide].contagem; i++)
  {
    ordenar[i] = lista_e[ide].itens[i];
  }

  for (i = 0; i < (lista_e[ide].contagem - 1); i++)
  {
    for (e = i + 1; e < lista_e[ide].contagem; e++)
    {
      if (0 < strcmp(lista_p[ordenar[i]].des, lista_p[ordenar[e]].des))
      {
        {
          reg = ordenar[e];
          ordenar[e] = ordenar[i];
          ordenar[i] = reg;
        }
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < lista_e[ide].contagem; i++)
  {
    e = acharProdE(ordenar[i], ide);
    printf("* %s %d %d\n", lista_p[ordenar[i]].des, lista_p[ordenar[i]].preco, lista_e[ide].quantidades[e]);
  }

}

int main()
{
  char fun;
  while (1 > 0)
  {
    fun = new_sym_var(sizeof(char) * 8);
    switch (fun)
    {
      case 'a':
        addProd();
        break;

      case 'q':
        addStock();
        break;

      case 'N':
        novaE();
        break;

      case 'A':
        addProdE();
        break;

      case 'r':
        remStock();
        break;

      case 'R':
        remProdE();
        break;

      case 'C':
        calculaPreco();
        break;

      case 'p':
        alteraPreco();
        break;

      case 'E':
        infoProdE();
        break;

      case 'm':
        EncomProdQtd();
        break;

      case 'l':
        organizaPrecos();
        break;

      case 'L':
        organizaDesE();
        break;

      case 'k':
        mostra_itens();
        break;

      case 'K':
        mostra_encomendas();
        break;

      case 'x':
        return 0;

    }

  }

  return 0;
}

