/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct produto
{
  int id;
  char descricao[64];
  int preco;
  int peso;
  int quantidade;
} Produto;
typedef struct encomenda
{
  int produtosEncomenda[200][2];
  int pesoEncomenda;
  int nroProds;
} Encomenda;
void novoProduto();
void adicionaStock();
void novaEncomenda();
void addProdEncomenda();
void removeProdStock();
void removeProdEncomenda();
void custoEncomenda();
void alteraPreco();
void mostraProdEncomenda();
void encomendaMaisProduto();
void listarPreco();
void listarProdsEncomenda();
void mergeSort(int array[], int esq, int dir);
void mergeAux(int array[], int esq, int med, int right);
void mergeStrings(int array[], int esq, int dir);
void mergeStrAux(int array[], int esq, int med, int dir);
int procuraIndexEncomenda(int ide, int idp);
void mostraProds();
Produto stockProdutos[10000];
Encomenda encomendas[500];
int idProdutos = 0;
int idEncomendas = 0;
int mergeArr[10000];
int mergeArrStr[200];
int main()
{
  char funcao;
  while ((funcao = getchar()) != EOF)
  {
    switch (funcao)
    {
      case 'a':
        novoProduto();
        break;

      case 'q':
        adicionaStock();
        break;

      case 'N':
        novaEncomenda();
        break;

      case 'A':
        addProdEncomenda();
        break;

      case 'r':
        removeProdStock();
        break;

      case 'R':
        removeProdEncomenda();
        break;

      case 'C':
        custoEncomenda();
        break;

      case 'p':
        alteraPreco();
        break;

      case 'E':
        mostraProdEncomenda();
        break;

      case 'm':
        encomendaMaisProduto();
        break;

      case 'l':
        listarPreco();
        break;

      case 'L':
        listarProdsEncomenda();
        break;

      case 'x':
        exit(0);
        break;

      case 'k':
        mostraProds();
        break;

    }

  }

  return 0;
}

void novoProduto()
{
  for (int stockProdutos_index = 0; stockProdutos_index < 10; stockProdutos_index++)
  {
    stockProdutos[idProdutos].descricao[stockProdutos_index] = new_sym_var(sizeof(char) * 8);
  }

  stockProdutos[idProdutos].descricao[10 - 1] = '\0';
  stockProdutos[idProdutos].preco = new_sym_var(sizeof(int) * 8);
  stockProdutos[idProdutos].peso = new_sym_var(sizeof(int) * 8);
  stockProdutos[idProdutos].quantidade = new_sym_var(sizeof(int) * 8);
  stockProdutos[idProdutos].id = idProdutos;
  printf("Novo produto %d.\n", stockProdutos[idProdutos].id);
  idProdutos++;
}

void adicionaStock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp < idProdutos)
  {
    {
      stockProdutos[idp].quantidade += qtd;
    }
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }

}

void novaEncomenda()
{
  encomendas[idEncomendas].nroProds = 0;
  encomendas[idEncomendas].pesoEncomenda = 0;
  printf("Nova encomenda %d.\n", idEncomendas);
  idEncomendas++;
}

void addProdEncomenda()
{
  int idp;
  int ide;
  int qtd;
  int len;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= idEncomendas)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= idProdutos)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (stockProdutos[idp].quantidade < qtd)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if ((encomendas[ide].pesoEncomenda + (stockProdutos[idp].peso * qtd)) > 200)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  len = encomendas[ide].nroProds;
  i = procuraIndexEncomenda(ide, idp);
  if (i >= 0)
  {
    {
      encomendas[ide].produtosEncomenda[i][1] = encomendas[ide].produtosEncomenda[i][1] + qtd;
      encomendas[ide].pesoEncomenda = encomendas[ide].pesoEncomenda + (qtd * stockProdutos[idp].peso);
      stockProdutos[idp].quantidade = stockProdutos[idp].quantidade - qtd;
    }
  }
  else
  {
    {
      encomendas[ide].produtosEncomenda[len][0] = idp;
      encomendas[ide].produtosEncomenda[len][1] = qtd;
      encomendas[ide].pesoEncomenda = encomendas[ide].pesoEncomenda + (qtd * stockProdutos[idp].peso);
      stockProdutos[idp].quantidade = stockProdutos[idp].quantidade - qtd;
      encomendas[ide].nroProds++;
    }
  }

}

void removeProdStock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= idProdutos)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if ((stockProdutos[idp].quantidade - qtd) < 0)
  {
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      return;
    }
  }
  else
  {
    
  }

  stockProdutos[idp].quantidade -= qtd;
}

void removeProdEncomenda()
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= idEncomendas)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= idProdutos)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  i = procuraIndexEncomenda(ide, idp);
  if (i >= 0)
  {
    {
      stockProdutos[idp].quantidade += encomendas[ide].produtosEncomenda[i][1];
      encomendas[ide].pesoEncomenda -= stockProdutos[idp].peso * encomendas[ide].produtosEncomenda[i][1];
      encomendas[ide].produtosEncomenda[i][1] = 0;
    }
  }
  else
  {
    
  }

}

void custoEncomenda()
{
  int ide;
  int precoEncomenda = 0;
  int i;
  int len;
  int identificador;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= idEncomendas)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  len = encomendas[ide].nroProds;
  for (i = 0; i < len; i++)
  {
    identificador = encomendas[ide].produtosEncomenda[i][0];
    precoEncomenda = precoEncomenda + (stockProdutos[identificador].preco * encomendas[ide].produtosEncomenda[i][1]);
  }

  printf("Custo da encomenda %d %d.\n", ide, precoEncomenda);
}

void alteraPreco()
{
  int idp;
  int novoPreco;
  idp = new_sym_var(sizeof(int) * 8);
  novoPreco = new_sym_var(sizeof(int) * 8);
  if (idp >= idProdutos)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  stockProdutos[idp].preco = novoPreco;
}

void mostraProdEncomenda()
{
  int ide;
  int idp;
  int indice;
  int quantidade;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= idEncomendas)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= idProdutos)
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  indice = procuraIndexEncomenda(ide, idp);
  if (indice >= 0)
  {
    {
      quantidade = encomendas[ide].produtosEncomenda[indice][1];
    }
  }
  else
  {
    {
      quantidade = 0;
    }
  }

  printf("%s %d.\n", stockProdutos[idp].descricao, quantidade);
}

void encomendaMaisProduto()
{
  int idp;
  int encomendaMaisRecorrente = -1;
  int quantidadeMaxima = 0;
  int i;
  int j;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= idProdutos)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < idEncomendas; i++)
  {
    j = procuraIndexEncomenda(i, idp);
    if ((j >= 0) && (encomendas[i].produtosEncomenda[j][1] > quantidadeMaxima))
    {
      {
        encomendaMaisRecorrente = i;
        quantidadeMaxima = encomendas[i].produtosEncomenda[j][1];
      }
    }
    else
    {
      
    }

  }

  if ((encomendaMaisRecorrente >= 0) && (quantidadeMaxima > 0))
  {
    {
      printf("Maximo produto %d %d %d.\n", idp, encomendaMaisRecorrente, quantidadeMaxima);
    }
  }
  else
  {
    
  }

}

void listarPreco()
{
  int i;
  int produtosOrdenados[10000];
  int len;
  len = idProdutos;
  for (i = 0; i < len; i++)
  {
    produtosOrdenados[i] = i;
  }

  mergeSort(produtosOrdenados, 0, len - 1);
  printf("Produtos\n");
  for (i = 0; i < len; i++)
  {
    printf("* %s %d %d\n", stockProdutos[produtosOrdenados[i]].descricao, stockProdutos[produtosOrdenados[i]].preco, stockProdutos[produtosOrdenados[i]].quantidade);
  }

}

void listarProdsEncomenda()
{
  int ide;
  int prodsEncomenda[200] = {0};
  int i;
  int j = 0;
  int len;
  int indice;
  int quantidade;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= idEncomendas)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  len = encomendas[ide].nroProds - 1;
  for (i = 0; i < idProdutos; i++)
  {
    indice = procuraIndexEncomenda(ide, i);
    if ((indice >= 0) && (encomendas[ide].produtosEncomenda[indice][1] > 0))
    {
      {
        prodsEncomenda[j] = i;
        j++;
      }
    }
    else
    {
      
    }

  }

  mergeStrings(prodsEncomenda, 0, len);
  printf("Encomenda %d\n", ide);
  for (i = 0; i < (len + 1); i++)
  {
    indice = procuraIndexEncomenda(ide, prodsEncomenda[i]);
    quantidade = encomendas[ide].produtosEncomenda[indice][1];
    if ((indice >= 0) && (quantidade > 0))
    {
      printf("* %s %d %d\n", stockProdutos[prodsEncomenda[i]].descricao, stockProdutos[prodsEncomenda[i]].preco, quantidade);
    }
    else
    {
      
    }

  }

}

void mostraProds()
{
  int i;
  int j;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  for (i = 0; i < 200; i++)
  {
    j = procuraIndexEncomenda(ide, i);
    if (j >= 0)
    {
      printf("%s %d %d\n", stockProdutos[i].descricao, stockProdutos[i].preco, encomendas[ide].produtosEncomenda[j][1]);
    }
    else
    {
      
    }

  }

}

int procuraIndexEncomenda(int ide, int idp)
{
  int i;
  int len = encomendas[ide].nroProds;
  for (i = 0; i < len; i++)
  {
    if (encomendas[ide].produtosEncomenda[i][0] == idp)
    {
      {
        return i;
      }
    }
    else
    {
      
    }

  }

  return -1;
}

void mergeAux(int array[], int esq, int med, int dir)
{
  int i;
  int j;
  int k;
  for (i = med + 1; i > esq; i--)
  {
    mergeArr[i - 1] = array[i - 1];
  }

  for (j = med; j < dir; j++)
  {
    mergeArr[(dir + med) - j] = array[j + 1];
  }

  for (k = esq; k <= dir; k++)
  {
    if ((stockProdutos[mergeArr[j]].preco < stockProdutos[mergeArr[i]].preco) || ((stockProdutos[mergeArr[j]].preco == stockProdutos[mergeArr[i]].preco) && (mergeArr[j] < mergeArr[i])))
    {
      {
        array[k] = mergeArr[j];
        j--;
      }
    }
    else
    {
      {
        array[k] = mergeArr[i];
        i++;
      }
    }

  }

}

void mergeSort(int array[], int esq, int dir)
{
  int med = (esq + dir) / 2;
  if (dir <= esq)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  mergeSort(array, esq, med);
  mergeSort(array, med + 1, dir);
  mergeAux(array, esq, med, dir);
}

void mergeStrAux(int array[], int esq, int med, int dir)
{
  int i;
  int j;
  int k;
  for (i = med + 1; i > esq; i--)
  {
    mergeArrStr[i - 1] = array[i - 1];
  }

  for (j = med; j < dir; j++)
  {
    mergeArrStr[(dir + med) - j] = array[j + 1];
  }

  for (k = esq; k <= dir; k++)
  {
    if ((strcmp(stockProdutos[mergeArrStr[j]].descricao, stockProdutos[mergeArrStr[i]].descricao) < 0) || (mergeArr[i] > mergeArr[med]))
    {
      {
        array[k] = mergeArrStr[j];
        j--;
      }
    }
    else
    {
      {
        array[k] = mergeArrStr[i];
        i++;
      }
    }

  }

}

void mergeStrings(int array[], int esq, int dir)
{
  int med = (dir + esq) / 2;
  if (dir <= esq)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  mergeStrings(array, esq, med);
  mergeStrings(array, med + 1, dir);
  mergeStrAux(array, esq, med, dir);
}

