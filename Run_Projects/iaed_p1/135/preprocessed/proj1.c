/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int preco;
  int peso;
  int quant;
  char descr[64];
} produto;
typedef struct encomenda
{
  int peso;
  int lstPrdts[10000];
} encomenda;
void adicionaProduto();
void adicionaStock();
void criaEncomenda();
void encomendaProduto();
void removeStock();
void removeProduto();
void custoEncomenda();
void alteraCusto();
void prodEncom();
void identEncom();
void listaProd();
void listaEncom();
void mergesort(int (*condicao)(int, int), int a[], int esq, int dir);
void merge(int (*condicao)(int, int), int a[], int esq, int m, int dir);
int produto404(int idp);
int encomenda404(int ide);
int quantidadeInsuf(int idp, int qnt);
int menorPreco(int a, int b);
int ordemAlf(int a, int b);
encomenda sistema[500];
produto produtos[10000];
int indexProd[10000];
int idpsEncom[10000];
int aux[10000];
int id_prod = 0;
int id_encom = 0;
int main()
{
  char comm;
  while (comm != 'x')
  {
    switch (comm = getchar())
    {
      case 'a':
        adicionaProduto();
        break;

      case 'q':
        adicionaStock();
        break;

      case 'N':
        criaEncomenda();
        break;

      case 'A':
        encomendaProduto();
        break;

      case 'r':
        removeStock();
        break;

      case 'R':
        removeProduto();
        break;

      case 'C':
        custoEncomenda();
        break;

      case 'p':
        alteraCusto();
        break;

      case 'E':
        prodEncom();
        break;

      case 'm':
        identEncom();
        break;

      case 'l':
        listaProd();
        break;

      case 'L':
        listaEncom();
        break;

    }

  }

  return 0;
}

int produto404(int idp)
{
  return idp >= id_prod;
}

int encomenda404(int ide)
{
  return ide >= id_encom;
}

int quantidadeInsuf(int idp, int qnt)
{
  return produtos[idp].quant < qnt;
}

void adicionaProduto()
{
  for (int produtos_index = 0; produtos_index < 10; produtos_index++)
  {
    produtos[id_prod].descr[produtos_index] = new_sym_var(sizeof(char) * 8);
  }

  produtos[id_prod].descr[10 - 1] = '\0';
  produtos[id_prod].preco = new_sym_var(sizeof(int) * 8);
  produtos[id_prod].peso = new_sym_var(sizeof(int) * 8);
  produtos[id_prod].quant = new_sym_var(sizeof(int) * 8);
  indexProd[id_prod] = id_prod;
  printf("Novo produto %d.\n", id_prod);
  id_prod++;
}

void adicionaStock()
{
  int idp;
  int qnt;
  idp = new_sym_var(sizeof(int) * 8);
  qnt = new_sym_var(sizeof(int) * 8);
  if (produto404(idp))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    produtos[idp].quant += qnt;
  }

}

void criaEncomenda()
{
  sistema[id_encom].peso = 0;
  printf("Nova encomenda %d.\n", id_encom);
  id_encom++;
}

void encomendaProduto()
{
  int ide;
  int idp;
  int qnt;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qnt = new_sym_var(sizeof(int) * 8);
  if (encomenda404(ide))
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (produto404(idp))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (quantidadeInsuf(idp, qnt))
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((sistema[ide].peso + (qnt * produtos[idp].peso)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          {
            sistema[ide].lstPrdts[idp] += qnt;
            sistema[ide].peso += qnt * produtos[idp].peso;
            produtos[idp].quant -= qnt;
          }
        }

      }

    }

  }

}

void removeStock()
{
  int idp;
  int qnt;
  idp = new_sym_var(sizeof(int) * 8);
  qnt = new_sym_var(sizeof(int) * 8);
  if (produto404(idp))
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (quantidadeInsuf(idp, qnt))
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qnt, idp);
    }
    else
    {
      produtos[idp].quant -= qnt;
    }

  }

}

void removeProduto()
{
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (encomenda404(ide))
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (produto404(idp))
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      {
        produtos[idp].quant += sistema[ide].lstPrdts[idp];
        sistema[ide].peso -= sistema[ide].lstPrdts[idp] * produtos[idp].peso;
        sistema[ide].lstPrdts[idp] = 0;
      }
    }

  }

}

void custoEncomenda()
{
  int i;
  int custo = 0;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (encomenda404(ide))
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    {
      for (i = 0; i < id_prod; i++)
      {
        if (sistema[ide].lstPrdts[i] != 0)
        {
          custo += sistema[ide].lstPrdts[i] * produtos[i].preco;
        }
        else
        {
          
        }

      }

      printf("Custo da encomenda %d %d.\n", ide, custo);
    }
  }

}

void alteraCusto()
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (produto404(idp))
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    produtos[idp].preco = preco;
  }

}

void prodEncom()
{
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (encomenda404(ide))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (produto404(idp))
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      printf("%s %d.\n", produtos[idp].descr, sistema[ide].lstPrdts[idp]);
    }

  }

}

void identEncom()
{
  int idp;
  int encom = 0;
  int i;
  idp = new_sym_var(sizeof(int) * 8);
  if (produto404(idp))
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (id_encom > 0)
    {
      {
        for (i = 0; i < id_encom; i++)
        {
          if (sistema[i].lstPrdts[idp] > sistema[encom].lstPrdts[idp])
          {
            encom = i;
          }
          else
          {
            
          }

        }

        if (sistema[encom].lstPrdts[idp] > 0)
        {
          printf("Maximo produto %d %d %d.\n", idp, encom, sistema[encom].lstPrdts[idp]);
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

}

int menorPreco(int a, int b)
{
  return (produtos[a].preco < produtos[b].preco) || ((produtos[a].preco == produtos[b].preco) && (a < b));
}

int ordemAlf(int a, int b)
{
  if (strcmp(produtos[a].descr, produtos[b].descr) < 0)
  {
    return 1;
  }
  else
  {
    
  }

  return 0;
}

void listaProd()
{
  int i;
  mergesort(menorPreco, indexProd, 0, id_prod - 1);
  printf("Produtos\n");
  for (i = 0; i < id_prod; i++)
    printf("* %s %d %d\n", produtos[indexProd[i]].descr, produtos[indexProd[i]].preco, produtos[indexProd[i]].quant);

}

void listaEncom()
{
  int ide;
  int i;
  int j = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (encomenda404(ide))
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < id_prod; i++)
    if (sistema[ide].lstPrdts[i] > 0)
  {
    idpsEncom[j++] = i;
  }
  else
  {
    
  }


  mergesort(ordemAlf, idpsEncom, 0, j - 1);
  printf("Encomenda %d\n", ide);
  for (i = 0; i < j; i++)
    printf("* %s %d %d\n", produtos[idpsEncom[i]].descr, produtos[idpsEncom[i]].preco, sistema[ide].lstPrdts[idpsEncom[i]]);

}

void mergesort(int (*condicao)(int, int), int a[], int esq, int dir)
{
  int m = (esq + dir) / 2;
  if (dir <= esq)
  {
    return;
  }
  else
  {
    
  }

  mergesort(condicao, a, esq, m);
  mergesort(condicao, a, m + 1, dir);
  merge(condicao, a, esq, m, dir);
}

void merge(int (*condicao)(int, int), int a[], int esq, int m, int dir)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > esq; i--)
    aux[i - 1] = a[i - 1];

  for (j = m; j < dir; j++)
    aux[(dir + m) - j] = a[j + 1];

  for (k = esq; k <= dir; k++)
  {
    if (condicao(aux[j], aux[i]))
    {
      a[k] = aux[j--];
    }
    else
    {
      a[k] = aux[i++];
    }

  }

}

