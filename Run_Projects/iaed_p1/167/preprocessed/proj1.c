/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  int qtd;
  int preco;
  int peso;
  int id;
  char descricao[62];
} produto;
typedef struct 
{
  int id;
  int produtos[200][2];
  int peso;
} encomenda;
produto lista_prods[10000];
encomenda lista_enc[500];
int adiciona_prod(int id_prods)
{
  id_prods++;
  for (int lista_prods_index = 0; lista_prods_index < 10; lista_prods_index++)
  {
    lista_prods[id_prods].descricao[lista_prods_index] = new_sym_var(sizeof(char) * 8);
  }

  lista_prods[id_prods].descricao[10 - 1] = '\0';
  lista_prods[id_prods].preco = new_sym_var(sizeof(int) * 8);
  lista_prods[id_prods].peso = new_sym_var(sizeof(int) * 8);
  lista_prods[id_prods].qtd = new_sym_var(sizeof(int) * 8);
  lista_prods[id_prods].id = id_prods;
  printf("Novo produto %d.\n", id_prods);
  return id_prods;
}

void adiciona_stock(int id_prod)
{
  int id_stock;
  int qtd;
  id_stock = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (id_stock > id_prod)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", id_stock);
    }
  }
  else
  {
    {
      lista_prods[id_stock].qtd += qtd;
    }
  }

}

void ad_prod_enc(int id_prod, int id_enc)
{
  int i;
  int ide;
  int idp;
  int qtd;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide > id_enc)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp > id_prod)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      if (qtd > lista_prods[idp].qtd)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        }
      }
      else
      {
        if (((lista_prods[idp].peso * qtd) + lista_enc[ide].peso) > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
          }
        }
        else
        {
          {
            for (i = 0; i <= lista_enc[ide].id; i++)
            {
              if (lista_enc[ide].produtos[i][0] == idp)
              {
                {
                  lista_enc[ide].produtos[i][1] += qtd;
                  lista_enc[ide].peso += lista_prods[idp].peso * qtd;
                  lista_prods[idp].qtd -= qtd;
                  return;
                }
              }
              else
              {
                
              }

            }

            lista_enc[ide].id += 1;
            lista_enc[ide].produtos[lista_enc[ide].id][0] = idp;
            lista_enc[ide].produtos[lista_enc[ide].id][1] = qtd;
            lista_enc[ide].peso += lista_prods[idp].peso * qtd;
            lista_prods[idp].qtd -= qtd;
          }
        }

      }

    }

  }

}

void remove_stock(int id_prod)
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp > id_prod)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    if (qtd > lista_prods[idp].qtd)
    {
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      }
    }
    else
    {
      {
        lista_prods[idp].qtd -= qtd;
      }
    }

  }

}

void remove_prod_enc(int id_enc, int id_prod)
{
  int i;
  int e;
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide > id_enc)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp > id_prod)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      {
        for (i = 0; i <= lista_enc[ide].id; i++)
        {
          if (idp == lista_enc[ide].produtos[i][0])
          {
            {
              lista_prods[idp].qtd += lista_enc[ide].produtos[i][1];
              lista_enc[ide].peso -= lista_prods[idp].peso * lista_enc[ide].produtos[i][1];
              for (e = i; e < lista_enc[ide].id; e++)
              {
                lista_enc[ide].produtos[e][0] = lista_enc[ide].produtos[e + 1][0];
                lista_enc[ide].produtos[e][1] = lista_enc[ide].produtos[e + 1][1];
              }

              lista_enc[ide].id--;
            }
          }
          else
          {
            
          }

        }

      }
    }

  }

}

void cal_preco_enc(int id_enc)
{
  int i;
  int idp;
  int ide;
  int soma = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide > id_enc)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      for (i = 0; i <= lista_enc[ide].id; i++)
      {
        idp = lista_enc[ide].produtos[i][0];
        soma += lista_prods[idp].preco * lista_enc[ide].produtos[i][1];
      }

      printf("Custo da encomenda %d %d.\n", ide, soma);
    }
  }

}

void altera_preco(int id_prod)
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp > id_prod)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      lista_prods[idp].preco = preco;
    }
  }

}

void des_qtd_prod_enc(int id_enc, int id_prod)
{
  int i;
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide > id_enc)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    if (idp > id_prod)
    {
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      }
    }
    else
    {
      {
        for (i = 0; i <= lista_enc[ide].id; i++)
        {
          if (lista_enc[ide].produtos[i][0] == idp)
          {
            {
              printf("%s %d.\n", lista_prods[idp].descricao, lista_enc[ide].produtos[i][1]);
              return;
            }
          }
          else
          {
            
          }

        }

        printf("%s %d.\n", lista_prods[idp].descricao, 0);
      }
    }

  }

}

void max_prod_enc(int id_prod, int id_enc)
{
  int e;
  int i;
  int idp;
  int id_prod_max = -1;
  int qtd_max = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp > id_prod)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      for (i = 0; i <= id_enc; i++)
      {
        for (e = 0; e <= lista_enc[i].id; e++)
        {
          if ((lista_enc[i].produtos[e][0] == idp) && (lista_enc[i].produtos[e][1] > qtd_max))
          {
            {
              qtd_max = lista_enc[i].produtos[e][1];
              id_prod_max = i;
            }
          }
          else
          {
            
          }

        }

      }

      if (id_prod_max != (-1))
      {
        {
          printf("Maximo produto %d %d %d.\n", idp, id_prod_max, qtd_max);
        }
      }
      else
      {
        
      }

    }
  }

}

produto aux[10000];
produto lista_ord[10000];
void merge(produto lista[], int left, int m, int right, char ctrl)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
  {
    aux[i - 1] = lista[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux[(right + m) - j] = lista[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if (ctrl == 'l')
    {
      {
        if (lista_prods[aux[j].id].preco < lista_prods[aux[i].id].preco)
        {
          {
            lista[k].id = aux[j--].id;
          }
        }
        else
        {
          if (lista_prods[aux[j].id].preco == lista_prods[aux[i].id].preco)
          {
            {
              if (aux[j].id < aux[i].id)
              {
                {
                  lista[k].id = aux[j--].id;
                }
              }
              else
              {
                {
                  lista[k].id = aux[i++].id;
                }
              }

            }
          }
          else
          {
            {
              lista[k].id = aux[i++].id;
            }
          }

        }

      }
    }
    else
    {
      {
        if (strcmp(lista_prods[aux[j].id].descricao, lista_prods[aux[i].id].descricao) < 0)
        {
          {
            lista[k] = aux[j--];
          }
        }
        else
        {
          {
            lista[k] = aux[i++];
          }
        }

      }
    }

  }

}

void mergesort(produto lista[], int left, int right, char ctrl)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  mergesort(lista, left, m, ctrl);
  mergesort(lista, m + 1, right, ctrl);
  merge(lista, left, m, right, ctrl);
}

void prod_por_preco(int id_prod)
{
  int i;
  for (i = 0; i <= id_prod; i++)
  {
    lista_ord[i].id = lista_prods[i].id;
  }

  mergesort(lista_ord, 0, id_prod, 'l');
  printf("Produtos\n");
  for (i = 0; i <= id_prod; i++)
  {
    printf("* %s %d %d\n", lista_prods[lista_ord[i].id].descricao, lista_prods[lista_ord[i].id].preco, lista_prods[lista_ord[i].id].qtd);
  }

}

void prod_enc_nome(int id_enc)
{
  int i;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide > id_enc)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      for (i = 0; i <= lista_enc[ide].id; i++)
      {
        lista_ord[i].id = lista_enc[ide].produtos[i][0];
        lista_ord[i].qtd = lista_enc[ide].produtos[i][1];
      }

      mergesort(lista_ord, 0, lista_enc[ide].id, 'L');
      printf("Encomenda %d\n", ide);
      for (i = 0; i <= lista_enc[ide].id; i++)
      {
        printf("* %s %d %d\n", lista_prods[lista_ord[i].id].descricao, lista_prods[lista_ord[i].id].preco, lista_ord[i].qtd);
      }

    }
  }

}

int main()
{
  char caracter;
  int i;
  int id_prod = -1;
  int id_enc = -1;
  for (i = 0; i < 500; i++)
  {
    lista_enc[i].id = -1;
  }

  caracter = getchar();
  while (caracter != 'x')
  {
    switch (caracter)
    {
      case 'a':
        id_prod = adiciona_prod(id_prod);
        break;

      case 'q':
        adiciona_stock(id_prod);
        break;

      case 'N':
        id_enc++;
        printf("Nova encomenda %d.\n", id_enc);
        break;

      case 'A':
        ad_prod_enc(id_prod, id_enc);
        break;

      case 'r':
        remove_stock(id_prod);
        break;

      case 'R':
        remove_prod_enc(id_enc, id_prod);
        break;

      case 'C':
        cal_preco_enc(id_enc);
        break;

      case 'p':
        altera_preco(id_prod);
        break;

      case 'E':
        des_qtd_prod_enc(id_enc, id_prod);
        break;

      case 'm':
        max_prod_enc(id_prod, id_enc);
        break;

      case 'l':
        prod_por_preco(id_prod);
        break;

      case 'L':
        prod_enc_nome(id_enc);
        break;

    }

    caracter = getchar();
  }

  return 0;
}

