/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int idp;
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
} produto;
produto sistemap[10000] = {0};
produto sistemae[500][10000] = {0};
produto sistemap_organizado[10000] = {0};
produto sistemap_organizado_aux[10000] = {0};
produto vetor_produtos_encomenda[10000] = {0};
produto vetor_produtos_encomenda_aux[10000] = {0};
void adiciona_produto(int i)
{
  for (int sistemap_index = 0; sistemap_index < 10; sistemap_index++)
  {
    sistemap[i].descricao[sistemap_index] = new_sym_var(sizeof(char) * 8);
  }

  sistemap[i].descricao[10 - 1] = '\0';
  sistemap[i].preco = new_sym_var(sizeof(int) * 8);
  sistemap[i].peso = new_sym_var(sizeof(int) * 8);
  sistemap[i].quantidade = new_sym_var(sizeof(int) * 8);
  sistemap[i].idp = i;
}

void adiciona_stock(int idp)
{
  int quantidade;
  int idp_dado;
  idp_dado = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_dado)
  {
    {
      sistemap[idp_dado].quantidade += quantidade;
    }
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp_dado);
    }
  }

}

void remove_stock(int idp)
{
  int idp_dado;
  int quantidade_dada;
  idp_dado = new_sym_var(sizeof(int) * 8);
  quantidade_dada = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_dado)
  {
    {
      if (sistemap[idp_dado].quantidade >= quantidade_dada)
      {
        {
          sistemap[idp_dado].quantidade = sistemap[idp_dado].quantidade - quantidade_dada;
        }
      }
      else
      {
        {
          printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidade_dada, idp_dado);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp_dado);
    }
  }

}

void altera_preco(int idp)
{
  int idp_dado;
  int preco;
  idp_dado = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_dado)
  {
    {
      sistemap[idp_dado].preco = preco;
    }
  }
  else
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp_dado);
    }
  }

}

void adiciona_produto_a_encomenda(int idp, int ide)
{
  int ide_dado;
  int idp_dado;
  int quantidade_dada;
  int i;
  int peso_tot = 0;
  ide_dado = new_sym_var(sizeof(int) * 8);
  idp_dado = new_sym_var(sizeof(int) * 8);
  quantidade_dada = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_dado)
  {
    {
      if (idp >= idp_dado)
      {
        {
          if (sistemap[idp_dado].quantidade >= quantidade_dada)
          {
            {
              peso_tot = peso_tot + (quantidade_dada * sistemap[idp_dado].peso);
              for (i = 0; i < 10000; i++)
              {
                peso_tot = peso_tot + (sistemap[i].peso * sistemae[ide_dado][i].quantidade);
              }

              if (peso_tot <= 200)
              {
                {
                  sistemae[ide_dado][idp_dado].quantidade += quantidade_dada;
                  sistemap[idp_dado].quantidade = sistemap[idp_dado].quantidade - quantidade_dada;
                }
              }
              else
              {
                {
                  printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp_dado, ide_dado);
                }
              }

            }
          }
          else
          {
            {
              printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp_dado, ide_dado);
            }
          }

        }
      }
      else
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp_dado, ide_dado);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp_dado, ide_dado);
    }
  }

}

void remove_produto_da_encomenda(int ide, int idp)
{
  int ide_dado;
  int idp_dado;
  ide_dado = new_sym_var(sizeof(int) * 8);
  idp_dado = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_dado)
  {
    {
      if (idp >= idp_dado)
      {
        {
          sistemap[idp_dado].quantidade = sistemap[idp_dado].quantidade + sistemae[ide_dado][idp_dado].quantidade;
          sistemae[ide_dado][idp_dado].quantidade = 0;
        }
      }
      else
      {
        {
          printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp_dado, ide_dado);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp_dado, ide_dado);
    }
  }

}

void custo_encomenda(int ide)
{
  int ide_dado;
  int custo = 0;
  int i;
  ide_dado = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_dado)
  {
    {
      for (i = 0; i < 10000; i++)
      {
        custo += sistemap[i].preco * sistemae[ide_dado][i].quantidade;
      }

      printf("Custo da encomenda %d %d.\n", ide_dado, custo);
    }
  }
  else
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide_dado);
    }
  }

}

void lista_produto_de_encomenda(int ide, int idp)
{
  int ide_dado;
  int idp_dado;
  ide_dado = new_sym_var(sizeof(int) * 8);
  idp_dado = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_dado)
  {
    {
      if (idp >= idp_dado)
      {
        {
          printf("%s %d.\n", sistemap[idp_dado].descricao, sistemae[ide_dado][idp_dado].quantidade);
        }
      }
      else
      {
        {
          printf("Impossivel listar produto %d. Produto inexistente.\n", idp_dado);
        }
      }

    }
  }
  else
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide_dado);
    }
  }

}

void maior_produto(int idp)
{
  int idp_dado;
  int maior = 0;
  int i;
  int ide_menor = 0;
  idp_dado = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_dado)
  {
    {
      for (i = 0; i < 500; i++)
      {
        if (sistemae[i][idp_dado].quantidade > maior)
        {
          {
            maior = sistemae[i][idp_dado].quantidade;
            ide_menor = i;
          }
        }
        else
        {
          
        }

      }

      if (maior != 0)
      {
        {
          printf("Maximo produto %d %d %d.\n", idp_dado, ide_menor, maior);
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp_dado);
    }
  }

}

void merge_ordena_produtos(produto sistemap_organizado[], int left, int meio, int right)
{
  int i;
  int j;
  int k;
  for (i = meio + 1; i > left; i--)
  {
    sistemap_organizado_aux[i - 1] = sistemap_organizado[i - 1];
  }

  for (j = meio; j < right; j++)
  {
    sistemap_organizado_aux[(right + meio) - j] = sistemap_organizado[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if (sistemap_organizado_aux[j].preco < sistemap_organizado_aux[i].preco)
    {
      {
        sistemap_organizado[k] = sistemap_organizado_aux[j--];
      }
    }
    else
    {
      if (sistemap_organizado_aux[j].preco > sistemap_organizado_aux[i].preco)
      {
        {
          sistemap_organizado[k] = sistemap_organizado_aux[i++];
        }
      }
      else
      {
        {
          if (sistemap_organizado_aux[j].idp < sistemap_organizado_aux[i].idp)
          {
            {
              sistemap_organizado[k] = sistemap_organizado_aux[j--];
            }
          }
          else
          {
            {
              sistemap_organizado[k] = sistemap_organizado_aux[i++];
            }
          }

        }
      }

    }

  }

}

void mergesort_ordena_produtos(produto sistemap_organizado[], int left, int right)
{
  int meio = (left + right) / 2;
  ;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_ordena_produtos(sistemap_organizado, left, meio);
  mergesort_ordena_produtos(sistemap_organizado, meio + 1, right);
  merge_ordena_produtos(sistemap_organizado, left, meio, right);
}

void ordena_produtos(int idp)
{
  int i;
  for (i = 0; i <= idp; i++)
  {
    sistemap_organizado[i] = sistemap[i];
  }

  mergesort_ordena_produtos(sistemap_organizado, 0, idp);
  printf("Produtos\n");
  for (i = 0; i <= idp; i++)
  {
    printf("* %s %d %d\n", sistemap_organizado[i].descricao, sistemap_organizado[i].preco, sistemap_organizado[i].quantidade);
  }

}

void merge_ordena_encomenda(produto vetor_produtos_encomenda[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    vetor_produtos_encomenda_aux[i - 1] = vetor_produtos_encomenda[i - 1];

  for (j = m; j < right; j++)
    vetor_produtos_encomenda_aux[(right + m) - j] = vetor_produtos_encomenda[j + 1];

  for (k = left; k <= right; k++)
    if (strcmp(vetor_produtos_encomenda_aux[j].descricao, vetor_produtos_encomenda_aux[i].descricao) < 0)
  {
    vetor_produtos_encomenda[k] = vetor_produtos_encomenda_aux[j--];
  }
  else
  {
    vetor_produtos_encomenda[k] = vetor_produtos_encomenda_aux[i++];
  }


}

void mergesort_ordena_encomenda(produto vetor_produtos_encomenda[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_ordena_encomenda(vetor_produtos_encomenda, left, m);
  mergesort_ordena_encomenda(vetor_produtos_encomenda, m + 1, right);
  merge_ordena_encomenda(vetor_produtos_encomenda, left, m, right);
}

void ordena_encomenda(int ide, int idp)
{
  int ide_dado;
  int i;
  ide_dado = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_dado)
  {
    {
      printf("Encomenda %d\n", ide_dado);
      for (i = 0; i <= idp; i++)
      {
        vetor_produtos_encomenda[i] = sistemap[i];
      }

      mergesort_ordena_encomenda(vetor_produtos_encomenda, 0, idp);
      for (i = 0; i <= idp; i++)
      {
        if (sistemae[ide_dado][vetor_produtos_encomenda[i].idp].quantidade != 0)
        {
          {
            printf("* %s %d %d\n", vetor_produtos_encomenda[i].descricao, vetor_produtos_encomenda[i].preco, sistemae[ide_dado][vetor_produtos_encomenda[i].idp].quantidade);
          }
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide_dado);
    }
  }

}

int main()
{
  int car;
  int idp = -1;
  int i = 0;
  int ide = -1;
  int j = 0;
  while ((car = getchar()) != 'x')
  {
    switch (car)
    {
      case 'a':
        if (i < 10000)
      {
        {
          adiciona_produto(i);
          idp = i;
          printf("Novo produto %d.\n", idp);
          i++;
        }
      }
      else
      {
        
      }

        break;

      case 'q':
        adiciona_stock(idp);
        break;

      case 'N':
        if (j < 500)
      {
        {
          ide = j;
          printf("Nova encomenda %d.\n", ide);
          j++;
        }
      }
      else
      {
        
      }

        break;

      case 'r':
        remove_stock(idp);
        break;

      case 'p':
        altera_preco(idp);
        break;

      case 'A':
        adiciona_produto_a_encomenda(idp, ide);
        break;

      case 'R':
        remove_produto_da_encomenda(ide, idp);
        break;

      case 'C':
        custo_encomenda(ide);
        break;

      case 'E':
        lista_produto_de_encomenda(ide, idp);
        break;

      case 'm':
        maior_produto(idp);
        break;

      case 'l':
        ordena_produtos(idp);
        break;

      case 'L':
        ordena_encomenda(ide, idp);
        break;

      case 'x':
        break;

    }

  }

  return 0;
}

