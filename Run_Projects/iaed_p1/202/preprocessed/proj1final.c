/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int id;
  char descricao[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct order
{
  int id;
  produto produtos[200];
  int preco;
} order;
order conj_encomendas[500];
produto armazem[10000];
int cont;
int n;
void adiciona_novo_produto()
{
  produto p;
  for (int p_index = 0; p_index < 10; p_index++)
  {
    p.descricao[p_index] = new_sym_var(sizeof(char) * 8);
  }

  p.descricao[10 - 1] = '\0';
  p.preco = new_sym_var(sizeof(int) * 8);
  p.peso = new_sym_var(sizeof(int) * 8);
  p.qtd = new_sym_var(sizeof(int) * 8);
  p.id = cont;
  armazem[cont] = p;
  printf("Novo produto %d.\n", p.id);
  cont++;
}

void adiciona_stock()
{
  int possivel_qtd = 0;
  int idp_inserido = 0;
  idp_inserido = new_sym_var(sizeof(int) * 8);
  possivel_qtd = new_sym_var(sizeof(int) * 8);
  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp_inserido);
    }
  }
  else
  {
    {
      armazem[idp_inserido].qtd += possivel_qtd;
    }
  }

}

void remove_stock()
{
  int qtd_inserida = 0;
  int idp_inserido = 0;
  idp_inserido = new_sym_var(sizeof(int) * 8);
  qtd_inserida = new_sym_var(sizeof(int) * 8);
  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp_inserido);
      return;
    }
  }
  else
  {
    
  }

  if (qtd_inserida > armazem[idp_inserido].qtd)
  {
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd_inserida, idp_inserido);
      return;
    }
  }
  else
  {
    {
      armazem[idp_inserido].qtd -= qtd_inserida;
    }
  }

  return;
}

void altera_precos()
{
  int idp_inserido;
  int novo_preco;
  idp_inserido = new_sym_var(sizeof(int) * 8);
  novo_preco = new_sym_var(sizeof(int) * 8);
  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp_inserido);
    }
  }
  else
  {
    {
      armazem[idp_inserido].preco = novo_preco;
    }
  }

}

void func_auxiliar(int n)
{
  int i = 0;
  for (i = 0; i < 200; i++)
  {
    conj_encomendas[n].produtos[i].id = -1;
  }

}

void cria_nova_encomenda()
{
  if (n < 500)
  {
    {
      conj_encomendas[n].id = n;
      func_auxiliar(n);
      printf("Nova encomenda %d.\n", n);
      n++;
    }
  }
  else
  {
    
  }

}

int calcula_peso(int ide_inserido, int idp_inserido, int qtd_a_inserir)
{
  int i = 0;
  int soma = 0;
  int peso_total = 0;
  for (i = 0; i < 200; i++)
  {
    if (conj_encomendas[ide_inserido].produtos[i].id > (-1))
    {
      {
        soma += conj_encomendas[ide_inserido].produtos[i].qtd * armazem[conj_encomendas[ide_inserido].produtos[i].id].peso;
      }
    }
    else
    {
      {
        continue;
      }
    }

  }

  peso_total = (armazem[idp_inserido].peso * qtd_a_inserir) + soma;
  return peso_total;
}

void adiciona_produto_a_encomenda()
{
  int ide_inserido = 0;
  int idp_inserido = 0;
  int qtd_a_inserir = 0;
  int i = 0;
  int peso_total = 0;
  ide_inserido = new_sym_var(sizeof(int) * 8);
  idp_inserido = new_sym_var(sizeof(int) * 8);
  qtd_a_inserir = new_sym_var(sizeof(int) * 8);
  if ((ide_inserido >= n) || (ide_inserido < 0))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  if (armazem[idp_inserido].qtd < qtd_a_inserir)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  peso_total = calcula_peso(ide_inserido, idp_inserido, qtd_a_inserir);
  if (peso_total > 200)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    {
      for (i = 0; i < 200; i++)
      {
        if (conj_encomendas[ide_inserido].produtos[i].id == idp_inserido)
        {
          {
            conj_encomendas[ide_inserido].produtos[i].qtd += qtd_a_inserir;
            armazem[idp_inserido].qtd -= qtd_a_inserir;
            return;
          }
        }
        else
        {
          if (conj_encomendas[ide_inserido].produtos[i].id == (-1))
          {
            {
              conj_encomendas[ide_inserido].produtos[i].id = idp_inserido;
              strcpy(conj_encomendas[ide_inserido].produtos[i].descricao, armazem[idp_inserido].descricao);
              conj_encomendas[ide_inserido].produtos[i].qtd = qtd_a_inserir;
              conj_encomendas[ide_inserido].produtos[i].preco = armazem[idp_inserido].preco;
              conj_encomendas[ide_inserido].produtos[i].peso = armazem[idp_inserido].peso;
              break;
            }
          }
          else
          {
            
          }

        }

      }

    }
  }

  armazem[idp_inserido].qtd -= qtd_a_inserir;
  return;
}

void remove_produto_encomenda()
{
  int ide_inserido = 0;
  int idp_inserido = 0;
  int i = 0;
  int posicao = -1;
  ide_inserido = new_sym_var(sizeof(int) * 8);
  idp_inserido = new_sym_var(sizeof(int) * 8);
  if ((ide_inserido >= n) || (ide_inserido < 0))
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp_inserido, ide_inserido);
      return;
    }
  }
  else
  {
    {
      for (i = 0; i < 200; i++)
      {
        if (conj_encomendas[ide_inserido].produtos[i].id == idp_inserido)
        {
          {
            posicao = i;
            armazem[idp_inserido].qtd += conj_encomendas[ide_inserido].produtos[i].qtd;
            break;
          }
        }
        else
        {
          
        }

      }

      if (posicao != (-1))
      {
        {
          for (i = posicao + 1; i < 200; i++)
          {
            conj_encomendas[ide_inserido].produtos[i - 1].id = conj_encomendas[ide_inserido].produtos[i].id;
            conj_encomendas[ide_inserido].produtos[i - 1].qtd = conj_encomendas[ide_inserido].produtos[i].qtd;
            conj_encomendas[ide_inserido].produtos[i - 1].preco = conj_encomendas[ide_inserido].produtos[i].preco;
            conj_encomendas[ide_inserido].produtos[i - 1].peso = conj_encomendas[ide_inserido].produtos[i].peso;
            strcpy(conj_encomendas[ide_inserido].produtos[i - 1].descricao, conj_encomendas[ide_inserido].produtos[i].descricao);
            if (conj_encomendas[ide_inserido].produtos[i].id == (-1))
            {
              {
                break;
              }
            }
            else
            {
              
            }

            if (i == 200)
            {
              {
                conj_encomendas[ide_inserido].produtos[i].id = -1;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        
      }

    }
  }

  return;
}

void calcula_custo_encomenda()
{
  int ide_inserido;
  int i = 0;
  int soma = 0;
  ide_inserido = new_sym_var(sizeof(int) * 8);
  if ((ide_inserido < n) && (ide_inserido >= 0))
  {
    {
      for (i = 0; i < 200; i++)
      {
        if (conj_encomendas[ide_inserido].produtos[i].id > (-1))
        {
          {
            soma += conj_encomendas[ide_inserido].produtos[i].qtd * armazem[conj_encomendas[ide_inserido].produtos[i].id].preco;
          }
        }
        else
        {
          {
            break;
          }
        }

      }

      printf("Custo da encomenda %d %d.\n", ide_inserido, soma);
      return;
    }
  }
  else
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide_inserido);
      return;
    }
  }

  return;
}

void avaliadora_qtd_produto()
{
  int idp_inserido = 0;
  int i = 0;
  int qtd_cmp = 0;
  int ide_cmp = 0;
  int j = 0;
  idp_inserido = new_sym_var(sizeof(int) * 8);
  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp_inserido);
      return;
    }
  }
  else
  {
    {
      for (i = 0; i < n; i++)
      {
        for (j = 0; j < 200; j++)
        {
          if ((conj_encomendas[i].produtos[j].id == idp_inserido) && (conj_encomendas[i].produtos[j].qtd > qtd_cmp))
          {
            {
              ide_cmp = i;
              qtd_cmp = conj_encomendas[i].produtos[j].qtd;
            }
          }
          else
          {
            
          }

        }

      }

    }
  }

  if (qtd_cmp > 0)
  {
    {
      printf("Maximo produto %d %d %d.\n", idp_inserido, ide_cmp, qtd_cmp);
    }
  }
  else
  {
    
  }

  return;
}

void lista_descricao_qtd()
{
  int ide_inserido = 0;
  int idp_inserido = 0;
  int i = 0;
  ide_inserido = new_sym_var(sizeof(int) * 8);
  idp_inserido = new_sym_var(sizeof(int) * 8);
  if ((ide_inserido >= n) || (ide_inserido < 0))
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  if ((idp_inserido >= cont) || (idp_inserido < 0))
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp_inserido);
      return;
    }
  }
  else
  {
    {
      for (i = 0; i < 200; i++)
      {
        if (conj_encomendas[ide_inserido].produtos[i].id == idp_inserido)
        {
          {
            printf("%s %d.\n", conj_encomendas[ide_inserido].produtos[i].descricao, conj_encomendas[ide_inserido].produtos[i].qtd);
            return;
          }
        }
        else
        {
          {
            continue;
          }
        }

      }

      printf("%s %d.\n", armazem[idp_inserido].descricao, 0);
      return;
    }
  }

  return;
}

int aux[10000];
void merge_preco(int vetor[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
  {
    aux[i - 1] = vetor[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux[(right + m) - j] = vetor[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if ((armazem[aux[j]].preco < armazem[aux[i]].preco) || (i > m))
    {
      {
        vetor[k] = aux[j--];
      }
    }
    else
    {
      {
        vetor[k] = aux[i++];
      }
    }

  }

}

void mergesort1(int vetor[], int left, int right)
{
  int m = (left + right) / 2;
  if (right <= left)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  mergesort1(vetor, left, m);
  mergesort1(vetor, m + 1, right);
  merge_preco(vetor, left, m, right);
}

void lista_produtos_preco()
{
  int i = 0;
  int j = 0;
  int vetor[10000];
  for (i = 0; i < cont; i++)
  {
    vetor[i] = i;
  }

  mergesort1(vetor, 0, cont - 1);
  printf("Produtos\n");
  for (j = 0; j < cont; j++)
  {
    printf("* %s %d %d\n", armazem[vetor[j]].descricao, armazem[vetor[j]].preco, armazem[vetor[j]].qtd);
  }

}

void lista_descricao()
{
  int ide_inserido = 0;
  int i = 0;
  int j = 0;
  int k = 0;
  produto aux;
  ide_inserido = new_sym_var(sizeof(int) * 8);
  if ((ide_inserido >= n) || (ide_inserido < 0))
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide_inserido);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (conj_encomendas[ide_inserido].produtos[i].id == (-1))
    {
      {
        break;
      }
    }
    else
    {
      
    }

    for (j = i + 1; j < 200; j++)
    {
      if (conj_encomendas[ide_inserido].produtos[j].id == (-1))
      {
        {
          break;
        }
      }
      else
      {
        
      }

      if (strcmp(conj_encomendas[ide_inserido].produtos[i].descricao, conj_encomendas[ide_inserido].produtos[j].descricao) > 0)
      {
        {
          aux = conj_encomendas[ide_inserido].produtos[i];
          conj_encomendas[ide_inserido].produtos[i] = conj_encomendas[ide_inserido].produtos[j];
          conj_encomendas[ide_inserido].produtos[j] = aux;
        }
      }
      else
      {
        
      }

    }

  }

  printf("Encomenda %d\n", ide_inserido);
  for (k = 0; k < 200; k++)
  {
    if (conj_encomendas[ide_inserido].produtos[k].id > (-1))
    {
      {
        printf("* %s %d %d\n", armazem[conj_encomendas[ide_inserido].produtos[k].id].descricao, armazem[conj_encomendas[ide_inserido].produtos[k].id].preco, conj_encomendas[ide_inserido].produtos[k].qtd);
      }
    }
    else
    {
      
    }

  }

}

void menu_informativo()
{
  printf("                 M E N U\n\n");
  printf("Comando                        Acao.\n\n");
  printf("  a               Adiciona um produto ao armazem.\n\n");
  printf("  A               Adiciona um produto a uma encomenda.\n\n");
  printf("  q               Adciona stock de um produto ao armazem.\n\n");
  printf("  r               Remove stock de um produto em armazem.\n\n");
  printf("  R               Remove um produto de uma encomenda.\n\n");
  printf("  C               Calcula o preco de uma encomenda.\n\n");
  printf("  E               Imprime descricao e quantidade de produto numa encomenda.\n\n");
  printf("  m               Encomenda de maior quantidade de um produto.\n\n");
  printf("  l               Lista os produtos do armazem por ordem (crescente) de preco.\n\n");
  printf("  L               Lista os produtos de uma encomenda por ordem alfabetica.\n\n");
  printf("ENTER             Acede a menu informativo.\n\n");
  printf("  x               QUIT.\n\n");
  return;
}

int main()
{
  int comando;
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        adiciona_novo_produto();
        break;

      case 'q':
        adiciona_stock();
        break;

      case 'r':
        remove_stock();
        break;

      case 'p':
        altera_precos();
        break;

      case 'N':
        cria_nova_encomenda();
        break;

      case 'A':
        adiciona_produto_a_encomenda();
        break;

      case 'R':
        remove_produto_encomenda();
        break;

      case 'C':
        calcula_custo_encomenda();
        break;

      case 'E':
        lista_descricao_qtd();
        break;

      case 'm':
        avaliadora_qtd_produto();
        break;

      case 'l':
        lista_produtos_preco();
        break;

      case 'L':
        lista_descricao();
        break;

    }

  }

  return 0;
}

