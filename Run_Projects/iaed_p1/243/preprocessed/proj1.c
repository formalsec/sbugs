/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct 
{
  int idp;
  char descricao[65];
  int preco;
  int peso;
  int quantidadeEmStock;
} Produto;
typedef struct 
{
  int ide;
  int pesoatual;
  int quantidadeatual;
  int precototal;
  Produto arrayprodutos[200];
  int produtosporencomenda;
} Encomenda;
const char delimitators[] = ":";
Produto produtos[10000];
Encomenda encomenda[500];
int numeroDeProdutos = 0;
int numeroDeEncomendas = 0;
char input[1000];
int AdicionaProduto();
int AdicionaStock();
void CriaEncomenda();
int AddProdutoEncomenda();
int RemoveStockProduto();
int RemoveProduto();
int CalculaCusto();
int AlteraPreco();
int RetornaDescricaoQuantidade();
int RetornaID();
void ListaPreco();
int ListaAlfabeticamente();
int main()
{
  char comando;
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        AdicionaProduto();
        break;

      case 'q':
        AdicionaStock();
        break;

      case 'r':
        RemoveStockProduto();
        break;

      case 'N':
        CriaEncomenda();
        break;

      case 'A':
        AddProdutoEncomenda();
        break;

      case 'R':
        RemoveProduto();
        break;

      case 'C':
        CalculaCusto();
        break;

      case 'p':
        AlteraPreco();
        break;

      case 'E':
        RetornaDescricaoQuantidade();
        break;

      case 'm':
        RetornaID();
        break;

      case 'l':
        ListaPreco();
        break;

      case 'L':
        ListaAlfabeticamente();

    }

  }

  return 0;
}

int AdicionaProduto()
{
  Produto tmp_produto;
  char *token;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  strcpy(tmp_produto.descricao, token);
  token = strtok(0, delimitators);
  tmp_produto.preco = atoi(token);
  token = strtok(0, delimitators);
  tmp_produto.peso = atoi(token);
  token = strtok(0, delimitators);
  tmp_produto.quantidadeEmStock = atoi(token);
  strcpy(produtos[numeroDeProdutos].descricao, tmp_produto.descricao);
  produtos[numeroDeProdutos].preco = tmp_produto.preco;
  produtos[numeroDeProdutos].peso = tmp_produto.peso;
  produtos[numeroDeProdutos].quantidadeEmStock = tmp_produto.quantidadeEmStock;
  produtos[numeroDeProdutos].idp = numeroDeProdutos;
  printf("Novo produto %d.\n", produtos[numeroDeProdutos].idp);
  numeroDeProdutos++;
  return 0;
}

int AdicionaStock()
{
  int i = 0;
  char *token;
  int nidp;
  int nquantidade;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nidp = atoi(token);
  token = strtok(0, delimitators);
  nquantidade = atoi(token);
  for (i = 0; i < numeroDeProdutos; i++)
  {
    if (nidp == produtos[i].idp)
    {
      {
        produtos[i].quantidadeEmStock += nquantidade;
        return 1;
      }
    }
    else
    {
      
    }

  }

  printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", nidp);
  return 0;
}

void CriaEncomenda()
{
  encomenda[numeroDeEncomendas].ide = numeroDeEncomendas;
  printf("Nova encomenda %d.\n", encomenda[numeroDeEncomendas].ide);
  numeroDeEncomendas++;
}

int AddProdutoEncomenda()
{
  char *token;
  int nide;
  int nidp;
  int nquantidade;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nide = atoi(token);
  token = strtok(0, delimitators);
  nidp = atoi(token);
  token = strtok(0, delimitators);
  nquantidade = atoi(token);
  if ((nide == encomenda[nide].ide) && (numeroDeEncomendas > 0))
  {
    {
      if ((nidp == produtos[nidp].idp) && (numeroDeProdutos > 0))
      {
        {
          if ((produtos[nidp].quantidadeEmStock - nquantidade) >= 0)
          {
            {
              if ((encomenda[nide].pesoatual + (nquantidade * produtos[nidp].peso)) <= 200)
              {
                {
                  encomenda[nide].arrayprodutos[nidp].idp = produtos[nidp].idp;
                  encomenda[nide].arrayprodutos[nidp].quantidadeEmStock += nquantidade;
                  strcpy(encomenda[nide].arrayprodutos[nidp].descricao, produtos[nidp].descricao);
                  produtos[nidp].quantidadeEmStock -= nquantidade;
                  encomenda[nide].precototal += nquantidade * produtos[nidp].preco;
                  encomenda[nide].pesoatual += nquantidade * produtos[nidp].peso;
                  return 1;
                }
              }
              else
              {
                
              }

              printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", nidp, nide);
              return 0;
            }
          }
          else
          {
            
          }

          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", nidp, nide);
          return 0;
        }
      }
      else
      {
        
      }

      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", nidp, nide);
      return 0;
    }
  }
  else
  {
    
  }

  printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", nidp, nide);
  return 0;
}

int RemoveStockProduto()
{
  int i = 0;
  char *token;
  int nidp;
  int nquantidade;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nidp = atoi(token);
  token = strtok(0, delimitators);
  nquantidade = atoi(token);
  for (i = 0; i < 10000; i++)
  {
    if ((nidp == produtos[i].idp) && (numeroDeProdutos > 0))
    {
      {
        if ((produtos[i].quantidadeEmStock - nquantidade) >= 0)
        {
          {
            produtos[i].quantidadeEmStock -= nquantidade;
            return 1;
            break;
          }
        }
        else
        {
          {
            printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", nquantidade, produtos[i].idp);
            return 0;
          }
        }

      }
    }
    else
    {
      
    }

  }

  printf("Impossivel remover stock do produto %d. Produto inexistente.\n", nidp);
  return 0;
}

int RemoveProduto()
{
  char *token;
  int nide;
  int nidp;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nide = atoi(token);
  token = strtok(0, delimitators);
  nidp = atoi(token);
  if ((nide == encomenda[nide].ide) && (numeroDeEncomendas > 0))
  {
    {
      if ((nidp == produtos[nidp].idp) && (numeroDeProdutos > 0))
      {
        {
          encomenda[nide].precototal -= encomenda[nide].arrayprodutos[nidp].quantidadeEmStock * produtos[nidp].preco;
          encomenda[nide].pesoatual -= encomenda[nide].arrayprodutos[nidp].quantidadeEmStock * produtos[nidp].peso;
          produtos[nidp].quantidadeEmStock += encomenda[nide].arrayprodutos[nidp].quantidadeEmStock;
          encomenda[nide].arrayprodutos[nidp].preco = 0;
          encomenda[nide].arrayprodutos[nidp].peso = 0;
          encomenda[nide].arrayprodutos[nidp].quantidadeEmStock = 0;
          return 1;
        }
      }
      else
      {
        
      }

      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", nidp, nide);
      return 0;
    }
  }
  else
  {
    
  }

  printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", nidp, nide);
  return 0;
}

int CalculaCusto()
{
  char *token;
  int nide;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nide = atoi(token);
  if (nide == encomenda[nide].ide)
  {
    {
      printf("Custo da encomenda %d %d.\n", nide, encomenda[nide].precototal);
      return 1;
    }
  }
  else
  {
    
  }

  printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", nide);
  return 0;
}

int AlteraPreco()
{
  char *token;
  int nidp;
  int npreco;
  int i;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nidp = atoi(token);
  token = strtok(0, delimitators);
  npreco = atoi(token);
  if (nidp == produtos[nidp].idp)
  {
    {
      for (i = 0; i < numeroDeEncomendas; i++)
      {
        if (nidp == encomenda[i].arrayprodutos[nidp].idp)
        {
          {
            encomenda[i].precototal -= produtos[nidp].preco * encomenda[i].arrayprodutos[nidp].quantidadeEmStock;
            encomenda[i].precototal += npreco * encomenda[i].arrayprodutos[nidp].quantidadeEmStock;
          }
        }
        else
        {
          
        }

      }

      produtos[nidp].preco = npreco;
      return 1;
    }
  }
  else
  {
    
  }

  printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", nidp);
  return 0;
}

int RetornaDescricaoQuantidade()
{
  char *token;
  int nide;
  int nidp;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nide = atoi(token);
  token = strtok(0, delimitators);
  nidp = atoi(token);
  if ((nide == encomenda[nide].ide) && (numeroDeEncomendas > 0))
  {
    {
      if ((nidp == produtos[nidp].idp) && (numeroDeProdutos > 0))
      {
        {
          printf("%s %d.\n", produtos[nidp].descricao, encomenda[nide].arrayprodutos[nidp].quantidadeEmStock);
          return 1;
        }
      }
      else
      {
        
      }

      printf("Impossivel listar produto %d. Produto inexistente.\n", nidp);
      return 0;
    }
  }
  else
  {
    
  }

  printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", nide);
  return 0;
}

int RetornaID()
{
  char *token;
  int nidp;
  int i;
  int max = 0;
  int idencomenda = 0;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nidp = atoi(token);
  if ((nidp == produtos[nidp].idp) && (numeroDeProdutos > 0))
  {
    {
      for (i = 0; i < numeroDeEncomendas; i++)
      {
        if ((encomenda[i].arrayprodutos[nidp].quantidadeEmStock > max) && (nidp == encomenda[i].arrayprodutos[nidp].idp))
        {
          {
            max = encomenda[i].arrayprodutos[nidp].quantidadeEmStock;
            idencomenda = encomenda[i].ide;
          }
        }
        else
        {
          
        }

      }

      if (max != 0)
      {
        {
          printf("Maximo produto %d %d %d.\n", nidp, idencomenda, max);
          return 1;
        }
      }
      else
      {
        {
          return 0;
        }
      }

    }
  }
  else
  {
    
  }

  printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", nidp);
  return 0;
}

void ListaPreco()
{
  int i;
  int d;
  Produto tmp_produto;
  for (i = 0; i < (numeroDeProdutos - 1); i++)
  {
    for (d = 0; d < ((numeroDeProdutos - i) - 1); d++)
    {
      if (produtos[d].preco > produtos[d + 1].preco)
      {
        {
          tmp_produto = produtos[d];
          produtos[d] = produtos[d + 1];
          produtos[d + 1] = tmp_produto;
        }
      }
      else
      {
        
      }

    }

  }

  printf("Produtos\n");
  for (i = 0; i < numeroDeProdutos; i++)
  {
    printf("* %s %d %d\n", produtos[i].descricao, produtos[i].preco, produtos[i].quantidadeEmStock);
  }

}

int ListaAlfabeticamente()
{
  int i;
  int j;
  char *token;
  int nide;
  Produto tmp_produto;
  getchar();
  fgets(input, 1000, stdin);
  token = strtok(input, delimitators);
  nide = atoi(token);
  if ((nide == encomenda[nide].ide) && (numeroDeEncomendas > 0))
  {
    {
      for (i = 0; i < (numeroDeProdutos - 1); i++)
      {
        for (j = 0; j < ((numeroDeProdutos - i) - 1); j++)
        {
          if (strcmp(encomenda[nide].arrayprodutos[j].descricao, encomenda[nide].arrayprodutos[j + 1].descricao) > 0)
          {
            {
              tmp_produto = produtos[j];
              produtos[j] = produtos[j + 1];
              produtos[j + 1] = tmp_produto;
            }
          }
          else
          {
            
          }

        }

      }

      printf("Encomenda %d\n", encomenda[nide].ide);
      for (i = 0; i < numeroDeProdutos; i++)
      {
        if (encomenda[nide].arrayprodutos[i].quantidadeEmStock > 0)
        {
          {
            printf("* %s %d %d\n", produtos[i].descricao, produtos[i].preco, encomenda[nide].arrayprodutos[i].quantidadeEmStock);
          }
        }
        else
        {
          
        }

      }

      return 1;
    }
  }
  else
  {
    
  }

  printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", nide);
  return 0;
}

