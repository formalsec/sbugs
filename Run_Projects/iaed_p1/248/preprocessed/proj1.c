/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "structures.h"


int produtosAtuais = 0;
int encomendasAtuais = 0;
int merge1Aux[10000];
int merge2Aux[10000];
int temp[10000];
Produto produtos[10000];
Encomenda encomendas[500];
int __a__()
{
  Produto novoProduto;
  char *token;
  char input[200];
  int c;
  int i;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  strcpy(novoProduto.descricao, token);
  token = strtok(0, ":");
  novoProduto.preco = atoi(token);
  token = strtok(0, ":");
  novoProduto.peso = atoi(token);
  token = strtok(0, ":");
  novoProduto.quantidade = atoi(token);
  novoProduto.idp = produtosAtuais;
  novoProduto.pCriado = 1;
  produtosAtuais++;
  produtos[novoProduto.idp] = novoProduto;
  printf("Novo produto %d.\n", novoProduto.idp);
  return 0;
}

int __q__()
{
  int i;
  int c;
  int _idp;
  int _quantidade;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _idp = atoi(token);
  token = strtok(0, ":");
  _quantidade = atoi(token);
  if (_idp < produtosAtuais)
  {
    {
      produtos[_idp].quantidade += _quantidade;
      return 0;
    }
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", _idp);
  }

  return 0;
}

int __N__()
{
  Encomenda novaEncomenda;
  int i;
  novaEncomenda.ide = encomendasAtuais;
  novaEncomenda.pesoEnc = 0;
  novaEncomenda.numberOfProds = 0;
  novaEncomenda.eCriado = 1;
  for (i = 0; i < 10000; i++)
    novaEncomenda.prodsEnc[i] = 0;

  encomendas[novaEncomenda.ide] = novaEncomenda;
  encomendasAtuais++;
  printf("Nova encomenda %d.\n", novaEncomenda.ide);
  return 0;
}

int __A__()
{
  int i;
  int c;
  int _ide;
  int _idp;
  int _qtd;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _ide = atoi(token);
  token = strtok(0, ":");
  _idp = atoi(token);
  token = strtok(0, ":");
  _qtd = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  if (produtos[_idp].pCriado != 1)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  if (produtos[_idp].quantidade < _qtd)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  if ((encomendas[_ide].pesoEnc + (_qtd * produtos[_idp].peso)) > 200)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  if ((encomendas[_ide].numberOfProds > 0) && (encomendas[_ide].prodsEnc[_idp] == 0))
  {
    encomendas[_ide].numberOfProds++;
  }
  else
  {
    
  }

  encomendas[_ide].prodsEnc[_idp] += _qtd;
  encomendas[_ide].pesoEnc += _qtd * produtos[_idp].peso;
  produtos[_idp].quantidade -= _qtd;
  return 0;
}

int __r__()
{
  int i;
  int c;
  int _idp;
  int _qtd;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _idp = atoi(token);
  token = strtok(0, ":");
  _qtd = atoi(token);
  if (produtos[_idp].pCriado != 1)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", _idp);
      return 0;
    }
  }
  else
  {
    
  }

  if ((produtos[_idp].quantidade - _qtd) < 0)
  {
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", _qtd, _idp);
      return 0;
    }
  }
  else
  {
    
  }

  produtos[_idp].quantidade -= _qtd;
  return 0;
}

int __R__()
{
  int i;
  int c;
  int _ide;
  int _idp;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _ide = atoi(token);
  token = strtok(0, ":");
  _idp = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  if (produtos[_idp].pCriado != 1)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", _idp, _ide);
      return 0;
    }
  }
  else
  {
    
  }

  encomendas[_ide].pesoEnc -= encomendas[_ide].prodsEnc[_idp] * produtos[_idp].peso;
  encomendas[_ide].numberOfProds--;
  produtos[_idp].quantidade += encomendas[_ide].prodsEnc[_idp];
  encomendas[_ide].prodsEnc[_idp] = 0;
  return 0;
}

int __C__()
{
  int i;
  int c;
  int _ide;
  int contadorPreco = 0;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, "\0");
  _ide = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", _ide);
      return 0;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 10000; i++)
  {
    if (encomendas[_ide].prodsEnc[i] > 0)
    {
      contadorPreco += produtos[i].preco * encomendas[_ide].prodsEnc[i];
    }
    else
    {
      
    }

  }

  printf("Custo da encomenda %d %d.\n", _ide, contadorPreco);
  return 0;
}

int __p__()
{
  int i;
  int c;
  int _idp;
  int _preco;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _idp = atoi(token);
  token = strtok(0, ":");
  _preco = atoi(token);
  if (produtos[_idp].pCriado != 1)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", _idp);
      return 0;
    }
  }
  else
  {
    
  }

  produtos[_idp].preco = _preco;
  return 0;
}

int __E__()
{
  int i;
  int c;
  int _ide;
  int _idp;
  int contadorErros = 0;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, ":");
  _ide = atoi(token);
  token = strtok(0, ":");
  _idp = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", _ide);
      contadorErros++;
    }
  }
  else
  {
    
  }

  if (produtos[_idp].pCriado != 1)
  {
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", _idp);
      contadorErros++;
    }
  }
  else
  {
    
  }

  if (contadorErros > 0)
  {
    return 0;
  }
  else
  {
    
  }

  printf("%s %d.\n", produtos[_idp].descricao, encomendas[_ide].prodsEnc[_idp]);
  return 0;
}

int __m__()
{
  int i;
  int c;
  int _idp;
  int _ide;
  int _qtd = 0;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, "\0");
  _idp = atoi(token);
  if (produtos[_idp].pCriado != 1)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", _idp);
  }
  else
  {
    
  }

  for (i = 0; i < 500; i++)
  {
    if (encomendas[i].eCriado == 1)
    {
      {
        if (_qtd < encomendas[i].prodsEnc[_idp])
        {
          {
            _qtd = encomendas[i].prodsEnc[_idp];
            _ide = i;
          }
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

  if (_qtd != 0)
  {
    printf("Maximo produto %d %d %d.\n", _idp, _ide, _qtd);
  }
  else
  {
    
  }

  return 0;
}

int __l__()
{
  int auxiliar[10000];
  int i;
  int tamanhoAux = 0;
  for (i = 0; i < 10000; i++)
  {
    if (produtos[i].pCriado == 1)
    {
      {
        auxiliar[tamanhoAux] = i;
        tamanhoAux++;
      }
    }
    else
    {
      
    }

  }

  mergesort1(auxiliar, 0, tamanhoAux - 1);
  printf("Produtos\n");
  for (i = 0; i < tamanhoAux; i++)
    printf("* %s %d %d\n", produtos[auxiliar[i]].descricao, produtos[auxiliar[i]].preco, produtos[auxiliar[i]].quantidade);

  return 0;
}

int __L__()
{
  int i;
  int c;
  int _ide;
  int tamanhoAux = 0;
  int temporario[10000];
  int auxiliar[10000];
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, "\0");
  _ide = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", _ide);
      return 0;
    }
  }
  else
  {
    
  }

  for (i = 0; i < 10000; i++)
  {
    if (encomendas[_ide].prodsEnc[i] != 0)
    {
      {
        auxiliar[tamanhoAux] = i;
        temporario[tamanhoAux] = encomendas[_ide].prodsEnc[i];
        tamanhoAux++;
      }
    }
    else
    {
      
    }

  }

  mergesort2(auxiliar, temporario, 0, tamanhoAux - 1);
  printf("Encomenda %d\n", _ide);
  for (i = 0; i < tamanhoAux; i++)
  {
    printf("* %s %d %d\n", produtos[auxiliar[i]].descricao, produtos[auxiliar[i]].preco, temporario[i]);
  }

  return 0;
}

void mergesort1(int a[], int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort1(a, l, m);
  mergesort1(a, m + 1, r);
  merge1(a, l, m, r);
}

void merge1(int a[], int l, int m, int r)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
    merge1Aux[i - 1] = a[i - 1];

  for (j = m; j < r; j++)
    merge1Aux[(r + m) - j] = a[j + 1];

  for (k = l; k <= r; k++)
  {
    if (produtos[merge1Aux[j]].preco < produtos[merge1Aux[i]].preco)
    {
      a[k] = merge1Aux[j--];
    }
    else
    {
      if ((produtos[merge1Aux[j]].preco == produtos[merge1Aux[i]].preco) && (produtos[merge1Aux[j]].idp < produtos[merge1Aux[i]].idp))
      {
        a[k] = merge1Aux[j--];
      }
      else
      {
        a[k] = merge1Aux[i++];
      }

    }

  }

}

void mergesort2(int a[], int b[], int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort2(a, b, l, m);
  mergesort2(a, b, m + 1, r);
  merge2(a, b, l, m, r);
}

void merge2(int a[], int b[], int l, int m, int r)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
  {
    merge2Aux[i - 1] = a[i - 1];
    temp[i - 1] = b[i - 1];
  }

  for (j = m; j < r; j++)
  {
    merge2Aux[(r + m) - j] = a[j + 1];
    temp[(r + m) - j] = b[j + 1];
  }

  for (k = l; k <= r; k++)
  {
    if (strcmp(produtos[merge2Aux[j]].descricao, produtos[merge2Aux[i]].descricao) < 0)
    {
      {
        a[k] = merge2Aux[j];
        b[k] = temp[j];
        j--;
      }
    }
    else
    {
      {
        a[k] = merge2Aux[i];
        b[k] = temp[i];
        i++;
      }
    }

  }

}

int __k__()
{
  int i;
  printf("Produtos:\n");
  for (i = 0; i < produtosAtuais; i++)
    printf("* %s %d %d\n", produtos[i].descricao, produtos[i].preco, produtos[i].quantidade);

  return 0;
}

int __K__()
{
  int i;
  int c;
  int _ide;
  char input[200];
  char *token;
  c = getchar();
  for (i = 0; c != '\n'; i++)
  {
    c = getchar();
    input[i] = c;
  }

  i--;
  input[i] = '\0';
  token = strtok(input, "\0");
  _ide = atoi(token);
  if (encomendas[_ide].eCriado != 1)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", _ide);
      return 0;
    }
  }
  else
  {
    
  }

  printf("Encomenda %d\n", _ide);
  for (i = 0; i < 10000; i++)
  {
    if (encomendas[_ide].prodsEnc[i] > 0)
    {
      {
        printf("* %s %d %d\n", produtos[i].descricao, produtos[i].preco, encomendas[_ide].prodsEnc[i]);
      }
    }
    else
    {
      
    }

  }

  return 0;
}

int main()
{
  int c;
  while (c != 'x')
  {
    c = getchar();
    switch (c)
    {
      case 'a':
        __a__();
        break;

      case 'q':
        __q__();
        break;

      case 'N':
        __N__();
        break;

      case 'A':
        __A__();
        break;

      case 'r':
        __r__();
        break;

      case 'R':
        __R__();
        break;

      case 'C':
        __C__();
        break;

      case 'p':
        __p__();
        break;

      case 'E':
        __E__();
        break;

      case 'm':
        __m__();
        break;

      case 'l':
        __l__();
        break;

      case 'L':
        __L__();
        break;

      case 'k':
        __k__();
        break;

      case 'K':
        __K__();
        break;

      case 'x':
        return 0;

    }

  }

  return 0;
}

