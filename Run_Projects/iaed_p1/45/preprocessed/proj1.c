/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stddef.h>


long int IDP = 0;
int IDE = 0;
typedef struct produto
{
  char descricao[64];
  long int peso;
  long int preco;
  long int qtd;
  long int idp;
} produto;
produto produtos[10000];
typedef struct encomenda
{
  int status;
  int peso;
  int numProdutos;
  produto listaProdutos[200];
} encomenda;
encomenda encomendas[500];
void exch(int *a, int *b);
int less_l(int a, int b);
int partition_l(int a[], int left, int right);
void quicksort_l(int a[], int left, int right);
int less_L(int a, int b, int ide);
int partition_L(int a[], int left, int right, int ide);
void quicksort_L(int a[], int left, int right, int ide);
void a();
void q();
void N();
void A();
void r();
void R();
void C();
void p();
void E();
void m();
void l();
void L();
void app();
int main()
{
  app();
  return 0;
}

void exch(int *a, int *b)
{
  int tmp = *a;
  *a = *b;
  *b = tmp;
}

int less_l(int a, int b)
{
  if (produtos[a].preco < produtos[b].preco)
  {
    return 1;
  }
  else
  {
    
  }

  if (produtos[b].preco > produtos[a].preco)
  {
    return 0;
  }
  else
  {
    
  }

  if (produtos[b].preco == produtos[a].preco)
  {
    {
      if (produtos[a].idp < produtos[b].idp)
      {
        return 1;
      }
      else
      {
        
      }

      if (produtos[b].idp > produtos[a].idp)
      {
        return 0;
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  return 0;
}

int partition_l(int a[], int left, int right)
{
  int i = left - 1;
  int j = right;
  int v = a[right];
  while (i < j)
  {
    while (less_l(a[++i], v))
      ;

    while (less_l(v, a[--j]))
      if (j == left)
    {
      break;
    }
    else
    {
      
    }


    if (i < j)
    {
      exch(&a[i], &a[j]);
    }
    else
    {
      
    }

  }

  exch(&a[i], &a[right]);
  return i;
}

void quicksort_l(int a[], int left, int right)
{
  int i;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  i = partition_l(a, left, right);
  quicksort_l(a, left, i - 1);
  quicksort_l(a, i + 1, right);
}

int less_L(int a, int b, int ide)
{
  if (strcmp(encomendas[ide].listaProdutos[a].descricao, encomendas[ide].listaProdutos[b].descricao) < 0)
  {
    return 1;
  }
  else
  {
    
  }

  if (strcmp(encomendas[ide].listaProdutos[a].descricao, encomendas[ide].listaProdutos[b].descricao) > 0)
  {
    return 0;
  }
  else
  {
    
  }

  return 0;
}

int partition_L(int a[], int left, int right, int ide)
{
  int i = left - 1;
  int j = right;
  int v = a[right];
  while (i < j)
  {
    while (less_L(a[++i], v, ide))
      ;

    while (less_L(v, a[--j], ide))
      if (j == left)
    {
      break;
    }
    else
    {
      
    }


    if (i < j)
    {
      exch(&a[i], &a[j]);
    }
    else
    {
      
    }

  }

  exch(&a[i], &a[right]);
  return i;
}

void quicksort_L(int a[], int left, int right, int ide)
{
  int i;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  i = partition_L(a, left, right, ide);
  quicksort_L(a, left, i - 1, ide);
  quicksort_L(a, i + 1, right, ide);
}

void a()
{
  int peso = 0;
  long int preco = 0;
  long int qtd = 0;
  char descricao[64];
  produto p;
  getchar();
  for (int descricao_index = 0; descricao_index < 10; descricao_index++)
  {
    descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
  }

  descricao[10 - 1] = '\0';
  preco = new_sym_var(sizeof(long int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(long int) * 8);
  if (((preco > 0) && (peso > 0)) && (qtd >= 0))
  {
    {
      p.peso = peso;
      p.preco = preco;
      p.qtd = qtd;
      strcpy(p.descricao, descricao);
      p.idp = IDP;
      produtos[IDP] = p;
      printf("Novo produto %ld.\n", IDP);
      IDP++;
    }
  }
  else
  {
    
  }

}

void q()
{
  long int idp = 0;
  long int qtd = 0;
  getchar();
  idp = new_sym_var(sizeof(long int) * 8);
  qtd = new_sym_var(sizeof(long int) * 8);
  if (((idp >= 0) && (idp <= 9999)) && (qtd >= 0))
  {
    {
      if (idp < IDP)
      {
        {
          produtos[idp].qtd = qtd + produtos[idp].qtd;
          return;
        }
      }
      else
      {
        
      }

      printf("Impossivel adicionar produto %ld ao stock. Produto inexistente.\n", idp);
    }
  }
  else
  {
    
  }

}

void N()
{
  printf("Nova encomenda %d.\n", IDE);
  encomendas[IDE].status = 1;
  IDE++;
}

void A()
{
  int i = 0;
  int ide = 0;
  long int idp = 0;
  long int qtd = 0;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(long int) * 8);
  qtd = new_sym_var(sizeof(long int) * 8);
  if (encomendas[ide].status == 0)
  {
    {
      printf("Impossivel adicionar produto %ld a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= IDP)
  {
    {
      printf("Impossivel adicionar produto %ld a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if ((produtos[idp].qtd - qtd) < 0)
  {
    {
      printf("Impossivel adicionar produto %ld a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (((produtos[idp].peso * qtd) + encomendas[ide].peso) > 200)
  {
    {
      printf("Impossivel adicionar produto %ld a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[ide].numProdutos; i++)
  {
    if ((idp == encomendas[ide].listaProdutos[i].idp) && (qtd <= produtos[idp].qtd))
    {
      {
        encomendas[ide].listaProdutos[i].qtd = encomendas[ide].listaProdutos[i].qtd + qtd;
        produtos[idp].qtd = produtos[idp].qtd - qtd;
        encomendas[ide].peso = (produtos[idp].peso * qtd) + encomendas[ide].peso;
        return;
      }
    }
    else
    {
      
    }

  }

  i = encomendas[ide].numProdutos;
  strcpy(encomendas[ide].listaProdutos[i].descricao, produtos[idp].descricao);
  encomendas[ide].listaProdutos[i].peso = produtos[idp].peso;
  encomendas[ide].listaProdutos[i].idp = produtos[idp].idp;
  encomendas[ide].listaProdutos[i].preco = produtos[idp].preco;
  encomendas[ide].listaProdutos[i].qtd = qtd;
  encomendas[ide].numProdutos++;
  encomendas[ide].peso = (produtos[idp].peso * qtd) + encomendas[ide].peso;
  if (qtd <= produtos[idp].qtd)
  {
    {
      produtos[idp].qtd = produtos[idp].qtd - qtd;
      return;
    }
  }
  else
  {
    
  }

}

void r()
{
  long int idp = 0;
  long int qtd = 0;
  getchar();
  idp = new_sym_var(sizeof(long int) * 8);
  qtd = new_sym_var(sizeof(long int) * 8);
  if (idp >= IDP)
  {
    {
      printf("Impossivel remover stock do produto %ld. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if ((produtos[idp].qtd - qtd) < 0)
  {
    {
      printf("Impossivel remover %ld unidades do produto %ld do stock. Quantidade insuficiente.\n", qtd, idp);
      return;
    }
  }
  else
  {
    
  }

  produtos[idp].qtd = produtos[idp].qtd - qtd;
}

void R()
{
  int ide = 0;
  int i = 0;
  int j = 0;
  long int idp = 0;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(long int) * 8);
  if (encomendas[ide].status == 0)
  {
    {
      printf("Impossivel remover produto %ld a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= IDP)
  {
    {
      printf("Impossivel remover produto %ld a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[ide].numProdutos; i++)
  {
    if (idp == encomendas[ide].listaProdutos[i].idp)
    {
      {
        produtos[idp].qtd = produtos[idp].qtd + encomendas[ide].listaProdutos[i].qtd;
        encomendas[ide].peso = encomendas[ide].peso - (encomendas[ide].listaProdutos[i].qtd * encomendas[ide].listaProdutos[i].peso);
        if (i < encomendas[ide].numProdutos)
        {
          {
            encomendas[ide].numProdutos--;
            for (j = i; j < encomendas[ide].numProdutos; j++)
              encomendas[ide].listaProdutos[j] = encomendas[ide].listaProdutos[j + 1];

          }
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

}

void C()
{
  int ide = 0;
  int i = 0;
  long int custo = 0;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].status == 0)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[ide].numProdutos; i++)
  {
    custo = custo + (encomendas[ide].listaProdutos[i].qtd * encomendas[ide].listaProdutos[i].preco);
  }

  printf("Custo da encomenda %d %ld.\n", ide, custo);
}

void p()
{
  long int idp = 0;
  long int preco = 0;
  int i = 0;
  int j = 0;
  getchar();
  idp = new_sym_var(sizeof(long int) * 8);
  preco = new_sym_var(sizeof(long int) * 8);
  if (idp >= IDP)
  {
    {
      printf("Impossivel alterar preco do produto %ld. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  produtos[idp].preco = preco;
  for (i = 0; i < IDE; i++)
    if (encomendas[i].numProdutos != 0)
  {
    for (j = 0; j < encomendas[i].numProdutos; j++)
      if (idp == encomendas[i].listaProdutos[j].idp)
    {
      encomendas[i].listaProdutos[j].preco = preco;
    }
    else
    {
      
    }


  }
  else
  {
    
  }


}

void E()
{
  int ide = 0;
  int i = 0;
  long int idp = 0;
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(long int) * 8);
  if (encomendas[ide].status == 0)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  if (idp >= IDP)
  {
    {
      printf("Impossivel listar produto %ld. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[ide].numProdutos; i++)
  {
    if (idp == encomendas[ide].listaProdutos[i].idp)
    {
      {
        printf("%s %ld.\n", encomendas[ide].listaProdutos[i].descricao, encomendas[ide].listaProdutos[i].qtd);
        return;
      }
    }
    else
    {
      
    }

  }

  printf("%s %d.\n", produtos[idp].descricao, 0);
}

void m()
{
  int i = 0;
  int j = 0;
  int ide = 0;
  long int max = 0;
  long int idp = 0;
  getchar();
  idp = new_sym_var(sizeof(long int) * 8);
  if (idp >= IDP)
  {
    {
      printf("Impossivel listar maximo do produto %ld. Produto inexistente.\n", idp);
      return;
    }
  }
  else
  {
    
  }

  if (encomendas[0].status == 0)
  {
    return;
  }
  else
  {
    
  }

  for (i = 0; i < IDE; i++)
    if (encomendas[i].numProdutos != 0)
  {
    for (j = 0; j < encomendas[i].numProdutos; j++)
      if (idp == encomendas[i].listaProdutos[j].idp)
    {
      if (max < encomendas[i].listaProdutos[j].qtd)
      {
        {
          max = encomendas[i].listaProdutos[j].qtd;
          ide = i;
        }
      }
      else
      {
        
      }

    }
    else
    {
      
    }


  }
  else
  {
    
  }


  if (max != 0)
  {
    printf("Maximo produto %ld %d %ld.\n", idp, ide, max);
  }
  else
  {
    
  }

}

void l()
{
  int i = 0;
  int idps[9999];
  printf("Produtos\n");
  if (IDP > 0)
  {
    {
      for (i = 0; i < IDP; i++)
      {
        idps[i] = produtos[i].idp;
      }

      quicksort_l(idps, 0, IDP - 1);
      for (i = 0; i < IDP; i++)
      {
        printf("* %s %ld %ld\n", produtos[idps[i]].descricao, produtos[idps[i]].preco, produtos[idps[i]].qtd);
      }

    }
  }
  else
  {
    
  }

}

void L()
{
  int ide = 0;
  int i = 0;
  int idps[200];
  getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (encomendas[ide].status == 0)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
      return;
    }
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[ide].numProdutos; i++)
  {
    idps[i] = i;
  }

  quicksort_L(idps, 0, encomendas[ide].numProdutos - 1, ide);
  printf("Encomenda %d\n", ide);
  for (i = 0; i < encomendas[ide].numProdutos; i++)
    printf("* %s %ld %ld\n", encomendas[ide].listaProdutos[idps[i]].descricao, encomendas[ide].listaProdutos[idps[i]].preco, encomendas[ide].listaProdutos[idps[i]].qtd);

}

void app()
{
  while (1)
  {
    char cmd = getchar();
    switch (cmd)
    {
      case 'a':
        a();
        break;

      case 'q':
        q();
        break;

      case 'N':
        N();
        break;

      case 'A':
        A();
        break;

      case 'r':
        r();
        break;

      case 'R':
        R();
        break;

      case 'C':
        C();
        break;

      case 'p':
        p();
        break;

      case 'E':
        E();
        break;

      case 'm':
        m();
        break;

      case 'l':
        l();
        break;

      case 'L':
        L();
        break;

      case 'x':
        return;

      default:
        break;

    }

  }

}

