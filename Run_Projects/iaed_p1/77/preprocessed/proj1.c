/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


int cont_produto = 0;
int cont_encomenda = 0;
typedef struct produto
{
  char descricao[64];
  int preco;
  int peso;
  int stock;
  int id;
} Produto;
Produto sistema[10000];
Produto encomendas[500][10000];
void adiciona_produto(char descricao[], int preco, int peso, int stock)
{
  strcpy(sistema[cont_produto].descricao, descricao);
  sistema[cont_produto].preco = preco;
  sistema[cont_produto].peso = peso;
  sistema[cont_produto].stock = stock;
  sistema[cont_produto].id = cont_produto;
  printf("Novo produto %d.\n", cont_produto);
  cont_produto++;
}

void adiciona_stock(int idp, int stock)
{
  if (idp >= cont_produto)
  {
    {
      printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      sistema[idp].stock = sistema[idp].stock + stock;
    }
  }

}

void cria_encomenda()
{
  printf("Nova encomenda %d.\n", cont_encomenda);
  cont_encomenda++;
}

void adiciona_produto_encomenda(int ide, int idp, int stock)
{
  int i;
  int peso_total = 0;
  for (i = 0; i < cont_produto; i++)
  {
    peso_total += encomendas[ide][i].peso * encomendas[ide][i].stock;
  }

  peso_total += sistema[idp].peso * stock;
  if (ide >= cont_encomenda)
  {
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp >= cont_produto)
    {
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      if (sistema[idp].stock < stock)
      {
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        }
      }
      else
      {
        if (peso_total > 200)
        {
          {
            printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
          }
        }
        else
        {
          if (encomendas[ide][idp].preco == sistema[idp].preco)
          {
            {
              encomendas[ide][idp].stock += stock;
              sistema[idp].stock -= stock;
            }
          }
          else
          {
            {
              encomendas[ide][idp] = sistema[idp];
              encomendas[ide][idp].stock = stock;
              sistema[idp].stock -= stock;
            }
          }

        }

      }

    }

  }

}

void remove_stock(int idp, int stock)
{
  if (idp >= cont_produto)
  {
    {
      printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    if (sistema[idp].stock < stock)
    {
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", stock, idp);
      }
    }
    else
    {
      {
        sistema[idp].stock -= stock;
      }
    }

  }

}

void remove_produto(int ide, int idp)
{
  if (ide >= cont_encomenda)
  {
    {
      printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    }
  }
  else
  {
    if (idp >= cont_produto)
    {
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      }
    }
    else
    {
      {
        sistema[idp].stock += encomendas[ide][idp].stock;
        encomendas[ide][idp].stock = 0;
      }
    }

  }

}

void calcula_custo(int ide)
{
  int i;
  int soma = 0;
  if (ide >= cont_encomenda)
  {
    {
      printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      for (i = 0; i < cont_produto; i++)
      {
        soma += encomendas[ide][i].preco * encomendas[ide][i].stock;
      }

      printf("Custo da encomenda %d %d.\n", ide, soma);
    }
  }

}

void altera_preco(int idp, int preco)
{
  int i;
  if (idp >= cont_produto)
  {
    {
      printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    {
      sistema[idp].preco = preco;
      for (i = 0; i < cont_encomenda; i++)
      {
        if (encomendas[i][idp].preco != 0)
        {
          {
            encomendas[i][idp].preco = preco;
          }
        }
        else
        {
          
        }

      }

    }
  }

}

void lista_descricao_stock(int ide, int idp)
{
  if (ide >= cont_encomenda)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    if (idp >= cont_produto)
    {
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      }
    }
    else
    {
      {
        printf("%s %d.\n", sistema[idp].descricao, encomendas[ide][idp].stock);
      }
    }

  }

}

void lista_identificador(int idp)
{
  int i;
  int ide;
  int max_ocorrencias = 0;
  if (idp >= cont_produto)
  {
    {
      printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    }
  }
  else
  {
    
  }

  for (i = 0; i < cont_encomenda; i++)
  {
    if (encomendas[i][idp].stock > max_ocorrencias)
    {
      {
        ide = i;
        max_ocorrencias = encomendas[i][idp].stock;
      }
    }
    else
    {
      
    }

  }

  if (max_ocorrencias > 0)
  {
    {
      printf("Maximo produto %d %d %d.\n", idp, ide, encomendas[ide][idp].stock);
    }
  }
  else
  {
    
  }

}

void merge(Produto a[], int left, int m, int right)
{
  Produto aux[10000];
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
  {
    aux[i - 1] = a[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux[(right + m) - j] = a[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if (aux[j].preco < aux[i].preco)
    {
      {
        a[k] = aux[j--];
      }
    }
    else
    {
      if (aux[j].preco > aux[i].preco)
      {
        {
          a[k] = aux[i++];
        }
      }
      else
      {
        {
          if (aux[j].id < aux[i].id)
          {
            {
              a[k] = aux[j--];
            }
          }
          else
          {
            {
              a[k] = aux[i++];
            }
          }

        }
      }

    }

  }

}

void mergesort(Produto a[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, left, m);
  mergesort(a, m + 1, right);
  merge(a, left, m, right);
}

void lista_por_preco()
{
  Produto lista_ordenada[10000];
  int i;
  for (i = 0; i < cont_produto; i++)
  {
    lista_ordenada[i] = sistema[i];
  }

  mergesort(lista_ordenada, 0, cont_produto - 1);
  printf("Produtos\n");
  for (i = 0; i < cont_produto; i++)
  {
    printf("* %s %d %d\n", lista_ordenada[i].descricao, lista_ordenada[i].preco, lista_ordenada[i].stock);
  }

}

void insertion(Produto a[], int left, int right)
{
  int i;
  int j;
  for (i = left + 1; i < right; i++)
  {
    Produto v = a[i];
    j = i - 1;
    while ((j >= left) && (strcmp(v.descricao, a[j].descricao) < 0))
    {
      a[j + 1] = a[j];
      j--;
    }

    a[j + 1] = v;
  }

}

void lista_encomenda(int ide)
{
  int i;
  Produto lista_nova[10000];
  if (ide >= cont_encomenda)
  {
    {
      printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    }
  }
  else
  {
    {
      for (i = 0; i < cont_produto; i++)
      {
        lista_nova[i] = encomendas[ide][i];
      }

      insertion(lista_nova, 0, cont_produto);
      printf("Encomenda %d\n", ide);
      for (i = 0; i < cont_produto; i++)
      {
        if (lista_nova[i].stock != 0)
        {
          {
            printf("* %s %d %d\n", lista_nova[i].descricao, lista_nova[i].preco, lista_nova[i].stock);
          }
        }
        else
        {
          
        }

      }

    }
  }

}

int main()
{
  char x;
  x = getchar();
  while (x != 'x')
  {
    if (x == 'a')
    {
      {
        int preco;
        int peso;
        int stock;
        char descricao[64];
        for (int descricao_index = 0; descricao_index < 10; descricao_index++)
        {
          descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
        }

        descricao[10 - 1] = '\0';
        preco = new_sym_var(sizeof(int) * 8);
        peso = new_sym_var(sizeof(int) * 8);
        stock = new_sym_var(sizeof(int) * 8);
        adiciona_produto(descricao, preco, peso, stock);
      }
    }
    else
    {
      if (x == 'q')
      {
        {
          int idp;
          int stock;
          idp = new_sym_var(sizeof(int) * 8);
          stock = new_sym_var(sizeof(int) * 8);
          adiciona_stock(idp, stock);
        }
      }
      else
      {
        if (x == 'N')
        {
          {
            cria_encomenda();
          }
        }
        else
        {
          if (x == 'A')
          {
            {
              int ide;
              int idp;
              int stock;
              ide = new_sym_var(sizeof(int) * 8);
              idp = new_sym_var(sizeof(int) * 8);
              stock = new_sym_var(sizeof(int) * 8);
              adiciona_produto_encomenda(ide, idp, stock);
            }
          }
          else
          {
            if (x == 'r')
            {
              {
                int idp;
                int stock;
                idp = new_sym_var(sizeof(int) * 8);
                stock = new_sym_var(sizeof(int) * 8);
                remove_stock(idp, stock);
              }
            }
            else
            {
              if (x == 'R')
              {
                {
                  int ide;
                  int idp;
                  ide = new_sym_var(sizeof(int) * 8);
                  idp = new_sym_var(sizeof(int) * 8);
                  remove_produto(ide, idp);
                }
              }
              else
              {
                if (x == 'C')
                {
                  {
                    int ide;
                    ide = new_sym_var(sizeof(int) * 8);
                    calcula_custo(ide);
                  }
                }
                else
                {
                  if (x == 'p')
                  {
                    {
                      int idp;
                      int preco;
                      idp = new_sym_var(sizeof(int) * 8);
                      preco = new_sym_var(sizeof(int) * 8);
                      altera_preco(idp, preco);
                    }
                  }
                  else
                  {
                    if (x == 'E')
                    {
                      {
                        int ide;
                        int idp;
                        ide = new_sym_var(sizeof(int) * 8);
                        idp = new_sym_var(sizeof(int) * 8);
                        lista_descricao_stock(ide, idp);
                      }
                    }
                    else
                    {
                      if (x == 'm')
                      {
                        {
                          int idp;
                          idp = new_sym_var(sizeof(int) * 8);
                          lista_identificador(idp);
                        }
                      }
                      else
                      {
                        if (x == 'l')
                        {
                          {
                            lista_por_preco();
                          }
                        }
                        else
                        {
                          if (x == 'L')
                          {
                            {
                              int ide;
                              ide = new_sym_var(sizeof(int) * 8);
                              lista_encomenda(ide);
                            }
                          }
                          else
                          {
                            
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

    x = getchar();
  }

  return 0;
}

