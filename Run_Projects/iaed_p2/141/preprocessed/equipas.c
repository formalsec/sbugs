/*File generated by PreProcessor.py*/


#include "equipas.h" 


void imprime_equipa(Equipa eq)
{
  printf("%s %d\n", eq->nome, eq->vitorias);
}

int prox_primo(int num)
{
  int primo = num;
  int encontrou = 0;
  if (num <= 1)
  {
    return 2;
  }
  else
  {
    
  }

  while (!encontrou)
  {
    primo++;
    if (eh_primo(primo))
    {
      encontrou = 1;
    }
    else
    {
      
    }

  }

  return primo;
}

int eh_primo(int num)
{
  int i;
  if (num <= 1)
  {
    return 0;
  }
  else
  {
    if (num <= 3)
    {
      return 1;
    }
    else
    {
      
    }

  }

  if (((num % 2) == 0) || ((num % 3) == 0))
  {
    return 0;
  }
  else
  {
    
  }

  for (i = 5; (i * i) <= num; i = i + 6)
    if (((num % i) == 0) || ((num % (i + 2)) == 0))
  {
    return 0;
  }
  else
  {
    
  }


  return 1;
}

Vetor inicializaVetor(int M)
{
  Vetor a = malloc(sizeof(struct vetor));
  a->vetor = malloc(M * (sizeof(struct equipa)));
  a->N = 0;
  a->M = M;
  return a;
}

void insereVetor(Vetor a, Equipa eq)
{
  if (a->N == a->M)
  {
    {
      int novo_tam = a->M + a->M;
      a->M = novo_tam;
      a->vetor = realloc(a->vetor, novo_tam * (sizeof(struct equipa)));
    }
  }
  else
  {
    
  }

  a->vetor[a->N++] = eq;
}

void freeVetor(Vetor a)
{
  free(a->vetor);
  a->vetor = 0;
  free(a);
}

int hash_eq(Chave_Equipas k, int M)
{
  int h = 0;
  int a = 127;
  for (; (*k) != '\0'; k++)
    h = ((a * h) + (*k)) % M;

  return h;
}

Hashtable_eq inicializaHT_eq(int max)
{
  Hashtable_eq ht = malloc(sizeof(struct hashtable_eq));
  Equipa *tab = malloc(max * (sizeof(Equipa)));
  int i;
  ht->N = 0;
  ht->M = max;
  for (i = 0; i < ht->M; i++)
    tab[i] = 0;

  ht->tabela = tab;
  return ht;
}

void insereHT_eq(Hashtable_eq ht, Equipa equipa)
{
  Chave_Equipas k = equipa->nome;
  int i = hash_eq(k, ht->M);
  Equipa *tab = ht->tabela;
  while (tab[i] != 0)
    i = (i + 1) % ht->M;

  tab[i] = equipa;
  if ((ht->N++) > (ht->M / 2))
  {
    expandeHT_eq(ht);
  }
  else
  {
    
  }

}

void expandeHT_eq(Hashtable_eq ht)
{
  int i;
  int tam_ant = ht->M;
  Equipa *aux = ht->tabela;
  int novo_tam = prox_primo(ht->M + ht->M);
  Equipa *tab = malloc(novo_tam * (sizeof(Equipa)));
  for (i = 0; i < novo_tam; i++)
    tab[i] = 0;

  ht->tabela = tab;
  ht->M = novo_tam;
  ht->N = 0;
  for (i = 0; i < tam_ant; i++)
    if (aux[i] != 0)
  {
    insereHT_eq(ht, aux[i]);
  }
  else
  {
    
  }


  free(aux);
}

Equipa procuraHT_eq(Hashtable_eq ht, Chave_Equipas k)
{
  int i = hash_eq(k, ht->M);
  Equipa *tab = ht->tabela;
  while (tab[i] != 0)
  {
    if (strcmp(k, tab[i]->nome) == 0)
    {
      return tab[i];
    }
    else
    {
      i = (i + 1) % ht->M;
    }

  }

  return 0;
}

void freeHT_eq(Hashtable_eq ht)
{
  int i = 0;
  Equipa *tab = ht->tabela;
  while (i < ht->M)
  {
    if (tab[i])
    {
      {
        free(tab[i]->nome);
        free(tab[i]);
      }
    }
    else
    {
      
    }

    i++;
  }

  free(tab);
  free(ht);
}

