/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "Projeto2.h"


void atualiza_lista(jogo_pont *lista_jogos_inicio, jogo_pont *lista_jogos_fim, jogo_pont jogo_adici)
{
  if ((*lista_jogos_fim) == 0)
  {
    {
      *lista_jogos_inicio = jogo_adici;
      *lista_jogos_fim = jogo_adici;
      (*lista_jogos_fim)->prox_jogo_lista = 0;
    }
  }
  else
  {
    {
      (*lista_jogos_fim)->prox_jogo_lista = jogo_adici;
      *lista_jogos_fim = jogo_adici;
      (*lista_jogos_fim)->prox_jogo_lista = 0;
    }
  }

}

equipa_pont encontra_equipa(char *nome_equipa, equipa_pont *tabela_hash_equipas, jogo_pont *jogo_adici, int equipa)
{
  int indice;
  equipa_pont e;
  equipa_pont aux = 0;
  indice = hash(nome_equipa, 2131);
  for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
  {
    if ((strcmp(e->nome_equipa, nome_equipa) == 0) && (equipa == 1))
    {
      {
        (*jogo_adici)->equipa1 = e->nome_equipa;
        aux = e;
      }
    }
    else
    {
      
    }

    if ((strcmp(e->nome_equipa, nome_equipa) == 0) && (equipa == 2))
    {
      {
        (*jogo_adici)->equipa2 = e->nome_equipa;
        aux = e;
      }
    }
    else
    {
      
    }

  }

  return aux;
}

void mete_jogo_hash(jogo_pont *jogo_adici, char *n_jogo, int resultado1, int resultado2, jogo_pont *tabela_hash_jogos, int indice)
{
  (*jogo_adici)->nome_jogo = (char *) malloc((sizeof(char)) * (strlen(n_jogo) + 1));
  strcpy((*jogo_adici)->nome_jogo, n_jogo);
  (*jogo_adici)->golos1 = (int *) malloc(sizeof(int));
  *(*jogo_adici)->golos1 = resultado1;
  (*jogo_adici)->golos2 = (int *) malloc(sizeof(int));
  *(*jogo_adici)->golos2 = resultado2;
  (*jogo_adici)->prox_jogo = tabela_hash_jogos[indice];
  tabela_hash_jogos[indice] = *jogo_adici;
}

void adic_jogo(jogo_pont *lista_jogos_inicio, jogo_pont *lista_jogos_fim, jogo_pont *tabela_hash_jogos, equipa_pont *tabela_hash_equipas, int nl)
{
  char n_jogo[1024];
  char nome_equipa1[1024];
  char nome_equipa2[1024];
  int resultado1;
  int resultado2;
  int indice1;
  jogo_pont jogo_adici;
  jogo_pont i;
  equipa_pont aux1;
  equipa_pont aux2;
  jogo_adici = (jogo_pont) malloc(sizeof(struct jogo));
  for (int n_jogo_index = 0; n_jogo_index < 10; n_jogo_index++)
  {
    n_jogo[n_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  n_jogo[10 - 1] = '\0';
  for (int nome_equipa1_index = 0; nome_equipa1_index < 10; nome_equipa1_index++)
  {
    nome_equipa1[nome_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa1[10 - 1] = '\0';
  for (int nome_equipa2_index = 0; nome_equipa2_index < 10; nome_equipa2_index++)
  {
    nome_equipa2[nome_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa2[10 - 1] = '\0';
  resultado1 = new_sym_var(sizeof(int) * 8);
  resultado2 = new_sym_var(sizeof(int) * 8);
  indice1 = hash(n_jogo, 5501);
  for (i = tabela_hash_jogos[indice1]; i != 0; i = i->prox_jogo)
  {
    if (strcmp(i->nome_jogo, n_jogo) == 0)
    {
      {
        printf("%d Jogo existente.\n", nl);
        free(jogo_adici);
        return;
      }
    }
    else
    {
      
    }

  }

  aux1 = encontra_equipa(nome_equipa1, tabela_hash_equipas, &jogo_adici, 1);
  if (aux1 == 0)
  {
    {
      printf("%d Equipa inexistente.\n", nl);
      free(jogo_adici);
      return;
    }
  }
  else
  {
    
  }

  aux2 = encontra_equipa(nome_equipa2, tabela_hash_equipas, &jogo_adici, 2);
  if (aux2 == 0)
  {
    {
      printf("%d Equipa inexistente.\n", nl);
      free(jogo_adici);
      return;
    }
  }
  else
  {
    
  }

  if (resultado1 > resultado2)
  {
    {
      (*aux1->vitorias)++;
    }
  }
  else
  {
    if (resultado1 < resultado2)
    {
      {
        (*aux2->vitorias)++;
      }
    }
    else
    {
      
    }

  }

  mete_jogo_hash(&jogo_adici, n_jogo, resultado1, resultado2, tabela_hash_jogos, indice1);
  atualiza_lista(lista_jogos_inicio, lista_jogos_fim, jogo_adici);
  return;
}

void jogos_introduzidos(jogo_pont lista_jogos_inicio, int nl)
{
  jogo_pont i;
  for (i = lista_jogos_inicio; i != 0; i = i->prox_jogo_lista)
  {
    printf("%d %s %s %s %d %d\n", nl, i->nome_jogo, i->equipa1, i->equipa2, *i->golos1, *i->golos2);
  }

}

void procura_jogo(jogo_pont *tabela_hash_jogos, int nl)
{
  char nome[1024];
  int indice;
  jogo_pont i;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  indice = hash(nome, 5501);
  for (i = tabela_hash_jogos[indice]; i != 0; i = i->prox_jogo)
  {
    if (strcmp(nome, i->nome_jogo) == 0)
    {
      {
        printf("%d %s %s %s %d %d\n", nl, i->nome_jogo, i->equipa1, i->equipa2, *i->golos1, *i->golos2);
        return;
      }
    }
    else
    {
      
    }

  }

  printf("%d Jogo inexistente.\n", nl);
}

void atualiza_vitorias_equipa1(equipa_pont *tabela_hash_equipas, int ctrl, jogo_pont aux)
{
  int indice;
  equipa_pont e;
  indice = hash(aux->equipa1, 2131);
  if ((((ctrl == 1) || (ctrl == 2)) || (ctrl == 3)) || (ctrl == 5))
  {
    {
      for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
      {
        if ((strcmp(aux->equipa1, e->nome_equipa) == 0) && ((ctrl == 3) || (ctrl == 5)))
        {
          {
            (*e->vitorias)++;
            return;
          }
        }
        else
        {
          
        }

        if ((strcmp(aux->equipa1, e->nome_equipa) == 0) && ((ctrl == 1) || (ctrl == 2)))
        {
          {
            (*e->vitorias)--;
            return;
          }
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    
  }

}

void atualiza_vitorias_equipa2(equipa_pont *tabela_hash_equipas, int ctrl, jogo_pont aux)
{
  int indice;
  equipa_pont e;
  indice = hash(aux->equipa2, 2131);
  if ((((ctrl == 1) || (ctrl == 4)) || (ctrl == 5)) || (ctrl == 6))
  {
    {
      for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
      {
        if ((strcmp(aux->equipa2, e->nome_equipa) == 0) && ((ctrl == 1) || (ctrl == 4)))
        {
          {
            (*e->vitorias)++;
            return;
          }
        }
        else
        {
          
        }

        if ((strcmp(aux->equipa2, e->nome_equipa) == 0) && ((ctrl == 5) || (ctrl == 6)))
        {
          {
            (*e->vitorias)--;
            return;
          }
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    
  }

}

int obtem_ctrl(jogo_pont i, int resultado1, int resultado2)
{
  if ((*i->golos1) > (*i->golos2))
  {
    {
      if (resultado1 < resultado2)
      {
        return 1;
      }
      else
      {
        if (resultado1 == resultado2)
        {
          return 2;
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    if ((*i->golos1) == (*i->golos2))
    {
      {
        if (resultado1 > resultado2)
        {
          return 3;
        }
        else
        {
          if (resultado1 < resultado2)
          {
            return 4;
          }
          else
          {
            
          }

        }

      }
    }
    else
    {
      if ((*i->golos1) < (*i->golos2))
      {
        {
          if (resultado1 > resultado2)
          {
            return 5;
          }
          else
          {
            if (resultado1 == resultado2)
            {
              return 6;
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        
      }

    }

  }

  return 0;
}

void altera_resultado(jogo_pont *tabela_hash_jogos, equipa_pont *tabela_hash_equipas, int nl)
{
  int resultado1;
  int resultado2;
  int indice1;
  int ctrl = 0;
  int ctrl_jogo = 0;
  char nome[1024];
  jogo_pont i;
  jogo_pont aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  resultado1 = new_sym_var(sizeof(int) * 8);
  resultado2 = new_sym_var(sizeof(int) * 8);
  indice1 = hash(nome, 5501);
  for (i = tabela_hash_jogos[indice1]; i != 0; i = i->prox_jogo)
  {
    if (strcmp(nome, i->nome_jogo) == 0)
    {
      {
        ctrl = obtem_ctrl(i, resultado1, resultado2);
        *i->golos1 = resultado1;
        *i->golos2 = resultado2;
        aux = i;
        ctrl_jogo = 1;
      }
    }
    else
    {
      
    }

  }

  if (ctrl_jogo == 0)
  {
    {
      printf("%d Jogo inexistente.\n", nl);
      return;
    }
  }
  else
  {
    
  }

  if (ctrl == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  atualiza_vitorias_equipa1(tabela_hash_equipas, ctrl, aux);
  atualiza_vitorias_equipa2(tabela_hash_equipas, ctrl, aux);
}

int remove_jogo_lista(jogo_pont *lista_jogos, jogo_pont *lista_jogos_fim, char *nome)
{
  jogo_pont i;
  jogo_pont aux;
  int ctrl = 0;
  for (i = *lista_jogos, aux = 0; i != 0; aux = i, i = i->prox_jogo_lista)
  {
    if (strcmp(nome, i->nome_jogo) == 0)
    {
      {
        if ((i == (*lista_jogos)) && (i->prox_jogo_lista == 0))
        {
          {
            *lista_jogos = 0;
            *lista_jogos_fim = 0;
            return ++ctrl;
          }
        }
        else
        {
          if (i == (*lista_jogos))
          {
            {
              *lista_jogos = (*lista_jogos)->prox_jogo_lista;
              return ++ctrl;
            }
          }
          else
          {
            if (i->prox_jogo_lista == 0)
            {
              {
                *lista_jogos_fim = aux;
                (*lista_jogos_fim)->prox_jogo_lista = 0;
                return ++ctrl;
              }
            }
            else
            {
              {
                aux->prox_jogo_lista = i->prox_jogo_lista;
                return ++ctrl;
              }
            }

          }

        }

      }
    }
    else
    {
      
    }

  }

  return ctrl;
}

jogo_pont remove_jogo_hash(jogo_pont *tabela_hash_jogos, char *nome, int *resultado1, int *resultado2, char *equipa1, char *equipa2)
{
  int indice;
  jogo_pont aux;
  jogo_pont i;
  jogo_pont aux_free;
  indice = hash(nome, 5501);
  for (i = tabela_hash_jogos[indice], aux = 0; i != 0; aux = i, i = i->prox_jogo)
  {
    if (strcmp(nome, i->nome_jogo) == 0)
    {
      {
        if (i == tabela_hash_jogos[indice])
        {
          {
            tabela_hash_jogos[indice] = i->prox_jogo;
            *resultado1 = *i->golos1;
            *resultado2 = *i->golos2;
            strcpy(equipa1, i->equipa1);
            strcpy(equipa2, i->equipa2);
            return i;
          }
        }
        else
        {
          if (i->prox_jogo == 0)
          {
            {
              *resultado1 = *i->golos1;
              *resultado2 = *i->golos2;
              strcpy(equipa1, i->equipa1);
              strcpy(equipa2, i->equipa2);
              aux_free = i;
              i = aux;
              i->prox_jogo = 0;
              return aux_free;
            }
          }
          else
          {
            {
              aux->prox_jogo = i->prox_jogo;
              *resultado1 = *i->golos1;
              *resultado2 = *i->golos2;
              strcpy(equipa1, i->equipa1);
              strcpy(equipa2, i->equipa2);
              return i;
            }
          }

        }

      }
    }
    else
    {
      
    }

  }

  return 0;
}

void apaga_jogo(jogo_pont *tabela_hash_jogos, equipa_pont *tabela_hash_equipas, jogo_pont *lista_jogos, jogo_pont *lista_jogos_fim, int nl)
{
  jogo_pont aux_free;
  equipa_pont e;
  int indice;
  int ctrl = 0;
  int resultado1;
  int resultado2 = 0;
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  ctrl = remove_jogo_lista(lista_jogos, lista_jogos_fim, nome);
  if (ctrl == 0)
  {
    {
      printf("%d Jogo inexistente.\n", nl);
      return;
    }
  }
  else
  {
    
  }

  aux_free = remove_jogo_hash(tabela_hash_jogos, nome, &resultado1, &resultado2, equipa1, equipa2);
  if (resultado1 > resultado2)
  {
    {
      indice = hash(equipa1, 2131);
      for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
      {
        if (strcmp(equipa1, e->nome_equipa) == 0)
        {
          {
            (*e->vitorias)--;
          }
        }
        else
        {
          
        }

      }

    }
  }
  else
  {
    if (resultado1 < resultado2)
    {
      {
        indice = hash(equipa2, 2131);
        for (e = tabela_hash_equipas[indice]; e != 0; e = e->prox_equipa)
        {
          if (strcmp(equipa2, e->nome_equipa) == 0)
          {
            {
              (*e->vitorias)--;
            }
          }
          else
          {
            
          }

        }

      }
    }
    else
    {
      
    }

  }

  free(aux_free->nome_jogo);
  free(aux_free->golos1);
  free(aux_free->golos2);
  free(aux_free);
  return;
}

