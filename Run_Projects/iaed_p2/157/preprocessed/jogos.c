/*File generated by PreProcessor.py*/


#include "jogos.h"


pt_jogo novo_jogo(char *nome, char *equipa1, char *equipa2, int score1, int score2, link_equipa *equipas)
{
  pt_jogo jogo_novo;
  int comp = strlen(nome) + 1;
  pt_equipa pt_equipa1 = procura_equipa(equipa1, equipas);
  pt_equipa pt_equipa2 = procura_equipa(equipa2, equipas);
  jogo_novo = (pt_jogo) malloc(sizeof(struct jogo));
  jogo_novo->nome = (char *) malloc(comp * (sizeof(char)));
  strcpy(jogo_novo->nome, nome);
  jogo_novo->equipa1 = pt_equipa1;
  jogo_novo->equipa2 = pt_equipa2;
  jogo_novo->score1 = score1;
  jogo_novo->score2 = score2;
  return jogo_novo;
}

pt_jogo procura_jogo(char *nome, link_jogo *jogos)
{
  int indice = hash_jogo(nome);
  link_jogo tmp;
  tmp = jogos[indice];
  while ((tmp != 0) && (strcmp(tmp->jogo->nome, nome) != 0))
    tmp = tmp->next;

  if (tmp == 0)
  {
    return 0;
  }
  else
  {
    return tmp->jogo;
  }

}

void apaga_jogo_tabela(char *nome, link_jogo *jogos)
{
  int indice = hash_jogo(nome);
  link_jogo tmp;
  link_jogo aux;
  tmp = jogos[indice];
  if (strcmp(tmp->jogo->nome, nome) == 0)
  {
    {
      jogos[indice] = tmp->next;
      if (tmp->jogo->score1 > tmp->jogo->score2)
      {
        tmp->jogo->equipa1->vitorias--;
      }
      else
      {
        if (tmp->jogo->score1 < tmp->jogo->score2)
        {
          tmp->jogo->equipa2->vitorias--;
        }
        else
        {
          
        }

      }

      free_jogo(tmp->jogo);
      free(tmp);
    }
  }
  else
  {
    {
      while (strcmp(tmp->next->jogo->nome, nome) != 0)
        tmp = tmp->next;

      aux = tmp->next;
      tmp->next = tmp->next->next;
      if (aux->jogo->score1 > aux->jogo->score2)
      {
        aux->jogo->equipa1->vitorias--;
      }
      else
      {
        if (aux->jogo->score1 < aux->jogo->score2)
        {
          aux->jogo->equipa2->vitorias--;
        }
        else
        {
          
        }

      }

      free_jogo(aux->jogo);
      free(aux);
      free(tmp);
    }
  }

}

bool jogo_existe(char *nome, link_jogo *jogos)
{
  return procura_jogo(nome, jogos) != 0;
}

void insere_jogo_tabela(pt_jogo jogo, link_jogo *jogos)
{
  int indice = hash_jogo(jogo->nome);
  link_jogo new = (link_jogo) malloc(sizeof(struct node_jogo));
  new->jogo = jogo;
  new->next = jogos[indice];
  jogos[indice] = new;
}

void free_jogo(pt_jogo jogo)
{
  free(jogo->nome);
  free(jogo);
}

link_jogo *init_jogos(link_jogo *tabela)
{
  int i;
  for (i = 0; i < 1009; i++)
    tabela[i] = 0;

  return tabela;
}

pt_nome apaga_nome_lista(pt_nome nomes_jogos, char *nome)
{
  pt_nome aux;
  pt_nome head = nomes_jogos;
  if (strcmp(nomes_jogos->nome, nome) == 0)
  {
    {
      head = nomes_jogos->next;
      free(nomes_jogos->nome);
      free(nomes_jogos);
    }
  }
  else
  {
    {
      while ((nomes_jogos->next != 0) && (strcmp(nomes_jogos->next->nome, nome) != 0))
        nomes_jogos = nomes_jogos->next;

      aux = nomes_jogos->next;
      nomes_jogos->next = nomes_jogos->next->next;
      free(aux->nome);
      free(aux);
    }
  }

  return head;
}

void free_all(link_jogo *jogos, link_equipa *equipas, pt_nome nomes_jogos)
{
  int i;
  pt_nome aux_nome;
  link_equipa aux_equipa;
  link_jogo aux_jogo;
  for (i = 0; i < 1009; i++)
  {
    while (jogos[i] != 0)
    {
      free_jogo(jogos[i]->jogo);
      aux_jogo = jogos[i];
      jogos[i] = jogos[i]->next;
      free(aux_jogo);
    }

  }

  for (i = 0; i < (1009 / 2); i++)
  {
    while (equipas[i] != 0)
    {
      free_equipa(equipas[i]->equipa);
      aux_equipa = equipas[i];
      equipas[i] = equipas[i]->next;
      free(aux_equipa);
    }

  }

  while (nomes_jogos->next != 0)
  {
    free(nomes_jogos->nome);
    aux_nome = nomes_jogos;
    nomes_jogos = nomes_jogos->next;
    free(aux_nome);
  }

  free(jogos);
  free(equipas);
  free(nomes_jogos);
}

pt_nome novo_nome(char *nome, pt_nome nomes_jogos)
{
  int comp;
  pt_nome novo_nome;
  pt_nome head = nomes_jogos;
  novo_nome = (pt_nome) malloc(sizeof(struct nome));
  novo_nome->next = 0;
  while (nomes_jogos->next != 0)
    nomes_jogos = nomes_jogos->next;

  nomes_jogos->next = novo_nome;
  comp = strlen(nome) + 1;
  nomes_jogos->nome = (char *) malloc(comp * (sizeof(char)));
  strcpy(nomes_jogos->nome, nome);
  return head;
}

