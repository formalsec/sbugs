/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "hashtable-structs.h"
#include "commands.h"


link a(link *hashtable, int size_table, team_ptr team_list, link game_list, int nl)
{
  char *aux_name;
  char *aux_team1_name;
  char *aux_team2_name;
  int aux_score_team1;
  int aux_score_team2;
  char c;
  aux_name = (char *) malloc((sizeof(char)) * 1023);
  aux_team1_name = (char *) malloc((sizeof(char)) * 1023);
  aux_team2_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_name_index = 0; aux_name_index < 10; aux_name_index++)
  {
    aux_name[aux_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_name[10 - 1] = '\0';
  for (int aux_team1_name_index = 0; aux_team1_name_index < 10; aux_team1_name_index++)
  {
    aux_team1_name[aux_team1_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_team1_name[10 - 1] = '\0';
  for (int aux_team2_name_index = 0; aux_team2_name_index < 10; aux_team2_name_index++)
  {
    aux_team2_name[aux_team2_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_team2_name[10 - 1] = '\0';
  aux_score_team1 = new_sym_var(sizeof(int) * 8);
  aux_score_team2 = new_sym_var(sizeof(int) * 8);
  if (LookUpInTable(hashtable, aux_name, size_table) == 0)
  {
    {
      if (LookUpTeams(team_list, aux_team1_name) != 0)
      {
        {
          if (LookUpTeams(team_list, aux_team2_name) != 0)
          {
            {
              if (aux_score_team1 > aux_score_team2)
              {
                {
                  LookUpTeams(team_list, aux_team1_name)->games_won += 1;
                }
              }
              else
              {
                if (aux_score_team2 > aux_score_team1)
                {
                  {
                    LookUpTeams(team_list, aux_team2_name)->games_won += 1;
                  }
                }
                else
                {
                  
                }

              }

              InsertInTable(hashtable, size_table, aux_name, aux_team1_name, aux_team2_name, aux_score_team1, aux_score_team2);
              game_list = InsertGameList(game_list, aux_name, aux_team1_name, aux_team2_name, aux_score_team1, aux_score_team2);
            }
          }
          else
          {
            {
              printf("%d Equipa inexistente.\n", nl);
            }
          }

        }
      }
      else
      {
        {
          printf("%d Equipa inexistente.\n", nl);
        }
      }

    }
  }
  else
  {
    {
      printf("%d Jogo existente.\n", nl);
    }
  }

  free(aux_name);
  free(aux_team1_name);
  free(aux_team2_name);
  return game_list;
}

team_ptr A(team_ptr team_list, int nl)
{
  char *aux_team_name;
  char c;
  aux_team_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_team_name_index = 0; aux_team_name_index < 10; aux_team_name_index++)
  {
    aux_team_name[aux_team_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_team_name[10 - 1] = '\0';
  if (LookUpTeams(team_list, aux_team_name) == 0)
  {
    {
      team_list = InsertBeginTeamList(team_list, aux_team_name);
    }
  }
  else
  {
    {
      printf("%d Equipa existente.\n", nl);
    }
  }

  free(aux_team_name);
  return team_list;
}

void p(link *hashtable, int size_table, int nl)
{
  char *aux_game_name;
  char c;
  aux_game_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_game_name_index = 0; aux_game_name_index < 10; aux_game_name_index++)
  {
    aux_game_name[aux_game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_game_name[10 - 1] = '\0';
  if (LookUpInTable(hashtable, aux_game_name, size_table) != 0)
  {
    {
      game_ptr x = LookUpInTable(hashtable, aux_game_name, size_table);
      printf("%d %s %s %s %d %d\n", nl, x->game_name, x->team1, x->team2, x->score_team1, x->score_team2);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", nl);
    }
  }

  free(aux_game_name);
}

void P(team_ptr team_list, int nl)
{
  char *aux_team_name;
  char c;
  aux_team_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_team_name_index = 0; aux_team_name_index < 10; aux_team_name_index++)
  {
    aux_team_name[aux_team_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_team_name[10 - 1] = '\0';
  if (LookUpTeams(team_list, aux_team_name) != 0)
  {
    {
      team_ptr x = LookUpTeams(team_list, aux_team_name);
      printf("%d %s %d\n", nl, x->team_name, x->games_won);
    }
  }
  else
  {
    {
      printf("%d Equipa inexistente.\n", nl);
    }
  }

  free(aux_team_name);
}

void l(link *hashtable, int size_table, link game_list, int nl)
{
  link x;
  for (x = game_list; x != 0; x = x->next)
  {
    if (LookUpInTable(hashtable, x->this_game->game_name, size_table) != 0)
    {
      {
        game_ptr g = LookUpInTable(hashtable, x->this_game->game_name, size_table);
        printf("%d %s %s %s %d %d\n", nl, g->game_name, g->team1, g->team2, g->score_team1, g->score_team2);
      }
    }
    else
    {
      
    }

  }

}

link r(link *hashtable, int size_table, link game_list, team_ptr team_list, int nl)
{
  char *aux_game_name;
  char c;
  aux_game_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_game_name_index = 0; aux_game_name_index < 10; aux_game_name_index++)
  {
    aux_game_name[aux_game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_game_name[10 - 1] = '\0';
  if (LookUpInTable(hashtable, aux_game_name, size_table) != 0)
  {
    {
      if (LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team1)->games_won > LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team2)->games_won)
      {
        {
          LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team1)->games_won -= 1;
        }
      }
      else
      {
        if (LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team1)->games_won < LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team2)->games_won)
        {
          {
            LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team2)->games_won -= 1;
          }
        }
        else
        {
          
        }

      }

      game_list = Remove(game_list, aux_game_name);
      RemoveFromTable(hashtable, size_table, aux_game_name);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", nl);
    }
  }

  free(aux_game_name);
  return game_list;
}

link s(link *hashtable, int size_table, link game_list, team_ptr team_list, int nl)
{
  char *aux_game_name;
  int aux_score_team1;
  int aux_score_team2;
  char c;
  aux_game_name = (char *) malloc((sizeof(char)) * 1023);
  while (c = getchar() != ' ')
    ;

  for (int aux_game_name_index = 0; aux_game_name_index < 10; aux_game_name_index++)
  {
    aux_game_name[aux_game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  aux_game_name[10 - 1] = '\0';
  aux_score_team1 = new_sym_var(sizeof(int) * 8);
  aux_score_team2 = new_sym_var(sizeof(int) * 8);
  if (LookUpInTable(hashtable, aux_game_name, size_table) != 0)
  {
    {
      if (LookUpInTable(hashtable, aux_game_name, size_table)->score_team1 < LookUpInTable(hashtable, aux_game_name, size_table)->score_team2)
      {
        {
          if (aux_score_team1 > aux_score_team2)
          {
            LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team2)->games_won -= 1;
          }
          else
          {
            
          }

        }
      }
      else
      {
        if (LookUpInTable(hashtable, aux_game_name, size_table)->score_team1 > LookUpInTable(hashtable, aux_game_name, size_table)->score_team2)
        {
          {
            if (aux_score_team2 > aux_score_team1)
            {
              LookUpTeams(team_list, LookUpInTable(hashtable, aux_game_name, size_table)->team1)->games_won -= 1;
            }
            else
            {
              
            }

          }
        }
        else
        {
          
        }

      }

      LookUpInTable(hashtable, aux_game_name, size_table)->score_team1 = aux_score_team1;
      LookUpInTable(hashtable, aux_game_name, size_table)->score_team2 = aux_score_team2;
      game_list = ChangeScore(game_list, aux_game_name, aux_score_team1, aux_score_team2);
    }
  }
  else
  {
    {
      printf("%d Jogo inexistente.\n", nl);
    }
  }

  free(aux_game_name);
  return game_list;
}

int compareStr(const void *pa, const void *pb)
{
  int r = strcmp(pa, pb);
  if (r == 0)
  {
    return 0;
  }
  else
  {
    if (r > 0)
    {
      return 1;
    }
    else
    {
      return -1;
    }

  }

}

void g(team_ptr team_list, int nl)
{
  int biggest_n_games_won = 0;
  char *team_names[100];
  int teams_array_size = 0;
  int i;
  if (team_list != 0)
  {
    {
      team_ptr x;
      for (x = team_list; x != 0; x = x->next)
      {
        if (x->games_won >= biggest_n_games_won)
        {
          biggest_n_games_won = x->games_won;
        }
        else
        {
          
        }

      }

      for (x = team_list; x != 0; x = x->next)
      {
        if (x->games_won == biggest_n_games_won)
        {
          teams_array_size++;
        }
        else
        {
          
        }

      }

      for (i = 0, x = team_list; x != 0; i++, x = x->next)
      {
        if (x->games_won == biggest_n_games_won)
        {
          {
            team_names[i] = (char *) malloc((sizeof(char)) * (strlen(x->team_name) + 1));
            strcpy(team_names[i], x->team_name);
          }
        }
        else
        {
          
        }

      }

      qsort(team_names, teams_array_size, sizeof(char *), compareStr);
      printf("%d Melhores %d\n", nl, biggest_n_games_won);
      for (i = 0; i < teams_array_size; i++)
      {
        printf("%d * %s\n", nl, team_names[i]);
        free(team_names[i]);
      }

    }
  }
  else
  {
    
  }

}

