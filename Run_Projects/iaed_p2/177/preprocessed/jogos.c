/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "jogos.h"


lista *inicializa_lista()
{
  lista *tmp = (lista *) malloc(sizeof(lista));
  tmp->head = 0;
  tmp->last = 0;
  return tmp;
}

void print(lista *l, int nl)
{
  pPerson x = l->head;
  for (; x != 0; x = x->next)
  {
    if (x->eliminado == 0)
    {
      {
        printf("%d %s %s %s %d %d\n", nl, x->nome, x->equipa1, x->equipa2, x->score1, x->score2);
      }
    }
    else
    {
      
    }

  }

  return;
}

int hash(char *v, int M)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
  {
    h = ((a * h) + (*v)) % M;
  }

  return h;
}

jogo inicializa_jogo(jogo st1, int m)
{
  int i;
  st1 = (jogo) malloc(m * (sizeof(struct perso)));
  st1->tamanho = m;
  st1->elementos = 0;
  st1->v = (pPerson *) malloc(m * (sizeof(pPerson)));
  for (i = 0; i < m; i++)
  {
    st1->v[i] = 0;
  }

  return st1;
}

jogo destroi_jogo(jogo st)
{
  int i;
  for (i = 0; i < st->tamanho; i++)
  {
    if (st->v[i] != 0)
    {
      {
        free(st->v[i]->nome);
        free(st->v[i]->equipa1);
        free(st->v[i]->equipa2);
        free(st->v[i]);
      }
    }
    else
    {
      
    }

  }

  free(st->v);
  free(st);
  return st;
}

jogo insere(jogo st, pPerson v, char *nome)
{
  int i;
  i = hash(nome, st->tamanho);
  while (st->v[i] != 0)
  {
    i = (i + 1) % st->tamanho;
  }

  st->v[i] = v;
  return st;
}

jogo re_hash_jogo(jogo st)
{
  jogo st1 = 0;
  int i;
  st1 = inicializa_jogo(st1, st->tamanho * 2);
  st1->elementos = st->elementos;
  for (i = 0; i < st->tamanho; i++)
  {
    if (st->v[i] != 0)
    {
      {
        st1 = insere(st1, st->v[i], st->v[i]->nome);
      }
    }
    else
    {
      
    }

  }

  free(st->v);
  free(st);
  return st1;
}

jogo insere_jogo(jogo st, lista *l, char *nome, char *equipa1, char *equipa2, int score1, int score2)
{
  int i;
  st->elementos += 1;
  if ((2 * st->elementos) >= st->tamanho)
  {
    {
      st = re_hash_jogo(st);
    }
  }
  else
  {
    
  }

  i = hash(nome, st->tamanho);
  while (st->v[i] != 0)
  {
    i = (i + 1) % st->tamanho;
  }

  st->v[i] = (pPerson) malloc(sizeof(struct person));
  st->v[i]->score1 = score1;
  st->v[i]->score2 = score2;
  st->v[i]->eliminado = 0;
  st->v[i]->nome = (char *) malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(st->v[i]->nome, nome);
  st->v[i]->equipa1 = (char *) malloc((sizeof(char)) * (strlen(equipa1) + 1));
  strcpy(st->v[i]->equipa1, equipa1);
  st->v[i]->equipa2 = (char *) malloc((sizeof(char)) * (strlen(equipa2) + 1));
  strcpy(st->v[i]->equipa2, equipa2);
  st->v[i]->next = 0;
  if (l->head == 0)
  {
    {
      l->head = st->v[i];
      l->last = st->v[i];
    }
  }
  else
  {
    {
      pPerson prev_last = l->last;
      prev_last->next = st->v[i];
      l->last = st->v[i];
    }
  }

  return st;
}

int pertence_jogo(jogo st1, char *nome)
{
  int i;
  i = hash(nome, st1->tamanho);
  while (st1->v[i] != 0)
  {
    if ((strcmp(st1->v[i]->nome, nome) == 0) && (st1->v[i]->eliminado == 0))
    {
      {
        return 1;
      }
    }
    else
    {
      {
        i = (i + 1) % st1->tamanho;
      }
    }

  }

  return 0;
}

void print_jogo(jogo st1, char *nome, int nl)
{
  int i;
  i = hash(nome, st1->tamanho);
  while (st1->v[i] != 0)
  {
    if ((strcmp(st1->v[i]->nome, nome) == 0) && (st1->v[i]->eliminado == 0))
    {
      {
        printf("%d %s %s %s %d %d\n", nl, st1->v[i]->nome, st1->v[i]->equipa1, st1->v[i]->equipa2, st1->v[i]->score1, st1->v[i]->score2);
        return;
      }
    }
    else
    {
      {
        i = (i + 1) % st1->tamanho;
      }
    }

  }

}

jogo altera_score(jogo st1, char *nome, int novo_score1, int novo_score2)
{
  int i;
  i = hash(nome, st1->tamanho);
  while (st1->v[i] != 0)
  {
    if ((strcmp(st1->v[i]->nome, nome) == 0) && (st1->v[i]->eliminado == 0))
    {
      {
        st1->v[i]->score1 = novo_score1;
        st1->v[i]->score2 = novo_score2;
        return st1;
      }
    }
    else
    {
      {
        i = (i + 1) % st1->tamanho;
      }
    }

  }

  return st1;
}

jogo elimina_jogo(jogo st, char *nome)
{
  int i;
  i = hash(nome, st->tamanho);
  while (st->v[i] != 0)
  {
    if ((strcmp(st->v[i]->nome, nome) == 0) && (st->v[i]->eliminado == 0))
    {
      {
        break;
      }
    }
    else
    {
      i = (i + 1) % st->tamanho;
    }

  }

  st->v[i]->eliminado = 1;
  return st;
}

