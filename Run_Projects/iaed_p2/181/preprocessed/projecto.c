/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "lista_jogos.h"
#include "lista_equipas.h"
#include "hash_jogos.h"
#include "hash_equipas.h"


void obter_comando(HashEquipas *equipas, ListaJogos *jogos_ordenados, HashJogos *jogos);
void a_adiciona_jogo(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos, HashEquipas *equipas);
void l_lista_jogos(int NL, ListaJogos *jogos_ordenados);
void p_procura_jogo(int NL, HashJogos *jogos);
void r_remove_jogo(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos);
void s_altera_resultado(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos);
void A_adiciona_equipa(int NL, HashEquipas *equipas);
void P_procura_equipa(int NL, HashEquipas *equipas);
void g_lista_equipas(int NL, HashEquipas *equipas);
int comparar_string(const void *a, const void *b);
int a_correr = 1;
int main()
{
  HashEquipas equipas;
  ListaJogos jogos_ordenados;
  HashJogos jogos;
  inicializa_HashEquipas(&equipas, 911);
  inicializa_HashJogos(&jogos, 911);
  inicializa_ListaJogos(&jogos_ordenados);
  while (a_correr)
    obter_comando(&equipas, &jogos_ordenados, &jogos);

  return 0;
}

void obter_comando(HashEquipas *equipas, ListaJogos *jogos_ordenados, HashJogos *jogos)
{
  static int numero_linha = 1;
  char comando;
  comando = getchar();
  switch (comando)
  {
    case 'a':
      a_adiciona_jogo(numero_linha, jogos_ordenados, jogos, equipas);
      numero_linha++;
      break;

    case 'A':
      A_adiciona_equipa(numero_linha, equipas);
      numero_linha++;
      break;

    case 'l':
      l_lista_jogos(numero_linha, jogos_ordenados);
      numero_linha++;
      break;

    case 'p':
      p_procura_jogo(numero_linha, jogos);
      numero_linha++;
      break;

    case 'P':
      P_procura_equipa(numero_linha, equipas);
      numero_linha++;
      break;

    case 'r':
      r_remove_jogo(numero_linha, jogos_ordenados, jogos);
      numero_linha++;
      break;

    case 's':
      s_altera_resultado(numero_linha, jogos_ordenados, jogos);
      numero_linha++;
      break;

    case 'g':
      g_lista_equipas(numero_linha, equipas);
      numero_linha++;
      break;

    case 'x':
      free_ListaJogo(jogos_ordenados);
      free_HashJogo(jogos);
      free_HashEquipas(equipas);
      a_correr = 0;
      break;

  }

}

void a_adiciona_jogo(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos, HashEquipas *equipas)
{
  Equipa *equipa1;
  Equipa *equipa2;
  Jogo *jogo;
  char nome[1024];
  char equipa1_nome[1024];
  char equipa2_nome[1024];
  int score1;
  int score2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_nome_index = 0; equipa1_nome_index < 10; equipa1_nome_index++)
  {
    equipa1_nome[equipa1_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1_nome[10 - 1] = '\0';
  for (int equipa2_nome_index = 0; equipa2_nome_index < 10; equipa2_nome_index++)
  {
    equipa2_nome[equipa2_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2_nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = procuraJogo_HashJogo(jogos, nome);
  if (jogo != 0)
  {
    {
      printf("%d Jogo existente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  equipa1 = procura_HashEquipas(equipas, equipa1_nome);
  equipa2 = procura_HashEquipas(equipas, equipa2_nome);
  if ((equipa1 == 0) || (equipa2 == 0))
  {
    {
      printf("%d Equipa inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  adicionaJogo_HashJogo(jogos, nome, equipa1, equipa2, score1, score2);
  adiciona_jogo(jogos_ordenados, nome, equipa1, equipa2, score1, score2);
  jogo = jogos_ordenados->inicio->jogo;
  adiciona_vitoria(jogo, 1);
}

void l_lista_jogos(int NL, ListaJogos *jogos_ordenados)
{
  if (jogos_ordenados->inicio != 0)
  {
    print_ListaJogosReverse(NL, jogos_ordenados->inicio);
  }
  else
  {
    
  }

}

void p_procura_jogo(int NL, HashJogos *jogos)
{
  Jogo *jogo;
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  jogo = procuraJogo_HashJogo(jogos, nome);
  if (jogo == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  print_jogo(NL, jogo);
}

void r_remove_jogo(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos)
{
  Jogo *jogo;
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  jogo = procuraJogo_HashJogo(jogos, nome);
  if (jogo == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  adiciona_vitoria(jogo, -1);
  removeJogo_HashJogo(jogos, nome);
  remove_jogo(jogos_ordenados, nome);
}

void s_altera_resultado(int NL, ListaJogos *jogos_ordenados, HashJogos *jogos)
{
  Jogo *jogo_hash;
  Jogo *jogo_lista;
  char nome[1024];
  int score1;
  int score2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo_hash = procuraJogo_HashJogo(jogos, nome);
  jogo_lista = procura_jogo(jogos_ordenados, nome);
  if ((jogo_hash == 0) || (jogo_lista == 0))
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  adiciona_vitoria(jogo_hash, -1);
  altera_resultado(jogo_hash, score1, score2);
  altera_resultado(jogo_lista, score1, score2);
  adiciona_vitoria(jogo_hash, 1);
}

void A_adiciona_equipa(int NL, HashEquipas *equipas)
{
  char nome[1024];
  Equipa *equipa;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa = procura_HashEquipas(equipas, nome);
  if (equipa != 0)
  {
    {
      printf("%d Equipa existente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  adiciona_HashEquipas(equipas, nome);
}

void P_procura_equipa(int NL, HashEquipas *equipas)
{
  char nome[1024];
  Equipa *equipa;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa = procura_HashEquipas(equipas, nome);
  if (equipa == 0)
  {
    {
      printf("%d Equipa inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  print_equipa(NL, equipa);
}

int comparar_string(const void *a, const void *b)
{
  const char *string1 = *((const char **) a);
  const char *string2 = *((const char **) b);
  return strcmp(string1, string2);
}

void g_lista_equipas(int NL, HashEquipas *equipas)
{
  int i;
  int max_vitorias = -1;
  int quantidade = 0;
  char **nomes_equipas;
  maior_numero_vitorias(equipas, &max_vitorias, &quantidade);
  if (max_vitorias != (-1))
  {
    {
      nomes_equipas = (char **) malloc((sizeof(char *)) * quantidade);
      procura_equipasVitoriaHash(equipas, nomes_equipas, max_vitorias, quantidade);
      qsort(nomes_equipas, quantidade, sizeof(char *), comparar_string);
      printf("%d Melhores %d\n", NL, max_vitorias);
      for (i = 0; i < quantidade; i++)
        printf("%d * %s\n", NL, nomes_equipas[i]);

      free(nomes_equipas);
    }
  }
  else
  {
    
  }

}

