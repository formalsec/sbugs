/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "hash.h"
#include "doublinklist.h"


int line = 1;
char nome[1024];
HashTable htJogos;
HashTable htEquipas;
link head = 0;
void case_a()
{
  char nome1[1024];
  char nome2[1024];
  int sc1;
  int sc2;
  pEquipa eq1;
  pEquipa eq2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int nome1_index = 0; nome1_index < 10; nome1_index++)
  {
    nome1[nome1_index] = new_sym_var(sizeof(char) * 8);
  }

  nome1[10 - 1] = '\0';
  for (int nome2_index = 0; nome2_index < 10; nome2_index++)
  {
    nome2[nome2_index] = new_sym_var(sizeof(char) * 8);
  }

  nome2[10 - 1] = '\0';
  sc1 = new_sym_var(sizeof(int) * 8);
  sc2 = new_sym_var(sizeof(int) * 8);
  eq1 = (pEquipa) HTsearch(nome1, &htEquipas);
  eq2 = (pEquipa) HTsearch(nome2, &htEquipas);
  if (HTsearch(nome, &htJogos) != 0)
  {
    {
      printf("%d Jogo existente.\n", line);
    }
  }
  else
  {
    if ((eq1 == 0) || (eq2 == 0))
    {
      {
        printf("%d Equipa inexistente.\n", line);
      }
    }
    else
    {
      {
        if (sc1 > sc2)
        {
          eq1->ganhos++;
        }
        else
        {
          
        }

        if (sc2 > sc1)
        {
          eq2->ganhos++;
        }
        else
        {
          
        }

        DLinsertEnd(NEWjogo(nome, eq1, eq2, sc1, sc2));
        HTinsert((void *) head->prev, &htJogos);
      }
    }

  }

}

void case_l()
{
  link p = head;
  while (p != 0)
  {
    printf("%d %s %s %s %d %d\n", line, p->v->nome, p->v->eq1->nome, p->v->eq2->nome, p->v->sc1, p->v->sc2);
    p = p->next;
  }

}

void case_p()
{
  link p;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  p = (link) HTsearch(nome, &htJogos);
  if (p == 0)
  {
    {
      printf("%d Jogo inexistente.\n", line);
    }
  }
  else
  {
    {
      printf("%d %s %s %s %d %d\n", line, p->v->nome, p->v->eq1->nome, p->v->eq2->nome, p->v->sc1, p->v->sc2);
    }
  }

}

void case_r()
{
  link p;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  p = (link) HTsearch(nome, &htJogos);
  if (p == 0)
  {
    {
      printf("%d Jogo inexistente.\n", line);
    }
  }
  else
  {
    {
      if (p->v->sc1 > p->v->sc2)
      {
        p->v->eq1->ganhos--;
      }
      else
      {
        
      }

      if (p->v->sc2 > p->v->sc1)
      {
        p->v->eq2->ganhos--;
      }
      else
      {
        
      }

      HTremove(nome, &htJogos);
      DLremove_with_item_free(p);
    }
  }

}

void case_s()
{
  int sc1;
  int sc2;
  link p;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  sc1 = new_sym_var(sizeof(int) * 8);
  sc2 = new_sym_var(sizeof(int) * 8);
  p = (link) HTsearch(nome, &htJogos);
  if (p == 0)
  {
    {
      printf("%d Jogo inexistente.\n", line);
    }
  }
  else
  {
    {
      if (p->v->sc1 > p->v->sc2)
      {
        p->v->eq1->ganhos--;
      }
      else
      {
        if (p->v->sc2 > p->v->sc1)
        {
          p->v->eq2->ganhos--;
        }
        else
        {
          
        }

      }

      if (sc1 > sc2)
      {
        p->v->eq1->ganhos++;
      }
      else
      {
        if (sc2 > sc1)
        {
          p->v->eq2->ganhos++;
        }
        else
        {
          
        }

      }

      p->v->sc1 = sc1;
      p->v->sc2 = sc2;
    }
  }

}

void case_A()
{
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (HTsearch(nome, &htEquipas) != 0)
  {
    {
      printf("%d Equipa existente.\n", line);
    }
  }
  else
  {
    {
      HTinsert((void *) NEWequipa(nome), &htEquipas);
    }
  }

}

void case_P()
{
  pEquipa eq;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  eq = (pEquipa) HTsearch(nome, &htEquipas);
  if (eq == 0)
  {
    {
      printf("%d Equipa inexistente.\n", line);
    }
  }
  else
  {
    {
      printf("%d %s %d\n", line, nome, eq->ganhos);
    }
  }

}

int compare_str(const void *a, const void *b)
{
  return strcmp((*((pEquipa *) a))->nome, (*((pEquipa *) b))->nome);
}

void case_g()
{
  int i;
  int max = 0;
  int count = 0;
  pEquipa eq;
  pEquipa melhores[99999];
  for (i = 0; i < htEquipas.M; i++)
  {
    eq = (pEquipa) htEquipas.t[i];
    if (eq && (eq->ganhos >= max))
    {
      {
        if (eq->ganhos > max)
        {
          {
            max = eq->ganhos;
            count = 0;
          }
        }
        else
        {
          
        }

        melhores[count] = eq;
        if (count < (99999 - 1))
        {
          count++;
        }
        else
        {
          
        }

      }
    }
    else
    {
      
    }

  }

  qsort((void *) melhores, count, sizeof(pEquipa), compare_str);
  if (count)
  {
    printf("%d Melhores %d\n", line, max);
  }
  else
  {
    
  }

  for (i = 0; i < count; i++)
  {
    printf("%d * %s\n", line, melhores[i]->nome);
  }

}

int main()
{
  char c;
  htEquipas = HTinit(13, keyEquipa);
  htJogos = HTinit(13, keyJogo);
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
        case_a();
        break;

      case 'l':
        case_l();
        break;

      case 'p':
        case_p();
        break;

      case 'r':
        case_r();
        break;

      case 's':
        case_s();
        break;

      case 'A':
        case_A();
        break;

      case 'P':
        case_P();
        break;

      case 'g':
        case_g();
        break;

    }

    line++;
  }

  HTdestroy_with_item_free(&htEquipas);
  HTdestroy(&htJogos);
  DLdestroy_with_item_free();
  return 0;
}

