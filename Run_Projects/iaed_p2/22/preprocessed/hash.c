/*File generated by PreProcessor.py*/


#include "hash.h"


unsigned long hash(char *s)
{
  unsigned long hash = 5381;
  int c;
  while (c = *(s++))
  {
    hash = (hash * 33) + c;
  }

  hash = hash % 43100;
  return hash;
}

void init_hash_games(struct game **hash_games)
{
  int i;
  for (i = 0; i < 43100; i++)
    hash_games[i] = 0;

}

void init_hash_teams(struct team **hash_teams)
{
  int i;
  for (i = 0; i < 43100; i++)
    hash_teams[i] = 0;

}

struct game *createGame(char *name, struct team *team1, struct team *team2, int score1, int score2)
{
  struct game *game = malloc(sizeof(struct game));
  game->name = malloc((strlen(name) * (sizeof(char))) + 1);
  game->team1 = team1;
  game->team2 = team2;
  game->score1 = score1;
  game->score2 = score2;
  strcpy(game->name, name);
  return game;
}

struct team *createTeam(char *name)
{
  struct team *team = malloc(sizeof(struct team));
  team->name = malloc((strlen(name) * (sizeof(char))) + 1);
  strcpy(team->name, name);
  team->wins = 0;
  return team;
}

void addTeam(char *name, struct team **hash_teams, struct team *last)
{
  struct team *newTeam;
  newTeam = createTeam(name);
  newTeam->nextHash = 0;
  if (hash_teams[hash(name)] == 0)
  {
    {
      newTeam->previousHash = 0;
      hash_teams[hash(name)] = newTeam;
    }
  }
  else
  {
    {
      newTeam->previousHash = last;
      last->nextHash = newTeam;
    }
  }

}

void addGame(char *name, char *team1, char *team2, int s1, int s2, struct game **hash_games, struct team **hash_teams, struct game **lastGame, struct game **firstGame)
{
  struct team *teamOne = getTeam(team1, hash_teams);
  struct team *teamTwo = getTeam(team2, hash_teams);
  struct game *newGame = createGame(name, teamOne, teamTwo, s1, s2);
  struct game *g;
  if ((*lastGame) == 0)
  {
    {
      newGame->previousGeral = 0;
      newGame->nextGeral = 0;
      *firstGame = newGame;
      *lastGame = newGame;
    }
  }
  else
  {
    {
      g = *lastGame;
      g->nextGeral = newGame;
      newGame->previousGeral = *lastGame;
      newGame->nextGeral = 0;
      *lastGame = newGame;
    }
  }

  if (hash_games[hash(name)] == 0)
  {
    {
      newGame->nextHash = 0;
      newGame->previousHash = 0;
      hash_games[hash(name)] = newGame;
    }
  }
  else
  {
    {
      g = hash_games[hash(name)];
      while (g->nextHash != 0)
      {
        g = g->nextHash;
      }

      newGame->nextHash = 0;
      newGame->previousHash = g;
      g->nextHash = newGame;
    }
  }

  if (s1 > s2)
  {
    {
      teamOne->wins++;
    }
  }
  else
  {
    
  }

  if (s1 < s2)
  {
    {
      teamTwo->wins++;
    }
  }
  else
  {
    
  }

}

void freeGame(struct game *game)
{
  free(game->name);
  free(game);
}

void freeTeam(struct team *team)
{
  free(team->name);
  free(team);
}

void deleteHashTeams(struct team **hash_teams)
{
  int i;
  struct team *t;
  struct team *t1;
  for (i = 0; i < 43100; i++)
  {
    if (hash_teams[i] != 0)
    {
      {
        t1 = hash_teams[i];
        while (t1 != 0)
        {
          t = t1->nextHash;
          freeTeam(t1);
          t1 = t;
        }

      }
    }
    else
    {
      
    }

  }

  free(hash_teams);
}

int teamExists(char *name, struct team **hash_teams)
{
  struct team *t;
  for (t = hash_teams[hash(name)]; t != 0; t = t->nextHash)
  {
    if (strcmp(name, t->name) == 0)
    {
      {
        return 0;
      }
    }
    else
    {
      
    }

  }

  return -1;
}

int gameExists(char *name, struct game **hash_games)
{
  struct game *g;
  if (hash_games[hash(name)] == 0)
  {
    {
      return -1;
    }
  }
  else
  {
    {
      for (g = hash_games[hash(name)]; g != 0; g = g->nextHash)
      {
        if (strcmp(name, g->name) == 0)
        {
          {
            return 0;
          }
        }
        else
        {
          
        }

      }

    }
  }

  return -1;
}

struct team *getTeam(char *name, struct team **hash_teams)
{
  struct team *t;
  for (t = hash_teams[hash(name)]; t != 0; t = t->nextHash)
  {
    if (strcmp(name, t->name) == 0)
    {
      {
        return t;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

void changeScore(struct game *g, int s1, int s2)
{
  if (g->score1 > g->score2)
  {
    {
      if (s1 < s2)
      {
        {
          g->team2->wins++;
          g->team1->wins--;
        }
      }
      else
      {
        
      }

      if (s1 == s2)
      {
        {
          g->team1->wins--;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    if (g->score1 < g->score2)
    {
      {
        if (s1 > s2)
        {
          {
            g->team1->wins++;
            g->team2->wins--;
          }
        }
        else
        {
          
        }

        if (s1 == s2)
        {
          {
            g->team2->wins--;
          }
        }
        else
        {
          
        }

      }
    }
    else
    {
      {
        if (s1 > s2)
        {
          {
            g->team1->wins++;
          }
        }
        else
        {
          
        }

        if (s1 < s2)
        {
          {
            g->team2->wins++;
          }
        }
        else
        {
          
        }

      }
    }

  }

  g->score1 = s1;
  g->score2 = s2;
}

void removeGame(struct game *g, struct game **hash_games, struct game **lastGame, struct game **firstGame)
{
  struct game *game;
  struct game *game1;
  changeScore(g, 0, 0);
  if (g->previousHash == 0)
  {
    {
      if (g->nextHash == 0)
      {
        {
          hash_games[hash(g->name)] = 0;
        }
      }
      else
      {
        {
          game = g->nextHash;
          game->previousHash = 0;
          hash_games[hash(g->name)] = game;
        }
      }

    }
  }
  else
  {
    {
      game = g->previousHash;
      game->nextHash = g->nextHash;
    }
  }

  if (g->previousGeral == 0)
  {
    {
      if (g->nextGeral == 0)
      {
        {
          *firstGame = 0;
          *lastGame = 0;
          freeGame(g);
          return;
        }
      }
      else
      {
        {
          game = g->nextGeral;
          game->previousGeral = 0;
          *firstGame = game;
          freeGame(g);
          return;
        }
      }

    }
  }
  else
  {
    {
      if (g->nextGeral == 0)
      {
        {
          game = g->previousGeral;
          game->nextGeral = 0;
          *lastGame = game;
          freeGame(g);
          return;
        }
      }
      else
      {
        {
          game = g->previousGeral;
          game1 = g->nextGeral;
          game1->previousGeral = game;
          game->nextGeral = game1;
          freeGame(g);
          return;
        }
      }

    }
  }

}

int findMaxWins(struct team **hash_teams)
{
  int max;
  int i;
  struct team *t;
  max = -1;
  for (i = 0; i < 43100; i++)
  {
    if (hash_teams[i] != 0)
    {
      {
        for (t = hash_teams[i]; t != 0; t = t->nextHash)
        {
          if (t->wins > max)
          {
            {
              max = t->wins;
            }
          }
          else
          {
            
          }

        }

      }
    }
    else
    {
      
    }

  }

  return max;
}

void sortAlphabetic(char **array, int max)
{
  int i;
  int j;
  char *swap;
  for (i = 0; i < max; i++)
  {
    for (j = 0; j < max; j++)
    {
      if (strcmp(array[j], array[i]) > 0)
      {
        {
          swap = array[i];
          array[i] = array[j];
          array[j] = swap;
        }
      }
      else
      {
        
      }

    }

  }

}

