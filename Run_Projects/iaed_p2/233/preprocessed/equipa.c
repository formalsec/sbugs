/*File generated by PreProcessor.py*/


#include "struct.h"
#include <string.h>
#include <stdio.h>
#include <stdlib.h>


int tamanho_hash = 97;
int nr_equipas = 0;
int hash(char *str)
{
  int aux = 0;
  int i = 0;
  while (str[i] != '\0')
  {
    aux = aux + str[i];
    i++;
  }

  return aux % tamanho_hash;
}

void createHash()
{
  int i;
  nr_equipas = 0;
  hash_e = malloc((sizeof(equipa *)) * tamanho_hash);
  for (i = 0; i < tamanho_hash; i++)
  {
    hash_e[i] = 0;
  }

}

void destroyHash()
{
  int i;
  for (i = 0; i < tamanho_hash; i++)
  {
    if (hash_e[i] != 0)
    {
      {
        free(hash_e[i]->nome);
        free(hash_e[i]);
      }
    }
    else
    {
      
    }

  }

  free(hash_e);
}

int A()
{
  char nome[1024];
  int i;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  i = hash(nome);
  while (hash_e[i] != 0)
  {
    if (strcmp(hash_e[i]->nome, nome) == 0)
    {
      {
        printf("%d Equipa existente.\n", NL);
        return 0;
      }
    }
    else
    {
      
    }

    i = (i + 1) % tamanho_hash;
  }

  hash_e[i] = malloc(sizeof(equipa));
  hash_e[i]->nome = malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(hash_e[i]->nome, nome);
  hash_e[i]->ganhos = 0;
  if ((nr_equipas++) > (tamanho_hash / 2))
  {
    {
      expand();
    }
  }
  else
  {
    
  }

  return 1;
}

void insert(equipa *aux)
{
  int i;
  i = hash(aux->nome);
  while (hash_e[i] != 0)
  {
    i = (i + 1) % tamanho_hash;
  }

  hash_e[i] = aux;
  nr_equipas++;
}

void expand()
{
  int i;
  equipa **aux = hash_e;
  tamanho_hash = tamanho_hash * 2;
  createHash();
  for (i = 0; i < (tamanho_hash / 2); i++)
  {
    if (aux[i] != 0)
    {
      {
        insert(aux[i]);
      }
    }
    else
    {
      
    }

  }

  free(aux);
}

int procuraEquipa(char *nome)
{
  int aux;
  aux = hash(nome);
  while (hash_e[aux] != 0)
  {
    if (strcmp(hash_e[aux]->nome, nome) == 0)
    {
      {
        return aux;
      }
    }
    else
    {
      
    }

    aux++;
    aux %= tamanho_hash;
  }

  return -1;
}

void printHash()
{
  int i;
  for (i = 0; i < tamanho_hash; i++)
  {
    if (hash_e[i] != 0)
    {
      {
        printf("%s(%d) %d\n", hash_e[i]->nome, i, hash_e[i]->ganhos);
      }
    }
    else
    {
      
    }

  }

}

void P()
{
  int aux;
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = procuraEquipa(nome);
  if (aux != (-1))
  {
    {
      printf("%d %s %d\n", NL, hash_e[aux]->nome, hash_e[aux]->ganhos);
    }
  }
  else
  {
    {
      printf("%d Equipa inexistente.\n", NL);
    }
  }

}

void troca(equipa **array, int pai, int filho)
{
  equipa *aux = array[pai];
  array[pai] = array[filho];
  array[filho] = aux;
}

void heapify(equipa **array, int t, int i)
{
  int pai = i;
  int esquerda = (2 * i) + 1;
  int direita = (2 * i) + 2;
  if ((esquerda < t) && (strcmp(array[esquerda]->nome, array[pai]->nome) > 0))
  {
    {
      pai = esquerda;
    }
  }
  else
  {
    
  }

  if ((direita < t) && (strcmp(array[direita]->nome, array[pai]->nome) > 0))
  {
    {
      pai = direita;
    }
  }
  else
  {
    
  }

  if (pai != i)
  {
    {
      troca(array, i, pai);
      heapify(array, t, pai);
    }
  }
  else
  {
    
  }

}

void g()
{
  int i;
  int e = 0;
  int mais_ganhos = -1;
  if (nr_equipas > 0)
  {
    {
      equipa **aux = malloc((sizeof(equipa *)) * nr_equipas);
      for (i = 0; i < tamanho_hash; i++)
      {
        if (hash_e[i] != 0)
        {
          {
            if (mais_ganhos == (-1))
            {
              {
                aux[e++] = hash_e[i];
                mais_ganhos = hash_e[i]->ganhos;
              }
            }
            else
            {
              if (aux[0]->ganhos < hash_e[i]->ganhos)
              {
                {
                  e = 0;
                  aux[e++] = hash_e[i];
                  mais_ganhos = hash_e[i]->ganhos;
                }
              }
              else
              {
                if (aux[0]->ganhos == hash_e[i]->ganhos)
                {
                  {
                    aux[e++] = hash_e[i];
                  }
                }
                else
                {
                  
                }

              }

            }

          }
        }
        else
        {
          
        }

      }

      for (i = (e / 2) - 1; i >= 0; i--)
      {
        heapify(aux, e, i);
      }

      for (i = e - 1; i >= 0; i--)
      {
        troca(aux, 0, i);
        heapify(aux, i, 0);
      }

      printf("%d Melhores %d\n", NL, mais_ganhos);
      for (i = 0; i < e; i++)
      {
        printf("%d * %s\n", NL, aux[i]->nome);
      }

      free(aux);
    }
  }
  else
  {
    
  }

}

