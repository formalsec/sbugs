/*File generated by PreProcessor.py*/


#include "p2.h"             /* Header file que contem as estruturas utilizadas no projeto e os comandos */
#include "auxiliares.h"     /* Header file que contem os defines relativos as funcoes auxiliares */
#include <stdio.h>
#include <stdlib.h> 
#include <string.h>


Lista_jogos *a(int NL, char s[], hashtable_jogos *ht_jogos, hashtable_equipas *ht_equipa, Lista_jogos *lista_jogo)
{
  unsigned int slot;
  Jogo *novo;
  Equipa *equipa;
  char *separa;
  separa = strtok(s, ":");
  if (ht_jogos_verifica(ht_jogos, separa) != 0)
  {
    {
      printf("%d Jogo existente.\n", NL);
      return lista_jogo;
    }
  }
  else
  {
    
  }

  novo = malloc(sizeof(Jogo));
  novo->nome = malloc(strlen(separa) + 1);
  strcpy(novo->nome, separa);
  separa = strtok(0, ":");
  if (ht_equipas_verifica(ht_equipa, separa) == 0)
  {
    {
      printf("%d Equipa inexistente.\n", NL);
      free(novo->nome);
      free(novo);
      return lista_jogo;
    }
  }
  else
  {
    
  }

  novo->equipa1 = malloc(sizeof(Equipa));
  novo->equipa1->nome = malloc(strlen(separa) + 1);
  strcpy(novo->equipa1->nome, separa);
  separa = strtok(0, ":");
  if (ht_equipas_verifica(ht_equipa, separa) == 0)
  {
    {
      printf("%d Equipa inexistente.\n", NL);
      free(novo->nome);
      free(novo);
      return lista_jogo;
    }
  }
  else
  {
    
  }

  novo->equipa2 = malloc(sizeof(Equipa));
  novo->equipa2->nome = malloc(strlen(separa) + 1);
  strcpy(novo->equipa2->nome, separa);
  separa = strtok(0, ":");
  novo->score1 = atoi(separa);
  separa = strtok(0, ":");
  novo->score2 = atoi(separa);
  if (novo->score1 > novo->score2)
  {
    {
      novo->equipa1->vitorias += 1;
      equipa = ht_equipas_verifica(ht_equipa, novo->equipa1->nome);
      equipa->vitorias += 1;
    }
  }
  else
  {
    
  }

  if (novo->score2 > novo->score1)
  {
    {
      novo->equipa2->vitorias += 1;
      equipa = ht_equipas_verifica(ht_equipa, novo->equipa2->nome);
      equipa->vitorias += 1;
    }
  }
  else
  {
    
  }

  novo->next = 0;
  novo->prev = lista_jogo->last;
  slot = hash(novo->nome);
  if (lista_jogo->head == 0)
  {
    {
      lista_jogo->head = novo;
    }
  }
  else
  {
    {
      lista_jogo->last->next = novo;
    }
  }

  lista_jogo->last = novo;
  ht_jogos->entradas[slot] = novo;
  return lista_jogo;
}

void p(int NL, char s[], hashtable_jogos *ht_jogo)
{
  Jogo *a = ht_jogos_verifica(ht_jogo, s);
  if (a == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  printf("%d %s %s %s %d %d\n", NL, a->nome, a->equipa1->nome, a->equipa2->nome, a->score1, a->score2);
  return;
}

void l(int NL, Lista_jogos *lista_jogo)
{
  Jogo *t = lista_jogo->head;
  if (t == 0)
  {
    {
      return;
    }
  }
  else
  {
    
  }

  while (t != 0)
  {
    printf("%d %s %s %s %d %d\n", NL, t->nome, t->equipa1->nome, t->equipa2->nome, t->score1, t->score2);
    t = t->next;
  }

  return;
}

Lista_jogos *r(int NL, char s[], hashtable_jogos *ht_jogos, hashtable_equipas *ht_equipa, Lista_jogos *lista_jogo)
{
  Equipa *equipa;
  Jogo *a = ht_jogos_verifica(ht_jogos, s);
  if (a == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return lista_jogo;
    }
  }
  else
  {
    
  }

  if (a->score1 > a->score2)
  {
    {
      if (a->equipa1->vitorias > 0)
      {
        {
          a->equipa1->vitorias -= 1;
          equipa = ht_equipas_verifica(ht_equipa, a->equipa1->nome);
          equipa->vitorias -= 1;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  if (a->score2 > a->score1)
  {
    {
      if (a->equipa2->vitorias > 0)
      {
        {
          a->equipa2->vitorias -= 1;
          equipa = ht_equipas_verifica(ht_equipa, a->equipa2->nome);
          equipa->vitorias -= 1;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  if (a->next != 0)
  {
    {
      a->next->prev = a->prev;
    }
  }
  else
  {
    
  }

  if (a->prev != 0)
  {
    {
      a->prev->next = a->next;
    }
  }
  else
  {
    
  }

  if (a == lista_jogo->head)
  {
    {
      lista_jogo->head = a->next;
    }
  }
  else
  {
    
  }

  if (a == lista_jogo->last)
  {
    {
      lista_jogo->last = a->prev;
    }
  }
  else
  {
    
  }

  free(a->equipa2->nome);
  free(a->equipa2);
  free(a->equipa1->nome);
  free(a->equipa1);
  free(a->nome);
  free(a);
  return lista_jogo;
}

Lista_jogos *s_altera(int NL, char s[], hashtable_jogos *ht_jogos, hashtable_equipas *ht_equipa, Lista_jogos *lista_jogo)
{
  Jogo *a;
  Equipa *equipa;
  char *separa = strtok(s, ":");
  a = ht_jogos_verifica(ht_jogos, separa);
  if (a == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return lista_jogo;
    }
  }
  else
  {
    
  }

  if (a->score1 > a->score2)
  {
    {
      if (a->equipa1->vitorias > 0)
      {
        {
          a->equipa1->vitorias -= 1;
          equipa = ht_equipas_verifica(ht_equipa, a->equipa1->nome);
          equipa->vitorias -= 1;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  if (a->score2 > a->score1)
  {
    {
      if (a->equipa2->vitorias > 0)
      {
        {
          a->equipa2->vitorias -= 1;
          equipa = ht_equipas_verifica(ht_equipa, a->equipa2->nome);
          equipa->vitorias -= 1;
        }
      }
      else
      {
        
      }

    }
  }
  else
  {
    
  }

  separa = strtok(0, ":");
  a->score1 = atoi(separa);
  separa = strtok(0, ":");
  a->score2 = atoi(separa);
  if (a->score1 > a->score2)
  {
    {
      a->equipa1->vitorias += 1;
      equipa = ht_equipas_verifica(ht_equipa, a->equipa1->nome);
      equipa->vitorias += 1;
    }
  }
  else
  {
    
  }

  if (a->score2 > a->score1)
  {
    {
      a->equipa2->vitorias += 1;
      equipa = ht_equipas_verifica(ht_equipa, a->equipa2->nome);
      equipa->vitorias += 1;
    }
  }
  else
  {
    
  }

  return lista_jogo;
}

