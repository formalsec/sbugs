/*File generated by PreProcessor.py*/


#include <string.h>
#include <stdlib.h>
#include "equipas.h"
#include "equipas_hashtable.h"


int hash(char *str, int M)
{
  int h;
  int a = 31415;
  int b = 27183;
  for (h = 0; (*str) != '\0'; str++, a = (a * b) % (M - 1))
  {
    h = ((a * h) + (*str)) % M;
  }

  return h;
}

equipa **inicia_hashtable_equipas(int *max, int *num_elem)
{
  equipa **nova_hastable;
  int i;
  int M = 2 * (*max);
  *num_elem = 0;
  nova_hastable = malloc(M * (sizeof(equipa *)));
  for (i = 0; i < M; i++)
  {
    nova_hastable[i] = 0;
  }

  return nova_hastable;
}

equipa *insere_equipa(equipa *nova_equipa, int *pt_max_ht_equipas, equipa **hashtable_equipas, int *pt_num_elem)
{
  int i = hash(nova_equipa->nome, *pt_max_ht_equipas);
  while (hashtable_equipas[i] != 0)
  {
    if (strcmp(hashtable_equipas[i]->nome, nova_equipa->nome) == 0)
    {
      {
        return 0;
      }
    }
    else
    {
      
    }

    i = (i + 1) % (*pt_max_ht_equipas);
  }

  hashtable_equipas[i] = nova_equipa;
  if (((*pt_num_elem)++) > ((*pt_max_ht_equipas) / 2))
  {
    {
      hashtable_equipas = expande_hashtable_equipas(hashtable_equipas, pt_max_ht_equipas, pt_num_elem);
    }
  }
  else
  {
    
  }

  return hashtable_equipas[i];
}

void liberta_hashtable_equipas(equipa **ht_equipas, int max_ht_equipas)
{
  int i;
  for (i = 0; i < max_ht_equipas; i++)
  {
    if (ht_equipas[i] != 0)
    {
      {
        liberta_equipa(ht_equipas[i]);
      }
    }
    else
    {
      
    }

  }

  free(ht_equipas);
}

equipa **expande_hashtable_equipas(equipa **ht_equipas, int *pt_max_ht_equipas, int *pt_num_elem)
{
  int i;
  equipa **hastable_antiga = ht_equipas;
  *pt_max_ht_equipas = 2 * (*pt_max_ht_equipas);
  ht_equipas = inicia_hashtable_equipas(pt_max_ht_equipas, pt_num_elem);
  for (i = 0; i < ((*pt_max_ht_equipas) / 2); i++)
  {
    if (hastable_antiga[i] != 0)
    {
      {
        insere_equipa(hastable_antiga[i], pt_max_ht_equipas, ht_equipas, pt_num_elem);
      }
    }
    else
    {
      
    }

  }

  liberta_hashtable_equipas(hastable_antiga, *pt_max_ht_equipas);
  return ht_equipas;
}

equipa *procura_equipa_ht(equipa **ht_equipas, char nome_equipa_procurar[], int max_ht_equipas)
{
  int i = hash(nome_equipa_procurar, max_ht_equipas);
  while (ht_equipas[i] != 0)
  {
    if (strcmp(ht_equipas[i]->nome, nome_equipa_procurar) == 0)
    {
      {
        return ht_equipas[i];
      }
    }
    else
    {
      {
        i = (i + 1) % max_ht_equipas;
      }
    }

  }

  return 0;
}

