/*File generated by PreProcessor.py*/


#include "declaracoes.h"
#include <stdio.h>
#include <string.h>
#include <stdlib.h>


lista *cria_lista()
{
  lista *l = malloc(sizeof(lista));
  l->head = (l->last = 0);
  return l;
}

void adiciona_novo_jogo(lista *ls, link_j *heads_j, link_e *heads_e, int nl)
{
  char buffer_nome[1024];
  char buffer_equipa1[1024];
  char buffer_equipa2[1024];
  link_e equipa1;
  link_e equipa2;
  int p1;
  int p2;
  int i;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  for (int buffer_equipa1_index = 0; buffer_equipa1_index < 10; buffer_equipa1_index++)
  {
    buffer_equipa1[buffer_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_equipa1[10 - 1] = '\0';
  for (int buffer_equipa2_index = 0; buffer_equipa2_index < 10; buffer_equipa2_index++)
  {
    buffer_equipa2[buffer_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_equipa2[10 - 1] = '\0';
  p1 = new_sym_var(sizeof(int) * 8);
  p2 = new_sym_var(sizeof(int) * 8);
  getchar();
  if (!pesquisa_jogo(heads_j, buffer_nome))
  {
    {
      equipa1 = pesquisa_equipa(heads_e, buffer_equipa1);
      equipa2 = pesquisa_equipa(heads_e, buffer_equipa2);
      if (equipa1 && equipa2)
      {
        {
          i = hash(buffer_nome, 1000);
          heads_j[i] = insere_jogo_inicio(ls, heads_j[i], buffer_nome, buffer_equipa1, buffer_equipa2, p1, p2);
          if (p1 > p2)
          {
            {
              equipa1->e.vitorias++;
            }
          }
          else
          {
            if (p1 < p2)
            {
              {
                equipa2->e.vitorias++;
              }
            }
            else
            {
              
            }

          }

        }
      }
      else
      {
        printf("%d Equipa inexistente.\n", nl);
      }

    }
  }
  else
  {
    printf("%d Jogo existente.\n", nl);
  }

}

void adiciona_nova_equipa(link_e *heads_e, int *contador_equipas, int nl)
{
  char buffer_nome[1024];
  int i;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  getchar();
  if (!pesquisa_equipa(heads_e, buffer_nome))
  {
    {
      i = hash(buffer_nome, 1000);
      heads_e[i] = insere_equipa_inicio(heads_e[i], buffer_nome);
      *contador_equipas = (*contador_equipas) + 1;
    }
  }
  else
  {
    printf("%d Equipa existente.\n", nl);
  }

}

void lista_jogos(lista *ls, int nl)
{
  node_j *n;
  for (n = ls->head; n; n = n->next)
    printf("%d %s %s %s %d %d\n", nl, n->j->nome, n->j->equipa1, n->j->equipa2, n->j->p1, n->j->p2);

  getchar();
}

void proucura_jogo(link_j *heads_j, int nl)
{
  char buffer_nome[1024];
  link_j t;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  getchar();
  t = pesquisa_jogo(heads_j, buffer_nome);
  if (t)
  {
    printf("%d %s %s %s %d %d\n", nl, buffer_nome, t->j->equipa1, t->j->equipa2, t->j->p1, t->j->p2);
  }
  else
  {
    printf("%d Jogo inexistente.\n", nl);
  }

}

void procura_equipa(link_e *heads_e, int nl)
{
  char buffer_nome[1024];
  link_e equipa;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  getchar();
  equipa = pesquisa_equipa(heads_e, buffer_nome);
  if (equipa)
  {
    {
      printf("%d %s %d\n", nl, buffer_nome, equipa->e.vitorias);
    }
  }
  else
  {
    printf("%d Equipa inexistente.\n", nl);
  }

}

void apaga_jogo(link_j *heads_j, link_e *heads_e, lista *ls, int nl)
{
  char buffer_nome[1024];
  link_j t;
  link_e equipa;
  int i;
  node_j *n;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  getchar();
  t = pesquisa_jogo(heads_j, buffer_nome);
  if (t)
  {
    {
      if (t->j->p1 > t->j->p2)
      {
        {
          equipa = pesquisa_equipa(heads_e, t->j->equipa1);
          equipa->e.vitorias--;
        }
      }
      else
      {
        if (t->j->p1 < t->j->p2)
        {
          {
            equipa = pesquisa_equipa(heads_e, t->j->equipa2);
            equipa->e.vitorias--;
          }
        }
        else
        {
          
        }

      }

      for (n = ls->head; n; n = n->next)
        if (strcmp(n->j->nome, buffer_nome) == 0)
      {
        {
          remove_node(ls, n);
          break;
        }
      }
      else
      {
        
      }


      i = hash(buffer_nome, 1000);
      heads_j[i] = apaga_node_jogo(heads_j[i], buffer_nome);
    }
  }
  else
  {
    printf("%d Jogo inexistente.\n", nl);
  }

}

void altera_score(link_j *heads_j, link_e *heads_e, int nl)
{
  char buffer_nome[1024];
  int p1;
  int p2;
  link_e equipa1;
  link_e equipa2;
  link_j t;
  getchar();
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  p1 = new_sym_var(sizeof(int) * 8);
  p2 = new_sym_var(sizeof(int) * 8);
  getchar();
  t = pesquisa_jogo(heads_j, buffer_nome);
  if (t)
  {
    {
      equipa1 = pesquisa_equipa(heads_e, t->j->equipa1);
      equipa2 = pesquisa_equipa(heads_e, t->j->equipa2);
      if ((t->j->p1 > t->j->p2) && (p2 > p1))
      {
        {
          equipa1->e.vitorias--;
          equipa2->e.vitorias++;
        }
      }
      else
      {
        if ((t->j->p1 < t->j->p2) && (p2 < p1))
        {
          {
            equipa1->e.vitorias++;
            equipa2->e.vitorias--;
          }
        }
        else
        {
          if (p1 == p2)
          {
            {
              if (t->j->p1 > t->j->p2)
              {
                equipa1->e.vitorias--;
              }
              else
              {
                if (t->j->p1 < t->j->p2)
                {
                  equipa2->e.vitorias--;
                }
                else
                {
                  
                }

              }

            }
          }
          else
          {
            if (t->j->p1 == t->j->p2)
            {
              {
                if (p1 < p2)
                {
                  equipa2->e.vitorias++;
                }
                else
                {
                  if (p1 > p2)
                  {
                    equipa1->e.vitorias++;
                  }
                  else
                  {
                    
                  }

                }

              }
            }
            else
            {
              
            }

          }

        }

      }

      t->j->p1 = p1;
      t->j->p2 = p2;
    }
  }
  else
  {
    printf("%d Jogo inexistente.\n", nl);
  }

}

void equipa_vitorias(link_e *heads_e, int *contador_equipas, int nl)
{
  int i;
  int max = 0;
  int contador;
  int conta_equipas = 0;
  link_e equipa;
  char *arr[200];
  getchar();
  for (i = 0; i < 1000; i++)
  {
    for (equipa = heads_e[i]; equipa; equipa = equipa->next)
    {
      contador = equipa->e.vitorias;
      if (contador > max)
      {
        max = contador;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < 1000; i++)
  {
    for (equipa = heads_e[i]; equipa; equipa = equipa->next)
    {
      if (equipa->e.vitorias == max)
      {
        {
          arr[conta_equipas] = equipa->e.nome;
          conta_equipas++;
        }
      }
      else
      {
        
      }

    }

  }

  qsort(arr, conta_equipas, sizeof(char *), comparador);
  if (*contador_equipas)
  {
    printf("%d Melhores %d\n", nl, max);
  }
  else
  {
    
  }

  for (i = 0; i < conta_equipas; i++)
    printf("%d * %s\n", nl, arr[i]);

}

void le_lixo()
{
  char buffer_nome[1024];
  for (int buffer_nome_index = 0; buffer_nome_index < 10; buffer_nome_index++)
  {
    buffer_nome[buffer_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer_nome[10 - 1] = '\0';
  getchar();
}

void limpa_ht_jogos(link_j *heads_j)
{
  int i;
  link_j limpa_aux;
  for (i = 0; i < 1000; i++)
  {
    while (heads_j[i])
    {
      limpa_aux = heads_j[i];
      heads_j[i] = heads_j[i]->next;
      free(limpa_aux->j->nome);
      free(limpa_aux->j->equipa1);
      free(limpa_aux->j->equipa2);
      free(limpa_aux->j);
      free(limpa_aux);
    }

  }

  free(heads_j);
}

void limpa_ht_equipas(link_e *heads_e)
{
  int i;
  link_e liberta_aux;
  for (i = 0; i < 1000; i++)
  {
    while (heads_e[i])
    {
      liberta_aux = heads_e[i];
      heads_e[i] = heads_e[i]->next;
      free(liberta_aux->e.nome);
      free(liberta_aux);
    }

  }

  free(heads_e);
}

void limpa_lista_ligada(lista *l)
{
  while (l->head)
  {
    node_j *aux = l->head->next;
    free(l->head);
    l->head = aux;
  }

  free(l);
}

