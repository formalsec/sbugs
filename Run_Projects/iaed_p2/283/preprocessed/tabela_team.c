/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "tabela_team.h"
#include "hash.h"


void liberta_link_t(link_t head)
{
  link_t aux;
  while (head != 0)
  {
    aux = head;
    head = head->next;
    free_team(aux->team);
    free(aux);
  }

  free(head);
}

link_t *init_t()
{
  link_t *table;
  table = calloc(1551, sizeof(link_t));
  return table;
}

Team *encontra_t(link_t *table, char team[])
{
  int hash_id;
  link_t aux;
  hash_id = hash(team);
  aux = table[hash_id];
  while (aux != 0)
  {
    if (strcmp(team, aux->team->name_team) == 0)
    {
      return aux->team;
    }
    else
    {
      
    }

    aux = aux->next;
  }

  return 0;
}

void introduz_table_t(link_t *table, Team *new_team)
{
  int hash_id;
  link_t novo_link;
  novo_link = malloc(sizeof(struct link_t));
  hash_id = hash(new_team->name_team);
  novo_link->team = new_team;
  novo_link->next = table[hash_id];
  table[hash_id] = novo_link;
}

void liberta_table_t(link_t *table)
{
  int i;
  link_t *aux;
  aux = table;
  for (i = 0; i < 1551; i++)
    liberta_link_t(aux[i]);

  free(aux);
}

void Remove_table_t(link_t *table, Team *t)
{
  int hash_id;
  link_t tmp;
  link_t tmp2;
  hash_id = hash(t->name_team);
  tmp = table[hash_id];
  if (table[hash_id] == 0)
  {
    return;
  }
  else
  {
    if ((table[hash_id]->next == 0) && (strcmp(t->name_team, tmp->team->name_team) != 0))
    {
      ;
    }
    else
    {
      if ((table[hash_id]->next == 0) && (strcmp(t->name_team, tmp->team->name_team) == 0))
      {
        {
          table[hash_id] = table[hash_id]->next;
          free_team(tmp->team);
          free(tmp);
          return;
        }
      }
      else
      {
        {
          if (strcmp(tmp->team->name_team, t->name_team) == 0)
          {
            {
              tmp2 = tmp;
              table[hash_id] = table[hash_id]->next;
              free_team(tmp2->team);
              free(tmp2);
              return;
            }
          }
          else
          {
            
          }

          while (tmp->next != 0)
          {
            if (strcmp(t->name_team, tmp->next->team->name_team) == 0)
            {
              {
                tmp2 = tmp->next;
                tmp->next = tmp2->next;
                free_team(tmp2->team);
                free(tmp2);
                return;
              }
            }
            else
            {
              
            }

            tmp = tmp->next;
          }

          return;
        }
      }

    }

  }

}

int ve_maior(link_t *table)
{
  int i;
  int maior = 0;
  link_t tmp;
  for (i = 0; i < 1551; i++)
  {
    if (table[i] == 0)
    {
      continue;
    }
    else
    {
      {
        tmp = table[i];
        while (tmp != 0)
        {
          if (tmp->team->numero_wins > maior)
          {
            maior = tmp->team->numero_wins;
          }
          else
          {
            
          }

          tmp = tmp->next;
        }

      }
    }

  }

  return maior;
}

int teams_maiores(link_t *table, char **vec, int maior)
{
  int i;
  int cont_teams = 0;
  link_t tmp;
  for (i = 0; i < 1551; i++)
  {
    if (table[i] != 0)
    {
      {
        tmp = table[i];
        while (tmp != 0)
        {
          if (tmp->team->numero_wins == maior)
          {
            {
              strcpy(vec[cont_teams], tmp->team->name_team);
              cont_teams++;
            }
          }
          else
          {
            
          }

          tmp = tmp->next;
        }

      }
    }
    else
    {
      
    }

  }

  return cont_teams;
}

void merge(char **aux, char **aux1, int l, int m, int r)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
    aux1[i - 1] = aux[i - 1];

  for (j = m; j < r; j++)
    aux1[(r + m) - j] = aux[j + 1];

  for (k = l; k <= r; k++)
  {
    if (strcmp(aux1[j], aux1[i]) < 0)
    {
      aux[k] = aux1[j--];
    }
    else
    {
      aux[k] = aux1[i++];
    }

  }

}

void merge_principal(char **aux, char **aux_1, int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  merge_principal(aux, aux_1, l, m);
  merge_principal(aux, aux_1, m + 1, r);
  merge(aux, aux_1, l, m, r);
}

