/*File generated by PreProcessor.py*/


#include "Funcoes.h"


void A(Hash_Equipa *ptr_HTE, Lista_Equipas *CE, int *Contador_Instrucoes)
{
  char equipa[1023];
  Equipas *aux;
  getchar();
  for (int equipa_index = 0; equipa_index < 10; equipa_index++)
  {
    equipa[equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa[10 - 1] = '\0';
  *Contador_Instrucoes += 1;
  if (!hash_procura_Equipa(ptr_HTE, equipa))
  {
    {
      int index = hash(equipa);
      aux = malloc(sizeof(Equipas));
      aux->nome = malloc(strlen(equipa) + 1);
      strcpy(aux->nome, equipa);
      aux->vitorias = 0;
      aux->proximo = CE->topo;
      CE->topo = aux;
      hash_insercao_EQUIPAS(ptr_HTE, index, aux);
    }
  }
  else
  {
    printf("%d Equipa existente.\n", *Contador_Instrucoes);
  }

}

void a(Hash_Jogo *ptr_HTJ, Hash_Equipa *ptr_HTE, Lista_Jogos *CJ, int *Contador_Instrucoes)
{
  char nome_jogo[1023];
  char equipa01[1023];
  char equipa02[1023];
  int pontuacao01;
  int pontuacao02;
  Jogo *aux;
  getchar();
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int equipa01_index = 0; equipa01_index < 10; equipa01_index++)
  {
    equipa01[equipa01_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa01[10 - 1] = '\0';
  for (int equipa02_index = 0; equipa02_index < 10; equipa02_index++)
  {
    equipa02[equipa02_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa02[10 - 1] = '\0';
  pontuacao01 = new_sym_var(sizeof(int) * 8);
  pontuacao02 = new_sym_var(sizeof(int) * 8);
  *Contador_Instrucoes += 1;
  if (hash_procura_Jogo(ptr_HTJ, nome_jogo))
  {
    printf("%d Jogo existente.\n", *Contador_Instrucoes);
  }
  else
  {
    if ((!hash_procura_Equipa(ptr_HTE, equipa01)) || (!hash_procura_Equipa(ptr_HTE, equipa02)))
    {
      printf("%d Equipa inexistente.\n", *Contador_Instrucoes);
    }
    else
    {
      {
        int index = hash(nome_jogo);
        aux = malloc(sizeof(Jogo));
        aux->nome = malloc(strlen(nome_jogo) + 1);
        strcpy(aux->nome, nome_jogo);
        aux->equipa1 = malloc(strlen(equipa01) + 1);
        strcpy(aux->equipa1, equipa01);
        aux->equipa2 = malloc(strlen(equipa02) + 1);
        strcpy(aux->equipa2, equipa02);
        aux->pontuacao1 = pontuacao01;
        aux->pontuacao2 = pontuacao02;
        if (pontuacao01 > pontuacao02)
        {
          {
            Equipas *aux_t = hash_procura_Equipa(ptr_HTE, equipa01);
            aux_t->vitorias += 1;
          }
        }
        else
        {
          if (pontuacao01 < pontuacao02)
          {
            {
              Equipas *aux_t = hash_procura_Equipa(ptr_HTE, equipa02);
              aux_t->vitorias += 1;
            }
          }
          else
          {
            
          }

        }

        aux->proximo = 0;
        aux->anterior = CJ->fim;
        if (!CJ->fim)
        {
          CJ->topo = aux;
        }
        else
        {
          CJ->fim->proximo = aux;
        }

        CJ->fim = aux;
        hash_insercao_JOGOS(ptr_HTJ, index, aux);
      }
    }

  }

}

void P(Hash_Equipa *ptr_HTE, int *Contador_Instrucoes)
{
  char nome_equipa[1023];
  getchar();
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  *Contador_Instrucoes += 1;
  if (!hash_procura_Equipa(ptr_HTE, nome_equipa))
  {
    printf("%d Equipa inexistente.\n", *Contador_Instrucoes);
  }
  else
  {
    {
      Equipas *aux = hash_procura_Equipa(ptr_HTE, nome_equipa);
      printf("%d %s %d\n", *Contador_Instrucoes, aux->nome, aux->vitorias);
    }
  }

}

void p(Hash_Jogo *ptr_HTJ, int *Contador_Instrucoes)
{
  char nome_jogo[1023];
  getchar();
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  *Contador_Instrucoes += 1;
  if (!hash_procura_Jogo(ptr_HTJ, nome_jogo))
  {
    printf("%d Jogo inexistente.\n", *Contador_Instrucoes);
  }
  else
  {
    {
      Jogo *aux = hash_procura_Jogo(ptr_HTJ, nome_jogo);
      printf("%d %s %s %s %d %d\n", *Contador_Instrucoes, aux->nome, aux->equipa1, aux->equipa2, aux->pontuacao1, aux->pontuacao2);
    }
  }

}

void l(Lista_Jogos *CJ, int *Contador_Instrucoes)
{
  Jogo *aux;
  *Contador_Instrucoes += 1;
  for (aux = CJ->topo; aux != 0; aux = aux->proximo)
  {
    printf("%d %s %s %s %d %d\n", *Contador_Instrucoes, aux->nome, aux->equipa1, aux->equipa2, aux->pontuacao1, aux->pontuacao2);
  }

}

void atualiza_pontuacoes(Jogo *aux_j, int pontuacao_nova1, int pontuacao_nova2)
{
  aux_j->pontuacao1 = pontuacao_nova1;
  aux_j->pontuacao2 = pontuacao_nova2;
}

void retira_vitoria(Hash_Equipa *ptr_HTE, char *equipa)
{
  Equipas *aux_e;
  aux_e = hash_procura_Equipa(ptr_HTE, equipa);
  if (aux_e->vitorias != 0)
  {
    aux_e->vitorias -= 1;
  }
  else
  {
    
  }

}

void adiciona_vitoria(Hash_Equipa *ptr_HTE, char *equipa)
{
  Equipas *aux_e;
  aux_e = hash_procura_Equipa(ptr_HTE, equipa);
  aux_e->vitorias += 1;
}

void s(Hash_Jogo *ptr_HTJ, Hash_Equipa *ptr_HTE, int *Contador_Instrucoes)
{
  Jogo *aux_j;
  char nome_jogo[1023];
  int pontuacao_nova1;
  int pontuacao_nova2;
  getchar();
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  pontuacao_nova1 = new_sym_var(sizeof(int) * 8);
  pontuacao_nova2 = new_sym_var(sizeof(int) * 8);
  *Contador_Instrucoes += 1;
  aux_j = hash_procura_Jogo(ptr_HTJ, nome_jogo);
  if (aux_j == 0)
  {
    {
      printf("%d Jogo inexistente.\n", *Contador_Instrucoes);
      return;
    }
  }
  else
  {
    if (aux_j->pontuacao1 > aux_j->pontuacao2)
    {
      {
        if (pontuacao_nova1 > pontuacao_nova2)
        {
          {
            atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
          }
        }
        else
        {
          if (pontuacao_nova1 < pontuacao_nova2)
          {
            {
              atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
              retira_vitoria(ptr_HTE, aux_j->equipa1);
              adiciona_vitoria(ptr_HTE, aux_j->equipa2);
            }
          }
          else
          {
            {
              atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
              retira_vitoria(ptr_HTE, aux_j->equipa1);
            }
          }

        }

      }
    }
    else
    {
      if (aux_j->pontuacao1 < aux_j->pontuacao2)
      {
        {
          if (pontuacao_nova1 < pontuacao_nova2)
          {
            {
              atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
            }
          }
          else
          {
            if (pontuacao_nova1 > pontuacao_nova2)
            {
              {
                atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
                adiciona_vitoria(ptr_HTE, aux_j->equipa1);
                retira_vitoria(ptr_HTE, aux_j->equipa2);
              }
            }
            else
            {
              {
                atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
                retira_vitoria(ptr_HTE, aux_j->equipa2);
              }
            }

          }

        }
      }
      else
      {
        {
          if (pontuacao_nova1 == pontuacao_nova2)
          {
            {
              atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
            }
          }
          else
          {
            if (pontuacao_nova1 > pontuacao_nova2)
            {
              {
                atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
                adiciona_vitoria(ptr_HTE, aux_j->equipa1);
              }
            }
            else
            {
              {
                atualiza_pontuacoes(aux_j, pontuacao_nova1, pontuacao_nova2);
                adiciona_vitoria(ptr_HTE, aux_j->equipa2);
              }
            }

          }

        }
      }

    }

  }

}

int compara_strings(const void *str1, const void *str2)
{
  char * const *pp1 = str1;
  char * const *pp2 = str2;
  return strcmp(*pp1, *pp2);
}

void g(Lista_Equipas *CE, int *Contador_Instrucoes)
{
  Equipas *aux_e;
  int Maximo_Vitorias = 0;
  int Contador_aux;
  int Contador_prints;
  int aux_comprimento;
  char **Lista_Equipas_Maiores;
  *Contador_Instrucoes += 1;
  if (CE->topo == 0)
  {
    return;
  }
  else
  {
    
  }

  for (aux_e = CE->topo; aux_e != 0; aux_e = aux_e->proximo)
  {
    if (aux_e->vitorias > Maximo_Vitorias)
    {
      Maximo_Vitorias = aux_e->vitorias;
    }
    else
    {
      
    }

  }

  for (aux_e = CE->topo, Contador_aux = 0; aux_e != 0; aux_e = aux_e->proximo)
  {
    if (aux_e->vitorias == Maximo_Vitorias)
    {
      Contador_aux++;
    }
    else
    {
      
    }

  }

  Lista_Equipas_Maiores = malloc((sizeof(char *)) * Contador_aux);
  aux_comprimento = Contador_aux;
  for (aux_e = CE->topo, Contador_aux = 0; Contador_aux < aux_comprimento; aux_e = aux_e->proximo)
  {
    if (aux_e->vitorias == Maximo_Vitorias)
    {
      {
        Lista_Equipas_Maiores[Contador_aux] = malloc((sizeof(char)) * (strlen(aux_e->nome) + 1));
        strcpy(Lista_Equipas_Maiores[Contador_aux], aux_e->nome);
        Contador_aux++;
      }
    }
    else
    {
      
    }

  }

  qsort(Lista_Equipas_Maiores, Contador_aux, sizeof(char *), compara_strings);
  printf("%d Melhores %d\n", *Contador_Instrucoes, Maximo_Vitorias);
  for (Contador_prints = 0; Contador_prints < Contador_aux; Contador_prints++)
  {
    printf("%d * %s\n", *Contador_Instrucoes, Lista_Equipas_Maiores[Contador_prints]);
    free(Lista_Equipas_Maiores[Contador_prints]);
  }

  free(Lista_Equipas_Maiores);
}

void apaga_lista_jogos(Lista_Jogos *CJ, cabeca_JOGO *no_jogo)
{
  if (no_jogo->ptrJOGO->anterior == 0)
  {
    {
      CJ->topo = no_jogo->ptrJOGO->proximo;
    }
  }
  else
  {
    {
      no_jogo->ptrJOGO->anterior->proximo = no_jogo->ptrJOGO->proximo;
    }
  }

  if (no_jogo->ptrJOGO->proximo == 0)
  {
    {
      CJ->fim = no_jogo->ptrJOGO->anterior;
    }
  }
  else
  {
    {
      no_jogo->ptrJOGO->proximo->anterior = no_jogo->ptrJOGO->anterior;
    }
  }

  free(no_jogo->ptrJOGO->nome);
  free(no_jogo->ptrJOGO->equipa1);
  free(no_jogo->ptrJOGO->equipa2);
  free(no_jogo->ptrJOGO);
}

void limpa_hash(Hash_Jogo *ptr_HTJ, cabeca_JOGO *no_jogo, int index)
{
  cabeca_JOGO *atual = ptr_HTJ->gaveta_JOGO[index];
  cabeca_JOGO *prox = ptr_HTJ->gaveta_JOGO[index];
  if ((atual != 0) && (atual == no_jogo))
  {
    {
      ptr_HTJ->gaveta_JOGO[index] = atual->proximo;
      free(atual);
      return;
    }
  }
  else
  {
    
  }

  for (; (atual != 0) && (atual != no_jogo); atual = atual->proximo)
    prox = atual;

  prox->proximo = atual->proximo;
  free(atual);
}

void r(Hash_Jogo *ptr_HTJ, Hash_Equipa *ptr_HTE, Lista_Jogos *CJ, int *Contador_Instrucoes)
{
  char nome_jogo[1023];
  int index;
  cabeca_JOGO *aux_no;
  Jogo *aux_j;
  getchar();
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  index = hash(nome_jogo);
  aux_no = ptr_HTJ->gaveta_JOGO[index];
  *Contador_Instrucoes += 1;
  aux_j = hash_procura_Jogo(ptr_HTJ, nome_jogo);
  if (!hash_procura_Jogo(ptr_HTJ, nome_jogo))
  {
    {
      printf("%d Jogo inexistente.\n", *Contador_Instrucoes);
    }
  }
  else
  {
    {
      for (; aux_no != 0; aux_no = aux_no->proximo)
      {
        if (strcmp(aux_no->ptrJOGO->nome, nome_jogo) == 0)
        {
          {
            if (aux_no->ptrJOGO->pontuacao1 > aux_no->ptrJOGO->pontuacao2)
            {
              {
                retira_vitoria(ptr_HTE, aux_j->equipa1);
                apaga_lista_jogos(CJ, aux_no);
                limpa_hash(ptr_HTJ, aux_no, index);
                return;
              }
            }
            else
            {
              if (aux_no->ptrJOGO->pontuacao2 > aux_no->ptrJOGO->pontuacao1)
              {
                {
                  retira_vitoria(ptr_HTE, aux_j->equipa2);
                  apaga_lista_jogos(CJ, aux_no);
                  limpa_hash(ptr_HTJ, aux_no, index);
                  return;
                }
              }
              else
              {
                {
                  apaga_lista_jogos(CJ, aux_no);
                  limpa_hash(ptr_HTJ, aux_no, index);
                  return;
                }
              }

            }

          }
        }
        else
        {
          
        }

      }

    }
  }

}

