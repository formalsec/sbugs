/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "commands.h"


void new_game(hash_table_games *game_ht, hash_table_teams *team_ht, h_t_ordered_list *lst, int NL)
{
  char name[1024];
  char team1[1024];
  char team2[1024];
  char *pName = name;
  char *pTeam1 = team1;
  char *pTeam2 = team2;
  int score1;
  int score2;
  list_games *g;
  list_teams *l;
  list_teams *ll;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  for (int team1_index = 0; team1_index < 10; team1_index++)
  {
    team1[team1_index] = new_sym_var(sizeof(char) * 8);
  }

  team1[10 - 1] = '\0';
  for (int team2_index = 0; team2_index < 10; team2_index++)
  {
    team2[team2_index] = new_sym_var(sizeof(char) * 8);
  }

  team2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if ((g = search_game_aux(game_ht, pName)) != 0)
  {
    {
      printf("%d Jogo existente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  if (((l = search_team_aux(team_ht, pTeam1)) == 0) || ((ll = search_team_aux(team_ht, pTeam2)) == 0))
  {
    {
      printf("%d Equipa inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  g = insertBegin_games(game_ht, pName, pTeam1, pTeam2, score1, score2);
  insertEnd_list(lst, g);
  if (score1 > score2)
  {
    {
      l->victories++;
    }
  }
  else
  {
    
  }

  if (score1 < score2)
  {
    {
      ll->victories++;
    }
  }
  else
  {
    
  }

}

void list_all_games(h_t_ordered_list *lst, int NL)
{
  print_list(lst, NL);
}

void search_game(hash_table_games *game_ht, int NL)
{
  list_games *g;
  char name[1024];
  char *pName = name;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  if ((g = search_game_aux(game_ht, pName)) != 0)
  {
    {
      printf("%d %s %s %s %d %d\n", NL, g->name, g->team1, g->team2, g->score1, g->score2);
      return;
    }
  }
  else
  {
    
  }

  printf("%d Jogo inexistente.\n", NL);
}

void delete_game(hash_table_games *game_ht, hash_table_teams *team_ht, h_t_ordered_list *lst, int NL)
{
  list_games *g;
  char name[1024];
  char *pName = name;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  if ((g = search_game_aux(game_ht, pName)) != 0)
  {
    {
      change_score_aux(g, team_ht, 0, 0);
      remove_list(lst, pName);
      delete_game_aux(game_ht, pName);
      return;
    }
  }
  else
  {
    
  }

  printf("%d Jogo inexistente.\n", NL);
}

void change_score(hash_table_games *game_ht, hash_table_teams *team_ht, int NL)
{
  char name[1024];
  char *pName = name;
  int score1;
  int score2;
  list_games *g;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if ((g = search_game_aux(game_ht, pName)) == 0)
  {
    {
      printf("%d Jogo inexistente.\n", NL);
      return;
    }
  }
  else
  {
    
  }

  change_score_aux(g, team_ht, score1, score2);
}

void new_team(hash_table_teams *team_ht, int NL)
{
  list_teams *l;
  char name[1024];
  char *pName = name;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  if ((l = search_team_aux(team_ht, pName)) == 0)
  {
    {
      insertBegin_teams(team_ht, pName);
      return;
    }
  }
  else
  {
    
  }

  printf("%d Equipa existente.\n", NL);
}

void search_team(hash_table_teams *team_ht, int NL)
{
  list_teams *l;
  char name[1024];
  char *pName = name;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  if ((l = search_team_aux(team_ht, pName)) != 0)
  {
    {
      printf("%d %s %d\n", NL, l->name, l->victories);
      return;
    }
  }
  else
  {
    
  }

  printf("%d Equipa inexistente.\n", NL);
}

void find_winners(hash_table_teams *team_ht, list_names *head_lst_names, int NL)
{
  int i;
  int j;
  int most_vict = 0;
  list_teams *temp;
  list_teams *aux;
  for (i = 0; i < team_ht->size; i++)
  {
    temp = team_ht->table[i];
    while (temp != 0)
    {
      if (temp->victories > most_vict)
      {
        most_vict = temp->victories;
      }
      else
      {
        
      }

      temp = temp->next;
    }

  }

  for (j = 0; j < team_ht->size; j++)
  {
    aux = team_ht->table[j];
    while (aux != 0)
    {
      if (aux->victories == most_vict)
      {
        head_lst_names = insert_name_list(head_lst_names, aux->name);
      }
      else
      {
        
      }

      aux = aux->next;
    }

  }

  if (head_lst_names != 0)
  {
    printf("%d Melhores %d\n", NL, most_vict);
  }
  else
  {
    
  }

  print_list_names(head_lst_names, NL);
}

void command_x(hash_table_games *game_ht, hash_table_teams *team_ht, h_t_ordered_list *lst)
{
  int i;
  int j;
  list_teams *list;
  list_teams *temp;
  list_games *g;
  list_games *aux;
  ordered_list_g head_aux = lst->head;
  if (team_ht != 0)
  {
    {
      for (i = 0; i < team_ht->size; i++)
      {
        list = team_ht->table[i];
        while (list != 0)
        {
          temp = list;
          list = list->next;
          free(temp->name);
          free(temp);
        }

      }

      free(team_ht->table);
      free(team_ht);
    }
  }
  else
  {
    
  }

  if (game_ht != 0)
  {
    {
      for (j = 0; j < game_ht->size; j++)
      {
        g = game_ht->table[j];
        while (g != 0)
        {
          aux = g;
          g = g->next;
          free(aux->name);
          free(aux->team1);
          free(aux->team2);
          free(aux);
        }

      }

      free(game_ht->table);
      free(game_ht);
    }
  }
  else
  {
    
  }

  while (head_aux != 0)
  {
    head_aux = lst->head->next;
    free(lst->head);
    lst->head = head_aux;
  }

  free(lst);
}

