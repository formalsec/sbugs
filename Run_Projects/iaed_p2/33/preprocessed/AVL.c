/*File generated by PreProcessor.py*/


#include "AVL.h"


void avl_init(Avl *avl)
{
  *avl = (Avl) malloc(sizeof(struct avl_str));
  (*avl)->head = 0;
}

avl_link avl_cria(pEquipa equipa)
{
  avl_link link = (avl_link) malloc(sizeof(struct avl_node));
  link->equipa = equipa;
  link->l = 0;
  link->r = 0;
  link->altura = 1;
  return link;
}

avl_link avl_insere(avl_link h, pEquipa equipa)
{
  if (h == 0)
  {
    return avl_cria(equipa);
  }
  else
  {
    
  }

  if (strcmp(h->equipa->nome, equipa->nome) > 0)
  {
    h->l = avl_insere(h->l, equipa);
  }
  else
  {
    h->r = avl_insere(h->r, equipa);
  }

  h = avl_balanco(h);
  return h;
}

avl_link avl_procura(avl_link h, Chave nome)
{
  if (h == 0)
  {
    return 0;
  }
  else
  {
    
  }

  if (strcmp(nome, h->equipa->nome) == 0)
  {
    return h;
  }
  else
  {
    
  }

  if (strcmp(h->equipa->nome, nome) > 0)
  {
    return avl_procura(h->l, nome);
  }
  else
  {
    return avl_procura(h->r, nome);
  }

}

avl_link avl_verifica(Avl avl, Chave nome, int opcao, int NL)
{
  avl_link link = avl_procura(avl->head, nome);
  if ((opcao == 0) && (link == 0))
  {
    printf("%d Equipa inexistente.\n", NL);
  }
  else
  {
    if ((opcao == 1) && (!(link == 0)))
    {
      printf("%d Equipa existente.\n", NL);
    }
    else
    {
      
    }

  }

  return link;
}

avl_link avl_balanco(avl_link h)
{
  int fator;
  if (h == 0)
  {
    return h;
  }
  else
  {
    
  }

  fator = avl_obtem_fator(h);
  if (fator < (-1))
  {
    {
      if (avl_obtem_fator(h->l) <= 0)
      {
        h = avl_rotacao_R(h);
      }
      else
      {
        h = avl_rotacao_LR(h);
      }

    }
  }
  else
  {
    if (fator > 1)
    {
      {
        if (avl_obtem_fator(h->r) >= 0)
        {
          h = avl_rotacao_L(h);
        }
        else
        {
          h = avl_rotacao_RL(h);
        }

      }
    }
    else
    {
      h->altura = avl_atualiza_altura(h);
    }

  }

  return h;
}

avl_link avl_rotacao_L(avl_link h)
{
  avl_link x;
  x = h->r;
  h->r = x->l;
  x->l = h;
  h->altura = avl_atualiza_altura(h);
  x->altura = avl_atualiza_altura(x);
  return x;
}

avl_link avl_rotacao_R(avl_link h)
{
  avl_link x;
  x = h->l;
  h->l = x->r;
  x->r = h;
  h->altura = avl_atualiza_altura(h);
  x->altura = avl_atualiza_altura(x);
  return x;
}

avl_link avl_rotacao_LR(avl_link h)
{
  if (h == 0)
  {
    return h;
  }
  else
  {
    
  }

  h->l = avl_rotacao_L(h->l);
  return avl_rotacao_R(h);
}

avl_link avl_rotacao_RL(avl_link h)
{
  if (h == 0)
  {
    return h;
  }
  else
  {
    
  }

  h->r = avl_rotacao_R(h->r);
  return avl_rotacao_L(h);
}

int avl_obtem_fator(avl_link link)
{
  if (link == 0)
  {
    return 0;
  }
  else
  {
    
  }

  return avl_obtem_altura(link->r) - avl_obtem_altura(link->l);
}

int avl_obtem_altura(avl_link h)
{
  if (h == 0)
  {
    return 0;
  }
  else
  {
    
  }

  return h->altura;
}

int avl_atualiza_altura(avl_link link)
{
  int altura_l;
  int altura_r;
  altura_l = avl_obtem_altura(link->l);
  altura_r = avl_obtem_altura(link->r);
  if (altura_l > altura_r)
  {
    return altura_l + 1;
  }
  else
  {
    
  }

  return altura_r + 1;
}

int avl_obtem_max_ganhos(avl_link h, int max_ganhos)
{
  if (h == 0)
  {
    return max_ganhos;
  }
  else
  {
    
  }

  max_ganhos = avl_obtem_max_ganhos(h->l, max_ganhos);
  if (h->equipa->ganhos > max_ganhos)
  {
    max_ganhos = h->equipa->ganhos;
  }
  else
  {
    
  }

  max_ganhos = avl_obtem_max_ganhos(h->r, max_ganhos);
  return max_ganhos;
}

void avl_print_melhores(avl_link h, int max_ganhos, int NL)
{
  if (h == 0)
  {
    return;
  }
  else
  {
    
  }

  avl_print_melhores(h->l, max_ganhos, NL);
  if (h->equipa->ganhos == max_ganhos)
  {
    equipa_print_melhor(h->equipa, NL);
  }
  else
  {
    
  }

  avl_print_melhores(h->r, max_ganhos, NL);
}

void avl_free_h(avl_link h)
{
  if (!(h == 0))
  {
    {
      avl_free_h(h->l);
      avl_free_h(h->r);
      equipa_free(h->equipa);
      free(h);
    }
  }
  else
  {
    
  }

}

void avl_free(Avl avl)
{
  avl_free_h(avl->head);
  free(avl);
}

