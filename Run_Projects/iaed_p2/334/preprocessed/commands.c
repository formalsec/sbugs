/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "commands.h"
#include "teams.h"


void command_a(char *command, teamList **t, gameList **g, int nl)
{
  char *name;
  char *t1name;
  char *t2name;
  char *sc1str;
  char *sc2str;
  int score1;
  int score2;
  teamList *team1;
  teamList *team2;
  name = command;
  {
    t1name = name;
    while ((*t1name) && ((*t1name) != ':'))
      t1name++;

    if (!(*t1name))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *t1name = '\0';
    t1name++;
  }
  ;
  {
    t2name = t1name;
    while ((*t2name) && ((*t2name) != ':'))
      t2name++;

    if (!(*t2name))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *t2name = '\0';
    t2name++;
  }
  ;
  {
    sc1str = t2name;
    while ((*sc1str) && ((*sc1str) != ':'))
      sc1str++;

    if (!(*sc1str))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *sc1str = '\0';
    sc1str++;
  }
  ;
  {
    sc2str = sc1str;
    while ((*sc2str) && ((*sc2str) != ':'))
      sc2str++;

    if (!(*sc2str))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *sc2str = '\0';
    sc2str++;
  }
  ;
  if (1 == 0)
  {
    {
      printf("%d %s\n", nl, "Bad command format.");
      return;
    }
  }
  else
  {
    score1 = new_sym_var(sizeof(int) * 8);
    
  }

  ;
  if (1 == 0)
  {
    {
      printf("%d %s\n", nl, "Bad command format.");
      return;
    }
  }
  else
  {
    score2 = new_sym_var(sizeof(int) * 8);
    
  }

  ;
  if (findGame(*g, name))
  {
    {
      printf("%d %s\n", nl, "Jogo existente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  team1 = findTeam(*t, t1name);
  team2 = findTeam(*t, t2name);
  if ((!team1) || (!team2))
  {
    {
      printf("%d %s\n", nl, "Equipa inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  if (score1 > score2)
  {
    team1->won++;
  }
  else
  {
    if (score1 < score2)
    {
      team2->won++;
    }
    else
    {
      
    }

  }

  *g = addGame(*g, name, team1, team2, score1, score2);
}

void command_A(char *command, teamList **t, int nl)
{
  char *name = command;
  name[strlen(name) - 1] = '\0';
  if (findTeam(*t, name))
  {
    {
      printf("%d %s\n", nl, "Equipa existente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  *t = addTeam(*t, name);
}

void command_l(gameList **g, int nl)
{
  gameList *cur = *g;
  while (cur)
  {
    printf("%d %s %s %s %d %d\n", nl, cur->name, cur->team1->name, cur->team2->name, cur->score1, cur->score2);
    cur = cur->next;
  }

}

void command_p(char *command, gameList **g, int nl)
{
  char *name = command;
  gameList *game;
  name[strlen(name) - 1] = '\0';
  game = findGame(*g, name);
  if (!game)
  {
    {
      printf("%d %s\n", nl, "Jogo inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  printf("%d %s %s %s %d %d\n", nl, game->name, game->team1->name, game->team2->name, game->score1, game->score2);
}

void command_P(char *command, teamList **t, int nl)
{
  char *name = command;
  teamList *team;
  name[strlen(name) - 1] = '\0';
  team = findTeam(*t, name);
  if (!team)
  {
    {
      printf("%d %s\n", nl, "Equipa inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  printf("%d %s %d\n", nl, team->name, team->won);
}

void command_r(char *command, gameList **g, int nl)
{
  char *name = command;
  gameList *game;
  name[strlen(name) - 1] = '\0';
  game = findGame(*g, name);
  if (!game)
  {
    {
      printf("%d %s\n", nl, "Jogo inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  if (game->score1 > game->score2)
  {
    game->team1->won--;
  }
  else
  {
    if (game->score1 < game->score2)
    {
      game->team2->won--;
    }
    else
    {
      
    }

  }

  *g = deleteGame(*g, game);
}

void command_s(char *command, gameList **g, int nl)
{
  char *name;
  char *sc1str;
  char *sc2str;
  int score1;
  int score2;
  gameList *game;
  name = command;
  {
    sc1str = name;
    while ((*sc1str) && ((*sc1str) != ':'))
      sc1str++;

    if (!(*sc1str))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *sc1str = '\0';
    sc1str++;
  }
  ;
  {
    sc2str = sc1str;
    while ((*sc2str) && ((*sc2str) != ':'))
      sc2str++;

    if (!(*sc2str))
    {
      {
        printf("%d %s\n", nl, "Bad command format.");
        return;
      }
    }
    else
    {
      
    }

    ;
    *sc2str = '\0';
    sc2str++;
  }
  ;
  if (1 == 0)
  {
    {
      printf("%d %s\n", nl, "Bad command format.");
      return;
    }
  }
  else
  {
    score1 = new_sym_var(sizeof(int) * 8);
    
  }

  ;
  if (1 == 0)
  {
    {
      printf("%d %s\n", nl, "Bad command format.");
      return;
    }
  }
  else
  {
    score2 = new_sym_var(sizeof(int) * 8);
    
  }

  ;
  game = findGame(*g, name);
  if (!game)
  {
    {
      printf("%d %s\n", nl, "Jogo inexistente.");
      return;
    }
  }
  else
  {
    
  }

  ;
  if (game->score1 > game->score2)
  {
    game->team1->won--;
  }
  else
  {
    if (game->score1 < game->score2)
    {
      game->team2->won--;
    }
    else
    {
      
    }

  }

  if (score1 > score2)
  {
    game->team1->won++;
  }
  else
  {
    if (score1 < score2)
    {
      game->team2->won++;
    }
    else
    {
      
    }

  }

  game->score1 = score1;
  game->score2 = score2;
}

int partition(char **names, int lo, int hi)
{
  char *pi = names[(hi + lo) / 2];
  char *swap;
  int i = lo;
  int j = hi;
  while (1)
  {
    while (strcmp(names[i], pi) < 0)
      i++;

    while (strcmp(names[j], pi) > 0)
      j--;

    if (i >= j)
    {
      return j;
    }
    else
    {
      
    }

    swap = names[i];
    names[i] = names[j];
    names[j] = swap;
    i++;
    j--;
  }

  return -1;
}

void quickSort(char **names, int lo, int hi)
{
  int pi;
  if (lo < hi)
  {
    {
      pi = partition(names, lo, hi);
      quickSort(names, lo, pi);
      quickSort(names, pi + 1, hi);
    }
  }
  else
  {
    
  }

}

void command_g(teamList **t, int nl)
{
  int maxWon = 0;
  int sizeWon = 0;
  int i = 0;
  char **listNames = 0;
  teamList *cur = *t;
  if (!(*t))
  {
    return;
  }
  else
  {
    
  }

  while (cur)
  {
    if (cur->won == maxWon)
    {
      sizeWon++;
    }
    else
    {
      
    }

    if (cur->won > maxWon)
    {
      {
        maxWon = cur->won;
        sizeWon = 1;
      }
    }
    else
    {
      
    }

    cur = cur->next;
  }

  listNames = malloc(sizeWon * (sizeof(char *)));
  if (!listNames)
  {
    exit(1);
  }
  else
  {
    
  }

  cur = *t;
  while (cur)
  {
    if (cur->won == maxWon)
    {
      {
        listNames[i] = cur->name;
        i++;
      }
    }
    else
    {
      
    }

    cur = cur->next;
  }

  quickSort(listNames, 0, sizeWon - 1);
  printf("%d Melhores %d\n", nl, maxWon);
  for (i = 0; i < sizeWon; i++)
  {
    printf("%d * %s\n", nl, listNames[i]);
  }

  free(listNames);
}

