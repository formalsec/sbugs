/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "hash_equipas.h"


link_equipa *init_equipa(int n)
{
  link_equipa *tabela_equipas;
  int i;
  tabela_equipas = (link_equipa *) malloc(n * (sizeof(link_equipa)));
  for (i = 0; i < n; i++)
  {
    tabela_equipas[i] = 0;
  }

  return tabela_equipas;
}

link_equipa nova_equipa(char *nome)
{
  link_equipa x = (link_equipa) malloc(sizeof(struct node_equipa));
  x->equipa = (pEquipa) malloc(sizeof(struct equipa));
  x->equipa->nome = (char *) malloc((strlen(nome) + 1) * (sizeof(char)));
  strcpy(x->equipa->nome, nome);
  x->equipa->vitorias = 0;
  x->next = 0;
  return x;
}

link_equipa procura_lista_equipa(link_equipa head, char *nome)
{
  link_equipa t;
  for (t = head; t != 0; t = t->next)
  {
    if (strcmp(t->equipa->nome, nome) == 0)
    {
      {
        return t;
      }
    }
    else
    {
      
    }

  }

  return 0;
}

link_equipa insere_equipa_lista(link_equipa head, char *nome)
{
  link_equipa x = nova_equipa(nome);
  x->next = head;
  return x;
}

link_equipa remove_equipa_lista(link_equipa head, char *nome)
{
  if (head == 0)
  {
    return 0;
  }
  else
  {
    
  }

  if (strcmp(head->equipa->nome, nome) == 0)
  {
    {
      link_equipa t;
      t = head->next;
      free(head->equipa->nome);
      free(head->equipa);
      free(head);
      return t;
    }
  }
  else
  {
    
  }

  head->next = remove_equipa_lista(head->next, nome);
  return head;
}

link_equipa remove_lista_2(link_equipa head)
{
  if (head == 0)
  {
    return 0;
  }
  else
  {
    {
      link_equipa t;
      t = head->next;
      free(head->equipa->nome);
      free(head->equipa);
      free(head);
      return t;
    }
  }

  head->next = remove_lista_2(head->next);
  return head;
}

int hash_strings(char *v, int N)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
  {
    h = ((a * h) + (*v)) % N;
  }

  return h;
}

link_equipa procura_equipa(char *nome, link_equipa *tabela_equipas)
{
  int i = hash_strings(nome, 1069);
  return procura_lista_equipa(tabela_equipas[i], nome);
}

link_equipa *insere_equipa(link_equipa equipa, link_equipa *tabela_equipas)
{
  int i = hash_strings(equipa->equipa->nome, 1069);
  tabela_equipas[i] = insere_equipa_lista(tabela_equipas[i], equipa->equipa->nome);
  return tabela_equipas;
}

link_equipa *apaga_equipa(char *nome, link_equipa *tabela_equipas)
{
  int i = hash_strings(nome, 1069);
  tabela_equipas[i] = remove_equipa_lista(tabela_equipas[i], nome);
  return tabela_equipas;
}

link_equipa insere_equipa_2(link_equipa equipa, link_equipa lista_equipas)
{
  lista_equipas = insere_equipa_lista_2(lista_equipas, equipa);
  return lista_equipas;
}

link_equipa insere_equipa_lista_2(link_equipa head, link_equipa equipa)
{
  link_equipa x;
  if (head == 0)
  {
    {
      return nova_equipa(equipa->equipa->nome);
    }
  }
  else
  {
    
  }

  for (x = head; x->next != 0; x = x->next)
    ;

  x->next = nova_equipa(equipa->equipa->nome);
  return head;
}

void print_equipas(link_equipa head, int linha)
{
  link_equipa t;
  for (t = head; t != 0; t = t->next)
  {
    printf("%d %s %d\n", linha, t->equipa->nome, t->equipa->vitorias);
  }

}

void atribui_vitoria(char *nome, link_equipa *tabela_equipas)
{
  link_equipa x;
  x = procura_equipa(nome, tabela_equipas);
  x->equipa->vitorias++;
}

void remove_vitoria(char *nome, link_equipa *tabela_equipas)
{
  link_equipa x;
  x = procura_equipa(nome, tabela_equipas);
  x->equipa->vitorias--;
}

link_equipa atribui_vitoria_2(char *nome, link_equipa lista_equipas)
{
  link_equipa x;
  x = procura_lista_equipa(lista_equipas, nome);
  x->equipa->vitorias++;
  return lista_equipas;
}

link_equipa remove_vitoria_2(char *nome, link_equipa lista_equipas)
{
  link_equipa x;
  x = procura_lista_equipa(lista_equipas, nome);
  x->equipa->vitorias--;
  return lista_equipas;
}

link_equipa apaga_equipa_2(char *nome, link_equipa lista_equipas)
{
  lista_equipas = remove_equipa_lista(lista_equipas, nome);
  return lista_equipas;
}

link_equipa *liberta_equipas(link_equipa *tabela_equipas)
{
  int i;
  for (i = 0; i < 1069; i++)
  {
    tabela_equipas[i] = remove_lista_2(tabela_equipas[i]);
  }

  return tabela_equipas;
}

