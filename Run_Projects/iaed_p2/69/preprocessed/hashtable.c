/*File generated by PreProcessor.py*/


#include "hashtable.h"


int hash(Key value, int m)
{
  return value % m;
}

lista *lista_por_ordem_inicializar()
{
  lista *nova_lista = malloc(sizeof(lista));
  nova_lista->head = 0;
  nova_lista->last = 0;
  return nova_lista;
}

void lista_por_ordem_add(lista *l, Jogo jogo1)
{
  lista_jogos ultimo = malloc(sizeof(struct str_jogos));
  ultimo->jogo = jogo1;
  ultimo->next = 0;
  if (l->head == 0)
  {
    {
      l->head = ultimo;
      l->last = ultimo;
    }
  }
  else
  {
    {
      l->last->next = ultimo;
      l->last = ultimo;
    }
  }

}

void apagar_jogo_lista_por_ordem(lista *l, char *nome)
{
  lista_jogos aux;
  lista_jogos prev;
  for (aux = l->head, prev = 0; strcmp(aux->jogo->nome_jogo, nome) != 0; prev = aux, aux = aux->next)
    ;

  if ((aux == l->head) && (aux == l->last))
  {
    {
      l->head = aux->next;
      l->last = aux->next;
      free(aux);
    }
  }
  else
  {
    if (aux == l->head)
    {
      {
        l->head = aux->next;
        free(aux);
      }
    }
    else
    {
      if (aux == l->last)
      {
        {
          l->last = prev;
          l->last->next = 0;
          free(aux);
        }
      }
      else
      {
        {
          prev->next = aux->next;
          free(aux);
        }
      }

    }

  }

}

void listar_jogos(lista *l, int count)
{
  lista_jogos t;
  for (t = l->head; t != 0; t = t->next)
  {
    printf("%d %s %s %s %d %d\n", count, t->jogo->nome_jogo, t->jogo->equipa1, t->jogo->equipa2, t->jogo->sc1, t->jogo->sc2);
  }

}

lista_jogos *lst_inicializar_jg(lista_jogos *heads_jg)
{
  int i;
  heads_jg = (lista_jogos *) malloc(997 * (sizeof(lista_jogos)));
  for (i = 0; i < 997; i++)
  {
    heads_jg[i] = 0;
  }

  return heads_jg;
}

lista_equipas *lst_inicializar_eq(lista_equipas *heads_eq)
{
  int i;
  heads_eq = (lista_equipas *) malloc(997 * (sizeof(lista_equipas)));
  for (i = 0; i < 997; i++)
  {
    heads_eq[i] = 0;
  }

  return heads_eq;
}

lista_jogos inserirInicio_da_Lista_JG(lista_jogos head_jg, Jogo jogo1)
{
  lista_jogos nova_head_jg;
  nova_head_jg = (lista_jogos) malloc(sizeof(struct str_jogos));
  nova_head_jg->jogo = jogo1;
  nova_head_jg->next = head_jg;
  return nova_head_jg;
}

lista_equipas inserirInicio_da_Lista_EQ(lista_equipas head_eq, Equipa equipa)
{
  lista_equipas nova_head_eq;
  nova_head_eq = (lista_equipas) malloc(sizeof(struct str_equipas));
  nova_head_eq->equipa = equipa;
  nova_head_eq->next = head_eq;
  return nova_head_eq;
}

void JGinserir(lista_jogos *heads_jg, Jogo jogo)
{
  int i = hash(jogo->id, 997);
  heads_jg[i] = inserirInicio_da_Lista_JG(heads_jg[i], jogo);
}

void EQinserir(lista_equipas *heads_eq, Equipa equipa)
{
  int i = hash(equipa->id, 997);
  heads_eq[i] = inserirInicio_da_Lista_EQ(heads_eq[i], equipa);
}

lista_jogos procuraLista_jg(lista_jogos head_jg, char *nome_jogo2)
{
  lista_jogos t;
  for (t = head_jg; t != 0; t = t->next)
  {
    if (strcmp(t->jogo->nome_jogo, nome_jogo2) == 0)
    {
      return t;
    }
    else
    {
      
    }

  }

  return 0;
}

lista_jogos JGprocurar(lista_jogos *heads_jg, char *nome_jogo)
{
  int id = cria_id(nome_jogo);
  int i = hash(id, 997);
  return procuraLista_jg(heads_jg[i], nome_jogo);
}

lista_equipas procuraLista_eq(lista_equipas head_eq, char *nome_equipa)
{
  lista_equipas t;
  for (t = head_eq; t != 0; t = t->next)
  {
    if (strcmp(t->equipa->nome, nome_equipa) == 0)
    {
      return t;
    }
    else
    {
      
    }

  }

  return 0;
}

lista_equipas EQprocurar(lista_equipas *heads_eq, char *nome_equipa)
{
  int id = cria_id(nome_equipa);
  int i = hash(id, 997);
  return procuraLista_eq(heads_eq[i], nome_equipa);
}

lista_jogos Elimina_jogo_aux(lista_jogos head_jg, char *nome)
{
  lista_jogos anterior;
  lista_jogos aux;
  for (aux = head_jg, anterior = 0; aux != 0; anterior = aux, aux = aux->next)
  {
    if (strcmp(aux->jogo->nome_jogo, nome) == 0)
    {
      {
        if (aux == head_jg)
        {
          {
            head_jg = aux->next;
          }
        }
        else
        {
          {
            anterior->next = aux->next;
          }
        }

        free_jogo(aux->jogo);
        free(aux);
        return head_jg;
      }
    }
    else
    {
      
    }

  }

  return head_jg;
}

void Elimina_jogo(lista_jogos *heads_jg, char *nome)
{
  int id = cria_id(nome);
  int i = hash(id, 997);
  heads_jg[i] = Elimina_jogo_aux(heads_jg[i], nome);
}

void free_heads_jg(lista_jogos *heads_jg)
{
  int i;
  lista_jogos aux;
  for (i = 0; i < 997; i++)
  {
    aux = heads_jg[i];
    while (heads_jg[i] != 0)
    {
      aux = heads_jg[i]->next;
      free_jogo(heads_jg[i]->jogo);
      free(heads_jg[i]);
      heads_jg[i] = aux;
    }

    free(heads_jg[i]);
  }

  free(heads_jg);
}

void free_heads_eq(lista_equipas *heads_eq)
{
  int i;
  lista_equipas aux;
  for (i = 0; i < 997; i++)
  {
    aux = heads_eq[i];
    while (heads_eq[i] != 0)
    {
      aux = heads_eq[i]->next;
      free_equipa(heads_eq[i]->equipa);
      free(heads_eq[i]);
      heads_eq[i] = aux;
    }

    free(heads_eq[i]);
  }

  free(heads_eq);
}

void free_head(lista *l)
{
  lista_jogos aux;
  while (l->head != 0)
  {
    aux = l->head->next;
    free(l->head);
    l->head = aux;
  }

  free(l);
}

