#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct connection
{
  int id;
  struct connection *next;
} Connection;
typedef struct router
{
  int id;
  Connection *head;
  Connection *tail;
} Router;
typedef struct network
{
  int N_rtrs;
  int M_cons;
  Router *routers;
} Network;
void create_router(int n, Network *nw)
{
  Router r;
  r.id = n;
  r.head = 0;
  r.tail = 0;
  nw->routers[n] = r;
}

Connection *create_connection()
{
  Connection *c = (Connection *) malloc(sizeof(struct connection));
  return c;
}

void router_add_conn(int u, int v, Network *Nw)
{
  if (Nw->routers[u].head == 0)
  {
    Nw->routers[u].head = (Nw->routers[u].tail = create_connection());
    Nw->routers[u].head->id = v;
    Nw->routers[u].head->next = 0;
  }
  else
  {
    if (Nw->routers[u].head == Nw->routers[u].tail)
    {
      Nw->routers[u].tail = create_connection();
      Nw->routers[u].head->next = Nw->routers[u].tail;
      Nw->routers[u].tail->id = v;
      Nw->routers[u].tail->next = 0;
    }
    else
    {
      Connection *c = create_connection();
      Nw->routers[u].tail->next = c;
      Nw->routers[u].tail = c;
      c->id = v;
      c->next = 0;
    }

  }

}

int *add_new_max(int *max, int newmax, int count)
{
  max[count] = newmax;
  return max;
}

void DFS(int v, int visited[], Network *Nw, int *nrouters, int flag)
{
  visited[v] = 1;
  Connection *c = Nw->routers[v].head;
  for (; c != 0; c = c->next)
  {
    if (!visited[c->id])
    {
      if (flag)
      {
        *nrouters = (*nrouters) + 1;
      }
      else
      {
        
      }

      DFS(c->id, visited, Nw, nrouters, flag);
    }
    else
    {
      
    }

  }

}

void getSubNets(Network *Nw)
{
  int *visited = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(visited, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int *max = (int *) malloc(sizeof(int));
  int v;
  int i;
  int count = 0;
  for (v = Nw->N_rtrs; v > 0; v--)
  {
    if (!visited[v])
    {
      max = realloc(max, (count + 1) * (sizeof(int)));
      DFS(v, visited, Nw, 0, 0);
      max = add_new_max(max, v, count);
      visited[0] = 0;
      count++;
    }
    else
    {
      
    }

  }

  free(visited);
  printf("%d\n", count);
  printf("%d", max[count - 1]);
  for (i = count - 2; i >= 0; i--)
    printf(" %d", max[i]);

  printf("\n");
  free(max);
}

void DFS_Tarjan(int v, int visited[], int dtime[], int ltime[], int parent[], int weak_routers[], int *time, Network *Nw)
{
  visited[v] = 1;
  dtime[v] = *time;
  ltime[v] = *time;
  int nchildren = 0;
  int possibleWR = 0;
  *time = (*time) + 1;
  Connection *c = Nw->routers[v].head;
  for (; c != 0; c = c->next)
  {
    if (!visited[c->id])
    {
      parent[c->id] = v;
      nchildren++;
      DFS_Tarjan(c->id, visited, dtime, ltime, parent, weak_routers, time, Nw);
      if (dtime[v] <= ltime[c->id])
      {
        possibleWR = 1;
      }
      else
      {
        if (ltime[c->id] < ltime[v])
        {
          ltime[v] = ltime[c->id];
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (c->id != parent[v])
      {
        if (dtime[c->id] < ltime[v])
        {
          ltime[v] = dtime[c->id];
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  if (((!parent[v]) && (nchildren > 1)) || (parent[v] && possibleWR))
  {
    weak_routers[0]++;
    weak_routers[weak_routers[0]] = v;
  }
  else
  {
    
  }

}

int *getWeakRouters(Network *Nw)
{
  int *visited = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(visited, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int *dtime = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(dtime, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int *ltime = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(ltime, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int *parent = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(parent, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int *weak_routers = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  weak_routers[0] = 0;
  int v;
  int time = 0;
  for (v = 1; v <= Nw->N_rtrs; v++)
  {
    if (!visited[v])
    {
      DFS_Tarjan(v, visited, dtime, ltime, parent, weak_routers, &time, Nw);
    }
    else
    {
      
    }

  }

  printf("%d\n", weak_routers[0]);
  free(visited);
  free(dtime);
  free(ltime);
  free(parent);
  return weak_routers;
}

void getMaxNRouters(Network *Nw, int *weak_routers)
{
  int *visited = (int *) malloc((Nw->N_rtrs + 1) * (sizeof(int)));
  memset(visited, 0, (Nw->N_rtrs + 1) * (sizeof(int)));
  int v;
  int max = 0;
  int nrouters = 1;
  for (v = 1; v <= weak_routers[0]; v++)
    visited[weak_routers[v]] = 1;

  for (v = 1; v <= Nw->N_rtrs; v++)
  {
    if (!visited[v])
    {
      DFS(v, visited, Nw, &nrouters, 1);
      if (nrouters > max)
      {
        max = nrouters;
      }
      else
      {
        
      }

      nrouters = 1;
    }
    else
    {
      
    }

  }

  free(visited);
  printf("%d\n", max);
}

void free_Network(Network *Nw)
{
  Router r = Nw->routers[1];
  int i;
  for (i = 1; i <= Nw->N_rtrs; r = Nw->routers[++i])
  {
    Connection *t;
    while ((t = r.head) != 0)
    {
      r.head = r.head->next;
      free(t);
    }

    r.head = 0;
  }

  free(Nw->routers);
  free(Nw);
}

int main(int argc, char **argv)
{
  int i;
  int n;
  int u;
  int v;
  int *weak_routers;
  if (1 < 0)
  {
    exit(-1);
  }
  else
  {
    n = new_sym_var(sizeof(int) * 8);
    
  }

  Network *Nw = (Network *) malloc(sizeof(struct network));
  Router *r = (Router *) malloc((n + 1) * (sizeof(struct router)));
  Nw->N_rtrs = n;
  Nw->routers = r;
  for (i = 0; i < Nw->N_rtrs; i++)
    create_router(i + 1, Nw);

  if (1 < 0)
  {
    exit(-1);
  }
  else
  {
    Nw->M_cons = new_sym_var(sizeof(int) * 8);
    
  }

  for (i = 0; i < Nw->M_cons; i++)
  {
    if (2 < 0)
    {
      exit(-1);
    }
    else
    {
      u = new_sym_var(sizeof(int) * 8);
      v = new_sym_var(sizeof(int) * 8);
      
    }

    router_add_conn(u, v, Nw);
    router_add_conn(v, u, Nw);
  }

  getSubNets(Nw);
  weak_routers = getWeakRouters(Nw);
  getMaxNRouters(Nw, weak_routers);
  free(weak_routers);
  free_Network(Nw);
  return 0;
}

