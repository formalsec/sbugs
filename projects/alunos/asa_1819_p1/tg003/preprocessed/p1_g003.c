#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct node
{
  long id;
  struct node *next;
} *node_t;
void insertNode(int u, int v);
void DFS();
void DFSvisit(int u);
void results();
int numRouters;
int numLinks;
int numSubNetworks = 0;
int numBreaks = 0;
int mostVertices = 0;
int mostVerticesAux = 0;
int DFS_time = 1;
int *DFS_c;
int *DFS_color;
int *DFS_d;
int *DFS_l;
int *DFS_child;
int *DFS_pi;
long DFS_biggestAux = 0;
long *DFS_biggest;
node_t *linkList;
int main(int argc, char *argv[])
{
  int i;
  int u;
  int v;
  char buffer[128];
  char *token;
  fgets(buffer, 128 - 1, stdin);
  numRouters = atoi(buffer);
  fgets(buffer, 128 - 1, stdin);
  numLinks = atoi(buffer);
  DFS_c = (int *) calloc(numRouters + 1, sizeof(int));
  DFS_color = (int *) malloc((numRouters + 1) * (sizeof(int)));
  DFS_d = (int *) malloc((numRouters + 1) * (sizeof(int)));
  DFS_l = (int *) malloc((numRouters + 1) * (sizeof(int)));
  DFS_pi = (int *) malloc((numRouters + 1) * (sizeof(int)));
  DFS_child = (int *) malloc((numRouters + 1) * (sizeof(int)));
  DFS_biggest = (long *) calloc(numRouters + 1, sizeof(long));
  linkList = (node_t *) malloc((numRouters + 1) * (sizeof(node_t)));
  for (i = 1; i <= numRouters; i++)
    linkList[i] = 0;

  for (i = 1; i <= numLinks; i++)
  {
    fgets(buffer, 128 - 1, stdin);
    token = strtok(buffer, " ");
    u = atoi(token);
    token = strtok(0, " ");
    v = atoi(token);
    insertNode(u, v);
    insertNode(v, u);
  }

  DFS();
  results();
  free(DFS_biggest);
  free(DFS_color);
  free(DFS_d);
  free(DFS_l);
  free(DFS_pi);
  free(DFS_child);
  free(DFS_c);
  free(linkList);
  return 0;
}

void insertNode(int u, int v)
{
  node_t new = (node_t) malloc(sizeof(struct node));
  new->id = v;
  new->next = linkList[u];
  linkList[u] = new;
}

void DFS()
{
  int i;
  for (i = 1; i <= numRouters; i++)
  {
    DFS_color[i] = (DFS_d[i] = (DFS_l[i] = (DFS_child[i] = 0)));
    DFS_pi[i] = -1;
  }

  for (i = 1; i <= numRouters; i++)
  {
    if ((DFS_color[i] == 0) && (DFS_c[i] != 1))
    {
      DFSvisit(i);
    }
    else
    {
      
    }

    if (DFS_pi[i] == (-1))
    {
      mostVertices = (mostVertices < mostVerticesAux) ? (mostVerticesAux) : (mostVertices);
      mostVerticesAux = 0;
      numSubNetworks++;
      DFS_biggest[DFS_biggestAux] = DFS_biggestAux;
      DFS_biggestAux = 0;
    }
    else
    {
      
    }

  }

}

void DFSvisit(int u)
{
  int v;
  node_t node_i = linkList[u];
  DFS_biggestAux = (u > DFS_biggestAux) ? (u) : (DFS_biggestAux);
  DFS_color[u] = 1;
  DFS_d[u] = (DFS_l[u] = DFS_time++);
  DFS_child[u] = 0;
  mostVerticesAux++;
  while (node_i != 0)
  {
    v = node_i->id;
    if (DFS_color[v] == 0)
    {
      DFS_pi[v] = u;
      DFS_child[u]++;
      if (DFS_c[v] != 1)
      {
        DFSvisit(v);
      }
      else
      {
        
      }

      DFS_l[u] = (DFS_l[u] < DFS_l[v]) ? (DFS_l[u]) : (DFS_l[v]);
      if ((DFS_pi[u] == (-1)) && (DFS_child[u] > 1))
      {
        if (!DFS_c[u])
        {
          numBreaks++;
        }
        else
        {
          
        }

        DFS_c[u] = 1;
      }
      else
      {
        
      }

      if ((DFS_pi[u] != (-1)) && (DFS_l[v] >= DFS_d[u]))
      {
        if (!DFS_c[u])
        {
          numBreaks++;
        }
        else
        {
          
        }

        DFS_c[u] = 1;
      }
      else
      {
        
      }

    }
    else
    {
      if (DFS_pi[u] != v)
      {
        DFS_l[u] = (DFS_l[u] < DFS_d[v]) ? (DFS_l[u]) : (DFS_d[v]);
      }
      else
      {
        
      }

    }

    node_i = node_i->next;
  }

  DFS_color[u] = 2;
}

void results()
{
  int i = 0;
  printf("%d\n", numSubNetworks);
  while (!DFS_biggest[++i])
    ;

  printf("%ld", DFS_biggest[i++]);
  for (; i <= numRouters; i++)
  {
    if (DFS_biggest[i])
    {
      printf(" %ld", DFS_biggest[i]);
    }
    else
    {
      
    }

  }

  printf("\n");
  printf("%d\n", numBreaks);
  mostVertices = 0;
  mostVerticesAux = 0;
  DFS();
  printf("%d\n", mostVertices);
}

