#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef struct 
{
  int nota;
  int numamigos;
  int *amigos;
  int visitado;
} aluno;
typedef struct 
{
  int numalunos;
  int *alunos;
} amigo;
aluno *tab;
amigo *atab;
int N;
int M;
void initNotas()
{
  int i;
  int nota;
  for (i = 0; i < N; i++)
  {
    nota = new_sym_var(sizeof(int) * 8);
    tab[i].nota = nota;
    tab[i].numamigos = 0;
    tab[i].amigos = 0;
    tab[i].visitado = 0;
    atab[i].numalunos = 0;
    atab[i].alunos = 0;
  }

}

void initAmigos()
{
  int i;
  int aluno;
  int amigo;
  for (i = 0; i < M; i++)
  {
    aluno = new_sym_var(sizeof(int) * 8);
    amigo = new_sym_var(sizeof(int) * 8);
    aluno--;
    amigo--;
    tab[aluno].amigos = realloc(tab[aluno].amigos, (sizeof(int)) * (tab[aluno].numamigos + 1));
    tab[aluno].amigos[tab[aluno].numamigos] = amigo;
    tab[aluno].numamigos++;
    atab[amigo].alunos = realloc(atab[amigo].alunos, (sizeof(int)) * (atab[amigo].numalunos + 1));
    atab[amigo].alunos[atab[amigo].numalunos] = aluno;
    atab[amigo].numalunos++;
  }

}

void printNotas()
{
  int i;
  for (i = 0; i < N; i++)
  {
    printf("%d\n", tab[i].nota);
    free(tab[i].amigos);
    free(atab[i].alunos);
  }

  free(tab);
  free(atab);
}

void refresh(int amigo)
{
  int i;
  int numalunos;
  int aluno;
  int new;
  numalunos = atab[amigo].numalunos;
  new = tab[amigo].nota;
  for (i = 0; i < numalunos; i++)
  {
    aluno = atab[amigo].alunos[i];
    if (new > tab[aluno].nota)
    {
      tab[aluno].nota = new;
      refresh(aluno);
    }
    else
    {
      
    }

  }

}

void recalcula(int aluno)
{
  if (tab[aluno].visitado == 1)
  {
    return;
  }
  else
  {
    
  }

  int i;
  int numamigos;
  int amigo;
  int old;
  int new;
  numamigos = tab[aluno].numamigos;
  old = tab[aluno].nota;
  new = old;
  tab[aluno].visitado = 1;
  for (i = 0; i < numamigos; i++)
  {
    amigo = tab[aluno].amigos[i];
    if (tab[amigo].visitado == 0)
    {
      recalcula(tab[aluno].amigos[i]);
    }
    else
    {
      
    }

    if (tab[amigo].nota > new)
    {
      new = tab[amigo].nota;
    }
    else
    {
      
    }

  }

  if (new > old)
  {
    tab[aluno].nota = new;
    refresh(aluno);
  }
  else
  {
    
  }

}

int main()
{
  int i;
  N = new_sym_var(sizeof(int) * 8);
  M = new_sym_var(sizeof(int) * 8);
  tab = malloc((sizeof(aluno)) * N);
  atab = malloc((sizeof(amigo)) * N);
  initNotas();
  initAmigos();
  for (i = 0; i < N; i++)
  {
    recalcula(i);
  }

  printNotas();
  return 0;
}

