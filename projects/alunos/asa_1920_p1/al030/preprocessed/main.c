/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef struct student_link
{
  int num;
  struct student_link *next;
} *link;
typedef struct student
{
  int num;
  int grade;
  link links;
  int visited;
} Student;
typedef struct visit
{
  int num;
  struct visit *next;
} Visit;
link newLink(Student *s)
{
  link l;
  l = (link) malloc(sizeof(struct student_link));
  l->num = s->num;
  l->next = 0;
  return l;
}

void insertLink(Student *first, Student *second)
{
  link new_l = newLink(second);
  if (first->links == 0)
  {
    first->links = new_l;
  }
  else
  {
    new_l->next = first->links;
    first->links = new_l;
  }

}

void freeLinks(link head)
{
  link item = head;
  link aux = 0;
  while (item != 0)
  {
    aux = item;
    item = item->next;
    free(aux);
  }

}

Visit *newVisit(int num)
{
  Visit *v = (Visit *) malloc(sizeof(Visit));
  v->num = num;
  v->next = 0;
  return v;
}

Visit *addVisit(Visit *head, int num)
{
  Visit *v = newVisit(num);
  if (head == 0)
  {
    head = v;
  }
  else
  {
    v->next = head;
    head = v;
  }

  return head;
}

void freeVisits(Visit *head)
{
  Visit *item = head;
  Visit *aux = 0;
  while (item != 0)
  {
    aux = item;
    item = item->next;
    free(aux);
  }

}

Student *students;
Visit *visits;
void visit(int num)
{
  students[num].visited = 1;
}

void resetVisited(int num)
{
  students[num].visited = 0;
}

int visited(int num)
{
  return students[num].visited;
}

int maxN(int n1, int n2)
{
  if (n1 > n2)
  {
    return n1;
  }
  else
  {
    return n2;
  }

}

int calcMax(int size, Visit *visits)
{
  int num;
  int max = 0;
  Visit *aux;
  for (aux = visits; aux != 0; aux = aux->next)
  {
    num = aux->num;
    max = maxN(students[num].grade, max);
    resetVisited(num);
  }

  return max;
}

Visit *calcLinks(int num, Visit *visits)
{
  link aux;
  int naux;
  if (!visited(num))
  {
    visit(num);
    visits = addVisit(visits, num);
    for (aux = students[num].links; aux != 0; aux = aux->next)
    {
      naux = aux->num;
      visits = calcLinks(naux, visits);
    }

  }
  else
  {
    
  }

  return visits;
}

int main()
{
  int i = 0;
  int temp1 = 0;
  int temp2 = 0;
  int n_size;
  int n_links;
  n_size = new_sym_var(sizeof(int) * 8);
  n_links = new_sym_var(sizeof(int) * 8);
  students = (Student *) malloc((sizeof(Student)) * n_size);
  for (i = 0; i < n_size; i++)
  {
    students[i].num = i;
    students[i].grade = new_sym_var(sizeof(int) * 8);
    students[i].links = 0;
    students[i].visited = 0;
  }

  for (i = 0; i < n_links; i++)
  {
    temp1 = new_sym_var(sizeof(int) * 8);
    temp2 = new_sym_var(sizeof(int) * 8);
    insertLink(&students[temp1 - 1], &students[temp2 - 1]);
  }

  for (i = 0; i < n_size; i++)
  {
    Visit *visits = 0;
    visits = calcLinks(i, visits);
    printf("%d\n", calcMax(n_size, visits));
    freeVisits(visits);
  }

  for (i = 0; i < n_size; i++)
  {
    freeLinks(students[i].links);
  }

  free(students);
  return 0;
}

