#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h> 
#include <stdlib.h>


typedef struct Node
{
  int dest;
  struct Node *next;
} *VerticeNode;
typedef struct VerticeList
{
  int color;
  int circle;
  int expected;
  int real;
  VerticeNode head;
} *VerticeList;
typedef struct Graph
{
  int numverts;
  int numedges;
  VerticeList vertices;
} *Graph;
Graph graph;
void createGraph(int vert, int edge)
{
  graph = (Graph) malloc(sizeof(struct Graph));
  graph->numverts = vert;
  graph->numedges = edge;
  graph->vertices = (VerticeList) malloc(vert * (sizeof(struct VerticeList)));
  int i;
  int grade;
  for (i = 0; i < vert; ++i)
  {
    graph->vertices[i].head = 0;
    graph->vertices[i].color = 0;
    grade = new_sym_var(sizeof(int) * 8);
    graph->vertices[i].expected = grade;
    graph->vertices[i].real = grade;
  }

}

void addEdge(int src, int dest)
{
  VerticeNode newNode = (VerticeNode) malloc(sizeof(struct Node));
  newNode->dest = dest;
  newNode->next = graph->vertices[src].head;
  graph->vertices[src].head = newNode;
}

void printGraph()
{
  int i;
  for (i = 0; i < graph->numverts; ++i)
  {
    printf("%d\n", graph->vertices[i].real);
  }

}

void dfsVisit(int u)
{
  int max = graph->vertices[u].expected;
  graph->vertices[u].color = 1;
  VerticeNode aux = graph->vertices[u].head;
  while (aux)
  {
    int v = aux->dest;
    if (graph->vertices[v].color == 0)
    {
      dfsVisit(v);
    }
    else
    {
      
    }

    if ((graph->vertices[v].color == 1) || (graph->vertices[v].circle == 3))
    {
      graph->vertices[u].circle = 3;
    }
    else
    {
      
    }

    if (graph->vertices[v].real > max)
    {
      max = graph->vertices[v].real;
    }
    else
    {
      
    }

    aux = aux->next;
  }

  graph->vertices[u].real = max;
  graph->vertices[u].color = 2;
}

void dfs()
{
  int i;
  int j;
  for (i = 0; i < graph->numverts; i++)
  {
    if (graph->vertices[i].color == 0)
    {
      dfsVisit(i);
    }
    else
    {
      
    }

  }

  for (i = 0; i < graph->numverts; i++)
  {
    if (graph->vertices[i].circle == 3)
    {
      for (j = 0; j < graph->numverts; j++)
      {
        if (graph->vertices[j].circle == 3)
        {
          graph->vertices[j].color = 0;
        }
        else
        {
          
        }

      }

      dfsVisit(i);
    }
    else
    {
      
    }

  }

}

int main()
{
  int a;
  int b;
  a = new_sym_var(sizeof(int) * 8);
  b = new_sym_var(sizeof(int) * 8);
  createGraph(a, b);
  int i;
  for (i = 0; i < graph->numedges; i++)
  {
    a = new_sym_var(sizeof(int) * 8);
    b = new_sym_var(sizeof(int) * 8);
    addEdge(--a, --b);
  }

  dfs();
  printGraph();
  return 0;
}

