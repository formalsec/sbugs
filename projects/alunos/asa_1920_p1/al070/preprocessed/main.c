#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef enum bool
{
  NAO,
  SIM
} Bool;
typedef struct amizade
{
  int id_aluno;
  struct amizade *proxima_amizade;
} Amizade;
typedef struct aluno
{
  int n_aluno;
  int nota_inicial;
  int nota_final;
  Amizade *primeira_amizade;
  Amizade *ultima_amizade;
  Amizade *primeira_relacao;
  Amizade *ultima_relacao;
  Amizade *prox_relacao_processar;
} Aluno;
typedef struct turma
{
  Aluno *alunos;
  int num_alunos;
} Turma;
void addAmizade(Turma *t, int id_aluno, int id_amizade)
{
  Aluno *al = t->alunos + id_aluno;
  Amizade *am = (Amizade *) malloc(sizeof(Amizade));
  am->proxima_amizade = 0;
  am->id_aluno = id_amizade;
  if (al->primeira_amizade == 0)
  {
    al->primeira_amizade = am;
  }
  else
  {
    al->ultima_amizade->proxima_amizade = am;
  }

  al->ultima_amizade = am;
}

void freeAmizade(Amizade *am)
{
  free(am);
}

void addAluno(int nota, int id, Turma *t)
{
  Aluno *al = t->alunos + id;
  al->primeira_amizade = 0;
  al->ultima_amizade = 0;
  al->primeira_relacao = 0;
  al->ultima_relacao = 0;
  al->prox_relacao_processar = 0;
  al->n_aluno = id;
  al->nota_inicial = nota;
  al->nota_final = nota;
}

void freeAluno(Aluno *al)
{
  Amizade *aux;
  Amizade *aux2;
  aux = al->primeira_amizade;
  while (aux)
  {
    aux2 = aux;
    aux = aux2->proxima_amizade;
    freeAmizade(aux2);
  }

  aux = al->primeira_relacao;
  while (aux)
  {
    aux2 = aux;
    aux = aux2->proxima_amizade;
    freeAmizade(aux2);
  }

}

Turma *newTurma(int num_alunos)
{
  Turma *t = (Turma *) malloc(sizeof(Turma));
  t->num_alunos = num_alunos;
  t->alunos = malloc(num_alunos * (sizeof(Aluno)));
  return t;
}

void freeTurma(Turma *t)
{
  int i;
  for (i = 0; i < t->num_alunos; i++)
  {
    freeAluno(t->alunos + i);
  }

  free(t->alunos);
  free(t);
}

void printAluno(Aluno *al)
{
  printf("%d\n", al->nota_final);
}

void printTurma(Turma *t)
{
  int i;
  for (i = 0; i < t->num_alunos; i++)
  {
    printAluno(t->alunos + i);
  }

}

Bool existeRelacao(Aluno *al, int id)
{
  Amizade *am;
  if (al->n_aluno == id)
  {
    return SIM;
  }
  else
  {
    
  }

  am = al->primeira_relacao;
  while (am)
  {
    if (am->id_aluno == id)
    {
      return SIM;
    }
    else
    {
      
    }

    am = am->proxima_amizade;
  }

  return NAO;
}

void addRelacao(Aluno *al, int id)
{
  Amizade *r = malloc(sizeof(Amizade));
  r->id_aluno = id;
  r->proxima_amizade = 0;
  if (!al->primeira_relacao)
  {
    al->primeira_relacao = r;
    al->ultima_relacao = r;
    al->prox_relacao_processar = r;
    return;
  }
  else
  {
    
  }

  al->ultima_relacao->proxima_amizade = r;
  al->ultima_relacao = r;
  if (!al->prox_relacao_processar)
  {
    al->prox_relacao_processar = r;
  }
  else
  {
    
  }

}

Amizade *getNextRelacaoProcessar(Aluno *al)
{
  Amizade *r;
  if (!al->prox_relacao_processar)
  {
    return 0;
  }
  else
  {
    
  }

  r = al->prox_relacao_processar;
  al->prox_relacao_processar = r->proxima_amizade;
  return r;
}

void calculaNotas(Turma *t)
{
  int i;
  Aluno *al;
  Aluno *al_rel;
  Amizade *am;
  Amizade *r;
  for (i = 0; i < t->num_alunos; i++)
  {
    al = t->alunos + i;
    am = al->primeira_amizade;
    while (am)
    {
      addRelacao(al, am->id_aluno);
      am = am->proxima_amizade;
    }

    while (r = getNextRelacaoProcessar(al))
    {
      al_rel = t->alunos + r->id_aluno;
      if (al_rel->nota_inicial > al->nota_final)
      {
        al->nota_final = al_rel->nota_inicial;
      }
      else
      {
        
      }

      am = al_rel->primeira_amizade;
      while (am)
      {
        if (existeRelacao(al, am->id_aluno) == NAO)
        {
          addRelacao(al, am->id_aluno);
        }
        else
        {
          
        }

        am = am->proxima_amizade;
      }

    }

  }

}

int main()
{
  Turma *t;
  int num_alunos;
  int num_amizades;
  int i;
  int tmp1;
  int tmp2;
  num_alunos = new_sym_var(sizeof(int) * 8);
  num_amizades = new_sym_var(sizeof(int) * 8);
  t = newTurma(num_alunos);
  for (i = 0; i < num_alunos; i++)
  {
    tmp1 = new_sym_var(sizeof(int) * 8);
    addAluno(tmp1, i, t);
  }

  for (i = 0; i < num_amizades; i++)
  {
    tmp1 = new_sym_var(sizeof(int) * 8);
    tmp2 = new_sym_var(sizeof(int) * 8);
    addAmizade(t, tmp1 - 1, tmp2 - 1);
  }

  calculaNotas(t);
  printTurma(t);
  freeTurma(t);
  return 0;
}

