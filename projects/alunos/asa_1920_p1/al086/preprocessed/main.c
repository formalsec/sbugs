#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct conexoes
{
  int id;
  struct conexoes *next;
} conexoes;
typedef struct aluno
{
  int nota;
  struct conexoes *amigo;
  struct conexoes *ultimoAmigo;
  int totalConexoes;
  int visitado;
} aluno;
void getAlunos(int numDeAlunos, aluno *alunos)
{
  int i;
  for (i = 0; i < numDeAlunos; i++)
  {
    if (1 != EOF)
    {
      alunos[i].nota = new_sym_var(sizeof(int) * 8);
      alunos[i].amigo = (conexoes *) malloc(sizeof(conexoes));
      alunos[i].amigo->id = -1;
      alunos[i].amigo->next = 0;
      alunos[i].ultimoAmigo = alunos[i].amigo;
      alunos[i].totalConexoes = 0;
      alunos[i].visitado = -1;
    }
    else
    {
      exit(1);
    }

  }

}

void getFriend(int estudante, int amigo, aluno *alunos)
{
  alunos[estudante].ultimoAmigo->id = amigo;
  alunos[estudante].ultimoAmigo->next = (conexoes *) malloc(sizeof(conexoes));
  alunos[estudante].ultimoAmigo->next->id = -1;
  alunos[estudante].ultimoAmigo->next->next = 0;
  alunos[estudante].ultimoAmigo = alunos[estudante].ultimoAmigo->next;
  alunos[estudante].totalConexoes++;
}

void getConnections(int numDeConexoes, aluno *alunos)
{
  int i;
  int estudante;
  int amigo;
  for (i = 0; i < numDeConexoes; i++)
  {
    if (2 != EOF)
    {
      estudante = new_sym_var(sizeof(int) * 8);
      amigo = new_sym_var(sizeof(int) * 8);
      getFriend(estudante - 1, amigo - 1, alunos);
    }
    else
    {
      exit(1);
    }

  }

}

int visitarAlunos(int idDoAluno, aluno *alunos, int numDaInteracao)
{
  int i;
  int temp = 0;
  int resultado = 0;
  conexoes *auxilar;
  if (alunos[idDoAluno].visitado != numDaInteracao)
  {
    alunos[idDoAluno].visitado = numDaInteracao;
    temp = alunos[idDoAluno].nota;
    auxilar = alunos[idDoAluno].amigo;
    for (i = 0; i < alunos[idDoAluno].totalConexoes; i++)
    {
      resultado = visitarAlunos(auxilar->id, alunos, numDaInteracao);
      auxilar = auxilar->next;
      if (temp < resultado)
      {
        temp = resultado;
        alunos[idDoAluno].nota = temp;
      }
      else
      {
        
      }

    }

    return temp;
  }
  else
  {
    return alunos[idDoAluno].nota;
  }

}

void calcularNotas(aluno *alunos, int numDeAlunos)
{
  int i = 0;
  for (i = 0; i < numDeAlunos; i++)
  {
    visitarAlunos(i, alunos, i);
  }

}

void imprimirNotas(aluno *alunos, int numDeAlunos)
{
  int i;
  for (i = 0; i < numDeAlunos; i++)
  {
    printf("%d\n", alunos[i].nota);
  }

}

void fim(aluno *alunos, int numDeAlunos)
{
  int i;
  int j;
  conexoes *auxiliar;
  for (i = 0; i < numDeAlunos; i++)
  {
    for (j = 0; j < alunos[i].totalConexoes; j++)
    {
      auxiliar = alunos[i].amigo;
      alunos[i].amigo = alunos[i].amigo->next;
      free(auxiliar);
    }

    free(alunos[i].ultimoAmigo);
  }

  free(alunos);
}

int main(void)
{
  char comma;
  int informacoes[2];
  if (3 != EOF)
  {
    informacoes[0] = new_sym_var(sizeof(int) * 8);
    comma = new_sym_var(sizeof(char) * 8);
    informacoes[1] = new_sym_var(sizeof(int) * 8);
    aluno *alunos = malloc(informacoes[0] * (sizeof(aluno)));
    getAlunos(informacoes[0], alunos);
    getConnections(informacoes[1], alunos);
    calcularNotas(alunos, informacoes[0]);
    imprimirNotas(alunos, informacoes[0]);
    fim(alunos, informacoes[0]);
  }
  else
  {
    
  }

  return 0;
}

