/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct student
{
  int id;
  int grade;
  int nFriends;
  int visited;
  int visiting;
  int wait;
  struct student **friends;
} Student;
typedef Student *pStudent;
typedef struct friendship
{
  int id;
  int friend;
} Friendship;
char *readInput(int length)
{
  int c;
  int i = 0;
  char *v = (char *) malloc((sizeof(char)) * length);
  c = getchar();
  while ((c != EOF) && (c != '\0'))
  {
    if (i == (length - 1))
    {
      length = length * 2;
      v = (char *) realloc(v, (sizeof(char)) * length);
    }
    else
    {
      
    }

    v[i++] = c;
    c = getchar();
  }

  v[i] = '\0';
  return v;
}

char *processFirstLine(char *input, int *position, char mark)
{
  int j = 0;
  int pos = *position;
  int length = 3;
  char *s = (char *) malloc((sizeof(char)) * length);
  while ((input[pos] != mark) && (input[pos] != '\0'))
  {
    if (j == (length - 1))
    {
      length = length * 2;
      s = (char *) realloc(s, (sizeof(char)) * length);
    }
    else
    {
      
    }

    s[j++] = input[pos++];
  }

  s[j] = '\0';
  *position = ++pos;
  return s;
}

void processGrades(char *input, int *vec, int *position, int n)
{
  int j;
  int i;
  int pos = *position;
  int lenght = 3;
  char *c = (char *) malloc((sizeof(char)) * lenght);
  for (j = 0; j < (n - 1); j++)
  {
    i = 0;
    while ((input[pos] != '\n') && (input[pos] != EOF))
    {
      if (i == (lenght - 1))
      {
        lenght = lenght * 2;
        c = (char *) realloc(c, (sizeof(char)) * lenght);
      }
      else
      {
        
      }

      c[i++] = input[pos++];
    }

    pos++;
    c[i] = '\0';
    vec[j] = atoi(c);
  }

  vec[j] = '\0';
  *position = pos;
  free(c);
}

char *nextChar(char *input, char *c, int *position)
{
  int i;
  int pos = *position;
  int length = 3;
  i = 0;
  while (((input[pos] != '\n') && (input[pos] != ' ')) && (input[pos] != '\0'))
  {
    if (i == (length - 1))
    {
      length = length * 2;
      c = (char *) realloc(c, (sizeof(char)) * length);
    }
    else
    {
      
    }

    c[i++] = input[pos++];
  }

  c[i] = '\0';
  *position = ++pos;
  return c;
}

void processFriendships(char *input, Friendship *vec, int *position, int n)
{
  int j;
  char *c = (char *) malloc((sizeof(char)) * 3);
  for (j = 0; j < n; j++)
  {
    nextChar(input, c, position);
    vec[j].id = atoi(c);
    nextChar(input, c, position);
    vec[j].friend = atoi(c);
  }

  free(c);
}

void initializeStudents(pStudent *s, int *g, int n)
{
  int i;
  for (i = 0; i < n; i++)
  {
    pStudent student = (pStudent) malloc(sizeof(Student));
    student->id = i + 1;
    student->grade = g[i];
    student->nFriends = 0;
    student->visited = 0;
    student->visiting = 0;
    student->wait = 0;
    student->friends = 0;
    s[i] = student;
  }

}

void addFriends(pStudent *s, Friendship *f, int n)
{
  int i;
  int id;
  int friend;
  for (i = 0; i < n; i++)
  {
    id = f[i].id;
    friend = f[i].friend;
    if (s[id - 1]->nFriends == 0)
    {
      s[id - 1]->friends = (pStudent *) malloc(sizeof(pStudent));
    }
    else
    {
      s[id - 1]->friends = (pStudent *) realloc(s[id - 1]->friends, (sizeof(pStudent)) * (s[id - 1]->nFriends + 1));
    }

    s[id - 1]->friends[s[id - 1]->nFriends] = s[friend - 1];
    s[id - 1]->nFriends++;
  }

}

int visit(pStudent s)
{
  if (s->visited)
  {
    return 0;
  }
  else
  {
    if (s->visiting)
    {
      return 1;
    }
    else
    {
      int d;
      s->visiting = 1;
      for (d = 0; d < s->nFriends; d++)
      {
        s->wait = visit(s->friends[d]);
        if (s->grade < s->friends[d]->grade)
        {
          s->grade = s->friends[d]->grade;
        }
        else
        {
          
        }

      }

      if (s->wait)
      {
        s->visiting = 0;
        return 1;
      }
      else
      {
        
      }

      s->visited = 1;
    }

  }

  return s->visited;
}

void spreadFriends(pStudent *s, int n)
{
  int i;
  for (i = 0; i < n; i++)
    visit(s[i]);

}

void finalPrint(pStudent *s, int n)
{
  int i;
  for (i = 0; i < n; i++)
    printf("%d\n", s[i]->grade);

}

int main()
{
  char *input;
  char *numStudents;
  char *numFriendships;
  int *grades;
  int x = 0;
  int *pos = &x;
  Friendship *friendships;
  pStudent *students;
  input = readInput(60);
  numStudents = processFirstLine(input, pos, ',');
  numFriendships = processFirstLine(input, pos, '\n');
  grades = (int *) malloc((sizeof(int)) * (atoi(numStudents) + 1));
  processGrades(input, grades, pos, atoi(numStudents) + 1);
  friendships = (Friendship *) malloc((sizeof(Friendship)) * atoi(numFriendships));
  processFriendships(input, friendships, pos, atoi(numFriendships));
  free(input);
  students = (pStudent *) malloc((sizeof(pStudent)) * atoi(numStudents));
  initializeStudents(students, grades, atoi(numStudents));
  free(grades);
  addFriends(students, friendships, atoi(numFriendships));
  free(friendships);
  free(numFriendships);
  spreadFriends(students, atoi(numStudents));
  finalPrint(students, atoi(numStudents));
  for (x = 0; x < atoi(numStudents); x++)
  {
    free(students[x]->friends);
    free(students[x]);
  }

  free(students);
  free(numStudents);
  return 0;
}

