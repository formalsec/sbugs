#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef struct 
{
  int colour;
  int grade;
  int nFriends;
  int *friends;
} Person;
Person *peopleList;
int *visited;
int *low;
int *stack;
int *disc;
int max;
int nPeople;
int nFriendships;
int nStack = 0;
void initialize()
{
  int i = 0;
  for (i = 0; i < nPeople; i++)
  {
    peopleList[i].colour = 0;
    peopleList[i].grade = 0;
    peopleList[i].nFriends = 0;
    peopleList[i].friends = 0;
  }

}

void addGrade(int index, int grade)
{
  peopleList[index].grade = grade;
}

void addFriend(int id, int friend)
{
  peopleList[id].nFriends++;
  peopleList[id].friends = (int *) realloc(peopleList[id].friends, (sizeof(int)) * peopleList[id].nFriends);
  peopleList[id].friends[peopleList[id].nFriends - 1] = friend;
}

void Push(int i)
{
  stack[nStack] = i;
  nStack++;
}

int Pop()
{
  nStack--;
  return stack[nStack];
}

int friendRelations(int index, int count)
{
  int i;
  int n;
  int friend;
  Push(index);
  peopleList[index].colour = 1;
  low[index] = ++count;
  disc[index] = count;
  for (i = 0; i < peopleList[index].nFriends; i++)
  {
    friend = peopleList[index].friends[i];
    if (peopleList[friend].colour == 0)
    {
      friendRelations(friend, count);
      low[index] = (low[index] < low[friend]) ? (low[index]) : (low[friend]);
    }
    else
    {
      if (peopleList[friend].colour == 1)
      {
        low[index] = (low[index] < low[friend]) ? (low[index]) : (low[friend]);
      }
      else
      {
        
      }

    }

    peopleList[index].grade = (peopleList[friend].grade > peopleList[index].grade) ? (peopleList[friend].grade) : (peopleList[index].grade);
  }

  if (disc[index] == low[index])
  {
    while ((n = Pop()) != (-1))
    {
      peopleList[n].colour = 2;
      peopleList[n].grade = peopleList[index].grade;
      if (n == index)
      {
        break;
      }
      else
      {
        
      }

    }

  }
  else
  {
    
  }

  return peopleList[index].grade;
}

void relations()
{
  int i;
  int count = 0;
  for (i = 0; i < nPeople; i++)
  {
    if (peopleList[i].colour == 0)
    {
      friendRelations(i, count);
    }
    else
    {
      
    }

  }

}

void verifyInput(int nPeople, int nFriendships)
{
  if ((nPeople < 2) || (nFriendships < 1))
  {
    exit(0);
  }
  else
  {
    
  }

}

int main()
{
  int i;
  int grade;
  int id;
  int friend;
  nPeople = new_sym_var(sizeof(int) * 8);
  nFriendships = new_sym_var(sizeof(int) * 8);
  verifyInput(nPeople, nFriendships);
  peopleList = malloc((sizeof(Person)) * nPeople);
  disc = malloc((sizeof(int)) * nPeople);
  stack = malloc((sizeof(int)) * nPeople);
  low = malloc((sizeof(int)) * nPeople);
  initialize();
  for (i = 0; i < nPeople; i++)
  {
    grade = new_sym_var(sizeof(int) * 8);
    addGrade(i, grade);
  }

  for (i = 0; i < nFriendships; i++)
  {
    id = new_sym_var(sizeof(int) * 8);
    friend = new_sym_var(sizeof(int) * 8);
    id--;
    friend--;
    addFriend(id, friend);
  }

  relations();
  for (i = 0; i < nPeople; i++)
  {
    printf("%d\n", peopleList[i].grade);
  }

  for (i = 0; i < nPeople; i++)
  {
    free(peopleList[i].friends);
  }

  free(peopleList);
  free(disc);
  free(stack);
  free(low);
  return 0;
}

