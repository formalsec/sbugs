/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef struct StudentGrade
{
  int id;
  int currentGrade;
  int changed;
} StudentGrade;
typedef struct Node
{
  StudentGrade *student;
  struct Node *next;
} Node;
typedef struct AdjacenciesList
{
  Node **nodes;
  int size;
} AdjacenciesList;
AdjacenciesList list;
StudentGrade *studentsGrades;
int *sortAux;
void countSort(StudentGrade **array, int n, int exp)
{
  int i;
  int count[10] = {0};
  for (i = 0; i < n; i++)
  {
    count[9 - ((array[i]->currentGrade / exp) % 10)]++;
  }

  for (i = 1; i < 10; i++)
  {
    count[i] += count[i - 1];
  }

  for (i = n - 1; i >= 0; i--)
  {
    sortAux[--count[9 - ((array[i]->currentGrade / exp) % 10)]] = array[i]->id;
  }

  for (i = 0; i < n; i++)
  {
    array[i] = &studentsGrades[sortAux[i]];
  }

}

void sort(StudentGrade **array, int n)
{
  int max = array[0]->currentGrade;
  int i;
  int exp;
  for (i = 1; i < n; i++)
  {
    if (array[i]->currentGrade > max)
    {
      max = array[i]->currentGrade;
    }
    else
    {
      
    }

  }

  for (exp = 1; (max / exp) > 0; exp *= 10)
  {
    countSort(array, n, exp);
  }

}

void changeStudentsGradeAndFriends(int newGrade, int id)
{
  Node *auxNode = list.nodes[id];
  if (studentsGrades[id].changed)
  {
    return;
  }
  else
  {
    
  }

  studentsGrades[id].currentGrade = newGrade;
  studentsGrades[id].changed = 1;
  if (auxNode == 0)
  {
    return;
  }
  else
  {
    
  }

  while (auxNode != 0)
  {
    changeStudentsGradeAndFriends(newGrade, auxNode->student->id);
    auxNode = auxNode->next;
  }

}

int main()
{
  int amountStudents;
  int amountFriendships;
  int id;
  int friendId;
  int grade;
  int i;
  Node *friendShipNodes;
  StudentGrade **queue;
  amountStudents = new_sym_var(sizeof(int) * 8);
  amountFriendships = new_sym_var(sizeof(int) * 8);
  list.nodes = (Node **) malloc((sizeof(Node *)) * amountStudents);
  friendShipNodes = (Node *) malloc((sizeof(Node)) * amountFriendships);
  studentsGrades = (StudentGrade *) malloc((sizeof(StudentGrade)) * amountStudents);
  queue = (StudentGrade **) malloc((sizeof(StudentGrade *)) * amountStudents);
  sortAux = (int *) malloc((sizeof(int)) * amountStudents);
  list.size = amountStudents;
  for (i = 0; i < amountStudents; i++)
  {
    grade = new_sym_var(sizeof(int) * 8);
    studentsGrades[i].id = i;
    studentsGrades[i].currentGrade = grade;
    studentsGrades[i].changed = 0;
    list.nodes[i] = 0;
    queue[i] = &studentsGrades[i];
  }

  for (i = 0; i < amountFriendships; i++)
  {
    friendId = new_sym_var(sizeof(int) * 8);
    id = new_sym_var(sizeof(int) * 8);
    id--;
    friendId--;
    friendShipNodes[i].student = &studentsGrades[friendId];
    if (list.nodes[id] == 0)
    {
      friendShipNodes[i].next = 0;
      list.nodes[id] = &friendShipNodes[i];
    }
    else
    {
      friendShipNodes[i].next = list.nodes[id];
      list.nodes[id] = &friendShipNodes[i];
    }

  }

  sort(queue, amountStudents);
  for (i = 0; i < amountStudents; i++)
  {
    changeStudentsGradeAndFriends(queue[i]->currentGrade, queue[i]->id);
  }

  for (i = 0; i < amountStudents; i++)
  {
    printf("%d\n", studentsGrades[i].currentGrade);
  }

  free(list.nodes);
  free(friendShipNodes);
  free(studentsGrades);
  free(queue);
  free(sortAux);
  return 0;
}

