/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


int flag = 1;
typedef struct student
{
  int id;
  int grade;
  struct student *next;
} student;
struct Graph
{
  int numStudents;
  int *visited;
  int *grades;
  struct student **relationships;
};
struct Graph *createGraph(int students)
{
  struct Graph *graph = malloc(sizeof(struct Graph));
  graph->numStudents = students;
  graph->grades = malloc(students * (sizeof(int)));
  graph->relationships = malloc(students * (sizeof(struct student *)));
  graph->visited = malloc(students * (sizeof(int)));
  int i;
  for (i = 0; i < students; i++)
  {
    graph->relationships[i] = 0;
    graph->visited[i] = 0;
  }

  return graph;
}

void freeRelationships(struct student *student)
{
  if (!student)
  {
    return;
  }
  else
  {
    
  }

  freeRelationships(student->next);
  free(student);
}

void freeGraph(struct Graph *graph, int students)
{
  free(graph->grades);
  free(graph->visited);
  int i;
  for (i = 0; i < students; i++)
  {
    freeRelationships(graph->relationships[i]);
  }

  free(graph->relationships);
  free(graph);
}

struct student *createStudent(int id, int grade)
{
  struct student *newStudent = malloc(sizeof(struct student));
  newStudent->id = id;
  newStudent->grade = grade;
  newStudent->next = 0;
  return newStudent;
}

void addEdge(struct Graph *graph, int src, int dest)
{
  struct student *newStudent = createStudent(dest, graph->grades[dest]);
  newStudent->next = graph->relationships[src];
  graph->relationships[src] = newStudent;
}

void DFSVisited(struct Graph *graph, int id)
{
  struct student *relationships = graph->relationships[id];
  struct student *temp = relationships;
  graph->visited[id] = 1;
  while (temp != 0)
  {
    int connectedId = temp->id;
    if (graph->visited[connectedId] == 0)
    {
      DFSVisited(graph, connectedId);
    }
    else
    {
      
    }

    if (graph->grades[id] < graph->grades[connectedId])
    {
      graph->grades[id] = graph->grades[connectedId];
      flag = 0;
    }
    else
    {
      
    }

    temp = temp->next;
  }

}

void checkGrades(struct Graph *graph, int id)
{
  struct student *relationships = graph->relationships[id];
  struct student *temp = relationships;
  while (temp != 0)
  {
    int connectedId = temp->id;
    if (graph->grades[id] < graph->grades[connectedId])
    {
      graph->grades[id] = graph->grades[connectedId];
      flag = 0;
    }
    else
    {
      
    }

    temp = temp->next;
  }

}

void DFS(struct Graph *graph, int students)
{
  int i;
  for (i = 0; i < students; i++)
  {
    if (graph->visited[i] == 0)
    {
      DFSVisited(graph, i);
    }
    else
    {
      
    }

  }

  while (!flag)
  {
    flag = 1;
    for (i = 0; i < students; i++)
    {
      checkGrades(graph, i);
    }

  }

}

int main(int argc, char *argv[])
{
  int students;
  int relationships;
  int grade;
  int src;
  int dest;
  int i;
  students = new_sym_var(sizeof(int) * 8);
  relationships = new_sym_var(sizeof(int) * 8);
  if ((students < 2) || (relationships < 1))
  {
    exit(1);
  }
  else
  {
    
  }

  struct Graph *graph = createGraph(students);
  for (i = 0; i < students; i++)
  {
    grade = new_sym_var(sizeof(int) * 8);
    if (grade > 20)
    {
      exit(1);
    }
    else
    {
      
    }

    graph->grades[i] = grade;
  }

  for (i = 0; i < relationships; i++)
  {
    src = new_sym_var(sizeof(int) * 8);
    dest = new_sym_var(sizeof(int) * 8);
    if ((src > students) || (dest > students))
    {
      exit(1);
    }
    else
    {
      
    }

    addEdge(graph, src - 1, dest - 1);
  }

  DFS(graph, students);
  for (i = 0; i < students; i++)
  {
    printf("%d\n", graph->grades[i]);
  }

  freeGraph(graph, students);
  return 0;
}

