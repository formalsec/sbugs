#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct Node
{
  long unsigned int id;
  struct Node *next;
} node;
typedef struct List
{
  node *head;
} list;
typedef struct Graph
{
  long unsigned int n;
  list *lists;
} graph;
node *createNode(long unsigned int id)
{
  node *newNode = (node *) malloc(sizeof(node *));
  newNode->id = id;
  newNode->next = 0;
  return newNode;
}

graph *createGraph(long unsigned int n)
{
  long unsigned int i;
  n++;
  graph *newGraph = (graph *) malloc(sizeof(graph));
  newGraph->n = n;
  newGraph->lists = (list *) malloc((sizeof(list)) * (n + 1));
  for (i = 1; i <= n; i++)
  {
    newGraph->lists[i].head = 0;
  }

  return newGraph;
}

void addEdge(graph *graph, long unsigned int v1, long unsigned int v2)
{
  node *newNode = createNode(v2);
  newNode->next = graph->lists[v1].head;
  graph->lists[v1].head = newNode;
}

void printGraph(graph *graph)
{
  long unsigned int v;
  for (v = 1; v <= graph->n; v++)
  {
    node *nodep = graph->lists[v].head;
    printf("Vertex %lu\n head", v);
    while (nodep)
    {
      printf(" > %lu", nodep->id);
      nodep = nodep->next;
    }

    printf("\n\n");
  }

}

void parseInput(graph *students, int *grades, long unsigned int n, long unsigned int m)
{
  long unsigned int i;
  long unsigned int s1;
  long unsigned int s2;
  int grade;
  for (i = 1; i <= n; i++)
  {
    if (1)
    {
      grade = new_sym_var(sizeof(int) * 8);
      ;
    }
    else
    {
      
    }

    grades[i] = grade;
  }

  for (i = 0; i < m; i++)
  {
    if (2)
    {
      s1 = new_sym_var(sizeof(long unsigned int) * 8);
      s2 = new_sym_var(sizeof(long unsigned int) * 8);
      ;
    }
    else
    {
      
    }

    addEdge(students, s2, s1);
  }

}

void run(graph *students, int *grades)
{
  int max;
  int maxi;
  int n;
  int i;
  int left;
  node *nodep;
  max = 0;
  maxi = 1;
  n = students->n;
  left = n;
  while (left > 0)
  {
    for (i = 1; i <= n; i++)
    {
      if ((students->lists[i].head != 0) && (grades[i] > max))
      {
        max = grades[i];
        maxi = i;
      }
      else
      {
        
      }

    }

    nodep = students->lists[maxi].head;
    while (nodep)
    {
      if (grades[nodep->id] < max)
      {
        grades[nodep->id] = max;
      }
      else
      {
        
      }

      nodep = nodep->next;
    }

    students->lists[maxi].head = 0;
    max = 0;
    left--;
  }

}

int main(int argc, char **argv)
{
  long unsigned int i;
  long unsigned int n;
  long unsigned int m;
  graph *students;
  int *grades;
  if (2)
  {
    n = new_sym_var(sizeof(long unsigned int) * 8);
    m = new_sym_var(sizeof(long unsigned int) * 8);
    ;
  }
  else
  {
    
  }

  grades = (int *) malloc((sizeof(int)) * (n + 1));
  students = createGraph(n);
  parseInput(students, grades, n, m);
  run(students, grades);
  for (i = 1; i <= n; i++)
  {
    printf("%d\n", grades[i]);
  }

  return 0;
}

