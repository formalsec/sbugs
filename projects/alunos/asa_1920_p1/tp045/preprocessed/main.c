#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>


typedef struct node *link;
struct node
{
  long connection;
  link next;
};
typedef struct 
{
  int index;
  int score;
  int visited;
  link listOfAdj;
} Student;
void DFSUtil(Student **studs, int idx, int grade)
{
  link adj = studs[idx]->listOfAdj;
  studs[idx]->visited = 1;
  if (grade > studs[idx]->score)
  {
    studs[idx]->score = grade;
  }
  else
  {
    
  }

  for (; adj != 0; adj = adj->next)
  {
    if (studs[adj->connection - 1]->visited == 0)
    {
      DFSUtil(studs, adj->connection - 1, studs[idx]->score);
    }
    else
    {
      if (studs[idx]->score > studs[adj->connection - 1]->score)
      {
        DFSUtil(studs, adj->connection - 1, studs[idx]->score);
      }
      else
      {
        
      }

    }

  }

}

void DFS(Student **graph, int vertexs)
{
  int i = 0;
  for (i = 0; i < vertexs; i++)
  {
    if (graph[i]->visited == 0)
    {
      DFSUtil(graph, i, 0);
    }
    else
    {
      
    }

  }

}

void createLink(link clink, int rela)
{
  clink->next = 0;
  clink->connection = rela;
}

void insertLink(Student **graph, int rela, int relb)
{
  link newAdj = malloc(sizeof(struct node));
  if (graph[relb - 1]->listOfAdj == 0)
  {
    graph[relb - 1]->listOfAdj = newAdj;
    createLink(graph[relb - 1]->listOfAdj, rela);
  }
  else
  {
    link adj = graph[relb - 1]->listOfAdj;
    while (adj->next != 0)
      adj = adj->next;

    adj->next = newAdj;
    createLink(newAdj, rela);
  }

}

int main(int argc, char **argv)
{
  long int N;
  long int M;
  long int rela;
  long int relb;
  int i = 0;
  N = new_sym_var(sizeof(long int) * 8);
  M = new_sym_var(sizeof(long int) * 8);
  Student *listOfStudents[N];
  while (i < N)
  {
    listOfStudents[i] = (Student *) malloc(sizeof(Student));
    listOfStudents[i]->score = new_sym_var(sizeof(int) * 8);
    listOfStudents[i]->index = i + 1;
    listOfStudents[i]->visited = 0;
    i++;
  }

  i = 0;
  while (i < M)
  {
    rela = new_sym_var(sizeof(long int) * 8);
    relb = new_sym_var(sizeof(long int) * 8);
    if ((rela > N) || (relb > N))
    {
      exit(0);
    }
    else
    {
      
    }

    insertLink(listOfStudents, rela, relb);
    i++;
  }

  DFS(listOfStudents, N);
  i = 0;
  while (i < N)
  {
    printf("%d\n", listOfStudents[i]->score);
    i++;
  }

  return 0;
}

