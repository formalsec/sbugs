#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>


typedef struct sequence_el
{
  int id;
  struct sequence_el *next_el;
} SequenceEl;
typedef struct sequence
{
  int size;
  SequenceEl *first;
  SequenceEl *last;
} Sequence;
Sequence *createSequence()
{
  Sequence *s = (Sequence *) malloc(sizeof(Sequence));
  s->size = 0;
  s->first = 0;
  s->last = 0;
  return s;
}

SequenceEl *createSequenceEl(int id)
{
  SequenceEl *se = (SequenceEl *) malloc(sizeof(SequenceEl));
  se->id = id;
  se->next_el = 0;
  return se;
}

void freeSequence(Sequence *s)
{
  SequenceEl *aux1;
  SequenceEl *aux2;
  aux1 = s->first;
  while (aux1)
  {
    aux2 = aux1->next_el;
    free(aux1);
    aux1 = aux2;
  }

  free(s);
}

void addNumberToSequence(Sequence *s, int id)
{
  SequenceEl *se = createSequenceEl(id);
  s->size++;
  if (s->first == 0)
  {
    s->first = se;
  }
  else
  {
    s->last->next_el = se;
  }

  s->last = se;
}

void problem1(Sequence *s)
{
  int i;
  int j;
  int *seq = malloc(s->size * (sizeof(int)));
  SequenceEl *se = s->first;
  for (i = 0; i < s->size; i++)
  {
    seq[i] = se->id;
    se = se->next_el;
  }

  int *len_seq = malloc(s->size * (sizeof(int)));
  int *num_seq = malloc(s->size * (sizeof(int)));
  for (i = 0; i < s->size; i++)
  {
    len_seq[i] = 1;
    num_seq[i] = 1;
  }

  for (i = 1; i < s->size; i++)
  {
    for (j = 0; j < i; j++)
    {
      if (seq[i] > seq[j])
      {
        if (len_seq[i] == (len_seq[j] + 1))
        {
          num_seq[i] = num_seq[i] + num_seq[j];
        }
        else
        {
          
        }

        if (len_seq[i] < (len_seq[j] + 1))
        {
          len_seq[i] = len_seq[i] + 1;
          num_seq[i] = num_seq[j];
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  int lis = 0;
  int n_lis = 0;
  for (i = 0; i < s->size; i++)
  {
    if (len_seq[i] > lis)
    {
      lis = len_seq[i];
      n_lis = 0;
    }
    else
    {
      
    }

    if (len_seq[i] == lis)
    {
      n_lis = n_lis + num_seq[i];
    }
    else
    {
      
    }

  }

  printf("%d %d\n", lis, n_lis);
  free(seq);
  free(len_seq);
  free(num_seq);
}

void problem2(Sequence *s1, Sequence *s2)
{
  int i;
  int j;
  int *seq1 = malloc(s1->size * (sizeof(int)));
  SequenceEl *se = s1->first;
  for (i = 0; i < s1->size; i++)
  {
    seq1[i] = se->id;
    se = se->next_el;
  }

  int *seq2 = malloc(s2->size * (sizeof(int)));
  se = s2->first;
  for (i = 0; i < s2->size; i++)
  {
    seq2[i] = se->id;
    se = se->next_el;
  }

  int *len_seq = malloc(s2->size * (sizeof(int)));
  for (i = 0; i < s2->size; i++)
  {
    len_seq[i] = 0;
  }

  int current_path = 0;
  for (i = 0; i < s1->size; i++)
  {
    for (j = 0; j < s2->size; j++)
    {
      if (seq1[i] > seq2[j])
      {
        if (len_seq[j] > current_path)
        {
          current_path = len_seq[j];
        }
        else
        {
          
        }

      }
      else
      {
        
      }

      if (seq1[i] == seq2[j])
      {
        if (len_seq[j] <= current_path)
        {
          len_seq[j] = current_path + 1;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

    current_path = 0;
  }

  int lcis = 0;
  for (i = 0; i < s2->size; i++)
  {
    if (len_seq[i] > lcis)
    {
      lcis = len_seq[i];
    }
    else
    {
      
    }

  }

  printf("%d\n", lcis);
  free(seq1);
  free(seq2);
  free(len_seq);
}

int main()
{
  int num_sequences;
  int tmp;
  char aux;
  Sequence *s1 = createSequence();
  if (1)
  {
    num_sequences = new_sym_var(sizeof(int) * 8);
    while (1)
    {
      tmp = new_sym_var(sizeof(int) * 8);
      addNumberToSequence(s1, tmp);
      if (1)
      {
        aux = new_sym_var(sizeof(char) * 8);
        if (aux == '\n')
        {
          break;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

    if (num_sequences == 2)
    {
      Sequence *s2 = createSequence();
      while (1)
      {
        tmp = new_sym_var(sizeof(int) * 8);
        addNumberToSequence(s2, tmp);
        if (1)
        {
          aux = new_sym_var(sizeof(char) * 8);
          if (aux == '\n')
          {
            break;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

      problem2(s1, s2);
      freeSequence(s1);
      freeSequence(s2);
    }
    else
    {
      problem1(s1);
      freeSequence(s1);
    }

  }
  else
  {
    
  }

  return 0;
}

