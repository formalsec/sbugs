#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


int *getSequence(int *);
void problem1();
void problem2();
int maxCommonSize(int *, int, int *, int);
unsigned long long int numberOfLongestIncreasingSubsequences(int *, int, int *);
int binarySearch(int *, int, int, int);
int main()
{
  char problemNumber = getchar();
  if (getchar() == EOF)
  {
    return 1;
  }
  else
  {
    
  }

  if (problemNumber == '1')
  {
    problem1();
  }
  else
  {
    
  }

  if (problemNumber == '2')
  {
    problem2();
  }
  else
  {
    
  }

  return 0;
}

int *getSequence(int *f_size)
{
  char line[900000];
  fgets(line, 900000, stdin);
  int *sequence = (int *) malloc((sizeof(int)) * 200000);
  if (sequence == 0)
  {
    return 0;
  }
  else
  {
    
  }

  char *n = strtok(line, " ");
  int i = 0;
  int number;
  for (; n != 0; n = strtok(0, " "), i++)
  {
    if (1 == EOF)
    {
      break;
    }
    else
    {
      number = new_sym_var(sizeof(int) * 8);
      
    }

    sequence[i] = number;
  }

  *f_size = i;
  return sequence;
}

int cmpfunc(const void *a, const void *b)
{
  return (*((int *) a)) - (*((int *) b));
}

int *getSecondSequence(int *f_size, int *seq, int size)
{
  int *aux = (int *) malloc((sizeof(int)) * size);
  int i = 0;
  for (; i < size; i++)
    aux[i] = seq[i];

  qsort(aux, size, sizeof(int), cmpfunc);
  char line[900000];
  fgets(line, 900000, stdin);
  int *sequence = (int *) malloc((sizeof(int)) * 200000);
  if (sequence == 0)
  {
    return 0;
  }
  else
  {
    
  }

  char *n = strtok(line, " ");
  i = 0;
  int number;
  for (; n != 0; n = strtok(0, " "))
  {
    if (1 == EOF)
    {
      break;
    }
    else
    {
      number = new_sym_var(sizeof(int) * 8);
      
    }

    if (binarySearch(aux, 0, size - 1, number))
    {
      sequence[i] = number;
      i++;
    }
    else
    {
      
    }

  }

  *f_size = i;
  free(aux);
  return sequence;
}

int binarySearch(int *seq, int left, int right, int number)
{
  int mid;
  while (left <= right)
  {
    mid = left + ((right - left) / 2);
    if (seq[mid] == number)
    {
      return 1;
    }
    else
    {
      if (seq[mid] < number)
      {
        left = mid + 1;
      }
      else
      {
        right = mid - 1;
      }

    }

  }

  return 0;
}

void problem1()
{
  int size;
  int maxDepth;
  int *sequence = getSequence(&size);
  unsigned long long int count = numberOfLongestIncreasingSubsequences(sequence, size, &maxDepth);
  printf("%d %llu\n", maxDepth, count);
  free(sequence);
}

void problem2()
{
  int size1;
  int size2;
  int *sequence1 = getSequence(&size1);
  int *sequence2 = getSecondSequence(&size2, sequence1, size1);
  int maxSize = maxCommonSize(sequence1, size1, sequence2, size2);
  printf("%d\n", maxSize);
  free(sequence1);
  free(sequence2);
}

unsigned long long int numberOfLongestIncreasingSubsequences(int *seq, int size, int *sizeOfSubSequence)
{
  *sizeOfSubSequence = 1;
  unsigned long long int numberOfSubSequences = 0;
  int *subSize = (int *) malloc((sizeof(int)) * size);
  unsigned long long int *count = (unsigned long long int *) malloc((sizeof(unsigned long long int)) * size);
  int i = 0;
  for (; i < size; i++)
  {
    count[i] = 1;
    subSize[i] = 1;
  }

  i = 0;
  int j;
  for (; i < size; i++)
  {
    j = i - 1;
    for (; j >= 0; j--)
    {
      if (seq[i] > seq[j])
      {
        if (subSize[i] < (subSize[j] + 1))
        {
          subSize[i] = subSize[j] + 1;
          count[i] = count[j];
        }
        else
        {
          if (subSize[i] == (subSize[j] + 1))
          {
            count[i] += count[j];
          }
          else
          {
            
          }

        }

      }
      else
      {
        
      }

    }

  }

  i = 0;
  for (; i < size; i++)
  {
    if (subSize[i] > (*sizeOfSubSequence))
    {
      *sizeOfSubSequence = subSize[i];
    }
    else
    {
      
    }

  }

  i = 0;
  for (; i < size; i++)
  {
    if (subSize[i] == (*sizeOfSubSequence))
    {
      numberOfSubSequences += count[i];
    }
    else
    {
      
    }

  }

  free(subSize);
  free(count);
  return numberOfSubSequences;
}

int maxCommonSize(int *v1, int s1, int *v2, int s2)
{
  int i = 0;
  int j;
  int maxCommonSize = 0;
  int *sizes = (int *) malloc((sizeof(int)) * s2);
  for (; i < s2; i++)
    sizes[i] = 0;

  int currentSize;
  i = 0;
  for (; i < s1; i++)
  {
    j = 0;
    currentSize = 0;
    for (; j < s2; j++)
    {
      if (v1[i] == v2[j])
      {
        if (sizes[j] < (currentSize + 1))
        {
          sizes[j] = currentSize + 1;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

      if (v1[i] > v2[j])
      {
        if (sizes[j] > currentSize)
        {
          currentSize = sizes[j];
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  i = 0;
  for (; i < s2; i++)
  {
    if (sizes[i] > maxCommonSize)
    {
      maxCommonSize = sizes[i];
    }
    else
    {
      
    }

  }

  free(sizes);
  return maxCommonSize;
}

