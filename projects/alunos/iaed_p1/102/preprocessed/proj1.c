/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


int dim_prod;
int dim_enc;
typedef struct produto
{
  int idt;
  char des[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct encomenda
{
  int idt;
  int peso;
  int prod_idt[200];
  int prod_qtd[200];
  int len;
} encomenda;
void insertion(produto vetor[], int left, int right)
{
  int i;
  int j;
  for (i = left + 1; i <= right; i++)
  {
    produto v;
    strcpy(v.des, vetor[i].des);
    v.preco = vetor[i].preco;
    v.qtd = vetor[i].qtd;
    j = i - 1;
    while ((j >= left) && (strcmp(v.des, vetor[j].des) < 0))
    {
      strcpy(vetor[j + 1].des, vetor[j].des);
      vetor[j + 1].preco = vetor[j].preco;
      vetor[j + 1].qtd = vetor[j].qtd;
      j--;
    }

    vetor[j + 1].preco = v.preco;
    strcpy(vetor[j + 1].des, v.des);
    vetor[j + 1].qtd = v.qtd;
  }

}

void merge(produto vetor[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  int n1 = (m - left) + 1;
  int n2 = right - m;
  produto Left[10000];
  produto Right[10000];
  for (i = 0; i < n1; i++)
  {
    strcpy(Left[i].des, vetor[left + i].des);
    Left[i].preco = vetor[left + i].preco;
    Left[i].qtd = vetor[left + i].qtd;
  }

  for (j = 0; j < n2; j++)
  {
    strcpy(Right[j].des, vetor[(m + 1) + j].des);
    Right[j].preco = vetor[(m + 1) + j].preco;
    Right[j].qtd = vetor[(m + 1) + j].qtd;
  }

  i = 0;
  j = 0;
  k = left;
  while ((i < n1) && (j < n2))
  {
    if (Left[i].preco <= Right[j].preco)
    {
      strcpy(vetor[k].des, Left[i].des);
      vetor[k].preco = Left[i].preco;
      vetor[k].qtd = Left[i].qtd;
      i++;
    }
    else
    {
      strcpy(vetor[k].des, Right[j].des);
      vetor[k].preco = Right[j].preco;
      vetor[k].qtd = Right[j].qtd;
      j++;
    }

    k++;
  }

  while (i < n1)
  {
    strcpy(vetor[k].des, Left[i].des);
    vetor[k].preco = Left[i].preco;
    vetor[k].qtd = Left[i].qtd;
    i++;
    k++;
  }

  while (j < n2)
  {
    strcpy(vetor[k].des, Right[j].des);
    vetor[k].preco = Right[j].preco;
    vetor[k].qtd = Right[j].qtd;
    j++;
    k++;
  }

}

void mergesort(produto vetor[], int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(vetor, left, m);
  mergesort(vetor, m + 1, right);
  merge(vetor, left, m, right);
}

int procura_enc(int ide, encomenda vetor_enc[])
{
  int i;
  for (i = 0; i < dim_enc; i++)
  {
    if (vetor_enc[i].idt == ide)
    {
      break;
    }
    else
    {
      
    }

  }

  return i;
}

int procura_prod(int idp, produto vetor_prod[])
{
  int a;
  for (a = 0; a < dim_prod; a++)
  {
    if (vetor_prod[a].idt == idp)
    {
      break;
    }
    else
    {
      
    }

  }

  return a;
}

void a(produto vetor_prod[]);
void q(produto vetor_prod[]);
void N(encomenda vetor_enc[]);
void A(encomenda vetor_enc[], produto vetor_prod[]);
void r(produto vetor_prod[]);
void R(encomenda vetor_enc[], produto vetor_prod[]);
void C(encomenda vetor_enc[], produto vetor_prod[]);
void p(produto vetor_prod[]);
void E(encomenda vetor_enc[], produto vetor_prod[]);
void m(encomenda vetor_enc[], produto vetor_prod[]);
void l(produto vetor_prod[]);
void L(encomenda vetor_enc[], produto vetor_prod[]);
int main()
{
  produto sistema_prod[10000];
  encomenda sistema_enc[500];
  char c;
  c = getchar();
  while (c != 'x')
  {
    switch (c)
    {
      case 'a':
        a(sistema_prod);
        break;

      case 'q':
        q(sistema_prod);
        break;

      case 'N':
        N(sistema_enc);
        break;

      case 'A':
        A(sistema_enc, sistema_prod);
        break;

      case 'r':
        r(sistema_prod);
        break;

      case 'R':
        R(sistema_enc, sistema_prod);
        break;

      case 'C':
        C(sistema_enc, sistema_prod);
        break;

      case 'p':
        p(sistema_prod);
        break;

      case 'E':
        E(sistema_enc, sistema_prod);
        break;

      case 'm':
        m(sistema_enc, sistema_prod);
        break;

      case 'l':
        l(sistema_prod);
        break;

      case 'L':
        L(sistema_enc, sistema_prod);
        break;

    }

    c = getchar();
  }

  return 0;
}

void a(produto vetor_prod[])
{
  produto p1;
  for (int p1_index = 0; p1_index < 10; p1_index++)
  {
    p1.des[p1_index] = new_sym_var(sizeof(char) * 8);
  }

  p1.des[10 - 1] = '\0';
  p1.preco = new_sym_var(sizeof(int) * 8);
  p1.peso = new_sym_var(sizeof(int) * 8);
  p1.qtd = new_sym_var(sizeof(int) * 8);
  p1.idt = dim_prod;
  vetor_prod[dim_prod] = p1;
  printf("Novo produto %d.\n", p1.idt);
  dim_prod = dim_prod + 1;
}

void q(produto vetor_prod[])
{
  int idp;
  int qtd;
  int i;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  i = procura_prod(idp, vetor_prod);
  if (i == dim_prod)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  vetor_prod[i].qtd += qtd;
}

void N(encomenda vetor_enc[])
{
  encomenda e1;
  int i;
  e1.idt = dim_enc;
  e1.peso = 0;
  e1.len = 0;
  for (i = 0; i < 200; i++)
  {
    e1.prod_idt[i] = -1;
    e1.prod_qtd[i] = 0;
  }

  vetor_enc[dim_enc] = e1;
  printf("Nova encomenda %d.\n", e1.idt);
  dim_enc = dim_enc + 1;
}

void A(encomenda vetor_enc[], produto vetor_prod[])
{
  int ide;
  int idp;
  int qtd;
  int i;
  int a;
  int j;
  int peso;
  int var_controlo;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  a = procura_enc(ide, vetor_enc);
  if (a == dim_enc)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  peso = vetor_enc[a].peso;
  i = procura_prod(idp, vetor_prod);
  if (i == dim_prod)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  if ((vetor_prod[i].qtd - qtd) < 0)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  var_controlo = 0;
  for (j = 0; j < vetor_enc[a].len; j++)
  {
    if (vetor_enc[a].prod_idt[j] == idp)
    {
      var_controlo = 1;
      if ((vetor_enc[a].peso + (vetor_prod[i].peso * qtd)) <= 200)
      {
        vetor_enc[a].peso += vetor_prod[i].peso * qtd;
        vetor_enc[a].prod_qtd[j] += qtd;
        vetor_prod[i].qtd = vetor_prod[i].qtd - qtd;
        break;
      }
      else
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        return;
      }

    }
    else
    {
      
    }

  }

  if (((var_controlo == 0) && (peso == vetor_enc[a].peso)) && ((vetor_enc[a].peso + (vetor_prod[i].peso * qtd)) <= 200))
  {
    vetor_enc[a].peso += vetor_prod[i].peso * qtd;
    vetor_enc[a].prod_idt[j] = idp;
    vetor_enc[a].prod_qtd[j] = qtd;
    vetor_enc[a].len += 1;
    vetor_prod[i].qtd = vetor_prod[i].qtd - qtd;
  }
  else
  {
    if ((var_controlo == 0) && ((vetor_enc[a].peso + (vetor_prod[i].peso * qtd)) > 200))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
    }
    else
    {
      
    }

  }

}

void r(produto vetor_prod[])
{
  int qtd;
  int idp;
  int i;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  i = procura_prod(idp, vetor_prod);
  if (i == dim_prod)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  if ((vetor_prod[i].qtd - qtd) >= 0)
  {
    vetor_prod[i].qtd = vetor_prod[i].qtd - qtd;
  }
  else
  {
    printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    return;
  }

}

void R(encomenda vetor_enc[], produto vetor_prod[])
{
  int ide;
  int idp;
  int i;
  int a;
  int j;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  i = procura_enc(ide, vetor_enc);
  if (i == dim_enc)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  j = procura_prod(idp, vetor_prod);
  if (j == dim_prod)
  {
    printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  for (a = 0; a < vetor_enc[i].len; a++)
  {
    if (vetor_enc[i].prod_idt[a] == idp)
    {
      vetor_prod[j].qtd += vetor_enc[i].prod_qtd[a];
      vetor_enc[i].peso = vetor_enc[i].peso - (vetor_prod[j].peso * vetor_enc[i].prod_qtd[a]);
      for (j = a; j < vetor_enc[i].len; j++)
      {
        vetor_enc[i].prod_idt[j] = vetor_enc[i].prod_idt[j + 1];
        vetor_enc[i].prod_qtd[j] = vetor_enc[i].prod_qtd[j + 1];
      }

      vetor_enc[i].len = vetor_enc[i].len - 1;
      break;
    }
    else
    {
      
    }

  }

}

void C(encomenda vetor_enc[], produto vetor_prod[])
{
  int ide;
  int total;
  int i;
  int j;
  int a;
  total = 0;
  ide = new_sym_var(sizeof(int) * 8);
  i = procura_enc(ide, vetor_enc);
  if (i == dim_enc)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  for (j = 0; j < vetor_enc[i].len; j++)
  {
    for (a = 0; a < dim_prod; a++)
    {
      if (vetor_enc[i].prod_idt[j] == vetor_prod[a].idt)
      {
        total = total + (vetor_prod[a].preco * vetor_enc[i].prod_qtd[j]);
      }
      else
      {
        
      }

    }

  }

  printf("Custo da encomenda %d %d.\n", ide, total);
}

void p(produto vetor_prod[])
{
  int idp;
  int preco;
  int i;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  i = procura_prod(idp, vetor_prod);
  if (i == dim_prod)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  vetor_prod[i].preco = preco;
}

void E(encomenda vetor_enc[], produto vetor_prod[])
{
  int ide;
  int idp;
  int i;
  int j;
  int a;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  i = procura_enc(ide, vetor_enc);
  if (i == dim_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  a = procura_prod(idp, vetor_prod);
  if (a == dim_prod)
  {
    printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (j = 0; j < vetor_enc[i].len; j++)
  {
    if (vetor_enc[i].prod_idt[j] == idp)
    {
      printf("%s %d.\n", vetor_prod[a].des, vetor_enc[i].prod_qtd[j]);
      break;
    }
    else
    {
      
    }

  }

  if (j == vetor_enc[i].len)
  {
    printf("%s 0.\n", vetor_prod[a].des);
  }
  else
  {
    
  }

}

void m(encomenda vetor_enc[], produto vetor_prod[])
{
  int idp;
  int enc_max;
  int qtd_max;
  int i;
  int j;
  int a;
  enc_max = -1;
  qtd_max = 0;
  idp = new_sym_var(sizeof(int) * 8);
  a = procura_prod(idp, vetor_prod);
  if (a == dim_prod)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < dim_enc; i++)
  {
    for (j = 0; j < vetor_enc[i].len; j++)
    {
      if (vetor_enc[i].prod_idt[j] == idp)
      {
        if (vetor_enc[i].prod_qtd[j] > qtd_max)
        {
          qtd_max = vetor_enc[i].prod_qtd[j];
          enc_max = vetor_enc[i].idt;
          break;
        }
        else
        {
          if ((vetor_enc[i].prod_qtd[j] == qtd_max) && (enc_max > vetor_enc[i].idt))
          {
            enc_max = vetor_enc[i].idt;
            break;
          }
          else
          {
            
          }

        }

      }
      else
      {
        
      }

    }

  }

  if (enc_max != (-1))
  {
    printf("Maximo produto %d %d %d.\n", idp, enc_max, qtd_max);
  }
  else
  {
    
  }

}

void l(produto vetor_prod[])
{
  int j;
  int i;
  produto vetor[10000];
  for (i = 0; i < dim_prod; i++)
  {
    strcpy(vetor[i].des, vetor_prod[i].des);
    vetor[i].preco = vetor_prod[i].preco;
    vetor[i].qtd = vetor_prod[i].qtd;
  }

  mergesort(vetor, 0, dim_prod - 1);
  printf("Produtos\n");
  for (j = 0; j < dim_prod; j++)
  {
    printf("* %s %d %d\n", vetor[j].des, vetor[j].preco, vetor[j].qtd);
  }

}

void L(encomenda vetor_enc[], produto vetor_prod[])
{
  int ide;
  int i;
  int j;
  int a;
  int b;
  ide = new_sym_var(sizeof(int) * 8);
  i = procura_enc(ide, vetor_enc);
  if (i == dim_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    produto vetor[200];
    for (j = 0; j < vetor_enc[i].len; j++)
    {
      for (a = 0; a < dim_prod; a++)
      {
        if (vetor_enc[i].prod_idt[j] == vetor_prod[a].idt)
        {
          strcpy(vetor[j].des, vetor_prod[a].des);
          vetor[j].preco = vetor_prod[a].preco;
          vetor[j].qtd = vetor_enc[i].prod_qtd[j];
        }
        else
        {
          
        }

      }

    }

    insertion(vetor, 0, vetor_enc[i].len - 1);
    printf("Encomenda %d\n", ide);
    for (b = 0; b < vetor_enc[i].len; b++)
    {
      printf("* %s %d %d\n", vetor[b].des, vetor[b].preco, vetor[b].qtd);
    }

  }

}

