/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct stock
{
  int quantidade;
  int preco;
  int peso;
  char descricao[63];
} stock;
typedef struct encomenda
{
  stock produtos[10000];
} encomenda;
encomenda encomendas[500];
void cria_produto(int identificador_produtos, stock stocks[10000])
{
  for (int stocks_index = 0; stocks_index < 10; stocks_index++)
  {
    stocks[identificador_produtos].descricao[stocks_index] = new_sym_var(sizeof(char) * 8);
  }

  stocks[identificador_produtos].descricao[10 - 1] = '\0';
  stocks[identificador_produtos].preco = new_sym_var(sizeof(int) * 8);
  stocks[identificador_produtos].peso = new_sym_var(sizeof(int) * 8);
  stocks[identificador_produtos].quantidade = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", identificador_produtos);
}

void adiciona_produto(int idp, int qtd, int identificador_produtos, stock stocks[10000])
{
  if (idp >= identificador_produtos)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    stocks[idp].quantidade += qtd;
  }

}

void cria_encomenda(int identificador_encomendas)
{
  printf("Nova encomenda %d.\n", identificador_encomendas);
}

void adiciona_encomenda(int ide, int idp, int qtd, int identificador_produtos, int identificador_encomendas, int peso_total, stock stocks[10000], encomenda encomendas[500])
{
  int i;
  if (idp >= identificador_produtos)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    if (ide >= identificador_encomendas)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
    else
    {
      if (stocks[idp].quantidade < qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        return;
      }
      else
      {
        for (i = 0; i < 10000; i++)
        {
          peso_total += encomendas[ide].produtos[i].peso;
        }

        peso_total += qtd * stocks[idp].peso;
        if (peso_total > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
          return;
        }
        else
        {
          encomendas[ide].produtos[idp].peso += qtd * stocks[idp].peso;
          encomendas[ide].produtos[idp].quantidade += qtd;
          encomendas[ide].produtos[idp].preco = stocks[idp].preco;
          strcpy(encomendas[ide].produtos[idp].descricao, stocks[idp].descricao);
          stocks[idp].quantidade -= qtd;
        }

      }

    }

  }

}

void remove_stock_produto(int identificador_produtos, int idp, int qtd, stock stocks[10000])
{
  if (idp >= identificador_produtos)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    if (stocks[idp].quantidade < qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
      return;
    }
    else
    {
      stocks[idp].quantidade -= qtd;
    }

  }

}

void remover_produto_encomenda(int ide, int idp, int identificador_produtos, int identificador_encomendas, stock stocks[10000], encomenda encomendas[500])
{
  if (ide >= identificador_encomendas)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    if (idp >= identificador_produtos)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
    else
    {
      stocks[idp].quantidade += encomendas[ide].produtos[idp].quantidade;
      encomendas[ide].produtos[idp].peso = 0;
      encomendas[ide].produtos[idp].preco = 0;
      encomendas[ide].produtos[idp].quantidade = 0;
    }

  }

}

void calcula_preco_encomenda(int ide, int preco_total, int identificador_encomendas, int i, stock stocks[10000], encomenda encomendas[500])
{
  if (ide >= identificador_encomendas)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    for (i = 0; i < 10000; i++)
    {
      preco_total += encomendas[ide].produtos[i].quantidade * stocks[i].preco;
    }

    printf("Custo da encomenda %d %d.\n", ide, preco_total);
  }

}

void muda_preco(int idp, int preco, int identificador_produtos, stock stocks[10000])
{
  if (idp >= identificador_produtos)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    stocks[idp].preco = preco;
  }

}

void produto_encomenda(int ide, int idp, int identificador_produtos, int identificador_encomendas, stock stocks[10000], encomenda encomendas[500])
{
  if (ide >= identificador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    if (idp >= identificador_produtos)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      return;
    }
    else
    {
      printf("%s %d.\n", stocks[idp].descricao, encomendas[ide].produtos[idp].quantidade);
    }

  }

}

void maximo_encomenda(int idp, int identificador_produtos, encomenda encomendas[500])
{
  int contador;
  int encomenda_maxima;
  int maximo = -1;
  if (idp >= identificador_produtos)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    for (contador = 0; contador < 500; contador++)
    {
      if (maximo < encomendas[contador].produtos[idp].quantidade)
      {
        maximo = encomendas[contador].produtos[idp].quantidade;
        encomenda_maxima = contador;
      }
      else
      {
        
      }

    }

  }

  if (maximo == 0)
  {
    return;
  }
  else
  {
    printf("Maximo produto %d %d %d.\n", idp, encomenda_maxima, encomendas[encomenda_maxima].produtos[idp].quantidade);
  }

}

void merge_1(int guarda_idp[], int left, int m, int right, stock stocks[10000])
{
  int aux[10000];
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
  {
    aux[i - 1] = guarda_idp[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux[(right + m) - j] = guarda_idp[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if ((stocks[aux[j]].preco < stocks[aux[i]].preco) || ((stocks[aux[j]].preco == stocks[aux[i]].preco) && (aux[j] < aux[i])))
    {
      guarda_idp[k] = aux[j--];
    }
    else
    {
      guarda_idp[k] = aux[i++];
    }

  }

}

void mergesort_1(int guarda_idp[25], int left, int right, stock stocks[10000])
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_1(guarda_idp, left, m, stocks);
  mergesort_1(guarda_idp, m + 1, right, stocks);
  merge_1(guarda_idp, left, m, right, stocks);
}

void lista_produtos(int guarda_idp[10000], int i, stock stocks[10000])
{
  int left = 0;
  int right = i - 1;
  int j;
  mergesort_1(guarda_idp, left, right, stocks);
  printf("Produtos\n");
  for (j = 0; j < i; j++)
  {
    printf("* %s %d %d\n", stocks[guarda_idp[j]].descricao, stocks[guarda_idp[j]].preco, stocks[guarda_idp[j]].quantidade);
  }

}

void merge_2(int guarda_idp[], int left, int m, int right, stock stocks[10000])
{
  int aux[10000];
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
  {
    aux[i - 1] = guarda_idp[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux[(right + m) - j] = guarda_idp[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if ((strcmp(stocks[aux[j]].descricao, stocks[aux[i]].descricao) < 0) || ((strcmp(stocks[aux[j]].descricao, stocks[aux[i]].descricao) == 0) && (aux[j] < aux[i])))
    {
      guarda_idp[k] = aux[j--];
    }
    else
    {
      guarda_idp[k] = aux[i++];
    }

  }

}

void mergesort_2(int guarda_idp[25], int left, int right, stock stocks[10000])
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_2(guarda_idp, left, m, stocks);
  mergesort_2(guarda_idp, m + 1, right, stocks);
  merge_2(guarda_idp, left, m, right, stocks);
}

void lista_encomenda(int ide, int identificador_encomendas, int guarda_idp[10000], stock stocks[10000], encomenda encomendas[500])
{
  int i = 0;
  int contador;
  int left = 0;
  if (ide >= identificador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    for (contador = 0; contador < 10000; contador++)
    {
      if (encomendas[ide].produtos[contador].quantidade != 0)
      {
        guarda_idp[i] = contador;
        i++;
      }
      else
      {
        
      }

    }

    mergesort_2(guarda_idp, left, i - 1, stocks);
    printf("Encomenda %d\n", ide);
    for (contador = 0; contador < i; contador++)
    {
      printf("* %s %d %d\n", stocks[guarda_idp[contador]].descricao, stocks[guarda_idp[contador]].preco, encomendas[ide].produtos[guarda_idp[contador]].quantidade);
    }

  }

}

int main()
{
  char letra;
  stock stocks[10000];
  int i;
  int idp;
  int ide;
  int qtd;
  int identificador_produtos = 0;
  int identificador_encomendas = 0;
  int peso_total;
  int preco_total;
  int guarda_idp[10000];
  int preco;
  while ((letra = getchar()) != EOF)
  {
    switch (letra)
    {
      case 'a':
        cria_produto(identificador_produtos, stocks);
        identificador_produtos += 1;
        break;

      case 'q':
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        adiciona_produto(idp, qtd, identificador_produtos, stocks);
        break;

      case 'N':
        cria_encomenda(identificador_encomendas);
        identificador_encomendas += 1;
        break;

      case 'A':
        peso_total = 0;
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        adiciona_encomenda(ide, idp, qtd, identificador_produtos, identificador_encomendas, peso_total, stocks, encomendas);
        break;

      case 'r':
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        remove_stock_produto(identificador_produtos, idp, qtd, stocks);
        break;

      case 'R':
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        remover_produto_encomenda(ide, idp, identificador_produtos, identificador_encomendas, stocks, encomendas);
        break;

      case 'C':
        preco_total = 0;
        ide = new_sym_var(sizeof(int) * 8);
        calcula_preco_encomenda(ide, preco_total, identificador_encomendas, i, stocks, encomendas);
        break;

      case 'p':
        idp = new_sym_var(sizeof(int) * 8);
        preco = new_sym_var(sizeof(int) * 8);
        muda_preco(idp, preco, identificador_produtos, stocks);
        break;

      case 'E':
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        produto_encomenda(ide, idp, identificador_produtos, identificador_encomendas, stocks, encomendas);
        break;

      case 'm':
        idp = new_sym_var(sizeof(int) * 8);
        maximo_encomenda(idp, identificador_produtos, encomendas);
        break;

      case 'l':
        i = 0;
        while (stocks[i].peso != 0)
      {
        guarda_idp[i] = i;
        i++;
      }

        lista_produtos(guarda_idp, i, stocks);
        break;

      case 'L':
        ide = new_sym_var(sizeof(int) * 8);
        lista_encomenda(ide, identificador_encomendas, guarda_idp, stocks, encomendas);
        break;

      case 'x':
        break;

    }

  }

  return 0;
}

