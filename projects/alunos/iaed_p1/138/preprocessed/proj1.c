/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  char desc[63];
  int pr;
  int ps;
  int st;
} prod;
typedef struct 
{
  int id_prod[200];
  int st_prod[200];
  int n_prod;
  int ps_e;
} order;
prod system_prod[10000];
order orders[500] = {{{0}, {0}, 0, 0}};
int last_id = -1;
int last_order = -1;
int list_aux[10000];
int id_list[10000];
void add_new_prod()
{
  last_id++;
  for (int system_prod_index = 0; system_prod_index < 10; system_prod_index++)
  {
    system_prod[last_id].desc[system_prod_index] = new_sym_var(sizeof(char) * 8);
  }

  system_prod[last_id].desc[10 - 1] = '\0';
  system_prod[last_id].pr = new_sym_var(sizeof(int) * 8);
  system_prod[last_id].ps = new_sym_var(sizeof(int) * 8);
  system_prod[last_id].st = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", last_id);
}

void add_or_rm_st_prod(prod p1[], int id_p, int st_p, int sig)
{
  p1[id_p].st += st_p * sig;
}

void new_order()
{
  last_order++;
  printf("Nova encomenda %d.\n", last_order);
}

void ch_price_prod(int id_p, int pr_p)
{
  system_prod[id_p].pr = pr_p;
}

void add_to_order(int id_e, int id_p, int st_p)
{
  int id;
  int status = 1;
  if (system_prod[id_p].st < st_p)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", id_p, id_e);
  }
  else
  {
    if ((orders[id_e].ps_e + (system_prod[id_p].ps * st_p)) > 200)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", id_p, id_e);
    }
    else
    {
      orders[id_e].ps_e += system_prod[id_p].ps * st_p;
      system_prod[id_p].st -= st_p;
      for (id = 0; id < orders[id_e].n_prod; id++)
      {
        if (orders[id_e].id_prod[id] == id_p)
        {
          orders[id_e].st_prod[id] += st_p;
          status = 0;
          break;
        }
        else
        {
          
        }

      }

      if (status)
      {
        orders[id_e].id_prod[orders[id_e].n_prod] = id_p;
        orders[id_e].st_prod[orders[id_e].n_prod] = st_p;
        orders[id_e].n_prod++;
      }
      else
      {
        
      }

    }

  }

}

void rm_prod_order(int id_e, int id_p)
{
  int id;
  for (id = 0; id < orders[id_e].n_prod; id++)
  {
    if (orders[id_e].id_prod[id] == id_p)
    {
      system_prod[id_p].st += orders[id_e].st_prod[id];
      orders[id_e].ps_e -= system_prod[id_p].ps * orders[id_e].st_prod[id];
      if (id != (orders[id_e].n_prod - 1))
      {
        orders[id_e].st_prod[id] = orders[id_e].st_prod[orders[id_e].n_prod - 1];
        orders[id_e].id_prod[id] = orders[id_e].id_prod[orders[id_e].n_prod - 1];
      }
      else
      {
        
      }

      orders[id_e].id_prod[orders[id_e].n_prod - 1] = 0;
      orders[id_e].st_prod[orders[id_e].n_prod - 1] = 0;
      orders[id_e].n_prod--;
      break;
    }
    else
    {
      
    }

  }

}

void order_cost(int id_e)
{
  int id;
  int cost = 0;
  for (id = 0; id < orders[id_e].n_prod; id++)
  {
    cost += system_prod[orders[id_e].id_prod[id]].pr * orders[id_e].st_prod[id];
  }

  printf("Custo da encomenda %d %d.\n", id_e, cost);
}

void list_prod_order(int id_e, int id_p)
{
  int id;
  int status = 1;
  for (id = 0; id < orders[id_e].n_prod; id++)
  {
    if (orders[id_e].id_prod[id] == id_p)
    {
      printf("%s %d.\n", system_prod[id_p].desc, orders[id_e].st_prod[id]);
      status = 0;
      break;
    }
    else
    {
      
    }

  }

  if (status)
  {
    printf("%s 0.\n", system_prod[id_p].desc);
  }
  else
  {
    
  }

}

void order_max_prod(int id_p)
{
  int id_e;
  int id;
  int max[2] = {-1, 0};
  for (id_e = 0; id_e <= last_order; id_e++)
  {
    for (id = 0; id < orders[id_e].n_prod; id++)
    {
      if (orders[id_e].id_prod[id] == id_p)
      {
        if ((max[0] == (-1)) || (orders[id_e].st_prod[id] > orders[max[0]].st_prod[max[1]]))
        {
          max[0] = id_e;
          max[1] = id;
        }
        else
        {
          
        }

        break;
      }
      else
      {
        
      }

    }

  }

  if (max[0] != (-1))
  {
    printf("Maximo produto %d %d %d.\n", id_p, max[0], orders[max[0]].st_prod[max[1]]);
  }
  else
  {
    
  }

}

void make_list_id(int size)
{
  int id;
  for (id = 0; id <= size; id++)
    id_list[id] = id;

}

void merge_sist(int a[], int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    list_aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    list_aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
    if ((system_prod[list_aux[j]].pr < system_prod[list_aux[i]].pr) && (j > m))
  {
    a[k] = list_aux[j--];
  }
  else
  {
    if ((system_prod[list_aux[j]].pr >= system_prod[list_aux[i]].pr) && (i < (m + 1)))
    {
      a[k] = list_aux[i++];
    }
    else
    {
      
    }

  }


}

void merge_order(int a[], int left, int m, int right, int id_e)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    list_aux[i - 1] = a[i - 1];

  for (j = m; j < right; j++)
    list_aux[(right + m) - j] = a[j + 1];

  for (k = left; k <= right; k++)
    if ((strcmp(system_prod[orders[id_e].id_prod[list_aux[j]]].desc, system_prod[orders[id_e].id_prod[list_aux[i]]].desc) < 0) && (j > m))
  {
    a[k] = list_aux[j--];
  }
  else
  {
    if ((strcmp(system_prod[orders[id_e].id_prod[list_aux[j]]].desc, system_prod[orders[id_e].id_prod[list_aux[i]]].desc) >= 0) && (i < (m + 1)))
    {
      a[k] = list_aux[i++];
    }
    else
    {
      
    }

  }


}

void mergesort(int a[], int left, int right, int status, int id_e)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, left, m, status, id_e);
  mergesort(a, m + 1, right, status, id_e);
  if (status)
  {
    merge_sist(a, left, m, right);
  }
  else
  {
    merge_order(a, left, m, right, id_e);
  }

}

void list_sist(int list_id[])
{
  int id;
  printf("Produtos\n");
  for (id = 0; id <= last_id; id++)
  {
    printf("* %s %d %d\n", system_prod[list_id[id]].desc, system_prod[list_id[id]].pr, system_prod[list_id[id]].st);
  }

}

void list_order(int id_e, int list_id[])
{
  int id;
  printf("Encomenda %d\n", id_e);
  for (id = 0; id < orders[id_e].n_prod; id++)
  {
    printf("* %s %d %d\n", system_prod[orders[id_e].id_prod[list_id[id]]].desc, system_prod[orders[id_e].id_prod[list_id[id]]].pr, orders[id_e].st_prod[list_id[id]]);
  }

}

void comand_q()
{
  int id_aux;
  int var1_aux;
  id_aux = new_sym_var(sizeof(int) * 8);
  var1_aux = new_sym_var(sizeof(int) * 8);
  if (id_aux > last_id)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", id_aux);
  }
  else
  {
    add_or_rm_st_prod(system_prod, id_aux, var1_aux, 1);
  }

  getchar();
}

void comand_A()
{
  int id_aux;
  int var1_aux;
  int var2_aux;
  var1_aux = new_sym_var(sizeof(int) * 8);
  id_aux = new_sym_var(sizeof(int) * 8);
  var2_aux = new_sym_var(sizeof(int) * 8);
  if (var1_aux > last_order)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", id_aux, var1_aux);
  }
  else
  {
    if (id_aux > last_id)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", id_aux, var1_aux);
    }
    else
    {
      add_to_order(var1_aux, id_aux, var2_aux);
    }

  }

  getchar();
}

void comand_r()
{
  int id_aux;
  int var1_aux;
  id_aux = new_sym_var(sizeof(int) * 8);
  var1_aux = new_sym_var(sizeof(int) * 8);
  if (id_aux > last_id)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", id_aux);
  }
  else
  {
    if (var1_aux > system_prod[id_aux].st)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", var1_aux, id_aux);
    }
    else
    {
      add_or_rm_st_prod(system_prod, id_aux, var1_aux, -1);
    }

  }

  getchar();
}

void comand_R()
{
  int id_aux;
  int var1_aux;
  var1_aux = new_sym_var(sizeof(int) * 8);
  id_aux = new_sym_var(sizeof(int) * 8);
  if (var1_aux > last_order)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", id_aux, var1_aux);
  }
  else
  {
    if (id_aux > last_id)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", id_aux, var1_aux);
    }
    else
    {
      rm_prod_order(var1_aux, id_aux);
    }

  }

  getchar();
}

void comand_C()
{
  int var1_aux;
  var1_aux = new_sym_var(sizeof(int) * 8);
  if (var1_aux > last_order)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", var1_aux);
  }
  else
  {
    order_cost(var1_aux);
  }

  getchar();
}

void comand_p()
{
  int id_aux;
  int var1_aux;
  id_aux = new_sym_var(sizeof(int) * 8);
  var1_aux = new_sym_var(sizeof(int) * 8);
  if (id_aux > last_id)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", id_aux);
  }
  else
  {
    ch_price_prod(id_aux, var1_aux);
  }

  getchar();
}

void comand_E()
{
  int id_aux;
  int var1_aux;
  var1_aux = new_sym_var(sizeof(int) * 8);
  id_aux = new_sym_var(sizeof(int) * 8);
  if (var1_aux > last_order)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", var1_aux);
  }
  else
  {
    if (id_aux > last_id)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", id_aux);
    }
    else
    {
      list_prod_order(var1_aux, id_aux);
    }

  }

  getchar();
}

void comand_m()
{
  int id_aux;
  id_aux = new_sym_var(sizeof(int) * 8);
  if (id_aux > last_id)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", id_aux);
  }
  else
  {
    order_max_prod(id_aux);
  }

  getchar();
}

void comand_l()
{
  make_list_id(last_id);
  mergesort(id_list, 0, last_id, 1, 0);
  list_sist(id_list);
  getchar();
}

void comand_L()
{
  int var1_aux;
  var1_aux = new_sym_var(sizeof(int) * 8);
  if (var1_aux > last_order)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", var1_aux);
  }
  else
  {
    make_list_id(orders[var1_aux].n_prod - 1);
    mergesort(id_list, 0, orders[var1_aux].n_prod - 1, 0, var1_aux);
    list_order(var1_aux, id_list);
  }

  getchar();
}

int main()
{
  char c;
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
        add_new_prod();
        getchar();
        break;

      case 'q':
        comand_q();
        break;

      case 'N':
        new_order();
        getchar();
        break;

      case 'A':
        comand_A();
        break;

      case 'r':
        comand_r();
        break;

      case 'R':
        comand_R();
        break;

      case 'C':
        comand_C();
        break;

      case 'p':
        comand_p();
        break;

      case 'E':
        comand_E();
        break;

      case 'm':
        comand_m();
        break;

      case 'l':
        comand_l();
        break;

      case 'L':
        comand_L();
        break;

    }

  }

  return 0;
}

