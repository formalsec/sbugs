/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int identificador;
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
} produto;
typedef struct encomenda
{
  produto produto[10000];
} encomenda;
char comando;
int i = 0;
int e = 0;
int nenc[500];
produto sistema[10000];
encomenda encomendas[500];
produto aux[10000];
void copia(produto sistemarep[], produto sistema[], int r, int m)
{
  sistemarep[r].identificador = sistema[m].identificador;
  strcpy(sistemarep[r].descricao, sistema[m].descricao);
  sistemarep[r].preco = sistema[m].preco;
  sistemarep[r].peso = sistema[m].peso;
  sistemarep[r].quantidade = sistema[m].quantidade;
}

void __a__(int i, produto sistema[])
{
  for (int sistema_index = 0; sistema_index < 10; sistema_index++)
  {
    sistema[i].descricao[sistema_index] = new_sym_var(sizeof(char) * 8);
  }

  sistema[i].descricao[10 - 1] = '\0';
  sistema[i].preco = new_sym_var(sizeof(int) * 8);
  sistema[i].peso = new_sym_var(sizeof(int) * 8);
  sistema[i].quantidade = new_sym_var(sizeof(int) * 8);
  sistema[i].identificador = i;
}

void __q__(int i, produto sistema[])
{
  int idp;
  int quant;
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (idp >= i)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    sistema[idp].quantidade += quant;
  }

}

void __A__(int e, int i, encomenda encomendas[], produto sistema[], int nenc[])
{
  int ide;
  int idp;
  int quant;
  int s;
  int peso = 0;
  int n = 1;
  int num;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  num = nenc[ide];
  if (ide >= e)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= i)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (quant > sistema[idp].quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        for (s = 0; s < nenc[ide]; s++)
        {
          peso = (encomendas[ide].produto[s].peso * encomendas[ide].produto[s].quantidade) + peso;
        }

        peso = (sistema[idp].peso * quant) + peso;
        if (peso > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          for (s = 0; s < num; s++)
          {
            if (idp == encomendas[ide].produto[s].identificador)
            {
              encomendas[ide].produto[s].quantidade += quant;
              n = 0;
              s = num;
            }
            else
            {
              
            }

          }

          if (n == 1)
          {
            encomendas[ide].produto[nenc[ide]] = sistema[idp];
            encomendas[ide].produto[nenc[ide]].quantidade = quant;
            nenc[ide] += 1;
          }
          else
          {
            
          }

          sistema[idp].quantidade -= quant;
        }

      }

    }

  }

}

void __r__(int i, produto sistema[])
{
  int idp;
  int quant;
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (idp >= i)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (quant > sistema[idp].quantidade)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quant, idp);
    }
    else
    {
      sistema[idp].quantidade -= quant;
    }

  }

}

void __R__(int i, int e, encomenda encomendas[], int nenc[], produto sistema[])
{
  int ide;
  int idp;
  int n;
  int num;
  produto prodvazio[1];
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  num = nenc[ide];
  if (ide >= e)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= i)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      for (n = 0; n < num; n++)
      {
        if (encomendas[ide].produto[n].identificador == idp)
        {
          if (n == (nenc[ide] - 1))
          {
            sistema[idp].quantidade += encomendas[ide].produto[n].quantidade;
            copia(encomendas[ide].produto, prodvazio, n, 0);
          }
          else
          {
            sistema[idp].quantidade += encomendas[ide].produto[n].quantidade;
            copia(encomendas[ide].produto, encomendas[ide].produto, n, nenc[ide] - 1);
            copia(encomendas[ide].produto, prodvazio, nenc[ide] - 1, 0);
            n = num;
          }

          nenc[ide] -= 1;
        }
        else
        {
          
        }

      }

    }

  }

}

void __C__(int e, encomenda encomendas[], int nenc[])
{
  int ide;
  int n;
  int total = 0;
  int num;
  ide = new_sym_var(sizeof(int) * 8);
  num = nenc[ide];
  if (ide >= e)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (n = 0; n < num; n++)
    {
      total = (encomendas[ide].produto[n].preco * encomendas[ide].produto[n].quantidade) + total;
    }

    printf("Custo da encomenda %d %d.\n", ide, total);
  }

}

void __p__(int i, int e, produto sistema[], encomenda encomendas[], int nenc[])
{
  int idp;
  int prec;
  int n;
  int m;
  idp = new_sym_var(sizeof(int) * 8);
  prec = new_sym_var(sizeof(int) * 8);
  if (idp >= i)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    sistema[idp].preco = prec;
    for (n = 0; n < e; n++)
    {
      for (m = 0; m < nenc[n]; m++)
      {
        if (encomendas[n].produto[m].identificador == idp)
        {
          encomendas[n].produto[m].preco = prec;
          m = nenc[n];
        }
        else
        {
          
        }

      }

    }

  }

}

void __E__(int i, int e, encomenda encomendas[], int nenc[], produto sistema[])
{
  int ide;
  int idp;
  int n;
  int m = 1;
  int num;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  num = nenc[ide];
  if (ide >= e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= i)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      for (n = 0; n < num; n++)
      {
        if (encomendas[ide].produto[n].identificador == idp)
        {
          printf("%s %d.\n", encomendas[ide].produto[n].descricao, encomendas[ide].produto[n].quantidade);
          m = 0;
          n = num;
        }
        else
        {
          
        }

      }

      if (m == 1)
      {
        printf("%s 0.\n", sistema[idp].descricao);
      }
      else
      {
        
      }

    }

  }

}

void __m__(int i, int e, encomenda encomendas[], int nenc[])
{
  int idp;
  int n;
  int m;
  int qtd = 0;
  int en;
  int se = 1;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= i)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    for (n = 0; n < e; n++)
    {
      for (m = 0; m < nenc[n]; m++)
      {
        if ((encomendas[n].produto[m].identificador == idp) && (encomendas[n].produto[m].quantidade > qtd))
        {
          qtd = encomendas[n].produto[m].quantidade;
          en = n;
          se = 0;
          m = nenc[n];
        }
        else
        {
          
        }

      }

    }

    if (se == 0)
    {
      printf("Maximo produto %d %d %d.\n", idp, en, qtd);
    }
    else
    {
      
    }

  }

}

void merge(produto a[], int l, int m, int r)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
  {
    aux[i - 1] = a[i - 1];
  }

  for (j = m; j < r; j++)
  {
    aux[(r + m) - j] = a[j + 1];
  }

  for (k = l; k <= r; k++)
  {
    if ((aux[j].preco < aux[i].preco) || ((aux[j].preco == aux[i].preco) && (aux[j].identificador < aux[i].identificador)))
    {
      a[k] = aux[j--];
    }
    else
    {
      a[k] = aux[i++];
    }

  }

}

void mergesort(produto a[], int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, l, m);
  mergesort(a, m + 1, r);
  merge(a, l, m, r);
}

void __l__(int i, produto sistema[])
{
  int n;
  produto sistemarep[10000];
  for (n = 0; n < i; n++)
  {
    copia(sistemarep, sistema, n, n);
  }

  mergesort(sistemarep, 0, i - 1);
  printf("Produtos\n");
  for (n = 0; n < i; n++)
  {
    printf("* %s %d %d\n", sistemarep[n].descricao, sistemarep[n].preco, sistemarep[n].quantidade);
  }

}

int partitionstr(encomenda encomendas[], int l, int r, int ide)
{
  int i = l - 1;
  int j = r;
  produto t[1];
  char v[63];
  strcpy(v, encomendas[ide].produto[r].descricao);
  while (i < j)
  {
    while (strcmp(encomendas[ide].produto[++i].descricao, v) < 0)
      ;

    while (strcmp(v, encomendas[ide].produto[--j].descricao) < 0)
    {
      if (j == l)
      {
        break;
      }
      else
      {
        
      }

    }

    if (i < j)
    {
      copia(t, encomendas[ide].produto, 0, i);
      copia(encomendas[ide].produto, encomendas[ide].produto, i, j);
      copia(encomendas[ide].produto, t, j, 0);
    }
    else
    {
      
    }

  }

  copia(t, encomendas[ide].produto, 0, i);
  copia(encomendas[ide].produto, encomendas[ide].produto, i, r);
  copia(encomendas[ide].produto, t, r, 0);
  return i;
}

void quicksortstr(encomenda encomendas[], int l, int r, int ide)
{
  int i;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  i = partitionstr(encomendas, l, r, ide);
  quicksortstr(encomendas, l, i - 1, ide);
  quicksortstr(encomendas, i + 1, r, ide);
}

void __L__(int e, int nenc[], encomenda encomendas[])
{
  int ide;
  int n;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    quicksortstr(encomendas, 0, nenc[ide] - 1, ide);
    printf("Encomenda %d\n", ide);
    for (n = 0; n < nenc[ide]; n++)
    {
      printf("* %s %d %d\n", encomendas[ide].produto[n].descricao, encomendas[ide].produto[n].preco, encomendas[ide].produto[n].quantidade);
    }

  }

}

int main()
{
  comando = new_sym_var(sizeof(char) * 8);
  while (comando != 'x')
  {
    switch (comando)
    {
      case 'a':
        __a__(i, sistema);
        printf("Novo produto %d.\n", i);
        i += 1;
        break;

      case 'q':
        __q__(i, sistema);
        break;

      case 'N':
        printf("Nova encomenda %d.\n", e);
        nenc[e] = 0;
        e += 1;
        break;

      case 'A':
        __A__(e, i, encomendas, sistema, nenc);
        break;

      case 'r':
        __r__(i, sistema);
        break;

      case 'R':
        __R__(i, e, encomendas, nenc, sistema);
        break;

      case 'C':
        __C__(e, encomendas, nenc);
        break;

      case 'p':
        __p__(i, e, sistema, encomendas, nenc);
        break;

      case 'E':
        __E__(i, e, encomendas, nenc, sistema);
        break;

      case 'm':
        __m__(i, e, encomendas, nenc);
        break;

      case 'l':
        __l__(i, sistema);
        break;

      case 'L':
        __L__(e, nenc, encomendas);
        break;

    }

    comando = new_sym_var(sizeof(char) * 8);
  }

  return 0;
}

