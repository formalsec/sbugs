/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


int cont_produto = 0;
int cont_encomenda = 0;
int cont_produtos_encomenda[200];
typedef struct produto
{
  int idp;
  char desc[63];
  int preco;
  int peso;
  int qtd;
} Produto;
Produto produto[10000];
Produto l_p_ordenados[10000];
Produto encomenda[500][10000];
void copiaQuantidade(int idp)
{
  int i;
  for (i = 0; i < cont_produto; i++)
  {
    if (idp == l_p_ordenados[i].idp)
    {
      l_p_ordenados[i].qtd = produto[idp].qtd;
      break;
    }
    else
    {
      
    }

  }

}

int pesoEncomenda(int ide)
{
  int i;
  int peso;
  peso = 0;
  for (i = 0; i < cont_produtos_encomenda[ide]; i++)
  {
    peso += encomenda[ide][i].peso * encomenda[ide][i].qtd;
  }

  return peso;
}

void ordenaProdutosVetorDecrescente(int n)
{
  int i;
  Produto aux;
  for (i = n; i > 0; i--)
  {
    if ((l_p_ordenados[i - 1].preco > l_p_ordenados[i].preco) || ((l_p_ordenados[i].preco == l_p_ordenados[i - 1].preco) && (l_p_ordenados[i].idp < l_p_ordenados[i - 1].idp)))
    {
      aux = l_p_ordenados[i - 1];
      l_p_ordenados[i - 1] = l_p_ordenados[i];
      l_p_ordenados[i] = aux;
    }
    else
    {
      break;
    }

  }

}

void ordenaProdutosVetorCrescente(int n)
{
  int i;
  Produto aux;
  for (i = n; i < (cont_produto - 1); i++)
  {
    if ((l_p_ordenados[i].preco > l_p_ordenados[i + 1].preco) || ((l_p_ordenados[i].preco == l_p_ordenados[i + 1].preco) && (l_p_ordenados[i].idp > l_p_ordenados[i + 1].idp)))
    {
      aux = l_p_ordenados[i];
      l_p_ordenados[i] = l_p_ordenados[i + 1];
      l_p_ordenados[i + 1] = aux;
    }
    else
    {
      break;
    }

  }

}

void ordenaEncomenda(int ide)
{
  int i;
  Produto aux;
  for (i = cont_produtos_encomenda[ide]; i > 0; i--)
  {
    if (strcmp(encomenda[ide][i].desc, encomenda[ide][i - 1].desc) < 0)
    {
      aux = encomenda[ide][i];
      encomenda[ide][i] = encomenda[ide][i - 1];
      encomenda[ide][i - 1] = aux;
    }
    else
    {
      break;
    }

  }

}

void a_criaProduto()
{
  Produto p;
  for (int p_index = 0; p_index < 10; p_index++)
  {
    p.desc[p_index] = new_sym_var(sizeof(char) * 8);
  }

  p.desc[10 - 1] = '\0';
  p.preco = new_sym_var(sizeof(int) * 8);
  p.peso = new_sym_var(sizeof(int) * 8);
  p.qtd = new_sym_var(sizeof(int) * 8);
  p.idp = cont_produto;
  l_p_ordenados[cont_produto] = p;
  produto[cont_produto] = p;
  printf("Novo produto %d.\n", cont_produto);
  ordenaProdutosVetorDecrescente(cont_produto);
  cont_produto++;
}

void q_adicionaProduto()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= cont_produto)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    produto[idp].qtd += qtd;
    copiaQuantidade(idp);
  }

}

void N_criaEncomenda()
{
  printf("Nova encomenda %d.\n", cont_encomenda);
  cont_produtos_encomenda[cont_encomenda] = 0;
  cont_encomenda++;
}

void A_adicionaProdutoEncomenda()
{
  int ide;
  int idp;
  int qtd;
  int existe;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= cont_encomenda)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= cont_produto)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (produto[idp].qtd < qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if (((qtd * produto[idp].peso) + pesoEncomenda(ide)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          existe = 0;
          for (i = 0; i < cont_produtos_encomenda[ide]; i++)
          {
            if (encomenda[ide][i].idp == produto[idp].idp)
            {
              encomenda[ide][i].qtd += qtd;
              existe = 1;
              break;
            }
            else
            {
              
            }

          }

          if (existe == 0)
          {
            encomenda[ide][cont_produtos_encomenda[ide]] = produto[idp];
            encomenda[ide][cont_produtos_encomenda[ide]].qtd = qtd;
            ordenaEncomenda(ide);
            cont_produtos_encomenda[ide]++;
          }
          else
          {
            
          }

          produto[idp].qtd -= qtd;
          copiaQuantidade(idp);
        }

      }

    }

  }

}

void r_removeStock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= cont_produto)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (qtd > produto[idp].qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      produto[idp].qtd -= qtd;
      copiaQuantidade(idp);
    }

  }

}

void R_removeProdutoEncomenda()
{
  int i;
  int ide;
  int idp;
  int remove;
  int n;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= cont_encomenda)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= cont_produto)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      remove = 0;
      n = cont_produtos_encomenda[ide];
      for (i = 0; i < cont_produtos_encomenda[ide]; i++)
      {
        if (encomenda[ide][i].idp == idp)
        {
          produto[idp].qtd += encomenda[ide][i].qtd;
          copiaQuantidade(idp);
          cont_produtos_encomenda[ide]--;
          n--;
          remove = 1;
        }
        else
        {
          
        }

        if (remove == 1)
        {
          encomenda[ide][i] = encomenda[ide][i + 1];
        }
        else
        {
          
        }

      }

    }

  }

}

void C_calculaCustoEncomenda()
{
  int ide;
  int i;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= cont_encomenda)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < cont_produtos_encomenda[ide]; i++)
    {
      custo += encomenda[ide][i].preco * encomenda[ide][i].qtd;
    }

    printf("Custo da encomenda %d %d.\n", ide, custo);
  }

}

void p_alteraPrecoProduto()
{
  int idp;
  int preco;
  int i;
  int j;
  int maior;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= cont_produto)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (preco > produto[idp].preco)
    {
      maior = 1;
    }
    else
    {
      
    }

    if (preco < produto[idp].preco)
    {
      maior = 0;
    }
    else
    {
      
    }

    produto[idp].preco = preco;
    for (i = 0; i < cont_produto; i++)
    {
      if (idp == l_p_ordenados[i].idp)
      {
        l_p_ordenados[i].preco = preco;
        break;
      }
      else
      {
        
      }

    }

    if (maior == 1)
    {
      ordenaProdutosVetorCrescente(i);
    }
    else
    {
      ordenaProdutosVetorDecrescente(i);
    }

    for (i = 0; i < cont_encomenda; i++)
    {
      for (j = 0; j < cont_produtos_encomenda[i]; j++)
      {
        if (encomenda[i][j].idp == idp)
        {
          encomenda[i][j].preco = preco;
          break;
        }
        else
        {
          
        }

      }

    }

  }

}

void E_listaUmProdutoEncomenda()
{
  int ide;
  int idp;
  int i;
  int existe;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= cont_encomenda)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= cont_produto)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      existe = 0;
      for (i = 0; i < cont_produtos_encomenda[ide]; i++)
      {
        if (encomenda[ide][i].idp == idp)
        {
          printf("%s %d.\n", encomenda[ide][i].desc, encomenda[ide][i].qtd);
          existe = 1;
          break;
        }
        else
        {
          
        }

      }

      if (existe == 0)
      {
        printf("%s 0.\n", produto[idp].desc);
      }
      else
      {
        
      }

    }

  }

}

void m_listaEncomendaMaisVezesProduto()
{
  int i;
  int j;
  int idp;
  int maior_ide;
  int maior_qtd;
  int existe;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= cont_produto)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    existe = (maior_ide = (maior_qtd = 0));
    for (i = 0; i < cont_encomenda; i++)
    {
      for (j = 0; j < cont_produtos_encomenda[i]; j++)
      {
        if (encomenda[i][j].idp == idp)
        {
          existe = 1;
          if (encomenda[i][j].qtd > maior_qtd)
          {
            maior_ide = i;
            maior_qtd = encomenda[i][j].qtd;
          }
          else
          {
            
          }

          break;
        }
        else
        {
          
        }

      }

    }

    if (existe == 1)
    {
      printf("Maximo produto %d %d %d.\n", idp, maior_ide, maior_qtd);
    }
    else
    {
      
    }

  }

}

void l_listaTodosProdutosPorPreco()
{
  int i;
  printf("Produtos\n");
  for (i = 0; i < cont_produto; i++)
  {
    printf("* %s %d %d\n", l_p_ordenados[i].desc, l_p_ordenados[i].preco, l_p_ordenados[i].qtd);
  }

}

void L_listaProdutosEncomendaPorOrdemAlfabetica()
{
  int i;
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= cont_encomenda)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    printf("Encomenda %d\n", ide);
    for (i = 0; i < cont_produtos_encomenda[ide]; i++)
    {
      printf("* %s %d %d\n", encomenda[ide][i].desc, encomenda[ide][i].preco, encomenda[ide][i].qtd);
    }

  }

}

int main()
{
  int c;
  int i;
  for (i = 0; (c = getchar()) != 'x'; i++)
  {
    if (c == 'a')
    {
      a_criaProduto();
    }
    else
    {
      if (c == 'q')
      {
        q_adicionaProduto();
      }
      else
      {
        if (c == 'N')
        {
          N_criaEncomenda();
        }
        else
        {
          if (c == 'A')
          {
            A_adicionaProdutoEncomenda();
          }
          else
          {
            if (c == 'r')
            {
              r_removeStock();
            }
            else
            {
              if (c == 'R')
              {
                R_removeProdutoEncomenda();
              }
              else
              {
                if (c == 'C')
                {
                  C_calculaCustoEncomenda();
                }
                else
                {
                  if (c == 'p')
                  {
                    p_alteraPrecoProduto();
                  }
                  else
                  {
                    if (c == 'E')
                    {
                      E_listaUmProdutoEncomenda();
                    }
                    else
                    {
                      if (c == 'm')
                      {
                        m_listaEncomendaMaisVezesProduto();
                      }
                      else
                      {
                        if (c == 'l')
                        {
                          l_listaTodosProdutosPorPreco();
                        }
                        else
                        {
                          if (c == 'L')
                          {
                            L_listaProdutosEncomendaPorOrdemAlfabetica();
                          }
                          else
                          {
                            
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

  }

  return 0;
}

