#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct prd
{
  int id;
  char desc[63];
  int price;
  int w;
  int qtd;
} prd;
prd stock[10000];
typedef struct order
{
  int n_diff_prod;
  int prod_ord[200];
  int qtd_ord[200];
} order;
order orders[500];
int main()
{
  int i;
  int j;
  int k;
  int l;
  char m[63];
  char input[100];
  char i0[63];
  char i1[30];
  char i2[30];
  char i3[30];
  char command;
  char *token;
  int n_input;
  int id_occupied = 0;
  int n_orders = 0;
  while ((command = getchar()) != 'x')
  {
    if (command != 'N')
    {
      if (command != 'l')
      {
        getchar();
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    fgets(input, 100, stdin);
    n_input = 0;
    token = strtok(input, ":");
    while (token != 0)
    {
      switch (n_input)
      {
        case 0:
          strcpy(i0, token);
          break;

        case 1:
          strcpy(i1, token);
          break;

        case 2:
          strcpy(i2, token);
          break;

        case 3:
          strcpy(i3, token);
          break;

      }

      n_input = n_input + 1;
      token = strtok(0, ":");
    }

    switch (command)
    {
      case 'a':
        stock[id_occupied].id = id_occupied;
        strcpy(stock[id_occupied].desc, i0);
        stock[id_occupied].price = atoi(i1);
        stock[id_occupied].w = atoi(i2);
        stock[id_occupied].qtd = atoi(i3);
        printf("Novo produto %d.\n", id_occupied);
        id_occupied = id_occupied + 1;
        break;

      case 'q':
        if (id_occupied <= atoi(i0))
      {
        printf("Impossivel adicionar produto %s ao stock. Produto inexistente.\n", i0);
        break;
      }
      else
      {
        
      }

        stock[atoi(i0)].qtd = stock[atoi(i0)].qtd + atoi(i1);
        break;

      case 'N':
        orders[n_orders].n_diff_prod = 0;
        printf("Nova encomenda %d.\n", n_orders);
        n_orders = n_orders + 1;
        break;

      case 'A':
        if (n_orders <= atoi(i0))
      {
        printf("Impossivel adicionar produto %s a encomenda %s. Encomenda inexistente.\n", i1, i0);
        break;
      }
      else
      {
        
      }

        if (id_occupied <= atoi(i1))
      {
        printf("Impossivel adicionar produto %s a encomenda %s. Produto inexistente.\n", i1, i0);
        break;
      }
      else
      {
        
      }

        if (stock[atoi(i1)].qtd < atoi(i2))
      {
        printf("Impossivel adicionar produto %s a encomenda %s. Quantidade em stock insuficiente.\n", i1, i0);
        break;
      }
      else
      {
        
      }

        i = 0;
        j = atoi(i2) * stock[atoi(i1)].w;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        j = j + (stock[orders[atoi(i0)].prod_ord[i]].w * orders[atoi(i0)].qtd_ord[i]);
        i = i + 1;
      }

        if (j > 200)
      {
        printf("Impossivel adicionar produto %s a encomenda %s. Peso da encomenda excede o maximo de 200.\n", i1, i0);
        break;
      }
      else
      {
        
      }

        i = 0;
        j = 0;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        if (orders[atoi(i0)].prod_ord[i] == atoi(i1))
        {
          orders[atoi(i0)].qtd_ord[i] = orders[atoi(i0)].qtd_ord[i] + atoi(i2);
          j = 1;
        }
        else
        {
          
        }

        i = i + 1;
      }

        if (j == 0)
      {
        orders[atoi(i0)].prod_ord[orders[atoi(i0)].n_diff_prod] = atoi(i1);
        orders[atoi(i0)].qtd_ord[orders[atoi(i0)].n_diff_prod] = atoi(i2);
        orders[atoi(i0)].n_diff_prod = orders[atoi(i0)].n_diff_prod + 1;
      }
      else
      {
        
      }

        stock[atoi(i1)].qtd = stock[atoi(i1)].qtd - atoi(i2);
        break;

      case 'r':
        if (id_occupied <= atoi(i0))
      {
        printf("Impossivel remover stock do produto %d. Produto inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        if (stock[atoi(i0)].qtd < atoi(i1))
      {
        printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", atoi(i1), atoi(i0));
        break;
      }
      else
      {
        
      }

        stock[atoi(i0)].qtd = stock[atoi(i0)].qtd - atoi(i1);
        break;

      case 'R':
        if (n_orders <= atoi(i0))
      {
        printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", atoi(i1), atoi(i0));
        break;
      }
      else
      {
        
      }

        if (id_occupied <= atoi(i1))
      {
        printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", atoi(i1), atoi(i0));
        break;
      }
      else
      {
        
      }

        i = 0;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        if (orders[atoi(i0)].prod_ord[i] == atoi(i1))
        {
          stock[atoi(i1)].qtd = stock[atoi(i1)].qtd + orders[atoi(i0)].qtd_ord[i];
          orders[atoi(i0)].qtd_ord[i] = 0;
        }
        else
        {
          
        }

        i = i + 1;
      }

        break;

      case 'C':
        if (n_orders <= atoi(i0))
      {
        printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        i = 0;
        j = 0;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        j = j + (stock[orders[atoi(i0)].prod_ord[i]].price * orders[atoi(i0)].qtd_ord[i]);
        i = i + 1;
      }

        printf("Custo da encomenda %d %d.\n", atoi(i0), j);
        break;

      case 'p':
        if (id_occupied <= atoi(i0))
      {
        printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        stock[atoi(i0)].price = atoi(i1);
        break;

      case 'E':
        if (n_orders <= atoi(i0))
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        if (id_occupied <= atoi(i1))
      {
        printf("Impossivel listar produto %d. Produto inexistente.\n", atoi(i1));
        break;
      }
      else
      {
        
      }

        i = 0;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        if (orders[atoi(i0)].prod_ord[i] == atoi(i1))
        {
          printf("%s %d.\n", stock[atoi(i1)].desc, orders[atoi(i0)].qtd_ord[i]);
        }
        else
        {
          
        }

        i = i + 1;
      }

        break;

      case 'm':
        if (id_occupied <= atoi(i0))
      {
        printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        i = n_orders;
        k = 0;
        while (i != 0)
      {
        j = 0;
        while (j != orders[i].n_diff_prod)
        {
          if (orders[i].prod_ord[j] == atoi(i0))
          {
            if (k <= orders[i].qtd_ord[j])
            {
              l = i;
            }
            else
            {
              
            }

          }
          else
          {
            
          }

          j = j + 1;
        }

        i = i - 1;
      }

        if (k == 0)
      {
        break;
      }
      else
      {
        
      }

        printf("Maximo produto %d %d %d.\n", atoi(i0), l, k);
        break;

      case 'l':
        i = 0;
        while (i != id_occupied)
      {
        j = i + 1;
        while (j != id_occupied)
        {
          if (stock[i].price > stock[j].price)
          {
            k = stock[i].price;
            stock[i].price = stock[j].price;
            stock[j].price = k;
            k = stock[i].qtd;
            stock[i].qtd = stock[j].qtd;
            stock[j].qtd = k;
            strcpy(m, stock[i].desc);
            strcpy(stock[i].desc, stock[j].desc);
            strcpy(stock[j].desc, m);
          }
          else
          {
            
          }

          j = j + 1;
        }

        i = i + 1;
      }

        i = 0;
        printf("Produtos\n");
        while (i != id_occupied)
      {
        printf("* %s %d %d\n", stock[i].desc, stock[i].price, stock[i].qtd);
        i = i + 1;
      }

        i = 0;
        while (i != id_occupied)
      {
        j = i + 1;
        while (j != id_occupied)
        {
          if (stock[i].id > stock[j].id)
          {
            k = stock[i].price;
            stock[i].price = stock[j].price;
            stock[j].price = k;
            k = stock[i].qtd;
            stock[i].qtd = stock[j].qtd;
            stock[j].qtd = k;
            strcpy(m, stock[i].desc);
            strcpy(stock[i].desc, stock[j].desc);
            strcpy(stock[j].desc, m);
          }
          else
          {
            
          }

          j = j + 1;
        }

        i = i + 1;
      }

        break;

      case 'L':
        if (n_orders <= atoi(i0))
      {
        printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", atoi(i0));
        break;
      }
      else
      {
        
      }

        i = 0;
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        j = i + 1;
        while (j != orders[atoi(i0)].n_diff_prod)
        {
          if (strcmp(stock[i].desc, stock[j].desc) > 0)
          {
            k = orders[atoi(i0)].prod_ord[i];
            orders[atoi(i0)].prod_ord[i] = orders[atoi(i0)].prod_ord[j];
            orders[atoi(i0)].prod_ord[j] = k;
            k = orders[atoi(i0)].qtd_ord[i];
            orders[atoi(i0)].qtd_ord[i] = orders[atoi(i0)].qtd_ord[j];
            orders[atoi(i0)].qtd_ord[j] = k;
          }
          else
          {
            
          }

          j = j + 1;
        }

        i = i + 1;
      }

        i = 0;
        printf("Encomenda %d\n", atoi(i0));
        while (i != orders[atoi(i0)].n_diff_prod)
      {
        if (orders[atoi(i0)].qtd_ord[i] != 0)
        {
          printf("* %s %d %d\n", stock[orders[atoi(i0)].prod_ord[i]].desc, stock[orders[atoi(i0)].prod_ord[i]].price, orders[atoi(i0)].qtd_ord[i]);
        }
        else
        {
          
        }

        i = i + 1;
      }

        break;

    }

  }

  return 0;
}

