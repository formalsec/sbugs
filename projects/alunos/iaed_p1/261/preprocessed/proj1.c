#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  char descricao[64];
  int preco;
  int peso;
  int stock;
} produto;
typedef struct 
{
  int idp;
  int encomendas;
} produto_encomendado;
typedef struct 
{
  int nr_produtos_encomendados;
  produto_encomendado produto[10000];
  int peso;
} encomendas;
produto pdt[10000];
encomendas e[500];
int nr_produtos = 0;
int nr_encomendas = 0;
void a()
{
  char descricao[64];
  int preco;
  int peso;
  int qtd;
  for (int descricao_index = 0; descricao_index < 10; descricao_index++)
  {
    descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
  }

  descricao[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (nr_produtos < 10000)
  {
    strcpy(pdt[nr_produtos].descricao, descricao);
    pdt[nr_produtos].preco = preco;
    pdt[nr_produtos].peso = peso;
    pdt[nr_produtos].stock = qtd;
    printf("Novo produto %d.\n", nr_produtos);
    nr_produtos++;
  }
  else
  {
    
  }

}

void k()
{
  int i;
  for (i = 0; i < nr_produtos; i++)
  {
    printf("%d %s %d %d %d\n", i, pdt[i].descricao, pdt[i].preco, pdt[i].peso, pdt[i].stock);
  }

}

void q()
{
  int i;
  int qtd;
  i = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (i < nr_produtos)
  {
    pdt[i].stock += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", i);
  }

}

void r()
{
  int i;
  int qtd;
  i = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (i >= nr_produtos)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", i);
  }
  else
  {
    if (qtd > pdt[i].stock)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, i);
    }
    else
    {
      pdt[i].stock -= qtd;
    }

  }

}

void p()
{
  int i;
  int preco;
  i = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (i < nr_produtos)
  {
    pdt[i].preco = preco;
  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", i);
  }

}

void merge(produto array[], int l, int m, int r)
{
  produto aux[10000];
  produto aux1[10000];
  int i;
  int j;
  int k;
  int n1 = (m - l) + 1;
  int n2 = r - m;
  for (i = 0; i < n1; i++)
  {
    aux[i] = array[l + i];
  }

  for (j = 0; j < n2; j++)
  {
    aux1[j] = array[(m + 1) + j];
  }

  i = 0;
  j = 0;
  k = l;
  while ((i < n1) && (j < n2))
  {
    if (aux[i].preco <= aux1[j].preco)
    {
      array[k] = aux[i];
      i++;
    }
    else
    {
      array[k] = aux1[j];
      j++;
    }

    k++;
  }

  while (i < n1)
  {
    array[k] = aux[i];
    i++;
    k++;
  }

  while (j < n2)
  {
    array[k] = aux1[j];
    j++;
    k++;
  }

}

void mergeSort(produto array[], int i, int e)
{
  int aux;
  if (i < e)
  {
    aux = i + ((e - i) / 2);
    mergeSort(array, i, aux);
    mergeSort(array, aux + 1, e);
    merge(array, i, aux, e);
  }
  else
  {
    
  }

}

void l()
{
  produto aux[10000];
  int i;
  for (i = 0; i < nr_produtos; i++)
  {
    aux[i] = pdt[i];
  }

  mergeSort(aux, 0, nr_produtos - 1);
  printf("Produtos\n");
  for (i = 0; i < nr_produtos; i++)
  {
    printf("* %s %d %d\n", aux[i].descricao, aux[i].preco, aux[i].stock);
  }

}

void N()
{
  if (nr_encomendas < 500)
  {
    printf("Nova encomenda %d.\n", nr_encomendas);
    e[nr_encomendas].nr_produtos_encomendados = 0;
    e[nr_encomendas].peso = 0;
    nr_encomendas++;
  }
  else
  {
    
  }

}

int findIdp(int ide, int idp)
{
  int i;
  for (i = 0; i < e[ide].nr_produtos_encomendados; i++)
  {
    if (idp == e[ide].produto[i].idp)
    {
      return i;
    }
    else
    {
      
    }

  }

  return -1;
}

void A()
{
  int ide;
  int idp;
  int qtd;
  int aux;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= nr_encomendas)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= nr_produtos)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (qtd > pdt[idp].stock)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if (((qtd * pdt[idp].peso) + e[ide].peso) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          aux = findIdp(ide, idp);
          if (aux == (-1))
          {
            aux = e[ide].nr_produtos_encomendados++;
            e[ide].produto[aux].idp = idp;
            e[ide].produto[aux].encomendas = qtd;
            e[ide].peso += qtd * pdt[idp].peso;
            pdt[idp].stock -= qtd;
          }
          else
          {
            e[ide].produto[aux].encomendas += qtd;
            e[ide].peso += qtd * pdt[idp].peso;
            pdt[idp].stock -= qtd;
          }

        }

      }

    }

  }

}

void K()
{
  int ide;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  printf("%d\n", e[ide].peso);
  for (i = 0; i < e[ide].nr_produtos_encomendados; i++)
  {
    printf("%d %d\n", e[ide].produto[i].idp, e[ide].produto[i].encomendas);
  }

}

void R()
{
  int ide;
  int idp;
  int aux;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= nr_encomendas)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= nr_produtos)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      aux = findIdp(ide, idp);
      if (aux != (-1))
      {
        e[ide].peso -= e[ide].produto[aux].encomendas * pdt[idp].peso;
        pdt[idp].stock += e[ide].produto[aux].encomendas;
        if (aux != (--e[ide].nr_produtos_encomendados))
        {
          for (i = aux; i < e[ide].nr_produtos_encomendados; i++)
          {
            e[ide].produto[i] = e[ide].produto[i + 1];
          }

        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

}

void C()
{
  int ide;
  int i;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= nr_encomendas)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < e[ide].nr_produtos_encomendados; i++)
    {
      custo += e[ide].produto[i].encomendas * pdt[e[ide].produto[i].idp].preco;
    }

    printf("Custo da encomenda %d %d.\n", ide, custo);
  }

}

void E()
{
  int ide;
  int idp;
  int aux;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= nr_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= nr_produtos)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      aux = findIdp(ide, idp);
      if (aux != (-1))
      {
        printf("%s %d.\n", pdt[idp].descricao, e[ide].produto[aux].encomendas);
      }
      else
      {
        printf("%s 0.\n", pdt[idp].descricao);
      }

    }

  }

}

void m()
{
  int idp;
  int i;
  int aux;
  int ide = -1;
  int max = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= nr_produtos)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    
  }

  for (i = 0; i < nr_encomendas; i++)
  {
    aux = findIdp(i, idp);
    if (aux != (-1))
    {
      if (max < e[i].produto[aux].encomendas)
      {
        ide = i;
        max = e[i].produto[aux].encomendas;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

  }

  if (ide != (-1))
  {
    printf("Maximo produto %d %d %d.\n", idp, ide, max);
  }
  else
  {
    
  }

}

void swapL(int ide, int cont)
{
  produto_encomendado aux = e[ide].produto[cont];
  e[ide].produto[cont] = e[ide].produto[cont + 1];
  e[ide].produto[cont + 1] = aux;
}

void L()
{
  int ide;
  int i;
  int cont;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= nr_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < (e[ide].nr_produtos_encomendados - 1); i++)
    {
      for (cont = 0; cont < ((e[ide].nr_produtos_encomendados - i) - 1); cont++)
      {
        if (strcmp(pdt[e[ide].produto[cont].idp].descricao, pdt[e[ide].produto[cont + 1].idp].descricao) > 0)
        {
          swapL(ide, cont);
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", ide);
    for (i = 0; i < e[ide].nr_produtos_encomendados; i++)
    {
      printf("* %s %d %d\n", pdt[e[ide].produto[i].idp].descricao, pdt[e[ide].produto[i].idp].preco, e[ide].produto[i].encomendas);
    }

  }

}

int main()
{
  int c;
  while (1)
  {
    c = getchar();
    switch (c)
    {
      case 'a':
        a();
        break;

      case 'k':
        k();
        break;

      case 'q':
        q();
        break;

      case 'r':
        r();
        break;

      case 'p':
        p();
        break;

      case 'l':
        l();
        break;

      case 'N':
        N();
        break;

      case 'A':
        A();
        break;

      case 'K':
        K();
        break;

      case 'R':
        R();
        break;

      case 'C':
        C();
        break;

      case 'E':
        E();
        break;

      case 'm':
        m();
        break;

      case 'L':
        L();
        break;

      case 'x':
        return 0;

    }

  }

  return 0;
}

