/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


int id_prod = 0;
int id_encomenda = 0;
int n_de_encomendas = 0;
char comando[300];
typedef struct produto
{
  char descricao[63];
  int preco;
  int peso;
  int stock;
  int idp;
} Produto;
typedef struct encomenda
{
  Produto prods[10000];
  int ide;
  int n_de_produtos;
} Encomenda;
Produto produtos[10000];
Encomenda encomendas[500];
int peso_da_encomenda(int id_enc, int num_de_prods)
{
  int peso_encomenda = 0;
  int b;
  for (b = 0; b < num_de_prods; b++)
  {
    peso_encomenda += encomendas[id_enc].prods[b].peso * encomendas[id_enc].prods[b].stock;
  }

  return peso_encomenda;
}

int a()
{
  Produto a;
  int i = 2;
  int k = 0;
  int n = 0;
  int p = 0;
  int j = 0;
  char preco_prod[300];
  char peso_prod[300];
  char stock_prod[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    a.descricao[k] = comando[i];
    k += 1;
  }

  i += 1;
  a.descricao[k] = '\0';
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    preco_prod[n] = comando[i];
    n += 1;
  }

  i += 1;
  preco_prod[n] = '\0';
  a.preco = atoi(preco_prod);
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    peso_prod[p] = comando[i];
    p += 1;
  }

  i += 1;
  peso_prod[p] = '\0';
  a.peso = atoi(peso_prod);
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    stock_prod[j] = comando[i];
    j += 1;
  }

  stock_prod[j] = '\0';
  a.stock = atoi(stock_prod);
  a.idp = id_prod;
  produtos[id_prod] = a;
  printf("Novo produto %d.\n", a.idp);
  id_prod += 1;
  return 0;
}

int q()
{
  int i = 2;
  int k = 0;
  int n = 0;
  int iden;
  int st;
  char id[300];
  char stk[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    id[k] = comando[i];
    k += 1;
  }

  i += 1;
  id[k] = '\0';
  iden = atoi(id);
  if (iden > (id_prod - 1))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", iden);
    return 0;
  }
  else
  {
    
  }

  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    stk[n] = comando[i];
    n += 1;
  }

  stk[n] = '\0';
  st = atoi(stk);
  produtos[iden].stock += st;
  return 0;
}

int N()
{
  Encomenda a;
  a.ide = id_encomenda;
  encomendas[id_encomenda] = a;
  a.n_de_produtos = 0;
  printf("Nova encomenda %d.\n", a.ide);
  id_encomenda += 1;
  n_de_encomendas += 1;
  return 0;
}

int A()
{
  int i = 2;
  int k = 0;
  int n = 0;
  int p = 0;
  int a = 0;
  int id_enc;
  int id_pr;
  int qtd;
  int peso_encomenda = 0;
  char encom[300];
  char prod[300];
  char quantidade[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    encom[k] = comando[i];
    k += 1;
  }

  i += 1;
  encom[k] = '\0';
  id_enc = atoi(encom);
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    prod[n] = comando[i];
    n += 1;
  }

  i += 1;
  prod[n] = '\0';
  id_pr = atoi(prod);
  if (id_enc >= n_de_encomendas)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", id_pr, id_enc);
    return 0;
  }
  else
  {
    
  }

  if (id_pr >= id_prod)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", id_pr, id_enc);
    return 0;
  }
  else
  {
    
  }

  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    quantidade[p] = comando[i];
    p += 1;
  }

  quantidade[p] = '\0';
  qtd = atoi(quantidade);
  if (qtd > produtos[id_pr].stock)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", id_pr, id_enc);
    return 0;
  }
  else
  {
    
  }

  peso_encomenda = peso_da_encomenda(id_enc, encomendas[id_enc].n_de_produtos);
  peso_encomenda += produtos[id_pr].peso * qtd;
  if (peso_encomenda > 200)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", id_pr, id_enc);
    return 0;
  }
  else
  {
    
  }

  for (; a < encomendas[id_enc].n_de_produtos; a++)
  {
    if (encomendas[id_enc].prods[a].idp == id_pr)
    {
      encomendas[id_enc].prods[a].stock += qtd;
      produtos[id_pr].stock = produtos[id_pr].stock - qtd;
      return 0;
    }
    else
    {
      
    }

  }

  encomendas[id_enc].prods[encomendas[id_enc].n_de_produtos] = produtos[id_pr];
  encomendas[id_enc].prods[encomendas[id_enc].n_de_produtos].stock = qtd;
  produtos[id_pr].stock = produtos[id_pr].stock - qtd;
  encomendas[id_enc].n_de_produtos += 1;
  return 0;
}

int r()
{
  int novo_stock;
  int id_produto;
  int i = 2;
  int a = 0;
  int b = 0;
  char com_stock[300];
  char com_prod[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_prod[a] = comando[i];
    a += 1;
  }

  i += 1;
  com_prod[a] = '\0';
  id_produto = atoi(com_prod);
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_stock[b] = comando[i];
    b += 1;
  }

  com_stock[b] = '\0';
  novo_stock = atoi(com_stock);
  if (id_produto >= id_prod)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", id_produto);
    return 0;
  }
  else
  {
    
  }

  if ((produtos[id_produto].stock - novo_stock) < 0)
  {
    printf("Impossivel remover %d do produto %d do stock. Quantidade insuficiente.\n", novo_stock, id_produto);
    return 0;
  }
  else
  {
    produtos[id_produto].stock = produtos[id_produto].stock - novo_stock;
  }

  return 0;
}

int R()
{
  int enc_id;
  int prod_id;
  int i = 2;
  int a = 0;
  int b = 0;
  int c = 0;
  Produto produto_a_remover;
  Produto ultimo_produto;
  char com_ide[300];
  char com_prod[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_ide[a] = comando[i];
    a += 1;
  }

  i += 1;
  com_ide[a] = '\0';
  enc_id = atoi(com_ide);
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_prod[b] = comando[i];
    b += 1;
  }

  com_prod[b] = '\0';
  prod_id = atoi(com_prod);
  if (enc_id >= id_encomenda)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", prod_id, enc_id);
    return 0;
  }
  else
  {
    
  }

  if (prod_id >= id_prod)
  {
    printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", prod_id, enc_id);
    return 0;
  }
  else
  {
    
  }

  produto_a_remover = produtos[prod_id];
  ultimo_produto = encomendas[enc_id].prods[encomendas[enc_id].n_de_produtos - 1];
  for (; c < encomendas[enc_id].n_de_produtos; c++)
  {
    if (encomendas[enc_id].prods[c].idp == prod_id)
    {
      produtos[prod_id].stock += encomendas[enc_id].prods[c].stock;
      encomendas[enc_id].prods[c] = ultimo_produto;
      encomendas[enc_id].prods[encomendas[enc_id].n_de_produtos - 1] = produto_a_remover;
      encomendas[enc_id].n_de_produtos = encomendas[enc_id].n_de_produtos - 1;
    }
    else
    {
      
    }

  }

  return 0;
}

int C()
{
  int i = 2;
  int a = 0;
  int b = 0;
  int id_encom;
  int total = 0;
  char controlo_encom[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    controlo_encom[b] = comando[i];
    b += 1;
  }

  controlo_encom[b] = '\0';
  id_encom = atoi(controlo_encom);
  if (id_encom >= id_encomenda)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", id_encom);
    return 0;
  }
  else
  {
    
  }

  for (; a < encomendas[id_encom].n_de_produtos; a++)
  {
    total += encomendas[id_encom].prods[a].stock * encomendas[id_encom].prods[a].preco;
  }

  printf("Custo da encomenda %d %d.\n", id_encom, total);
  return 0;
}

int p()
{
  int produto_id;
  int novo_preco;
  int a = 0;
  int b = 0;
  int i = 2;
  int c;
  int d;
  char com_idp[300];
  char com_npreco[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_idp[a] = comando[i];
    a += 1;
  }

  i += 1;
  com_idp[a] = '\0';
  produto_id = atoi(com_idp);
  if (produto_id > (id_prod - 1))
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", produto_id);
    return 0;
  }
  else
  {
    
  }

  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_npreco[b] = comando[i];
    b += 1;
  }

  com_npreco[b] = '\0';
  novo_preco = atoi(com_npreco);
  produtos[produto_id].preco = novo_preco;
  for (c = 0; c < id_encomenda; c++)
  {
    for (d = 0; d < id_prod; d++)
    {
      if (encomendas[c].prods[d].idp == produto_id)
      {
        encomendas[c].prods[d].preco = novo_preco;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int E()
{
  int idenc;
  int idprod;
  int a = 0;
  int b = 0;
  int c = 0;
  int i = 2;
  char idencomenda[300];
  char idproduto[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    idencomenda[a] = comando[i];
    a += 1;
  }

  i += 1;
  idencomenda[a] = '\0';
  idenc = atoi(idencomenda);
  if (idenc >= id_encomenda)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", idenc);
    return 0;
  }
  else
  {
    
  }

  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    idproduto[b] = comando[i];
    b += 1;
  }

  idproduto[b] = '\0';
  idprod = atoi(idproduto);
  if (idprod >= id_prod)
  {
    printf("Impossivel listar produto %d. Produto inexistente.\n", idprod);
    return 0;
  }
  else
  {
    
  }

  while (c < encomendas[idenc].n_de_produtos)
  {
    if (encomendas[idenc].prods[c].idp == idprod)
    {
      printf("%s %d.\n", encomendas[idenc].prods[c].descricao, encomendas[idenc].prods[c].stock);
      return 0;
    }
    else
    {
      
    }

    c += 1;
  }

  printf("%s %d.\n", produtos[idprod].descricao, 0);
  return 0;
}

int m()
{
  int prod_id;
  int i = 2;
  int a = 0;
  int k = 0;
  int p;
  int enc_prod = -1;
  int qtd = 0;
  char comando_idp[300];
  if (n_de_encomendas == 0)
  {
    return 0;
  }
  else
  {
    
  }

  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    comando_idp[a] = comando[i];
    a += 1;
  }

  comando_idp[a] = '\0';
  prod_id = atoi(comando_idp);
  for (; k < n_de_encomendas; k++)
  {
    for (p = 0; p < encomendas[k].n_de_produtos; p++)
    {
      if (encomendas[k].prods[p].idp == prod_id)
      {
        if (encomendas[k].prods[p].stock > qtd)
        {
          enc_prod = k;
          qtd = encomendas[k].prods[p].stock;
          if (encomendas[k].prods[p].stock == qtd)
          {
            if (k < enc_prod)
            {
              enc_prod = k;
              qtd = encomendas[k].prods[p].stock;
            }
            else
            {
              
            }

          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  if (enc_prod == (-1))
  {
    return 0;
  }
  else
  {
    
  }

  printf("Maximo produto %d %d %d.\n", prod_id, enc_prod, qtd);
  return 0;
}

int l()
{
  return 0;
}

int L()
{
  return 0;
}

int K()
{
  int id_enc;
  int peso_encomenda = 0;
  int i = 2;
  int a = 0;
  int b;
  char com_encomenda[300];
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    com_encomenda[a] = comando[i];
    a += 1;
  }

  com_encomenda[a] = '\0';
  id_enc = atoi(com_encomenda);
  for (b = 0; b < encomendas[id_enc].n_de_produtos; b++)
  {
    peso_encomenda += encomendas[id_enc].prods[b].peso * encomendas[id_enc].prods[b].stock;
  }

  printf("Peso da encomenda %d e igual a %d.\n", id_enc, peso_encomenda);
  return 0;
}

int P()
{
  int i = 2;
  int a = 0;
  char product_id[300];
  int product;
  for (; ((comando[i] != ':') && (comando[i] != EOF)) && (comando[i] != '\n'); i++)
  {
    product_id[a] = comando[i];
    a += 1;
  }

  product = atoi(product_id);
  printf("%s %d %d %d\n", produtos[product].descricao, produtos[product].preco, produtos[product].peso, produtos[product].stock);
  return 0;
}

int main()
{
  while (comando[0] != 'x')
  {
    fgets(comando, 300, stdin);
    if (comando[0] == 'a')
    {
      a();
    }
    else
    {
      
    }

    if (comando[0] == 'q')
    {
      q();
    }
    else
    {
      
    }

    if (comando[0] == 'A')
    {
      A();
    }
    else
    {
      
    }

    if (comando[0] == 'N')
    {
      N();
    }
    else
    {
      
    }

    if (comando[0] == 'r')
    {
      r();
    }
    else
    {
      
    }

    if (comando[0] == 'R')
    {
      R();
    }
    else
    {
      
    }

    if (comando[0] == 'C')
    {
      C();
    }
    else
    {
      
    }

    if (comando[0] == 'E')
    {
      E();
    }
    else
    {
      
    }

    if (comando[0] == 'p')
    {
      p();
    }
    else
    {
      
    }

    if (comando[0] == 'm')
    {
      m();
    }
    else
    {
      
    }

    if (comando[0] == 'l')
    {
      l();
    }
    else
    {
      
    }

    if (comando[0] == 'L')
    {
      L();
    }
    else
    {
      
    }

    if (comando[0] == 'K')
    {
      K();
    }
    else
    {
      
    }

    if (comando[0] == 'P')
    {
      P();
    }
    else
    {
      
    }

  }

  return 0;
}

