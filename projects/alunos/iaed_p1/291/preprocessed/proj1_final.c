#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int ident;
  int preco;
  int peso;
  int qtd;
  char descricao[63];
} Produto;
typedef struct encomenda
{
  int qtd_prod[200][2];
  int peso;
  int n_prod_enc;
} Encomenda;
int __a__(int n_prod, Produto l_prod[10000])
{
  for (int l_prod_index = 0; l_prod_index < 10; l_prod_index++)
  {
    l_prod[n_prod].descricao[l_prod_index] = new_sym_var(sizeof(char) * 8);
  }

  l_prod[n_prod].descricao[10 - 1] = '\0';
  l_prod[n_prod].preco = new_sym_var(sizeof(int) * 8);
  l_prod[n_prod].peso = new_sym_var(sizeof(int) * 8);
  l_prod[n_prod].qtd = new_sym_var(sizeof(int) * 8);
  l_prod[n_prod].ident = n_prod;
  printf("Novo produto %d.\n", n_prod++);
  return n_prod;
}

void __q__(int n_prod, Produto l_prod[10000])
{
  int idp;
  int quant;
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (idp < n_prod)
  {
    l_prod[idp].qtd += quant;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

}

void __A__(int n_prod, int n_enc, Produto l_prod[10000], Encomenda l_enc[500])
{
  int ide;
  int idp;
  int quant;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (ide >= n_enc)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= n_prod)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (quant > l_prod[idp].qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((l_enc[ide].peso + (quant * l_prod[idp].peso)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          l_enc[ide].peso += quant * l_prod[idp].peso;
          l_prod[idp].qtd -= quant;
          for (i = 0; i < l_enc[ide].n_prod_enc; i++)
          {
            if (l_enc[ide].qtd_prod[i][0] == idp)
            {
              l_enc[ide].qtd_prod[i][1] += quant;
              return;
            }
            else
            {
              
            }

          }

          if (l_enc[ide].n_prod_enc < 200)
          {
            l_enc[ide].qtd_prod[l_enc[ide].n_prod_enc][1] = quant;
            l_enc[ide].qtd_prod[l_enc[ide].n_prod_enc++][0] = idp;
          }
          else
          {
            for (i = 0; i < 200; i++)
            {
              if (l_enc[ide].qtd_prod[i][1] == 0)
              {
                l_enc[ide].qtd_prod[i][0] = idp;
                l_enc[ide].qtd_prod[i][1] = quant;
              }
              else
              {
                
              }

            }

          }

        }

      }

    }

  }

}

void __r__(int n_prod, Produto l_prod[10000])
{
  int idp;
  int quant;
  idp = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (idp >= n_prod)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if ((l_prod[idp].qtd - quant) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quant, idp);
    }
    else
    {
      l_prod[idp].qtd -= quant;
    }

  }

}

void __R__(int n_prod, int n_enc, Produto l_prod[10000], Encomenda l_enc[500])
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= n_enc)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= n_prod)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      for (i = 0; i < l_enc[ide].n_prod_enc; i++)
      {
        if (l_enc[ide].qtd_prod[i][0] == idp)
        {
          l_enc[ide].peso -= l_enc[ide].qtd_prod[i][1] * l_prod[idp].peso;
          l_prod[idp].qtd += l_enc[ide].qtd_prod[i][1];
          l_enc[ide].qtd_prod[i][1] = 0;
        }
        else
        {
          
        }

      }

    }

  }

}

void __C__(int n_enc, Produto l_prod[10000], Encomenda l_enc[500])
{
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= n_enc)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    int i;
    int custo = 0;
    for (i = 0; i < l_enc[ide].n_prod_enc; i++)
      custo += l_enc[ide].qtd_prod[i][1] * l_prod[l_enc[ide].qtd_prod[i][0]].preco;

    printf("Custo da encomenda %d %d.\n", ide, custo);
  }

}

void __p__(int n_prod, Produto l_prod[10000])
{
  int idp;
  int pr;
  idp = new_sym_var(sizeof(int) * 8);
  pr = new_sym_var(sizeof(int) * 8);
  if (idp < n_prod)
  {
    l_prod[idp].preco = pr;
  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }

}

void __E__(int n_prod, int n_enc, Produto l_prod[10000], Encomenda l_enc[500])
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= n_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= n_prod)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      for (i = 0; i < l_enc[ide].n_prod_enc; i++)
      {
        if (l_enc[ide].qtd_prod[i][0] == idp)
        {
          printf("%s %d.\n", l_prod[idp].descricao, l_enc[ide].qtd_prod[i][1]);
          return;
        }
        else
        {
          
        }

      }

      printf("%s 0.\n", l_prod[idp].descricao);
    }

  }

}

void __m__(int n_prod, int n_enc, Encomenda l_enc[500])
{
  int idp;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= n_prod)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    int max_qtd = 0;
    int max_ide = 0;
    int i;
    int j;
    for (i = 0; i < n_enc; i++)
    {
      for (j = 0; j < l_enc[i].n_prod_enc; j++)
      {
        if (l_enc[i].qtd_prod[j][0] == idp)
        {
          if (l_enc[i].qtd_prod[j][1] > max_qtd)
          {
            max_qtd = l_enc[i].qtd_prod[j][1];
            max_ide = i;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

    }

    if (max_qtd != 0)
    {
      printf("Maximo produto %d %d %d.\n", idp, max_ide, max_qtd);
    }
    else
    {
      
    }

  }

}

void troca_prod_enc(int v[200][2], int i, int j)
{
  int a[2];
  a[0] = v[i][0];
  a[1] = v[i][1];
  v[i][0] = v[j][0];
  v[i][1] = v[j][1];
  v[j][0] = a[0];
  v[j][1] = a[1];
}

int partition_desc(int v[200][2], int e, int d, Produto l_prod[10000])
{
  int i = e - 1;
  int j = d + 1;
  while (i < j)
  {
    while (strcmp(l_prod[v[++i][0]].descricao, l_prod[v[d][0]].descricao) < 0)
      ;

    while (strcmp(l_prod[v[d][0]].descricao, l_prod[v[--j][0]].descricao) < 0)
    {
      if (j == e)
      {
        break;
      }
      else
      {
        
      }

    }

    if (i < j)
    {
      troca_prod_enc(v, i, j);
    }
    else
    {
      
    }

  }

  troca_prod_enc(v, i, d);
  return i;
}

void quicksort_desc(int v[200][2], int e, int d, Produto l_prod[10000])
{
  int i;
  if (d <= e)
  {
    return;
  }
  else
  {
    
  }

  i = partition_desc(v, e, d, l_prod);
  quicksort_desc(v, e, i - 1, l_prod);
  quicksort_desc(v, i + 1, d, l_prod);
}

void copia(int n_prod, Produto v_aux[10000], Produto a[10000])
{
  int i;
  for (i = 0; i < n_prod; i++)
  {
    v_aux[i].ident = a[i].ident;
    v_aux[i].peso = a[i].peso;
    v_aux[i].preco = a[i].preco;
    v_aux[i].qtd = a[i].qtd;
    strcpy(v_aux[i].descricao, a[i].descricao);
  }

}

void troca_prod(Produto v[], int i, int j)
{
  Produto a;
  a = v[i];
  v[i] = v[j];
  v[j] = a;
}

int partition_preco(Produto v[10000], int e, int d)
{
  int i = e - 1;
  int j = d + 1;
  while (i < j)
  {
    while ((v[++i].preco < v[d].preco) || ((v[i].preco == v[d].preco) && (v[i].ident < v[d].ident)))
      ;

    while ((v[d].preco < v[--j].preco) || ((v[d].preco == v[j].preco) && (v[d].ident < v[j].ident)))
    {
      if (j == e)
      {
        break;
      }
      else
      {
        
      }

    }

    if (i < j)
    {
      troca_prod(v, i, j);
    }
    else
    {
      
    }

  }

  troca_prod(v, i, d);
  return i;
}

void quicksort_preco(Produto v[10000], int e, int d)
{
  int i;
  if (d <= e)
  {
    return;
  }
  else
  {
    
  }

  i = partition_preco(v, e, d);
  quicksort_preco(v, e, i - 1);
  quicksort_preco(v, i + 1, d);
}

void __l__(int n_prod, Produto l_prod[10000])
{
  int i;
  Produto v_aux[10000];
  copia(n_prod, v_aux, l_prod);
  quicksort_preco(v_aux, 0, n_prod - 1);
  printf("Produtos\n");
  for (i = 0; i < n_prod; i++)
  {
    printf("* %s %d %d\n", v_aux[i].descricao, v_aux[i].preco, v_aux[i].qtd);
  }

}

void __L__(int n_enc, Produto l_prod[10000], Encomenda l_enc[500])
{
  int ide;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= n_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    int i;
    quicksort_desc(l_enc[ide].qtd_prod, 0, l_enc[ide].n_prod_enc - 1, l_prod);
    printf("Encomenda %d\n", ide);
    for (i = 0; i < l_enc[ide].n_prod_enc; i++)
    {
      if (l_enc[ide].qtd_prod[i][1] != 0)
      {
        printf("* %s %d %d\n", l_prod[l_enc[ide].qtd_prod[i][0]].descricao, l_prod[l_enc[ide].qtd_prod[i][0]].preco, l_enc[ide].qtd_prod[i][1]);
      }
      else
      {
        
      }

    }

    return;
  }

}

int main()
{
  char c;
  Encomenda l_enc[500] = {0};
  Produto l_prod[10000] = {0};
  int n_prod = 0;
  int n_enc = 0;
  while ((c = getchar()) != EOF)
  {
    if (c == 'a')
    {
      n_prod = __a__(n_prod, l_prod);
    }
    else
    {
      if (c == 'q')
      {
        __q__(n_prod, l_prod);
      }
      else
      {
        if (c == 'x')
        {
          break;
        }
        else
        {
          if (c == 'N')
          {
            printf("Nova encomenda %d.\n", n_enc++);
          }
          else
          {
            if (c == 'A')
            {
              __A__(n_prod, n_enc, l_prod, l_enc);
            }
            else
            {
              if (c == 'r')
              {
                __r__(n_prod, l_prod);
              }
              else
              {
                if (c == 'R')
                {
                  __R__(n_prod, n_enc, l_prod, l_enc);
                }
                else
                {
                  if (c == 'C')
                  {
                    __C__(n_enc, l_prod, l_enc);
                  }
                  else
                  {
                    if (c == 'p')
                    {
                      __p__(n_prod, l_prod);
                    }
                    else
                    {
                      if (c == 'E')
                      {
                        __E__(n_prod, n_enc, l_prod, l_enc);
                      }
                      else
                      {
                        if (c == 'm')
                        {
                          __m__(n_prod, n_enc, l_enc);
                        }
                        else
                        {
                          if (c == 'l')
                          {
                            __l__(n_prod, l_prod);
                          }
                          else
                          {
                            if (c == 'L')
                            {
                              __L__(n_enc, l_prod, l_enc);
                            }
                            else
                            {
                              
                            }

                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

  }

  return 0;
}

