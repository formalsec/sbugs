/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct Produto
{
  char nome[64];
  int idp;
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct Encomenda
{
  int ide;
  int peso;
  int prdEnc[200][2];
} encomenda;
produto stock_produto[10000];
encomenda stock_encomenda[500];
int n_pro = 0;
int n_enc = 0;
int leInput(char str[])
{
  char c;
  int i = 0;
  while ((c = getchar()) != '\n')
  {
    str[i] = c;
    i++;
  }

  str[i] = '\0';
  return 0;
}

int separaStrings(char str[], char strAlvo[][64], int max)
{
  int i = 0;
  int j = 0;
  int k = 0;
  for (i = 0; i < max; i++)
  {
    strncpy(strAlvo[i], "", 64);
  }

  i = 0;
  while (str[i] != '\0')
  {
    if (str[i] == ':')
    {
      strAlvo[j][k] = '\0';
      k = 0;
      j++;
    }
    else
    {
      strAlvo[j][k] = str[i];
      k++;
    }

    i++;
  }

  return j;
}

void mergeL(int tabela_final[], int limite_inferior, int limite_superior, int meio, int enc)
{
  int k;
  int i;
  int j;
  int tab_aux[10000];
  for (i = meio + 1; i > limite_inferior; i--)
  {
    tab_aux[i - 1] = tabela_final[i - 1];
  }

  for (j = meio; j < limite_superior; j++)
  {
    tab_aux[(limite_superior + meio) - j] = tabela_final[j + 1];
  }

  for (k = limite_inferior; k <= limite_superior; k++)
  {
    if (strcmp(stock_produto[stock_encomenda[enc].prdEnc[tab_aux[j]][0]].nome, stock_produto[stock_encomenda[enc].prdEnc[tab_aux[i]][0]].nome) < 0)
    {
      tabela_final[k] = tab_aux[j--];
    }
    else
    {
      tabela_final[k] = tab_aux[i++];
    }

  }

}

void mergel(int tabela_final[], int limite_inferior, int limite_superior, int meio)
{
  int k;
  int i;
  int j;
  int tab_aux[10000];
  for (i = meio + 1; i > limite_inferior; i--)
  {
    tab_aux[i - 1] = tabela_final[i - 1];
  }

  for (j = meio; j < limite_superior; j++)
  {
    tab_aux[(limite_superior + meio) - j] = tabela_final[j + 1];
  }

  for (k = limite_inferior; k <= limite_superior; k++)
  {
    if (stock_produto[tab_aux[j]].preco < stock_produto[tab_aux[i]].preco)
    {
      tabela_final[k] = tab_aux[j--];
    }
    else
    {
      if ((stock_produto[tab_aux[j]].preco == stock_produto[tab_aux[i]].preco) && (stock_produto[tab_aux[j]].idp < stock_produto[tab_aux[i]].idp))
      {
        tabela_final[k] = tab_aux[j--];
      }
      else
      {
        tabela_final[k] = tab_aux[i++];
      }

    }

  }

}

void mergesort(int limite_inferior, int limite_superior, int tabela_final[], int eh_string, int enc)
{
  int meio = (limite_superior + limite_inferior) / 2;
  if (limite_superior <= limite_inferior)
  {
    return;
  }
  else
  {
    
  }

  mergesort(limite_inferior, meio, tabela_final, eh_string, enc);
  mergesort(meio + 1, limite_superior, tabela_final, eh_string, enc);
  if (eh_string)
  {
    mergeL(tabela_final, limite_inferior, limite_superior, meio, enc);
  }
  else
  {
    mergel(tabela_final, limite_inferior, limite_superior, meio);
  }

}

int cmd_a()
{
  char s[80];
  char sAux[4][64];
  getchar();
  leInput(s);
  separaStrings(s, sAux, 4);
  stock_produto[n_pro].idp = n_pro;
  printf("Novo produto %d.\n", n_pro);
  strcpy(stock_produto[n_pro].nome, sAux[0]);
  stock_produto[n_pro].preco = atoi(sAux[1]);
  stock_produto[n_pro].peso = atoi(sAux[2]);
  stock_produto[n_pro].qtd = atoi(sAux[3]);
  n_pro++;
  return 0;
}

int cmd_q()
{
  int idp;
  char s[64];
  char sAux[2][64];
  getchar();
  leInput(s);
  separaStrings(s, sAux, 2);
  idp = atoi(sAux[0]);
  if (idp < n_pro)
  {
    stock_produto[idp].qtd += atoi(sAux[1]);
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

  return 0;
}

int cmd_N()
{
  stock_encomenda[n_enc].ide = n_enc;
  stock_encomenda[n_enc].peso = 0;
  printf("Nova encomenda %d.\n", n_enc);
  n_enc++;
  return 0;
}

int cmd_A()
{
  int i;
  int produto;
  int encomenda;
  int qtd;
  char s[64];
  char sAux[3][64];
  getchar();
  leInput(s);
  separaStrings(s, sAux, 3);
  encomenda = atoi(sAux[0]);
  produto = atoi(sAux[1]);
  qtd = atoi(sAux[2]);
  if (encomenda >= n_enc)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", produto, encomenda);
    return 0;
  }
  else
  {
    
  }

  if (produto >= n_pro)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", produto, encomenda);
    return 0;
  }
  else
  {
    
  }

  if (stock_produto[produto].qtd < qtd)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", produto, encomenda);
    return 0;
  }
  else
  {
    
  }

  if ((stock_encomenda[encomenda].peso + (qtd * stock_produto[produto].peso)) > 200)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", produto, encomenda);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (stock_encomenda[encomenda].prdEnc[i][0] == produto)
    {
      break;
    }
    else
    {
      
    }

  }

  if (i >= 200)
  {
    for (i = 0; i < 200; i++)
    {
      if (stock_encomenda[encomenda].prdEnc[i][0] == (-1))
      {
        break;
      }
      else
      {
        
      }

    }

  }
  else
  {
    
  }

  if (stock_encomenda[encomenda].prdEnc[i][0] == (-1))
  {
    stock_encomenda[encomenda].prdEnc[i][0] = produto;
    stock_encomenda[encomenda].prdEnc[i][1] = qtd;
  }
  else
  {
    stock_encomenda[encomenda].prdEnc[i][1] += qtd;
  }

  stock_produto[produto].qtd -= qtd;
  stock_encomenda[encomenda].peso += stock_produto[produto].peso * qtd;
  return 0;
}

int cmd_r()
{
  int idproduto;
  int qtd;
  char s[64];
  char sAux[2][64];
  getchar();
  leInput(s);
  separaStrings(s, sAux, 2);
  idproduto = atoi(sAux[0]);
  qtd = atoi(sAux[1]);
  if (idproduto >= n_pro)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idproduto);
    return 0;
  }
  else
  {
    
  }

  if (stock_produto[idproduto].qtd < qtd)
  {
    printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idproduto);
    return 0;
  }
  else
  {
    
  }

  stock_produto[idproduto].qtd -= qtd;
  return 0;
}

int cmd_R()
{
  int i;
  int idencomenda;
  int idproduto;
  char s[8];
  char sAux[2][64];
  getchar();
  leInput(s);
  separaStrings(s, sAux, 2);
  idencomenda = atoi(sAux[0]);
  idproduto = atoi(sAux[1]);
  if (idencomenda >= n_enc)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idproduto, idencomenda);
    return 0;
  }
  else
  {
    
  }

  if (idproduto >= n_pro)
  {
    printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idproduto, idencomenda);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (stock_encomenda[idencomenda].prdEnc[i][0] == idproduto)
    {
      stock_produto[idproduto].qtd += stock_encomenda[idencomenda].prdEnc[i][1];
      stock_encomenda[idencomenda].peso -= stock_encomenda[idencomenda].prdEnc[i][1] * stock_produto[idproduto].peso;
      stock_encomenda[idencomenda].prdEnc[i][0] = 0;
      stock_encomenda[idencomenda].prdEnc[i][0] = -1;
      break;
    }
    else
    {
      
    }

  }

  return 0;
}

int cmd_C()
{
  int i;
  int soma = 0;
  int enc;
  char s[5];
  leInput(s);
  enc = atoi(s);
  if (enc >= n_enc)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", enc);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (stock_encomenda[enc].prdEnc[i][0] != (-1))
    {
      soma += stock_encomenda[enc].prdEnc[i][1] * stock_produto[stock_encomenda[enc].prdEnc[i][0]].preco;
    }
    else
    {
      
    }

  }

  printf("Custo da encomenda %d %d.\n", enc, soma);
  return 0;
}

int cmd_p()
{
  int idproduto;
  int pre;
  char s[64];
  char sAux[2][64];
  leInput(s);
  separaStrings(s, sAux, 2);
  idproduto = atoi(sAux[0]);
  pre = atoi(sAux[1]);
  if (idproduto >= n_pro)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idproduto);
    return 0;
  }
  else
  {
    
  }

  stock_produto[idproduto].preco = pre;
  return 0;
}

int cmd_E()
{
  int i;
  int qtd_produto = 0;
  int idencomenda;
  int idproduto;
  char s[64];
  char sAux[2][64];
  leInput(s);
  separaStrings(s, sAux, 2);
  idencomenda = atoi(sAux[0]);
  idproduto = atoi(sAux[1]);
  if (idencomenda >= n_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", idencomenda);
    return 0;
  }
  else
  {
    
  }

  if (atoi(sAux[1]) >= n_pro)
  {
    printf("Impossivel listar produto %d. Produto inexistente.\n", idproduto);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (stock_encomenda[idencomenda].prdEnc[i][0] == idproduto)
    {
      qtd_produto = stock_encomenda[idencomenda].prdEnc[i][1];
    }
    else
    {
      
    }

  }

  printf("%s %d.\n", stock_produto[idproduto].nome, qtd_produto);
  return 0;
}

int cmd_m()
{
  int i;
  int j;
  int ide_max;
  int qtd_produto = -1;
  int prod;
  char s[7];
  leInput(s);
  prod = atoi(s);
  if (prod >= n_pro)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", prod);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < n_enc; i++)
  {
    for (j = 0; j < 200; j++)
    {
      if ((stock_encomenda[i].prdEnc[j][0] == prod) && (stock_encomenda[i].prdEnc[j][1] > qtd_produto))
      {
        qtd_produto = stock_encomenda[i].prdEnc[j][1];
        ide_max = i;
      }
      else
      {
        
      }

    }

  }

  if (qtd_produto != (-1))
  {
    printf("Maximo produto %d %d %d.\n", prod, ide_max, qtd_produto);
  }
  else
  {
    
  }

  return 0;
}

int cmd_l()
{
  int j;
  int tabela_final[10000];
  int limite_superior = n_pro;
  int limite_inferior = 0;
  for (j = 0; j < n_pro; j++)
    tabela_final[j] = stock_produto[j].idp;

  mergesort(limite_inferior, limite_superior - 1, tabela_final, 0, 0);
  printf("Produtos\n");
  for (j = 0; j < n_pro; j++)
  {
    printf("* %s %d %d\n", stock_produto[tabela_final[j]].nome, stock_produto[tabela_final[j]].preco, stock_produto[tabela_final[j]].qtd);
  }

  return 0;
}

int cmd_L()
{
  int i;
  int enc;
  int tabela_final[200];
  int limite_superior = 0;
  int limite_inferior = 0;
  char s[7];
  leInput(s);
  enc = atoi(s);
  if (enc >= n_enc)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", enc);
    return 0;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
    if (stock_encomenda[enc].prdEnc[i][0] != (-1))
  {
    tabela_final[limite_superior] = i;
    limite_superior++;
  }
  else
  {
    
  }


  mergesort(limite_inferior, limite_superior - 1, tabela_final, 1, enc);
  printf("Encomenda %d\n", enc);
  for (i = 0; i < limite_superior; i++)
  {
    printf("* %s %d %d\n", stock_produto[stock_encomenda[enc].prdEnc[tabela_final[i]][0]].nome, stock_produto[stock_encomenda[enc].prdEnc[tabela_final[i]][0]].preco, stock_encomenda[enc].prdEnc[tabela_final[i]][1]);
  }

  return 0;
}

int main()
{
  char c;
  int i;
  int j;
  int run = 1;
  for (i = 0; i < 500; i++)
  {
    for (j = 0; j < 200; j++)
    {
      stock_encomenda[i].prdEnc[j][0] = -1;
    }

  }

  while (run)
  {
    switch (c = getchar())
    {
      case 'a':
        cmd_a();
        break;

      case 'q':
        cmd_q();
        break;

      case 'N':
        cmd_N();
        break;

      case 'A':
        cmd_A();
        break;

      case 'r':
        cmd_r();
        break;

      case 'R':
        cmd_R();
        break;

      case 'C':
        cmd_C();
        break;

      case 'p':
        cmd_p();
        break;

      case 'E':
        cmd_E();
        break;

      case 'm':
        cmd_m();
        break;

      case 'l':
        cmd_l();
        break;

      case 'L':
        cmd_L();
        break;

      case 'x':
        run = 0;
        break;

    }

  }

  return 0;
}

