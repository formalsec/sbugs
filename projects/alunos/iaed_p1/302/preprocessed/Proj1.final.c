/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


int ident_p = 0;
int ident_e = 0;
int ide;
int idp;
typedef struct 
{
  char descricao[63];
  int preco;
  int peso;
  int quantidade;
  int identificador;
} produto;
typedef struct 
{
  int identificador;
  int peso;
  int numero_de_produtos;
  produto produtos[150];
} encomenda;
encomenda conj_encomendas[500];
produto conj_produtos[10000];
void funcao_a()
{
  for (int conj_produtos_index = 0; conj_produtos_index < 10; conj_produtos_index++)
  {
    conj_produtos[ident_p].descricao[conj_produtos_index] = new_sym_var(sizeof(char) * 8);
  }

  conj_produtos[ident_p].descricao[10 - 1] = '\0';
  conj_produtos[ident_p].preco = new_sym_var(sizeof(int) * 8);
  conj_produtos[ident_p].peso = new_sym_var(sizeof(int) * 8);
  conj_produtos[ident_p].quantidade = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", ident_p);
  conj_produtos[ident_p].identificador = ident_p;
  ident_p++;
}

void funcao_q()
{
  int stock;
  idp = new_sym_var(sizeof(int) * 8);
  stock = new_sym_var(sizeof(int) * 8);
  if (ident_p <= idp)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    conj_produtos[idp].quantidade += stock;
  }

}

void funcao_N()
{
  printf("Nova encomenda %d.\n", ident_e);
  ident_e++;
}

void funcao_A()
{
  int quantidade;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (idp >= ident_p)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    if (ide >= ident_e)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
      return;
    }
    else
    {
      if (conj_produtos[idp].quantidade < quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
        return;
      }
      else
      {
        if ((conj_encomendas[ide].peso + (conj_produtos[idp].peso * quantidade)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
          return;
        }
        else
        {
          for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
          {
            if (conj_encomendas[ide].produtos[i].identificador == idp)
            {
              conj_encomendas[ide].produtos[i].quantidade += quantidade;
              conj_produtos[idp].quantidade -= quantidade;
              conj_encomendas[ide].peso += conj_produtos[idp].peso * quantidade;
              return;
            }
            else
            {
              
            }

          }

          conj_encomendas[ide].peso += conj_produtos[idp].peso * quantidade;
          conj_encomendas[ide].produtos[conj_encomendas[ide].numero_de_produtos] = conj_produtos[idp];
          conj_encomendas[ide].produtos[conj_encomendas[ide].numero_de_produtos].quantidade = quantidade;
          conj_encomendas[ide].numero_de_produtos++;
          conj_produtos[idp].quantidade -= quantidade;
        }

      }

    }

  }

}

void funcao_r()
{
  int quantidade;
  idp = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (ident_p <= idp)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (conj_produtos[idp].quantidade < quantidade)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidade, idp);
    }
    else
    {
      conj_produtos[idp].quantidade -= quantidade;
    }

  }

}

void funcao_R()
{
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ident_e <= ide)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (ident_p <= idp)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
      {
        if (conj_encomendas[ide].produtos[i].identificador == idp)
        {
          conj_produtos[idp].quantidade += conj_encomendas[ide].produtos[i].quantidade;
          conj_encomendas[ide].peso -= conj_encomendas[ide].produtos[i].quantidade * conj_produtos[idp].peso;
          conj_encomendas[ide].produtos[i].quantidade = 0;
          return;
        }
        else
        {
          
        }

      }

    }

  }

}

void funcao_C()
{
  int i;
  int somatorio;
  int idProduto;
  ide = new_sym_var(sizeof(int) * 8);
  if (ident_e <= ide)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    somatorio = 0;
    for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
    {
      idProduto = conj_encomendas[ide].produtos[i].identificador;
      somatorio = somatorio + (conj_encomendas[ide].produtos[i].quantidade * conj_produtos[idProduto].preco);
    }

  }

  printf("Custo da encomenda %d %d.\n", ide, somatorio);
}

void funcao_p()
{
  int preco_novo = 0;
  idp = new_sym_var(sizeof(int) * 8);
  preco_novo = new_sym_var(sizeof(int) * 8);
  if (ident_p <= idp)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    conj_produtos[idp].preco = preco_novo;
  }

}

void funcao_E()
{
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ident_e <= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (ident_p <= idp)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
      {
        if (conj_encomendas[ide].produtos[i].identificador == idp)
        {
          printf("%s %d.\n", conj_produtos[idp].descricao, conj_encomendas[ide].produtos[i].quantidade);
          return;
        }
        else
        {
          
        }

      }

      printf("%s %d.\n", conj_produtos[idp].descricao, 0);
    }

  }

}

void funcao_m()
{
  int i;
  int n;
  int maximo = 0;
  int EncomendaIdMax = -1;
  idp = new_sym_var(sizeof(int) * 8);
  if (ident_p <= idp)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    for (i = 0; i < ident_e; i++)
    {
      for (n = 0; n < conj_encomendas[i].numero_de_produtos; n++)
      {
        if ((conj_encomendas[i].produtos[n].identificador == idp) && (maximo < conj_encomendas[i].produtos[n].quantidade))
        {
          maximo = conj_encomendas[i].produtos[n].quantidade;
          EncomendaIdMax = i;
        }
        else
        {
          
        }

      }

    }

    if ((maximo == 0) || (EncomendaIdMax == (-1)))
    {
      return;
    }
    else
    {
      
    }

    printf("Maximo produto %d %d %d.\n", idp, EncomendaIdMax, maximo);
  }

}

void funcao_l()
{
}

void funcao_L()
{
  int i;
  int n;
  int r;
  produto produto_aux;
  ide = new_sym_var(sizeof(int) * 8);
  if (ident_e <= ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
    {
      for (n = 0; n < conj_encomendas[ide].numero_de_produtos; n++)
      {
        r = strcmp(conj_encomendas[ide].produtos[n].descricao, conj_encomendas[ide].produtos[i].descricao);
        if (r > 0)
        {
          produto_aux = conj_encomendas[ide].produtos[i];
          conj_encomendas[ide].produtos[i] = conj_encomendas[ide].produtos[n];
          conj_encomendas[ide].produtos[n] = produto_aux;
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", ide);
    for (i = 0; i < conj_encomendas[ide].numero_de_produtos; i++)
    {
      if (conj_encomendas[ide].produtos[i].quantidade != 0)
      {
        n = conj_encomendas[ide].produtos[i].identificador;
        printf("* %s %d %d\n", conj_encomendas[ide].produtos[i].descricao, conj_produtos[n].preco, conj_encomendas[ide].produtos[i].quantidade);
      }
      else
      {
        
      }

    }

  }

}

void funcao_k()
{
  int i;
  for (i = 0; i < ident_p; i++)
  {
    printf("ProdId:%d Pre?o:%d Peso:%d Quantidade:%d\n", conj_produtos[i].identificador, conj_produtos[i].preco, conj_produtos[i].peso, conj_produtos[i].quantidade);
  }

}

int main()
{
  char comando;
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        funcao_a();
        break;

      case 'q':
        funcao_q();
        break;

      case 'N':
        funcao_N();
        break;

      case 'A':
        funcao_A();
        break;

      case 'r':
        funcao_r();
        break;

      case 'R':
        funcao_R();
        break;

      case 'C':
        funcao_C();
        break;

      case 'p':
        funcao_p();
        break;

      case 'E':
        funcao_E();
        break;

      case 'm':
        funcao_m();
        break;

      case 'l':
        funcao_l();
        break;

      case 'L':
        funcao_L();
        break;

      case 'k':
        funcao_k();
        break;

    }

  }

  return 0;
}

