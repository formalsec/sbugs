#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct 
{
  int identificador;
  char descricao[63];
  int preco;
  int peso;
  int quant_stk;
} Produto;
typedef struct 
{
  int identificador_encomenda;
  int peso_encomenda;
  int n_produtos;
  Produto produtosEncomenda[200];
} Encomenda;
Produto p1;
Produto produtos[10000];
Encomenda Encomendas[500];
Encomenda e1;
int idp = 0;
int ide = 0;
void a()
{
  int preco;
  int peso;
  int quant_stk;
  for (int p1_index = 0; p1_index < 10; p1_index++)
  {
    p1.descricao[p1_index] = new_sym_var(sizeof(char) * 8);
  }

  p1.descricao[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  quant_stk = new_sym_var(sizeof(int) * 8);
  p1.preco = preco;
  p1.peso = peso;
  p1.quant_stk = quant_stk;
  p1.identificador = idp;
  produtos[idp] = p1;
  printf("Novo produto %d.\n", p1.identificador);
  idp++;
}

void q()
{
  int identifi;
  int quantidade;
  identifi = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  p1.identificador = identifi;
  if (identifi <= idp)
  {
    p1.quant_stk = quantidade + p1.quant_stk;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", identifi);
  }

}

void N()
{
  e1.identificador_encomenda = ide;
  Encomendas[ide] = e1;
  Encomendas[ide].n_produtos = 0;
  printf("Nova encomenda %d.\n", ide);
  ++ide;
}

void A()
{
  int iden_enc;
  int ide_pro;
  int qtd;
  int percorrer;
  iden_enc = new_sym_var(sizeof(int) * 8);
  ide_pro = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (iden_enc > ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  if (ide_pro > idp)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  if (qtd > produtos[ide_pro].quant_stk)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  if ((Encomendas[iden_enc].peso_encomenda + (produtos[ide_pro].peso * qtd)) > 200)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  for (percorrer = 0; percorrer < Encomendas[iden_enc].n_produtos; percorrer++)
  {
    if (Encomendas[iden_enc].produtosEncomenda[percorrer].identificador == ide_pro)
    {
      Encomendas[iden_enc].produtosEncomenda[percorrer].quant_stk += qtd;
      Encomendas[iden_enc].peso_encomenda += produtos[ide_pro].peso * qtd;
      produtos[ide_pro].quant_stk -= qtd;
    }
    else
    {
      
    }

  }

  Encomendas[iden_enc].produtosEncomenda[Encomendas[iden_enc].n_produtos] = produtos[ide_pro];
  Encomendas[iden_enc].produtosEncomenda[Encomendas[iden_enc].n_produtos].quant_stk = qtd;
  Encomendas[iden_enc].n_produtos = Encomendas[iden_enc].n_produtos + 1;
  Encomendas[iden_enc].peso_encomenda += produtos[ide_pro].peso * qtd;
  produtos[ide_pro].quant_stk -= qtd;
}

void r()
{
  int identifi;
  int quantidade;
  identifi = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (identifi > idp)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", identifi);
  }
  else
  {
    
  }

  if (produtos[identifi].quant_stk < quantidade)
  {
    printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidade, identifi);
  }
  else
  {
    
  }

  produtos[identifi].quant_stk -= quantidade;
}

void R()
{
  int iden_enc;
  int ide_pro;
  int i;
  iden_enc = new_sym_var(sizeof(int) * 8);
  ide_pro = new_sym_var(sizeof(int) * 8);
  if (iden_enc > ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  if (ide_pro > idp)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", ide_pro, iden_enc);
  }
  else
  {
    
  }

  for (i = 0; i < Encomendas[iden_enc].n_produtos; i++)
  {
    if (Encomendas[iden_enc].produtosEncomenda[i].identificador == ide_pro)
    {
      Encomendas[iden_enc].produtosEncomenda[i].peso = 0;
      produtos[ide_pro].quant_stk++;
    }
    else
    {
      
    }

  }

}

void C()
{
  int idencom;
  int i;
  int custo;
  idencom = new_sym_var(sizeof(int) * 8);
  if (idencom > ide)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", idencom);
  }
  else
  {
    for (i = 0; i < Encomendas[idencom].n_produtos; i++)
    {
      custo += Encomendas[idencom].produtosEncomenda[i].preco * Encomendas[idencom].produtosEncomenda[i].quant_stk;
    }

  }

  printf("Custo da encomenda %d %d\n", idencom, custo);
}

void p()
{
  int p;
  int idpr;
  idpr = new_sym_var(sizeof(int) * 8);
  p = new_sym_var(sizeof(int) * 8);
  if (idpr > idp)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idpr);
  }
  else
  {
    produtos[idpr].preco = p;
  }

}

void E()
{
  int iden;
  int ip;
  int quantidade;
  int i;
  iden = new_sym_var(sizeof(int) * 8);
  ip = new_sym_var(sizeof(int) * 8);
  if (iden > ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", iden);
  }
  else
  {
    if (ip > idp)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", ip);
    }
    else
    {
      
    }

  }

  for (i = 0; i < Encomendas[iden].n_produtos; i++)
  {
    if (Encomendas[iden].produtosEncomenda[i].identificador == ip)
    {
      quantidade = Encomendas[iden].produtosEncomenda[i].quant_stk;
    }
    else
    {
      
    }

  }

  printf("%s %d\n", produtos[ip].descricao, quantidade);
}

void m()
{
  printf("erro");
}

void l()
{
  printf("erro");
}

void L()
{
  printf("erro");
}

int main()
{
  char comando;
  while ((comando = getchar()) != 'x')
  {
    switch (comando)
    {
      case 'a':
        a();
        break;

      case 'q':
        q();
        break;

      case 'N':
        N();
        break;

      case 'A':
        A();
        break;

      case 'r':
        r();
        break;

      case 'R':
        R();
        break;

      case 'C':
        C();
        break;

      case 'p':
        p();
        break;

      case 'E':
        E();
        break;

      case 'm':
        m();
        break;

      case 'l':
        l();
        break;

      case 'L':
        L();
        break;

    }

    getchar();
  }

  return 0;
}

