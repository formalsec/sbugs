/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produtos
{
  char descricao[64];
  int preco;
  int peso;
  int qtd;
} produto;
produto storage[10000];
typedef struct encomendas
{
  produto artigos[10000];
  int preco_total;
  int peso_total;
  int cont_produtos;
  int prod_adic[10000];
} encomenda;
encomenda order[500];
void a(produto storage[10000], int idp)
{
  int cont = 0;
  char descript;
  char lstdescript[64];
  getchar();
  while ((descript = getchar()) != ':')
  {
    lstdescript[cont++] = descript;
  }

  lstdescript[cont] = '\0';
  strcpy(storage[idp].descricao, lstdescript);
  storage[idp].preco = new_sym_var(sizeof(int) * 8);
  storage[idp].peso = new_sym_var(sizeof(int) * 8);
  storage[idp].qtd = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", idp);
}

void q(produto storage[10000], int idp)
{
  int in_idp;
  int new_stock;
  in_idp = new_sym_var(sizeof(int) * 8);
  new_stock = new_sym_var(sizeof(int) * 8);
  if (idp <= in_idp)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", in_idp);
  }
  else
  {
    storage[in_idp].qtd += new_stock;
  }

}

void r(produto storage[10000], int idp)
{
  int in_idp;
  int rem_stock;
  in_idp = new_sym_var(sizeof(int) * 8);
  rem_stock = new_sym_var(sizeof(int) * 8);
  if (idp <= in_idp)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", in_idp);
  }
  else
  {
    if ((storage[in_idp].qtd - rem_stock) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", rem_stock, in_idp);
    }
    else
    {
      storage[in_idp].qtd -= rem_stock;
    }

  }

}

void p(produto storage[10000], int idp, int ide, encomenda order[500])
{
  int in_idp;
  int new_preco;
  in_idp = new_sym_var(sizeof(int) * 8);
  new_preco = new_sym_var(sizeof(int) * 8);
  if (idp <= in_idp)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", in_idp);
  }
  else
  {
    size_t i;
    int ja_existe;
    int c;
    for (c = 0; c <= ide; c++)
    {
      for (i = 0; i < ((sizeof(order[c].prod_adic)) / (sizeof(order[c].prod_adic[0]))); i++)
      {
        if (order[c].prod_adic[i] == in_idp)
        {
          ja_existe = 1;
        }
        else
        {
          
        }

      }

      if (ja_existe == 1)
      {
        order[c].artigos[in_idp].preco = new_preco;
        order[c].preco_total -= order[c].artigos[in_idp].preco * order[c].artigos[in_idp].qtd;
        order[c].preco_total += new_preco * order[c].artigos[in_idp].qtd;
      }
      else
      {
        
      }

    }

    storage[in_idp].preco = new_preco;
  }

}

void N(int ide)
{
  printf("Nova encomenda %d.\n", ide);
}

void A(encomenda order[500], produto storage[10000], int ide, int idp)
{
  int in_ide;
  int in_idp;
  int in_qtd;
  in_ide = new_sym_var(sizeof(int) * 8);
  in_idp = new_sym_var(sizeof(int) * 8);
  in_qtd = new_sym_var(sizeof(int) * 8);
  if (ide <= in_ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", in_idp, in_ide);
  }
  else
  {
    if (idp <= in_idp)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", in_idp, in_ide);
    }
    else
    {
      if (storage[in_idp].qtd < in_qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", in_idp, in_ide);
      }
      else
      {
        if (((storage[in_idp].peso * in_qtd) + order[in_ide].peso_total) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", in_idp, in_ide);
        }
        else
        {
          size_t i;
          int ja_existe;
          for (i = 0; i < ((sizeof(order[in_ide].prod_adic)) / (sizeof(order[in_ide].prod_adic[0]))); i++)
          {
            if (order[in_ide].prod_adic[i] == in_idp)
            {
              ja_existe = 1;
            }
            else
            {
              
            }

          }

          if (ja_existe == 1)
          {
            order[in_ide].peso_total += storage[in_idp].peso * in_qtd;
            order[in_ide].preco_total += storage[in_idp].preco * in_qtd;
            order[in_ide].artigos[idp].qtd += in_qtd;
            storage[in_idp].qtd -= in_qtd;
          }
          else
          {
            order[in_ide].peso_total += storage[in_idp].peso * in_qtd;
            order[in_ide].preco_total += storage[in_idp].preco * in_qtd;
            strcpy(order[in_ide].artigos[in_idp].descricao, storage[in_idp].descricao);
            order[in_ide].artigos[in_idp].preco = storage[in_idp].preco;
            order[in_ide].artigos[in_idp].peso = storage[in_idp].peso;
            order[in_ide].artigos[in_idp].qtd = in_qtd;
            order[in_ide].prod_adic[order[in_ide].cont_produtos] += in_idp;
            order[in_ide].cont_produtos++;
            storage[in_idp].qtd -= in_qtd;
          }

        }

      }

    }

  }

}

void R(int idp, int ide, encomenda order[500], produto storage[10000])
{
  int in_ide;
  int in_idp;
  in_ide = new_sym_var(sizeof(int) * 8);
  in_idp = new_sym_var(sizeof(int) * 8);
  if (ide <= in_ide)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", in_idp, in_ide);
  }
  else
  {
    if (idp <= in_idp)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", in_idp, in_ide);
    }
    else
    {
      order[in_ide].peso_total -= order[in_ide].artigos[in_idp].peso * order[in_ide].artigos[in_idp].qtd;
      order[in_ide].preco_total -= order[in_ide].artigos[in_idp].preco * order[in_ide].artigos[in_idp].qtd;
      storage[in_idp].qtd += order[in_ide].artigos[in_idp].qtd;
      order[in_ide].artigos[in_idp].qtd = 0;
      order[in_ide].artigos[in_idp].preco = 0;
      order[in_ide].artigos[in_idp].peso = 0;
    }

  }

}

void C(int ide, encomenda order[500])
{
  int in_ide;
  in_ide = new_sym_var(sizeof(int) * 8);
  if (ide <= in_ide)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", in_ide);
  }
  else
  {
    printf("Custo da encomenda %d %d.\n", in_ide, order[in_ide].preco_total);
  }

}

void E(int ide, int idp, encomenda order[500])
{
  int in_ide;
  int in_idp;
  in_ide = new_sym_var(sizeof(int) * 8);
  in_idp = new_sym_var(sizeof(int) * 8);
  if (ide <= in_ide)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", in_ide);
  }
  else
  {
    if (idp <= in_idp)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", in_idp);
    }
    else
    {
      if (order[in_ide].artigos[in_idp].qtd != 0)
      {
        printf("%s %d.\n", order[in_ide].artigos[in_idp].descricao, order[in_ide].artigos[in_idp].qtd);
      }
      else
      {
        printf("%s %d.\n", storage[in_idp].descricao, order[in_ide].artigos[in_idp].qtd);
      }

    }

  }

}

void m(int idp, int ide, encomenda order[500])
{
  int in_idp;
  in_idp = new_sym_var(sizeof(int) * 8);
  if (idp <= in_idp)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", in_idp);
  }
  else
  {
    int mais_stock = 0;
    int quantificador = 0;
    int maior_ide = 0;
    int c;
    size_t i;
    for (c = 0; c <= ide; c++)
    {
      for (i = 0; i < ((sizeof(order[c].prod_adic)) / (sizeof(order[c].prod_adic[0]))); i++)
      {
        if (order[c].prod_adic[i] == in_idp)
        {
          quantificador = order[c].artigos[in_idp].qtd;
        }
        else
        {
          
        }

      }

      if (mais_stock < quantificador)
      {
        mais_stock = quantificador;
        maior_ide = c;
      }
      else
      {
        
      }

    }

    printf("Maximo produto %d %d %d.", in_idp, maior_ide, mais_stock);
  }

}

int main()
{
  char str;
  int idp = 0;
  int ide = 0;
  while (str != 'x')
  {
    str = new_sym_var(sizeof(char) * 8);
    if (str == 'a')
    {
      a(storage, idp);
      idp++;
    }
    else
    {
      
    }

    if (str == 'q')
    {
      q(storage, idp);
    }
    else
    {
      
    }

    if (str == 'r')
    {
      r(storage, idp);
    }
    else
    {
      
    }

    if (str == 'p')
    {
      p(storage, idp, ide, order);
    }
    else
    {
      
    }

    if (str == 'N')
    {
      N(ide);
      ide++;
    }
    else
    {
      
    }

    if (str == 'A')
    {
      A(order, storage, ide, idp);
    }
    else
    {
      
    }

    if (str == 'R')
    {
      R(idp, ide, order, storage);
    }
    else
    {
      
    }

    if (str == 'C')
    {
      C(ide, order);
    }
    else
    {
      
    }

    if (str == 'E')
    {
      E(ide, idp, order);
    }
    else
    {
      
    }

    if (str == 'm')
    {
      m(idp, ide, order);
    }
    else
    {
      
    }

  }

  return 0;
}

