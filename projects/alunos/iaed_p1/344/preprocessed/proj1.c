#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  char desc[64];
  int pr;
  int pe;
  int qtd;
  int ativo;
  int searched;
} produto;
typedef struct encomenda
{
  int pe_total;
  int ativo;
  produto conteudo[10000];
} encomenda;
produto inventario[10000];
int idp_gl;
encomenda encomendas[500];
int ide_gl;
int pot(int b, int e)
{
  int res = 1;
  if (e == 0)
  {
    return 1;
  }
  else
  {
    
  }

  for (; e > 0; e--)
  {
    res *= b;
  }

  return res;
}

void numsIn_em_vet(char term, int num[])
{
  int i;
  int n;
  for (i = 0; ((n = getchar()) != term) && (i < 11); i++)
  {
    num[i] = n - 48;
  }

  num[i] = 10;
}

int num_digs(int num[])
{
  int i;
  int res = 0;
  for (i = 0; (num[i] != 10) && (i < 11); i++)
  {
    res += 1;
  }

  return res;
}

int vetNums_em_int(int num[])
{
  int i;
  int digs = num_digs(num);
  int xdez = digs - 1;
  int res = 0;
  for (i = 0; (num[i] != 10) && (i < 11); i++)
  {
    res += num[i] * pot(10, xdez);
    xdez -= 1;
  }

  return res;
}

int numsIn_em_int(char term)
{
  static int num[11];
  int res;
  numsIn_em_vet(term, num);
  res = vetNums_em_int(num);
  return res;
}

int in_vet_p(produto vet[], int id)
{
  if (vet[id].ativo)
  {
    return 1;
  }
  else
  {
    return 0;
  }

}

int in_vet_e(encomenda vet[], int id)
{
  if (vet[id].ativo)
  {
    return 1;
  }
  else
  {
    return 0;
  }

}

void remove_qtd_invent(int idp, int Qtd)
{
  inventario[idp].qtd -= Qtd;
}

int n_ps_ati(produto vet[])
{
  int res = 0;
  int i;
  for (i = 0; i < 10000; i++)
  {
    if (vet[i].ativo)
    {
      res += 1;
    }
    else
    {
      
    }

  }

  return res;
}

void a()
{
  char c;
  int i;
  int prop;
  for (i = 0; i < 64; i++)
  {
    if ((c = getchar()) != ':')
    {
      inventario[idp_gl].desc[i] = c;
    }
    else
    {
      if (c == ':')
      {
        break;
      }
      else
      {
        
      }

    }

  }

  inventario[idp_gl].desc[i] = '\0';
  prop = numsIn_em_int(':');
  inventario[idp_gl].pr = prop;
  prop = numsIn_em_int(':');
  inventario[idp_gl].pe = prop;
  prop = numsIn_em_int('\n');
  inventario[idp_gl].qtd = prop;
  inventario[idp_gl].ativo = 1;
  printf("Novo produto %d.\n", idp_gl);
  idp_gl += 1;
}

void q()
{
  int idp = numsIn_em_int(':');
  int Qtd = numsIn_em_int('\n');
  if (!in_vet_p(inventario, idp))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    inventario[idp].qtd += Qtd;
  }

}

void N()
{
  encomendas[ide_gl].ativo = 1;
  encomendas[ide_gl].pe_total = 0;
  printf("Nova encomenda %d.\n", ide_gl);
  ide_gl += 1;
}

void A()
{
  int ide = numsIn_em_int(':');
  int idp = numsIn_em_int(':');
  int Qtd = numsIn_em_int('\n');
  if (!in_vet_e(encomendas, ide))
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (!in_vet_p(inventario, idp))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if ((inventario[idp].qtd - Qtd) < 0)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((encomendas[ide].pe_total + (inventario[idp].pe * Qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          if (in_vet_p(encomendas[ide].conteudo, idp))
          {
            encomendas[ide].conteudo[idp].qtd += Qtd;
            encomendas[ide].pe_total += inventario[idp].pe * Qtd;
            remove_qtd_invent(idp, Qtd);
          }
          else
          {
            encomendas[ide].conteudo[idp] = inventario[idp];
            encomendas[ide].conteudo[idp].qtd = Qtd;
            encomendas[ide].pe_total += inventario[idp].pe * Qtd;
            remove_qtd_invent(idp, Qtd);
          }

        }

      }

    }

  }

}

void r()
{
  int idp = numsIn_em_int(':');
  int Qtd = numsIn_em_int('\n');
  if (!in_vet_p(inventario, idp))
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if ((inventario[idp].qtd - Qtd) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", Qtd, idp);
    }
    else
    {
      remove_qtd_invent(idp, Qtd);
    }

  }

}

void R()
{
  int ide = numsIn_em_int(':');
  int idp = numsIn_em_int('\n');
  if (!in_vet_e(encomendas, ide))
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (!in_vet_p(inventario, idp))
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (in_vet_p(encomendas[ide].conteudo, idp))
      {
        encomendas[ide].pe_total -= inventario[idp].pe * encomendas[ide].conteudo[idp].qtd;
        inventario[idp].qtd += encomendas[ide].conteudo[idp].qtd;
      }
      else
      {
        
      }

      encomendas[ide].conteudo[idp].ativo = 0;
      encomendas[ide].conteudo[idp].qtd = 0;
    }

  }

}

void C()
{
  int ide = numsIn_em_int('\n');
  int total = 0;
  int i;
  if (!in_vet_e(encomendas, ide))
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    ;
  }
  else
  {
    for (i = 0; i < 10000; i++)
    {
      if (in_vet_p(encomendas[ide].conteudo, i))
      {
        total += encomendas[ide].conteudo[i].pr * encomendas[ide].conteudo[i].qtd;
      }
      else
      {
        
      }

    }

    printf("Custo da encomenda %d %d.\n", ide, total);
  }

}

void p()
{
  int idp = numsIn_em_int(':');
  int preco = numsIn_em_int('\n');
  int i;
  if (!in_vet_p(inventario, idp))
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    inventario[idp].pr = preco;
    for (i = 0; i < 500; i++)
    {
      encomendas[i].conteudo[idp].pr = preco;
    }

  }

}

void E()
{
  int ide = numsIn_em_int(':');
  int idp = numsIn_em_int('\n');
  if (!in_vet_e(encomendas, ide))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (!in_vet_p(inventario, idp))
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      printf("%s %d.\n", inventario[idp].desc, encomendas[ide].conteudo[idp].qtd);
    }

  }

}

void m()
{
  int idp = numsIn_em_int('\n');
  int ide;
  int maior_qtd = -1;
  int ide_maior = -1;
  if (!in_vet_p(inventario, idp))
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (ide = 0; ide < 500; ide++)
  {
    if ((in_vet_e(encomendas, ide) && in_vet_p(encomendas[ide].conteudo, idp)) && (encomendas[ide].conteudo[idp].qtd > maior_qtd))
    {
      maior_qtd = encomendas[ide].conteudo[idp].qtd;
      ide_maior = ide;
    }
    else
    {
      
    }

  }

  if ((maior_qtd == (-1)) || (ide_maior == (-1)))
  {
    return;
  }
  else
  {
    
  }

  printf("Maximo produto %d %d %d.\n", idp, ide_maior, maior_qtd);
}

void l()
{
  int i;
  int menor_pr = -1;
  int maior_definitivo;
  int i_menor = 0;
  int num_ps_searched = n_ps_ati(inventario);
  for (i = 0; i < 10000; i++)
  {
    maior_definitivo += inventario[i].pr;
  }

  menor_pr = maior_definitivo;
  printf("Produtos\n");
  while (num_ps_searched > 0)
  {
    for (i = 0; i < 10000; i++)
    {
      if (!inventario[i].searched)
      {
        if ((0 < inventario[i].pr) && (inventario[i].pr < menor_pr))
        {
          menor_pr = inventario[i].pr;
          i_menor = i;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

    printf("* %s %d %d\n", inventario[i_menor].desc, inventario[i_menor].pr, inventario[i_menor].qtd);
    inventario[i_menor].searched = 1;
    menor_pr = maior_definitivo;
    num_ps_searched -= 1;
  }

  for (i = 0; i < 10000; i++)
  {
    inventario[i].searched = 0;
  }

}

void L()
{
  int ide = numsIn_em_int('\n');
  int i;
  char menor_desc[64];
  char maior_definitivo[64];
  int i_menor = 0;
  int num_ps_searched = n_ps_ati(encomendas[ide].conteudo);
  if (!in_vet_e(encomendas, ide))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  maior_definitivo[0] = 127;
  maior_definitivo[1] = '\0';
  strcpy(menor_desc, maior_definitivo);
  printf("Encomenda %d\n", ide);
  while (num_ps_searched > 0)
  {
    for (i = 0; i < 10000; i++)
    {
      if ((!encomendas[ide].conteudo[i].searched) && in_vet_p(encomendas[ide].conteudo, i))
      {
        if ((strcmp(encomendas[ide].conteudo[i].desc, menor_desc) < 0) && (strlen(encomendas[ide].conteudo[i].desc) != 0))
        {
          strcpy(menor_desc, encomendas[ide].conteudo[i].desc);
          i_menor = i;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

    printf("* %s %d %d\n", encomendas[ide].conteudo[i_menor].desc, encomendas[ide].conteudo[i_menor].pr, encomendas[ide].conteudo[i_menor].qtd);
    encomendas[ide].conteudo[i_menor].searched = 1;
    strcpy(menor_desc, maior_definitivo);
    num_ps_searched -= 1;
  }

  for (i = 0; i < 10000; i++)
  {
    encomendas[ide].conteudo[i].searched = 0;
  }

}

int main()
{
  char c;
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
        c = getchar();
        a();
        break;

      case 'q':
        c = getchar();
        q();
        break;

      case 'N':
        N();
        break;

      case 'A':
        c = getchar();
        A();
        break;

      case 'r':
        c = getchar();
        r();
        break;

      case 'R':
        c = getchar();
        R();
        break;

      case 'C':
        c = getchar();
        C();
        break;

      case 'p':
        c = getchar();
        p();
        break;

      case 'E':
        c = getchar();
        E();
        break;

      case 'm':
        c = getchar();
        m();
        break;

      case 'l':
        l();
        break;

      case 'L':
        c = getchar();
        L();
        break;

    }

  }

  return 0;
}

