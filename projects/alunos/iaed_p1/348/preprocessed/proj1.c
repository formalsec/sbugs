/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct prod
{
  int preco;
  int peso;
  int qtd;
  char descricao[64];
  int id;
} Produto;
typedef struct encomenda
{
  struct prod p[200];
  int contador;
  int ide;
} Encomenda;
int id = 0;
int ide = 0;
Produto sistema[10000];
Encomenda encomendas[500];
void cria_e_adiciona_produto()
{
  Produto new;
  for (int new_index = 0; new_index < 10; new_index++)
  {
    new.descricao[new_index] = new_sym_var(sizeof(char) * 8);
  }

  new.descricao[10 - 1] = '\0';
  new.preco = new_sym_var(sizeof(int) * 8);
  new.peso = new_sym_var(sizeof(int) * 8);
  new.qtd = new_sym_var(sizeof(int) * 8);
  new.id = id;
  sistema[id] = new;
  printf("Novo produto %d.\n", id);
  id++;
}

void adiciona_stock()
{
  int current_id;
  int current_qtd;
  current_id = new_sym_var(sizeof(int) * 8);
  current_qtd = new_sym_var(sizeof(int) * 8);
  if (current_id > (id - 1))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", current_id);
  }
  else
  {
    sistema[current_id].qtd += current_qtd;
  }

}

void cria_nova_encomenda()
{
  Encomenda new;
  new.ide = ide;
  new.contador = 0;
  printf("Nova encomenda %d.\n", ide);
  encomendas[ide++] = new;
}

void adiciona_produto_encomenda()
{
  int current_peso = 0;
  int current_id;
  int current_qtd;
  int current_ide;
  int existe = 0;
  int i;
  current_ide = new_sym_var(sizeof(int) * 8);
  current_id = new_sym_var(sizeof(int) * 8);
  current_qtd = new_sym_var(sizeof(int) * 8);
  if (current_ide > (ide - 1))
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", current_id, current_ide);
    return;
  }
  else
  {
    if (current_id > (id - 1))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", current_id, current_ide);
      return;
    }
    else
    {
      if (sistema[current_id].qtd < current_qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", current_id, current_ide);
        return;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < encomendas[current_ide].contador; i++)
  {
    current_peso += encomendas[current_ide].p[i].peso * encomendas[current_ide].p[i].qtd;
  }

  current_peso += sistema[current_id].peso * current_qtd;
  if (current_peso > 200)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", current_id, current_ide);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < encomendas[current_ide].contador; i++)
  {
    if (strcmp(sistema[current_id].descricao, encomendas[current_ide].p[i].descricao) == 0)
    {
      existe = i;
    }
    else
    {
      
    }

  }

  if (existe != 0)
  {
    encomendas[current_ide].p[existe].qtd += current_qtd;
    sistema[current_id].qtd -= current_qtd;
  }
  else
  {
    encomendas[current_ide].p[encomendas[current_ide].contador] = sistema[current_id];
    encomendas[current_ide].p[encomendas[current_ide].contador].qtd = current_qtd;
    sistema[current_id].qtd -= current_qtd;
    encomendas[current_ide].contador++;
  }

}

void remove_stock()
{
  int current_id;
  int current_qtd;
  current_id = new_sym_var(sizeof(int) * 8);
  current_qtd = new_sym_var(sizeof(int) * 8);
  if (current_id > (id - 1))
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", current_id);
  }
  else
  {
    if (current_qtd > sistema[current_id].qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", current_qtd, current_id);
    }
    else
    {
      sistema[current_id].qtd -= current_qtd;
    }

  }

}

void remove_produto_encomenda()
{
  int current_ide;
  int current_id;
  int i;
  current_ide = new_sym_var(sizeof(int) * 8);
  current_id = new_sym_var(sizeof(int) * 8);
  if (current_ide > (ide - 1))
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", current_id, current_ide);
  }
  else
  {
    
  }

  if (current_id > (id - 1))
  {
    printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", current_id, current_ide);
  }
  else
  {
    for (i = 0; i < encomendas[current_ide].contador; i++)
    {
      if (strcmp(sistema[current_id].descricao, encomendas[current_ide].p[i].descricao) == 0)
      {
        sistema[current_id].qtd += encomendas[current_ide].p[i].qtd;
        encomendas[current_ide].p[i].qtd = 0;
        encomendas[current_ide].contador--;
        return;
      }
      else
      {
        
      }

    }

  }

}

void calcula_custo_encomenda()
{
  int current_ide;
  int total = 0;
  int i;
  current_ide = new_sym_var(sizeof(int) * 8);
  if (current_ide > (ide - 1))
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", current_ide);
  }
  else
  {
    for (i = 0; i < encomendas[current_ide].contador; i++)
    {
      total += encomendas[current_ide].p[i].preco * encomendas[current_ide].p[i].qtd;
    }

    printf("Custo da encomenda %d %d.\n", current_ide, total);
  }

}

void altera_preco_produto_no_sistema()
{
  int current_id;
  int current_preco;
  int i;
  int j;
  current_id = new_sym_var(sizeof(int) * 8);
  current_preco = new_sym_var(sizeof(int) * 8);
  if (current_id > (id - 1))
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", current_id);
  }
  else
  {
    for (i = 0; i < ide; i++)
    {
      for (j = 0; j < encomendas[i].contador; j++)
      {
        if (strcmp(sistema[current_id].descricao, encomendas[i].p[j].descricao) == 0)
        {
          encomendas[i].p[j].preco = current_preco;
        }
        else
        {
          
        }

      }

    }

    sistema[current_id].preco = current_preco;
  }

}

void retorna_descricao_e_quantidade_de_produto_na_encomenda()
{
  int current_id;
  int current_ide;
  int i;
  int current_qtd = 0;
  current_ide = new_sym_var(sizeof(int) * 8);
  current_id = new_sym_var(sizeof(int) * 8);
  if (current_ide > (ide - 1))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", current_ide);
  }
  else
  {
    if (current_id > (id - 1))
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", current_id);
    }
    else
    {
      for (i = 0; i < encomendas[current_ide].contador; i++)
      {
        if (strcmp(sistema[current_id].descricao, encomendas[current_ide].p[i].descricao) == 0)
        {
          current_qtd = encomendas[current_ide].p[i].qtd;
        }
        else
        {
          
        }

      }

      printf("%s %d.\n", sistema[current_id].descricao, current_qtd);
    }

  }

}

void retorna_id_encomenda_ocorre_mais_vezes()
{
  int current_id;
  int maximo = 0;
  int current_ide;
  int i;
  int j;
  current_id = new_sym_var(sizeof(int) * 8);
  if (current_id > (id - 1))
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", current_id);
  }
  else
  {
    for (i = 0; i < ide; i++)
    {
      for (j = 0; j < encomendas[i].contador; j++)
      {
        if ((strcmp(sistema[current_id].descricao, encomendas[i].p[j].descricao) == 0) && (encomendas[i].p[j].qtd > maximo))
        {
          maximo = encomendas[i].p[j].qtd;
          current_ide = i;
        }
        else
        {
          
        }

      }

    }

    if (maximo != 0)
    {
      printf("Maximo produto %d %d %d.\n", current_id, current_ide, maximo);
    }
    else
    {
      
    }

  }

}

void lista_produtos_ordem_crescente_preco()
{
  int i;
  Produto aux;
  Produto copia[10000];
  int contador;
  for (i = 0; i < id; i++)
  {
    copia[i] = sistema[i];
  }

  for (contador = 0; contador < id; contador++)
  {
    for (i = 0; i < ((id - contador) - 1); i++)
    {
      if (copia[i].preco > copia[i + 1].preco)
      {
        aux = copia[i];
        copia[i] = copia[i + 1];
        copia[i + 1] = aux;
      }
      else
      {
        
      }

    }

  }

  printf("Produtos\n");
  for (i = 0; i < id; i++)
  {
    printf("* %s %d %d\n", copia[i].descricao, copia[i].preco, copia[i].qtd);
  }

}

void lista_produtos_encomenda_ordem_alfabetica()
{
  int current_ide;
  int i;
  Produto aux;
  Produto copia[200];
  int contador;
  current_ide = new_sym_var(sizeof(int) * 8);
  if (current_ide > (ide - 1))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", current_ide);
  }
  else
  {
    for (i = 0; i < encomendas[current_ide].contador; i++)
    {
      copia[i] = encomendas[current_ide].p[i];
    }

    for (contador = 1; contador < encomendas[current_ide].contador; contador++)
    {
      for (i = 0; i < (encomendas[current_ide].contador - contador); i++)
      {
        if (strcmp(copia[i].descricao, copia[i + 1].descricao) > 0)
        {
          aux = copia[i];
          copia[i] = copia[i + 1];
          copia[i + 1] = aux;
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", current_ide);
    for (i = 0; i < encomendas[current_ide].contador; i++)
    {
      printf("* %s %d %d\n", copia[i].descricao, copia[i].preco, copia[i].qtd);
    }

  }

}

int main()
{
  char comando;
  while (comando != 'x')
  {
    comando = getchar();
    switch (comando)
    {
      case 'a':
        cria_e_adiciona_produto();
        break;

      case 'q':
        adiciona_stock();
        break;

      case 'N':
        cria_nova_encomenda();
        break;

      case 'A':
        adiciona_produto_encomenda();
        break;

      case 'r':
        remove_stock();
        break;

      case 'R':
        remove_produto_encomenda();
        break;

      case 'C':
        calcula_custo_encomenda();
        break;

      case 'p':
        altera_preco_produto_no_sistema();
        break;

      case 'E':
        retorna_descricao_e_quantidade_de_produto_na_encomenda();
        break;

      case 'm':
        retorna_id_encomenda_ocorre_mais_vezes();
        break;

      case 'l':
        lista_produtos_ordem_crescente_preco();
        break;

      case 'L':
        lista_produtos_encomenda_ordem_alfabetica();
        break;

      case 'x':
        break;

    }

  }

  return 0;
}

