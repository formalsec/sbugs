/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  char descricao[63];
  int idp;
  int preco;
  int peso;
  int qtd;
} Produto;
typedef struct 
{
  int peso_e;
  Produto produtos[200];
  int contador;
} Encomenda;
Produto sistema[10000];
Encomenda sistema_e[500];
int contador_produtos;
int contador_encomendas;
int getCommand();
void funcao_a();
void funcao_q();
void funcao_N();
void funcao_A();
void funcao_r();
void funcao_R();
void funcao_C();
void funcao_p();
void funcao_E();
void funcao_m();
void funcao_l();
void funcao_L();
int main()
{
  getCommand();
  return 0;
}

int getCommand()
{
  while (1)
  {
    int command = getchar();
    switch (command)
    {
      case 'a':
        getchar();
        funcao_a();
        break;

      case 'q':
        funcao_q();
        break;

      case 'N':
        funcao_N();
        break;

      case 'A':
        funcao_A();
        break;

      case 'r':
        funcao_r();
        break;

      case 'R':
        funcao_R();
        break;

      case 'C':
        funcao_C();
        break;

      case 'p':
        funcao_p();
        break;

      case 'E':
        funcao_E();
        break;

      case 'm':
        funcao_m();
        break;

      case 'l':
        funcao_l();
        break;

      case 'L':
        funcao_L();
        break;

      case 'x':
        return 0;

      default:
        break;

    }

  }

  return 0;
}

void funcao_a()
{
  char descricao[63];
  int preco;
  int peso;
  int qtd;
  if (contador_produtos < 10000)
  {
    for (int descricao_index = 0; descricao_index < 10; descricao_index++)
    {
      descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
    }

    descricao[10 - 1] = '\0';
    preco = new_sym_var(sizeof(int) * 8);
    peso = new_sym_var(sizeof(int) * 8);
    qtd = new_sym_var(sizeof(int) * 8);
    strcpy(sistema[contador_produtos].descricao, descricao);
    sistema[contador_produtos].preco = preco;
    sistema[contador_produtos].peso = peso;
    sistema[contador_produtos].qtd = qtd;
    sistema[contador_produtos].idp = contador_produtos;
    printf("Novo produto %d.\n", contador_produtos);
    contador_produtos++;
  }
  else
  {
    
  }

}

void funcao_q()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp < contador_produtos)
  {
    sistema[idp].qtd += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

}

void funcao_N()
{
  if (contador_encomendas < 500)
  {
    printf("Nova encomenda %d.\n", contador_encomendas);
    sistema_e[contador_encomendas].peso_e = 0;
    sistema_e[contador_encomendas].contador = 0;
    contador_encomendas++;
  }
  else
  {
    
  }

}

void funcao_A()
{
  int idp;
  int ide;
  int qtd;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (sistema[idp].descricao[0] == '\0')
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (sistema[idp].qtd < qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((sistema_e[ide].peso_e + (sistema[idp].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          for (i = 0; i < sistema_e[ide].contador; i++)
          {
            if (sistema_e[ide].produtos[i].idp == idp)
            {
              sistema_e[ide].produtos[i].qtd += qtd;
              sistema_e[ide].peso_e += sistema[idp].peso * qtd;
              sistema[idp].qtd -= qtd;
              return;
            }
            else
            {
              
            }

          }

          sistema_e[ide].produtos[sistema_e[ide].contador] = sistema[idp];
          sistema_e[ide].produtos[sistema_e[ide].contador].qtd = qtd;
          sistema_e[ide].peso_e += sistema[idp].peso * qtd;
          sistema[idp].qtd -= qtd;
          sistema_e[ide].contador++;
        }

      }

    }

  }

}

void funcao_r()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (sistema[idp].descricao[0] == '\0')
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (sistema[idp].qtd < qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      sistema[idp].qtd -= qtd;
    }

  }

}

void funcao_R()
{
  int idp;
  int ide;
  int i;
  int k;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    if (sistema[idp].descricao[0] == '\0')
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
      return;
    }
    else
    {
      
    }

  }

  for (i = 0; i < sistema_e[ide].contador; i++)
  {
    if (sistema_e[ide].produtos[i].idp == idp)
    {
      sistema[idp].qtd += sistema_e[ide].produtos[i].qtd;
      sistema_e[ide].peso_e -= sistema[idp].peso * sistema_e[ide].produtos[i].qtd;
      for (k = i; k < sistema_e[ide].contador; k++)
        sistema_e[ide].produtos[k] = sistema_e[ide].produtos[k + 1];

      sistema_e[ide].contador--;
      return;
    }
    else
    {
      
    }

  }

}

void funcao_C()
{
  int ide;
  int i;
  int soma = 0;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < sistema_e[ide].contador; i++)
    {
      idp = sistema_e[ide].produtos[i].idp;
      soma += sistema[idp].preco * sistema_e[ide].produtos[i].qtd;
    }

    printf("Custo da encomenda %d %d.\n", ide, soma);
  }

}

void funcao_p()
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (sistema[idp].descricao[0] == '\0')
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    
  }

  sistema[idp].preco = preco;
}

void funcao_E()
{
  int ide;
  int idp;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    if (sistema[idp].descricao[0] == '\0')
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
      return;
    }
    else
    {
      
    }

  }

  for (i = 0; i < sistema_e[ide].contador; i++)
    if (sistema_e[ide].produtos[i].idp == idp)
  {
    printf("%s %d.\n", sistema[idp].descricao, sistema_e[ide].produtos[i].qtd);
    return;
  }
  else
  {
    
  }


  printf("%s %d.\n", sistema[idp].descricao, 0);
}

void funcao_m()
{
  int idp;
  int i1;
  int k;
  int v;
  int i2;
  idp = new_sym_var(sizeof(int) * 8);
  k = 0;
  if (sistema[idp].descricao[0] == '\0')
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (i1 = 0; i1 < contador_encomendas; i1++)
    for (i2 = 0; i2 < sistema_e[i1].contador; i2++)
    if ((sistema_e[i1].produtos[i2].idp == idp) && (sistema_e[i1].produtos[i2].qtd > k))
  {
    k = sistema_e[i1].produtos[i2].qtd;
    v = i1;
  }
  else
  {
    
  }



  if (k > 0)
  {
    printf("Maximo produto %d %d %d.\n", idp, v, k);
  }
  else
  {
    
  }

}

void exch(Produto *l, Produto *r)
{
  Produto k = *l;
  *l = *r;
  *r = k;
}

int particao(Produto a[], int l, int r, int comparacao)
{
  int i = l - 1;
  int j;
  Produto v = a[r];
  for (j = l; j <= (r - 1); j++)
  {
    if (comparacao == 0)
    {
      if ((a[j].preco == v.preco) && (a[j].idp < v.idp))
      {
        i++;
        exch(&a[i], &a[j]);
      }
      else
      {
        
      }

      if (a[j].preco < v.preco)
      {
        i++;
        exch(&a[i], &a[j]);
      }
      else
      {
        
      }

    }
    else
    {
      if (comparacao == 1)
      {
        if (strcmp(a[j].descricao, v.descricao) < 0)
        {
          i++;
          exch(&a[i], &a[j]);
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  exch(&a[i + 1], &a[r]);
  return i + 1;
}

void quickSrt(Produto a[], int l, int r, int comparacao)
{
  int i;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  i = particao(a, l, r, comparacao);
  quickSrt(a, l, i - 1, comparacao);
  quickSrt(a, i + 1, r, comparacao);
}

void funcao_l()
{
  int i;
  int l = 0;
  Produto ordered_sistema[10000];
  for (i = 0; i < contador_produtos; i++)
    ordered_sistema[i] = sistema[i];

  printf("Produtos\n");
  if (!(contador_produtos == 0))
  {
    quickSrt(ordered_sistema, 0, contador_produtos - 1, l);
    for (i = 0; i < contador_produtos; i++)
      printf("* %s %d %d\n", ordered_sistema[i].descricao, ordered_sistema[i].preco, ordered_sistema[i].qtd);

  }
  else
  {
    
  }

}

void funcao_L()
{
  int ide;
  int l = 1;
  int i;
  int idp;
  Produto array_produtos[200];
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= contador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < sistema_e[ide].contador; i++)
      array_produtos[i] = sistema_e[ide].produtos[i];

    printf("Encomenda %d\n", ide);
    quickSrt(array_produtos, 0, sistema_e[ide].contador - 1, l);
    for (i = 0; i < sistema_e[ide].contador; i++)
    {
      idp = array_produtos[i].idp;
      printf("* %s %d %d\n", sistema[idp].descricao, sistema[idp].preco, array_produtos[i].qtd);
    }

  }

}

