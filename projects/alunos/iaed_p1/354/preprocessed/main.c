/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  int idp;
  char descricao[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct 
{
  int pes;
  int qtd;
  produto enc[200];
} Encomenda;
Encomenda Enc_exis[500];
produto Prod_exis[10000];
int idp_at = 0;
int ide_at = 0;
void Adiciona_Produto()
{
  produto pro;
  for (int pro_index = 0; pro_index < 10; pro_index++)
  {
    pro.descricao[pro_index] = new_sym_var(sizeof(char) * 8);
  }

  pro.descricao[10 - 1] = '\0';
  pro.preco = new_sym_var(sizeof(int) * 8);
  pro.peso = new_sym_var(sizeof(int) * 8);
  pro.qtd = new_sym_var(sizeof(int) * 8);
  pro.idp = idp_at;
  Prod_exis[pro.idp] = pro;
  printf("Novo produto %d.\n", pro.idp);
}

void Adiciona_Stock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp < idp_at)
  {
    Prod_exis[idp].qtd += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }

}

void Cria_Encomenda()
{
  printf("Nova encomenda %d.\n", ide_at);
}

int Encontra_IP(Encomenda E, int idp)
{
  int i;
  for (i = 0; i < E.qtd; i++)
    if (E.enc[i].idp == idp)
  {
    return i;
  }
  else
  {
    
  }


  return -2;
}

void Adiciona_Prod_Enc()
{
  int ide;
  int idp;
  int qtd;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_at)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= idp_at)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if ((Prod_exis[idp].qtd - qtd) < 0)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((Enc_exis[ide].pes + (Prod_exis[idp].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          if (Encontra_IP(Enc_exis[ide], idp) >= 0)
          {
            Enc_exis[ide].enc[Encontra_IP(Enc_exis[ide], idp)].qtd += qtd;
            Prod_exis[idp].qtd -= qtd;
            Enc_exis[ide].pes += Prod_exis[idp].peso * qtd;
          }
          else
          {
            produto p;
            p.idp = Prod_exis[idp].idp;
            strcpy(p.descricao, Prod_exis[idp].descricao);
            p.preco = Prod_exis[idp].preco;
            p.qtd = qtd;
            p.peso = Prod_exis[idp].peso;
            Prod_exis[idp].qtd -= qtd;
            Enc_exis[ide].enc[Enc_exis[ide].qtd] = p;
            Enc_exis[ide].pes += Prod_exis[idp].peso * qtd;
            Enc_exis[ide].qtd++;
          }

        }

      }

    }

  }

}

void Remove_Stock()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_at)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if ((Prod_exis[idp].qtd - qtd) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      Prod_exis[idp].qtd -= qtd;
    }

  }

}

void Remove_PE()
{
  int ide;
  int idp;
  int idpp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_at)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= idp_at)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (Encontra_IP(Enc_exis[ide], idp) >= 0)
      {
        idpp = Encontra_IP(Enc_exis[ide], idp);
        Prod_exis[idp].qtd += Enc_exis[ide].enc[idpp].qtd;
        Enc_exis[ide].pes -= Enc_exis[ide].enc[idpp].qtd * Enc_exis[ide].enc[idpp].peso;
        Enc_exis[ide].enc[idpp].qtd = 0;
      }
      else
      {
        
      }

    }

  }

}

void Custo_E()
{
  int ide;
  int res;
  int i;
  res = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_at)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < Enc_exis[ide].qtd; i++)
      res += Enc_exis[ide].enc[i].preco * Enc_exis[ide].enc[i].qtd;

    printf("Custo da encomenda %d %d.\n", ide, res);
  }

}

void Altera_Preco()
{
  int idp;
  int preco;
  int i;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_at)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    Prod_exis[idp].preco = preco;
    for (i = 0; i < ide_at; i++)
    {
      if (Encontra_IP(Enc_exis[i], idp) >= 0)
      {
        Enc_exis[i].enc[Encontra_IP(Enc_exis[i], idp)].preco = preco;
      }
      else
      {
        
      }

    }

  }

}

void L_descricaoqtd()
{
  int ide;
  int idp;
  int idpe;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_at)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= idp_at)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      if (Encontra_IP(Enc_exis[ide], idp) >= 0)
      {
        idpe = Encontra_IP(Enc_exis[ide], idp);
        printf("%s %d.\n", Enc_exis[ide].enc[idpe].descricao, Enc_exis[ide].enc[idpe].qtd);
      }
      else
      {
        if (Encontra_IP(Enc_exis[ide], idp) == (-2))
        {
          printf("%s %d.\n", Prod_exis[idp].descricao, 0);
        }
        else
        {
          
        }

      }

    }

  }

}

void L_idep()
{
  int idp;
  int i;
  int max = 0;
  int res = -1;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= idp_at)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    for (i = 0; i < ide_at; i++)
      if (Encontra_IP(Enc_exis[i], idp) != (-2))
    {
      if (Enc_exis[i].enc[Encontra_IP(Enc_exis[i], idp)].qtd > max)
      {
        max = Enc_exis[i].enc[Encontra_IP(Enc_exis[i], idp)].qtd;
        res = i;
      }
      else
      {
        if (Enc_exis[i].enc[Encontra_IP(Enc_exis[i], idp)].qtd == max)
        {
          if (i < res)
          {
            res = 1;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

    }
    else
    {
      
    }


    if (res >= 0)
    {
      printf("Maximo produto %d %d %d.\n", idp, res, max);
    }
    else
    {
      
    }

  }

}

int less(produto a, produto v, char o)
{
  if (o == 'l')
  {
    if (a.preco == v.preco)
    {
      return a.idp < v.idp;
    }
    else
    {
      
    }

    return a.preco < v.preco;
  }
  else
  {
    
  }

  if (o == 'L')
  {
    return strcmp(a.descricao, v.descricao) < 0;
  }
  else
  {
    
  }

  return 0;
}

int partition(produto a[], int l, int r, char o)
{
  int i = l - 1;
  int j = r;
  produto v = a[r];
  while (i < j)
  {
    while (less(a[++i], v, o))
      ;

    while (less(v, a[--j], o))
      if (j == l)
    {
      break;
    }
    else
    {
      
    }


    if (i < j)
    {
      produto t = a[i];
      a[i] = a[j];
      a[j] = t;
    }
    else
    {
      
    }

    ;
  }

  {
    produto t = a[i];
    a[i] = a[r];
    a[r] = t;
  }
  ;
  return i;
}

void quicksort(produto a[], int l, int r, char o)
{
  int i;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  i = partition(a, l, r, o);
  quicksort(a, l, i - 1, o);
  quicksort(a, i + 1, r, o);
}

void L_Ppreco()
{
  int i;
  char o = 'l';
  produto copia[10000];
  for (i = 0; i < idp_at; i++)
    copia[i] = Prod_exis[i];

  quicksort(copia, 0, idp_at - 1, o);
  printf("Produtos\n");
  for (i = 0; i < idp_at; i++)
    printf("* %s %d %d\n", copia[i].descricao, copia[i].preco, copia[i].qtd);

}

void L_PED()
{
  int i;
  int j = 0;
  int ide;
  char o = 'L';
  produto copia[10000];
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= ide_at)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < Enc_exis[ide].qtd; i++)
      if (Enc_exis[ide].enc[i].qtd != 0)
    {
      copia[j++] = Enc_exis[ide].enc[i];
    }
    else
    {
      
    }


    quicksort(copia, 0, j - 1, o);
    printf("Encomenda %d\n", ide);
    for (i = 0; i < j; i++)
      printf("* %s %d %d\n", copia[i].descricao, copia[i].preco, copia[i].qtd);

  }

}

int main()
{
  char tecla;
  while (((tecla = getchar()) != 'x') && (tecla != EOF))
  {
    if (tecla != '\n')
    {
      switch (tecla)
      {
        case 'a':
          Adiciona_Produto();
          idp_at++;
          break;

        case 'q':
          Adiciona_Stock();
          break;

        case 'N':
          Cria_Encomenda();
          ide_at++;
          break;

        case 'A':
          Adiciona_Prod_Enc();
          break;

        case 'r':
          Remove_Stock();
          break;

        case 'R':
          Remove_PE();
          break;

        case 'C':
          Custo_E();
          break;

        case 'p':
          Altera_Preco();
          break;

        case 'E':
          L_descricaoqtd();
          break;

        case 'm':
          L_idep();
          break;

        case 'l':
          L_Ppreco();
          break;

        case 'L':
          L_PED();
          break;

      }

    }
    else
    {
      
    }

  }

  return 0;
}

