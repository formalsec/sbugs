/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct produto
{
  char desc[64];
  int idp;
  int preco;
  int peso;
  int qtd;
} Produto;
typedef struct encomendas
{
  Produto produtos[200];
  int ide;
} Encomendas;
Produto prod[10000];
Encomendas encom[500];
int n_atual_prod = 0;
int n_atual_encom = 0;
void reset_encomendas()
{
  int i;
  for (i = 0; i < 500; i++)
  {
    encom[i].ide = 500;
  }

}

int peso_encomenda(int ide)
{
  int i;
  int peso_total = 0;
  for (i = 0; i < 200; i++)
  {
    if (encom[ide].produtos[i].qtd > 0)
    {
      peso_total += encom[ide].produtos[i].qtd * encom[ide].produtos[i].peso;
    }
    else
    {
      
    }

  }

  return peso_total;
}

int num_produto(int ide, int n_produto)
{
  int i;
  int n_produto_temp = 200;
  for (i = 0; i < 200; i++)
  {
    if (encom[ide].produtos[i].idp == n_produto)
    {
      n_produto_temp = i;
      return n_produto_temp;
      break;
    }
    else
    {
      
    }

  }

  if (n_produto_temp == 200)
  {
    for (i = 0; i < 200; i++)
    {
      if (encom[ide].produtos[i].qtd == 0)
      {
        n_produto_temp = i;
        return n_produto_temp;
        break;
      }
      else
      {
        
      }

    }

  }
  else
  {
    
  }

  return n_produto_temp;
}

int qtd_encomenda(int ide, int idp)
{
  int n_produto = num_produto(ide, idp);
  return encom[ide].produtos[n_produto].qtd;
}

int qtd_sistema(int idp)
{
  int i;
  long quantidade = prod[idp].qtd;
  for (i = 0; i < 500; i++)
  {
    quantidade += qtd_encomenda(i, idp);
  }

  return quantidade;
}

void adiciona_produto()
{
  char descricao_p[64];
  int preco_p;
  int peso_p;
  int qtd_p;
  for (int descricao_p_index = 0; descricao_p_index < 10; descricao_p_index++)
  {
    descricao_p[descricao_p_index] = new_sym_var(sizeof(char) * 8);
  }

  descricao_p[10 - 1] = '\0';
  preco_p = new_sym_var(sizeof(int) * 8);
  peso_p = new_sym_var(sizeof(int) * 8);
  qtd_p = new_sym_var(sizeof(int) * 8);
  if (n_atual_prod < 10000)
  {
    strcpy(prod[n_atual_prod].desc, descricao_p);
    prod[n_atual_prod].idp = n_atual_prod;
    prod[n_atual_prod].preco = preco_p;
    prod[n_atual_prod].peso = peso_p;
    prod[n_atual_prod].qtd = qtd_p;
    printf("Novo produto %d.\n", n_atual_prod);
    n_atual_prod++;
  }
  else
  {
    
  }

}

void adiciona_stock()
{
  int n_produto;
  int add;
  n_produto = new_sym_var(sizeof(int) * 8);
  add = new_sym_var(sizeof(int) * 8);
  if (prod[n_produto].preco == 0)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", n_produto);
  }
  else
  {
    prod[n_produto].qtd += add;
  }

}

void adiciona_encomenda()
{
  if (n_atual_encom < 500)
  {
    encom[n_atual_encom].ide = n_atual_encom;
    printf("Nova encomenda %d.\n", n_atual_encom);
    n_atual_encom++;
  }
  else
  {
    
  }

}

void adiciona_produto_encomenda()
{
  int n_produto;
  int n_encomenda;
  int quantidade;
  int n_produto_mod;
  int peso_produto;
  n_encomenda = new_sym_var(sizeof(int) * 8);
  n_produto = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  n_produto_mod = num_produto(n_encomenda, n_produto);
  if (encom[n_encomenda].ide == 500)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", n_produto, n_encomenda);
  }
  else
  {
    if (prod[n_produto].preco == 0)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", n_produto, n_encomenda);
    }
    else
    {
      if (prod[n_produto].qtd < quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", n_produto, n_encomenda);
      }
      else
      {
        peso_produto = quantidade * prod[n_produto].peso;
        if ((peso_encomenda(n_encomenda) + peso_produto) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", n_produto, n_encomenda);
        }
        else
        {
          if (encom[n_encomenda].produtos[n_produto_mod].qtd == 0)
          {
            strcpy(encom[n_encomenda].produtos[n_produto_mod].desc, prod[n_produto].desc);
            encom[n_encomenda].produtos[n_produto_mod].idp = prod[n_produto].idp;
            encom[n_encomenda].produtos[n_produto_mod].peso = prod[n_produto].peso;
            encom[n_encomenda].produtos[n_produto_mod].preco = prod[n_produto].preco;
            encom[n_encomenda].produtos[n_produto_mod].qtd += quantidade;
            prod[n_produto].qtd -= quantidade;
          }
          else
          {
            encom[n_encomenda].produtos[n_produto_mod].qtd += quantidade;
            prod[n_produto].qtd -= quantidade;
          }

        }

      }

    }

  }

}

void remove_stock()
{
  int n_produto;
  int remove;
  n_produto = new_sym_var(sizeof(int) * 8);
  remove = new_sym_var(sizeof(int) * 8);
  if (prod[n_produto].preco == 0)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", n_produto);
  }
  else
  {
    if (prod[n_produto].qtd < remove)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", remove, n_produto);
    }
    else
    {
      prod[n_produto].qtd -= remove;
    }

  }

}

void remove_produto_encomenda()
{
  int n_encomenda;
  int n_produto;
  int n_produto_mod;
  n_encomenda = new_sym_var(sizeof(int) * 8);
  n_produto = new_sym_var(sizeof(int) * 8);
  n_produto_mod = num_produto(n_encomenda, n_produto);
  if (encom[n_encomenda].ide == 500)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", n_produto, n_encomenda);
  }
  else
  {
    if (prod[n_produto].preco == 0)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", n_produto, n_encomenda);
    }
    else
    {
      if (n_produto_mod < 200)
      {
        prod[n_produto].qtd += encom[n_encomenda].produtos[n_produto_mod].qtd;
        encom[n_encomenda].produtos[n_produto_mod].qtd = 0;
      }
      else
      {
        
      }

    }

  }

}

void custo_encomenda()
{
  int n_encomenda;
  int i;
  long custo = 0;
  n_encomenda = new_sym_var(sizeof(int) * 8);
  if (encom[n_encomenda].ide == 500)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", n_encomenda);
  }
  else
  {
    for (i = 0; i < 200; i++)
    {
      if (encom[n_encomenda].produtos[i].qtd > 0)
      {
        custo += encom[n_encomenda].produtos[i].qtd * encom[n_encomenda].produtos[i].preco;
      }
      else
      {
        
      }

    }

    printf("Custo da encomenda %d %ld.\n", n_encomenda, custo);
  }

}

void altera_preco()
{
  int n_produto;
  int novo_preco;
  int i;
  int j;
  n_produto = new_sym_var(sizeof(int) * 8);
  novo_preco = new_sym_var(sizeof(int) * 8);
  if (prod[n_produto].preco == 0)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", n_produto);
  }
  else
  {
    prod[n_produto].preco = novo_preco;
    for (i = 0; i < 500; i++)
    {
      for (j = 0; j < 200; j++)
      {
        if (encom[i].ide != 500)
        {
          if ((encom[i].produtos[j].qtd > 0) && (encom[i].produtos[j].idp == n_produto))
          {
            encom[i].produtos[j].preco = novo_preco;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

    }

  }

}

void desc_qtd_encom()
{
  int n_encomenda;
  int n_produto;
  int n_produto_mod;
  n_encomenda = new_sym_var(sizeof(int) * 8);
  n_produto = new_sym_var(sizeof(int) * 8);
  n_produto_mod = num_produto(n_encomenda, n_produto);
  if (encom[n_encomenda].ide == 500)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", n_encomenda);
  }
  else
  {
    if (prod[n_produto].preco == 0)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", n_produto);
    }
    else
    {
      printf("%s %d.\n", prod[n_produto].desc, encom[n_encomenda].produtos[n_produto_mod].qtd);
    }

  }

}

void mais_vezes()
{
  int n_produto;
  int i;
  int j;
  int max = 0;
  int encom_max = 500;
  n_produto = new_sym_var(sizeof(int) * 8);
  if (prod[n_produto].preco == 0)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", n_produto);
  }
  else
  {
    for (i = 0; i < 500; i++)
    {
      for (j = 0; j < 200; j++)
      {
        if (encom[i].produtos[j].idp == n_produto)
        {
          if (encom[i].produtos[j].qtd > max)
          {
            max = encom[i].produtos[j].qtd;
            encom_max = encom[i].ide;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

    }

    if (encom_max != 500)
    {
      printf("Maximo produto %d %d %d.\n", n_produto, encom_max, encom[encom_max].produtos[num_produto(encom_max, n_produto)].qtd);
    }
    else
    {
      
    }

  }

}

void preco_crescente()
{
  int i;
  int key;
  int j;
  int vet_precos[10000];
  int vet_qtd[10000];
  for (i = 0; i < n_atual_prod; i++)
  {
    vet_precos[i] = prod[i].preco;
    vet_qtd[i] = prod[i].qtd;
  }

  for (i = 1; i < n_atual_prod; i++)
  {
    key = vet_precos[i];
    j = i - 1;
    while ((j >= 0) && (vet_precos[j] > key))
    {
      vet_precos[j + 1] = vet_precos[j];
      j = j - 1;
    }

    vet_precos[j + 1] = key;
  }

  printf("Produtos\n");
  for (i = 0; i < n_atual_prod; i++)
  {
    for (j = 0; j < n_atual_prod; j++)
    {
      if ((prod[j].preco == vet_precos[i]) && (prod[j].qtd != 0))
      {
        printf("* %s %d %d.\n", prod[j].desc, prod[j].preco, prod[j].qtd);
        prod[j].qtd = 0;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < n_atual_prod; i++)
  {
    prod[i].qtd = vet_qtd[i];
  }

}

void ordem_alfabetica()
{
  int n_encomenda;
  int n_atual_vec = 0;
  int i;
  int j;
  char temp[64];
  char strings[200][64];
  int vet_pesos[200];
  n_encomenda = new_sym_var(sizeof(int) * 8);
  if (encom[n_encomenda].ide == 500)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", n_encomenda);
  }
  else
  {
    for (i = 0; i < 200; i++)
    {
      if (encom[n_encomenda].produtos[i].qtd != 0)
      {
        strcpy(strings[n_atual_vec], encom[n_encomenda].produtos[i].desc);
        vet_pesos[n_atual_vec] = encom[n_encomenda].produtos[i].peso;
        n_atual_vec++;
      }
      else
      {
        
      }

    }

    for (i = 0; i < (n_atual_vec - 1); i++)
    {
      for (j = 0; j < (n_atual_vec - 1); j++)
      {
        if (strcmp(strings[j], strings[j + 1]) > 0)
        {
          strcpy(temp, strings[j]);
          strcpy(strings[j], strings[j + 1]);
          strcpy(strings[j + 1], temp);
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", n_encomenda);
    if (vet_pesos[0] != 0)
    {
      for (i = 0; i < n_atual_vec; i++)
      {
        for (j = 0; j < n_atual_prod; j++)
        {
          if ((strcmp(prod[j].desc, strings[i]) == 0) && (prod[j].peso != 0))
          {
            printf("* %s %d %d\n", prod[j].desc, prod[j].preco, qtd_encomenda(n_encomenda, prod[j].idp));
            vet_pesos[j] = prod[j].peso;
            prod[j].peso = 0;
          }
          else
          {
            
          }

        }

      }

      for (j = 0; j < n_atual_prod; j++)
      {
        prod[j].peso = vet_pesos[j];
      }

    }
    else
    {
      
    }

  }

}

int main()
{
  char c;
  reset_encomendas();
  while ((c = getchar()) != 'x')
  {
    switch (c)
    {
      case 'a':
        adiciona_produto();
        break;

      case 'q':
        adiciona_stock();
        break;

      case 'N':
        adiciona_encomenda();
        break;

      case 'A':
        adiciona_produto_encomenda();
        break;

      case 'r':
        remove_stock();
        break;

      case 'R':
        remove_produto_encomenda();
        break;

      case 'C':
        custo_encomenda();
        break;

      case 'p':
        altera_preco();
        break;

      case 'E':
        desc_qtd_encom();
        break;

      case 'm':
        mais_vezes();
        break;

      case 'l':
        preco_crescente();
        break;

      case 'L':
        ordem_alfabetica();
        break;

    }

  }

  return 0;
}

