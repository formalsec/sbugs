#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct 
{
  int id;
  char nome[63];
  int preco;
  int peso;
  int qtd;
} Produto;
typedef struct 
{
  Produto produtos[200];
  int np;
} Encomenda;
Produto produtos[10000];
Encomenda encomendas[500];
int prod_atual = 0;
int encom_atual = 0;
void a()
{
  for (int produtos_index = 0; produtos_index < 10; produtos_index++)
  {
    produtos[prod_atual].nome[produtos_index] = new_sym_var(sizeof(char) * 8);
  }

  produtos[prod_atual].nome[10 - 1] = '\0';
  produtos[prod_atual].preco = new_sym_var(sizeof(int) * 8);
  produtos[prod_atual].peso = new_sym_var(sizeof(int) * 8);
  produtos[prod_atual].qtd = new_sym_var(sizeof(int) * 8);
  produtos[prod_atual].id = prod_atual;
  printf("Novo produto %d.\n", prod_atual++);
}

void q()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= prod_atual)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    produtos[idp].qtd += qtd;
  }

}

void N()
{
  printf("Nova encomenda %d.\n", encom_atual++);
}

void A()
{
  int ide;
  int idp;
  int qtd;
  int i;
  int peso;
  int idpe = -1;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  peso = produtos[idp].peso * qtd;
  for (i = 0; i < encomendas[ide].np; i++)
  {
    peso += encomendas[ide].produtos[i].peso * encomendas[ide].produtos[i].qtd;
    if (encomendas[ide].produtos[i].id == idp)
    {
      idpe = i;
    }
    else
    {
      
    }

  }

  if (ide >= encom_atual)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= prod_atual)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (qtd > produtos[idp].qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if (peso > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          if (idpe != (-1))
          {
            encomendas[ide].produtos[idpe].qtd += qtd;
            produtos[idp].qtd -= qtd;
          }
          else
          {
            encomendas[ide].produtos[encomendas[ide].np] = produtos[idp];
            encomendas[ide].produtos[encomendas[ide].np].qtd = qtd;
            encomendas[ide].np++;
            produtos[idp].qtd -= qtd;
          }

        }

      }

    }

  }

}

void r()
{
  int idp;
  int qtd;
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= prod_atual)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (qtd > produtos[idp].qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      produtos[idp].qtd -= qtd;
    }

  }

}

void R()
{
  int i;
  int ide;
  int idp;
  int idpe = -1;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= encom_atual)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= prod_atual)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      for (i = 0; i < encomendas[ide].np; i++)
        if (encomendas[ide].produtos[i].id == idp)
      {
        idpe = i;
      }
      else
      {
        
      }


      if (idpe != (-1))
      {
        produtos[idp].qtd += encomendas[ide].produtos[idpe].qtd;
        encomendas[ide].produtos[idpe].qtd = 0;
      }
      else
      {
        
      }

    }

  }

}

void C()
{
  int i;
  int ide;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= encom_atual)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < encomendas[ide].np; i++)
      custo += encomendas[ide].produtos[i].qtd * encomendas[ide].produtos[i].preco;

    printf("Custo da encomenda %d %d.\n", ide, custo);
  }

}

void p()
{
  int i;
  int j;
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= prod_atual)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    produtos[idp].preco = preco;
    for (i = 0; i < encom_atual; i++)
      for (j = 0; j < encomendas[i].np; j++)
      if (encomendas[i].produtos[j].id == idp)
    {
      encomendas[i].produtos[j].preco = preco;
    }
    else
    {
      
    }



  }

}

void E()
{
  int i;
  int ide;
  int idp;
  int idpe = -1;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= encom_atual)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= prod_atual)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      for (i = 0; i < encomendas[ide].np; i++)
        if (encomendas[ide].produtos[i].id == idp)
      {
        idpe = i;
      }
      else
      {
        
      }


      if (idpe != (-1))
      {
        printf("%s %d.\n", produtos[idp].nome, encomendas[ide].produtos[idpe].qtd);
      }
      else
      {
        printf("%s 0.\n", produtos[idp].nome);
      }

    }

  }

}

void m()
{
  int i;
  int j;
  int idp;
  int ide;
  int qtd = 0;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= prod_atual)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    for (i = 0; i < encom_atual; i++)
      for (j = 0; j < encomendas[i].np; j++)
      if ((encomendas[i].produtos[j].id == idp) && (encomendas[i].produtos[j].qtd > qtd))
    {
      qtd = encomendas[i].produtos[j].qtd;
      ide = i;
    }
    else
    {
      
    }



    if (qtd)
    {
      printf("Maximo produto %d %d %d.\n", idp, ide, qtd);
    }
    else
    {
      
    }

  }

}

int cmppreco(Produto prod1, Produto prod2)
{
  return (prod1.preco != prod2.preco) ? (prod1.preco < prod2.preco) : (prod1.id < prod2.id);
}

int cmpdesc(Produto prod1, Produto prod2)
{
  return strcmp(prod1.nome, prod2.nome) < 0;
}

void quicksort(Produto lista[], int l, int r, int (*cmp)())
{
  int i = l - 1;
  int j = r;
  Produto v = lista[r];
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  while (i < j)
  {
    while (cmp(lista[++i], v))
      ;

    while (cmp(v, lista[--j]))
    {
      if (j == l)
      {
        break;
      }
      else
      {
        
      }

    }

    if (i < j)
    {
      Produto t = lista[i];
      lista[i] = lista[j];
      lista[j] = t;
    }
    else
    {
      
    }

    ;
  }

  {
    Produto t = lista[i];
    lista[i] = lista[r];
    lista[r] = t;
  }
  ;
  quicksort(lista, l, i - 1, cmp);
  quicksort(lista, i + 1, r, cmp);
}

void l()
{
  Produto lista[10000];
  int i;
  for (i = 0; i < prod_atual; i++)
    lista[i] = produtos[i];

  quicksort(lista, 0, prod_atual - 1, cmppreco);
  printf("Produtos\n");
  for (i = 0; i < prod_atual; i++)
    printf("* %s %d %d\n", lista[i].nome, lista[i].preco, lista[i].qtd);

}

void L()
{
  int ide;
  int i;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= encom_atual)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    quicksort(encomendas[ide].produtos, 0, encomendas[ide].np - 1, cmpdesc);
    printf("Encomenda %d\n", ide);
    for (i = 0; i < encomendas[ide].np; i++)
      if (encomendas[ide].produtos[i].qtd > 0)
    {
      printf("* %s %d %d\n", encomendas[ide].produtos[i].nome, encomendas[ide].produtos[i].preco, encomendas[ide].produtos[i].qtd);
    }
    else
    {
      
    }


  }

}

int main()
{
  char cmdo;
  while (1)
  {
    cmdo = new_sym_var(sizeof(char) * 8);
    switch (cmdo)
    {
      case 'a':
        a();
        break;

      case 'q':
        q();
        break;

      case 'N':
        N();
        break;

      case 'A':
        A();
        break;

      case 'r':
        r();
        break;

      case 'R':
        R();
        break;

      case 'C':
        C();
        break;

      case 'p':
        p();
        break;

      case 'E':
        E();
        break;

      case 'm':
        m();
        break;

      case 'l':
        l();
        break;

      case 'L':
        L();
        break;

      case 'x':
        goto sair;
        break;

    }

  }

  sair:
  return 0;

}

