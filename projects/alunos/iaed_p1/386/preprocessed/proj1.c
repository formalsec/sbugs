/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int identificador;
  char descricao[64];
  int preco;
  int peso;
  int quantidade;
} Produto;
typedef struct encomenda
{
  Produto produto[200];
  int prod_ids[200];
} Encomenda;
int id_prod = 0;
int id_enco = 0;
int sair = 0;
int inicio = 0;
Produto stockloja[10000];
Encomenda encomendas[500];
int lista_de_ids[10000];
void AdicionarProduto()
{
  char descricao[64];
  int preco = 0;
  int peso = 0;
  int qtd = 0;
  getchar();
  for (int descricao_index = 0; descricao_index < 10; descricao_index++)
  {
    descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
  }

  descricao[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  strcpy(stockloja[id_prod].descricao, descricao);
  stockloja[id_prod].identificador = id_prod;
  stockloja[id_prod].preco = preco;
  stockloja[id_prod].peso = peso;
  stockloja[id_prod].quantidade = qtd;
  printf("Novo produto %d.\n", id_prod);
  id_prod++;
  if (id_prod == 0)
  {
    inicio = 1;
  }
  else
  {
    
  }

}

void AdicionarStock()
{
  int nova_qtd = 0;
  int id_do_prod = 0;
  getchar();
  id_do_prod = new_sym_var(sizeof(int) * 8);
  nova_qtd = new_sym_var(sizeof(int) * 8);
  if (id_do_prod >= id_prod)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", id_do_prod);
    return;
  }
  else
  {
    stockloja[id_do_prod].quantidade += nova_qtd;
  }

}

void CriaEncomenda()
{
  printf("Nova encomenda %d.\n", id_enco);
  id_enco++;
}

int VerificaPeso(int id_e, int Quantidade, int id_p)
{
  int peso = 0;
  int peso_novo = 0;
  int cont;
  for (cont = 0; cont < 200; cont++)
  {
    peso += encomendas[id_e].produto[cont].peso * encomendas[id_e].produto[cont].quantidade;
  }

  peso_novo = Quantidade * stockloja[id_p].peso;
  if ((peso + peso_novo) > 200)
  {
    return 0;
  }
  else
  {
    
  }

  return 1;
}

void AdicionaEncomenda()
{
  int id_e;
  int id_p;
  int qtd;
  int k;
  int j;
  int local;
  getchar();
  id_e = new_sym_var(sizeof(int) * 8);
  id_p = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  local = id_p + 1;
  if (id_e >= id_enco)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", id_p, id_e);
    return;
  }
  else
  {
    if ((id_p >= id_prod) && (inicio == 0))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", id_p, id_e);
      return;
    }
    else
    {
      if (qtd > stockloja[id_p].quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", id_p, id_e);
        return;
      }
      else
      {
        if (!VerificaPeso(id_e, qtd, id_p))
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", id_p, id_e);
          return;
        }
        else
        {
          for (j = 0; j < 200; j++)
          {
            if (encomendas[id_e].prod_ids[j] == local)
            {
              encomendas[id_e].produto[j].quantidade += qtd;
              stockloja[id_p].quantidade -= qtd;
              return;
            }
            else
            {
              
            }

          }

          for (k = 0; k < 200; k++)
          {
            if (encomendas[id_e].prod_ids[k] == 0)
            {
              encomendas[id_e].prod_ids[k] = id_p + 1;
              encomendas[id_e].produto[k] = stockloja[id_p];
              encomendas[id_e].produto[k].quantidade = qtd;
              stockloja[id_p].quantidade -= qtd;
              return;
            }
            else
            {
              
            }

          }

        }

      }

    }

  }

}

void RemoveStock()
{
  int id_p;
  int qtd;
  getchar();
  id_p = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (id_p >= id_prod)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", id_p);
    return;
  }
  else
  {
    if (stockloja[id_p].quantidade < qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, id_p);
      return;
    }
    else
    {
      stockloja[id_p].quantidade -= qtd;
    }

  }

}

void RemoverDaEncomenda()
{
  int id_e;
  int id_p;
  int k;
  int local;
  getchar();
  id_e = new_sym_var(sizeof(int) * 8);
  id_p = new_sym_var(sizeof(int) * 8);
  local = id_p + 1;
  if (id_e >= id_enco)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", id_p, id_e);
    return;
  }
  else
  {
    if (id_p >= id_prod)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", id_p, id_e);
      return;
    }
    else
    {
      for (k = 0; k < 200; k++)
      {
        if (encomendas[id_e].prod_ids[k] == local)
        {
          stockloja[id_p].quantidade += encomendas[id_e].produto[k].quantidade;
          encomendas[id_e].produto[k].quantidade = 0;
          strcpy(encomendas[id_e].produto[k].descricao, "");
          encomendas[id_e].produto[k].peso = 0;
          encomendas[id_e].produto[k].preco = 0;
          encomendas[id_e].produto[k].identificador = 0;
          encomendas[id_e].prod_ids[k] = 0;
          return;
        }
        else
        {
          
        }

      }

    }

  }

}

void CalculaCusto()
{
  int id_e;
  int k;
  int total = 0;
  getchar();
  id_e = new_sym_var(sizeof(int) * 8);
  if (id_e >= id_enco)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", id_e);
    return;
  }
  else
  {
    for (k = 0; k < 200; k++)
    {
      total += encomendas[id_e].produto[k].preco * encomendas[id_e].produto[k].quantidade;
    }

    printf("Custo da encomenda %d %d.\n", id_e, total);
  }

}

void AlteraPreco()
{
  int id_p;
  int preco_novo;
  int k;
  int local;
  int j;
  getchar();
  id_p = new_sym_var(sizeof(int) * 8);
  preco_novo = new_sym_var(sizeof(int) * 8);
  local = id_p + 1;
  if (id_p >= id_prod)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", id_p);
    return;
  }
  else
  {
    stockloja[id_p].preco = preco_novo;
    for (k = 0; k < 500; k++)
    {
      for (j = 0; j < 200; j++)
      {
        if (encomendas[k].prod_ids[j] == local)
        {
          encomendas[k].produto[j].preco = preco_novo;
        }
        else
        {
          
        }

      }

    }

  }

}

void ListarQuantidade()
{
  int id_e;
  int id_p;
  int k;
  int local;
  getchar();
  id_e = new_sym_var(sizeof(int) * 8);
  id_p = new_sym_var(sizeof(int) * 8);
  local = id_p + 1;
  if (id_e >= id_enco)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id_e);
    return;
  }
  else
  {
    if (id_p >= id_prod)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", id_p);
      return;
    }
    else
    {
      for (k = 0; k < 200; k++)
      {
        if (encomendas[id_e].prod_ids[k] == local)
        {
          printf("%s %d.\n", stockloja[id_p].descricao, encomendas[id_e].produto[k].quantidade);
          return;
        }
        else
        {
          
        }

      }

      printf("%s 0.\n", stockloja[id_p].descricao);
    }

  }

}

void ListaMaiorFrequencia()
{
  int id_p;
  int k;
  int j;
  int local;
  int maior = 0;
  int lista[500];
  int ultima_enc = 0;
  int l;
  getchar();
  memset(lista, 0, id_enco * (sizeof(lista[0])));
  id_p = new_sym_var(sizeof(int) * 8);
  local = id_p + 1;
  if (id_p >= id_prod)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", id_p);
    return;
  }
  else
  {
    if (id_enco == 0)
    {
      return;
    }
    else
    {
      
    }

    for (k = 0; k < id_enco; k++)
    {
      for (j = 0; j < 200; j++)
      {
        if (encomendas[k].prod_ids[j] == local)
        {
          lista[k] = encomendas[k].produto[j].quantidade;
        }
        else
        {
          
        }

      }

    }

    for (l = 0; l < id_enco; l++)
    {
      if (lista[l] > maior)
      {
        ultima_enc = l;
        maior = lista[l];
      }
      else
      {
        
      }

    }

    if (maior != 0)
    {
      printf("Maximo produto %d %d %d.\n", id_p, ultima_enc, maior);
    }
    else
    {
      
    }

  }

}

void OrdenarProdutosMerge(int inicio_m, int fim)
{
  int meio = (inicio_m + fim) / 2;
  int atual;
  int i;
  int interno1 = inicio_m;
  int interno2 = meio + 1;
  int lista_aux[10000];
  if (inicio_m == fim)
  {
    return;
  }
  else
  {
    
  }

  OrdenarProdutosMerge(inicio_m, meio);
  OrdenarProdutosMerge(meio + 1, fim);
  for (i = inicio_m; i <= fim; i++)
  {
    lista_aux[i] = lista_de_ids[i];
  }

  for (atual = inicio_m; atual <= fim; atual++)
  {
    if (interno1 == (meio + 1))
    {
      lista_de_ids[atual] = lista_aux[interno2++];
    }
    else
    {
      if (interno2 > fim)
      {
        lista_de_ids[atual] = lista_aux[interno1++];
      }
      else
      {
        if (stockloja[lista_aux[interno1]].preco <= stockloja[lista_aux[interno2]].preco)
        {
          lista_de_ids[atual] = lista_aux[interno1++];
        }
        else
        {
          lista_de_ids[atual] = lista_aux[interno2++];
        }

      }

    }

  }

}

void ListarStock()
{
  int k;
  int j;
  for (k = 0; k < id_prod; k++)
  {
    lista_de_ids[k] = stockloja[k].identificador;
  }

  printf("Produtos\n");
  if (id_prod == 1)
  {
    printf("* %s %d %d\n", stockloja[0].descricao, stockloja[0].preco, stockloja[0].quantidade);
    return;
  }
  else
  {
    if (id_prod > 1)
    {
      OrdenarProdutosMerge(0, id_prod - 1);
      for (j = 0; j < id_prod; j++)
      {
        printf("* %s %d %d\n", stockloja[lista_de_ids[j]].descricao, stockloja[lista_de_ids[j]].preco, stockloja[lista_de_ids[j]].quantidade);
      }

    }
    else
    {
      
    }

  }

}

void ListarEncomenda()
{
  int id_e;
  int j;
  int i;
  int h;
  int k;
  int g;
  int max = 0;
  int lista_de_id[200];
  int aux;
  int enc_zero = 0;
  char desc_aux[64][200];
  char temp[64];
  getchar();
  id_e = new_sym_var(sizeof(int) * 8);
  if (id_enco <= id_e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", id_e);
    return;
  }
  else
  {
    for (k = 0; k < 200; k++)
    {
      if (encomendas[id_e].prod_ids[k] != 0)
      {
        lista_de_id[max] = k;
        strcpy(desc_aux[max], encomendas[id_e].produto[k].descricao);
        max++;
        i = k;
      }
      else
      {
        enc_zero++;
      }

    }

    printf("Encomenda %d\n", id_e);
    if (enc_zero == 200)
    {
      return;
    }
    else
    {
      
    }

    if (max == 1)
    {
      printf("* %s %d %d\n", encomendas[id_e].produto[i].descricao, encomendas[id_e].produto[i].preco, encomendas[id_e].produto[i].quantidade);
      return;
    }
    else
    {
      
    }

    for (h = 0; h < (max - 1); h++)
    {
      for (j = 1; j < max; j++)
      {
        if (strcmp(desc_aux[j - 1], desc_aux[j]) > 0)
        {
          strcpy(temp, desc_aux[j - 1]);
          aux = lista_de_id[j - 1];
          strcpy(desc_aux[j - 1], desc_aux[j]);
          lista_de_id[j - 1] = lista_de_id[j];
          strcpy(desc_aux[j], temp);
          lista_de_id[j] = aux;
        }
        else
        {
          
        }

      }

    }

    for (g = 0; g < max; g++)
    {
      if (encomendas[id_e].produto[lista_de_id[g]].preco != 0)
      {
        printf("* %s %d %d\n", encomendas[id_e].produto[lista_de_id[g]].descricao, encomendas[id_e].produto[lista_de_id[g]].preco, encomendas[id_e].produto[lista_de_id[g]].quantidade);
      }
      else
      {
        
      }

    }

  }

}

void Comando()
{
  char comando;
  comando = getchar();
  switch (comando)
  {
    case 'a':
      AdicionarProduto();
      break;

    case 'q':
      AdicionarStock();
      break;

    case 'N':
      CriaEncomenda();
      break;

    case 'A':
      AdicionaEncomenda();
      break;

    case 'r':
      RemoveStock();
      break;

    case 'R':
      RemoverDaEncomenda();
      break;

    case 'C':
      CalculaCusto();
      break;

    case 'p':
      AlteraPreco();
      break;

    case 'E':
      ListarQuantidade();
      break;

    case 'm':
      ListaMaiorFrequencia();
      break;

    case 'l':
      ListarStock();
      break;

    case 'L':
      ListarEncomenda();
      break;

    case 'x':
      sair = 1;
      break;

  }

}

int main()
{
  while (1)
  {
    Comando();
    if (sair)
    {
      break;
    }
    else
    {
      
    }

  }

  return 0;
}

