#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


struct produto
{
  int id;
  char descricao[64];
  int preco;
  int peso;
  int stock;
};
struct produto prod[10000];
struct encomenda
{
  int id;
  struct produto prod[200];
};
struct encomenda enc[500];
void init()
{
  int i;
  int idx;
  for (i = 0; i < 10000; i++)
  {
    prod[i].id = -1;
  }

  for (i = 0; i < 500; i++)
  {
    enc[i].id = -1;
    for (idx = 0; idx < 200; idx++)
    {
      enc[i].prod[idx].id = -1;
    }

  }

}

void run_a(char descricao[], int preco, int peso, int qtd)
{
  int i;
  for (i = 0; i < 10000; i++)
  {
    if (prod[i].id == (-1))
    {
      prod[i].id = i;
      strcpy(prod[i].descricao, descricao);
      prod[i].preco = preco;
      prod[i].peso = peso;
      prod[i].stock = qtd;
      printf("Novo produto %d.\n", prod[i].id);
      break;
    }
    else
    {
      
    }

  }

}

void run_q(int idp, int qtd)
{
  if (prod[idp].id == (-1))
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  prod[idp].stock += qtd;
}

void run_N()
{
  int i;
  for (i = 0; i < 500; i++)
  {
    if (enc[i].id == (-1))
    {
      enc[i].id = i;
      printf("Nova encomenda %d.\n", i);
      break;
    }
    else
    {
      
    }

  }

}

void run_A(int ide, int idp, int qtd)
{
  int i;
  int peso = 0;
  for (i = 0; i < 200; i++)
  {
    if (enc[ide].prod[i].id != (-1))
    {
      peso += enc[ide].prod[i].peso * enc[ide].prod[i].stock;
    }
    else
    {
      
    }

  }

  if (enc[ide].id != ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  if (prod[idp].id != idp)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  if (prod[idp].stock < qtd)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  if (((prod[idp].peso * qtd) + peso) > 200)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (enc[ide].prod[i].id == prod[idp].id)
    {
      enc[ide].prod[i].stock += qtd;
      prod[idp].stock -= qtd;
      return;
    }
    else
    {
      
    }

    if (enc[ide].prod[i].id == (-1))
    {
      enc[ide].prod[i].id = idp;
      strcpy(enc[ide].prod[i].descricao, prod[idp].descricao);
      enc[ide].prod[i].preco = prod[idp].preco;
      enc[ide].prod[i].peso = prod[idp].peso;
      enc[ide].prod[i].stock = qtd;
      prod[idp].stock -= qtd;
      break;
    }
    else
    {
      
    }

  }

}

void run_r(int idp, int qtd)
{
  if (prod[idp].id == (-1))
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  if (prod[idp].stock < qtd)
  {
    printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    return;
  }
  else
  {
    
  }

  prod[idp].stock -= qtd;
}

void run_R(int ide, int idp)
{
  int i;
  int idx;
  if (enc[ide].id == (-1))
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  if (prod[idp].id == (-1))
  {
    printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (enc[ide].prod[i].id == idp)
    {
      prod[idp].stock += enc[ide].prod[i].stock;
      for (idx = i; idx < 200; idx++)
      {
        enc[ide].prod[idx].id = enc[ide].prod[idx + 1].id;
        strcpy(enc[ide].prod[idx].descricao, enc[ide].prod[idx + 1].descricao);
        enc[ide].prod[idx].preco = enc[ide].prod[idx + 1].preco;
        enc[ide].prod[idx].peso = enc[ide].prod[idx + 1].peso;
        enc[ide].prod[idx].stock = enc[ide].prod[idx + 1].stock;
      }

      enc[ide].prod[200 - 1].id = -1;
      strcpy(enc[ide].prod[200 - 1].descricao, "");
      enc[ide].prod[200 - 1].preco = 0;
      enc[ide].prod[200 - 1].peso = 0;
      enc[ide].prod[200 - 1].stock = 0;
      break;
    }
    else
    {
      
    }

  }

}

void run_C(int ide)
{
  int i;
  int total = 0;
  if (enc[ide].id == (-1))
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    total += enc[ide].prod[i].preco * enc[ide].prod[i].stock;
  }

  printf("Custo da encomenda %d %d.\n", ide, total);
}

void run_p(int idp, int preco)
{
  int i;
  int idx;
  if (prod[idp].id == (-1))
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  prod[idp].preco = preco;
  for (i = 0; i < 500; i++)
  {
    for (idx = 0; idx < 200; idx++)
    {
      if (enc[i].prod[idx].id == prod[idp].id)
      {
        enc[i].prod[idx].preco = preco;
        break;
      }
      else
      {
        
      }

    }

  }

}

void run_E(int ide, int idp)
{
  int i;
  if (enc[ide].id == (-1))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  if (prod[idp].id == (-1))
  {
    printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    if (enc[ide].prod[i].id == prod[idp].id)
    {
      printf("%s %d.\n", prod[idp].descricao, enc[ide].prod[i].stock);
      break;
    }
    else
    {
      
    }

  }

}

void run_m(int idp)
{
  int i;
  int idx;
  int ide;
  int maior = 0;
  if (prod[idp].id == (-1))
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 500; i++)
  {
    for (idx = 0; idx < 200; idx++)
    {
      if (enc[i].prod[idx].id == prod[idp].id)
      {
        if (enc[i].prod[idx].stock > maior)
        {
          maior = enc[i].prod[idx].stock;
          ide = enc[i].id;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  if (maior == 0)
  {
    return;
  }
  else
  {
    
  }

  printf("Maximo produto %d %d %d.\n", idp, ide, maior);
}

void run_l()
{
  int i;
  int idx;
  char descrAux[64];
  int idAux;
  int precoAux;
  int qtdAux;
  struct produto ord[10000];
  for (i = 0; i < 10000; i++)
  {
    ord[i].id = prod[i].id;
    strcpy(ord[i].descricao, prod[i].descricao);
    ord[i].preco = prod[i].preco;
    ord[i].stock = prod[i].stock;
  }

  for (i = 1; i < 10000; i++)
  {
    idAux = ord[i].id;
    strcpy(descrAux, ord[i].descricao);
    precoAux = ord[i].preco;
    qtdAux = ord[i].stock;
    for (idx = i - 1; idx >= 0; idx--)
    {
      if ((precoAux >= ord[idx].preco) && (ord[idx].id != (-1)))
      {
        break;
      }
      else
      {
        
      }

      ord[idx + 1].id = ord[idx].id;
      strcpy(ord[idx + 1].descricao, ord[idx].descricao);
      ord[idx + 1].preco = ord[idx].preco;
      ord[idx + 1].stock = ord[idx].stock;
    }

    ord[idx + 1].id = idAux;
    strcpy(ord[idx + 1].descricao, descrAux);
    ord[idx + 1].preco = precoAux;
    ord[idx + 1].stock = qtdAux;
  }

  printf("Produtos\n");
  for (i = 0; i < 10000; i++)
  {
    if (ord[i].id != (-1))
    {
      printf("* %s %d %d\n", ord[i].descricao, ord[i].preco, ord[i].stock);
    }
    else
    {
      
    }

  }

}

void run_L(int ide)
{
  int i;
  int idx;
  struct produto ord[10000];
  char descrAux[64];
  int precoAux;
  int qtdAux;
  if (enc[ide].id == (-1))
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 200; i++)
  {
    ord[i].id = enc[ide].prod[i].id;
    strcpy(ord[i].descricao, enc[ide].prod[i].descricao);
    ord[i].preco = enc[ide].prod[i].preco;
    ord[i].stock = enc[ide].prod[i].stock;
  }

  for (i = 0; i < 200; i++)
  {
    if (ord[i].id == (-1))
    {
      break;
    }
    else
    {
      
    }

    for (idx = 0; idx < 200; idx++)
    {
      if (ord[i].id == (-1))
      {
        break;
      }
      else
      {
        
      }

      if (strcmp(ord[i].descricao, ord[idx].descricao) < 0)
      {
        strcpy(descrAux, ord[i].descricao);
        precoAux = ord[i].preco;
        qtdAux = ord[i].stock;
        strcpy(ord[i].descricao, ord[idx].descricao);
        ord[i].preco = ord[idx].preco;
        ord[i].stock = ord[idx].stock;
        strcpy(ord[idx].descricao, descrAux);
        ord[idx].preco = precoAux;
        ord[idx].stock = qtdAux;
      }
      else
      {
        
      }

    }

  }

  printf("Encomenda %d\n", ide);
  for (i = 0; i < 200; i++)
  {
    if (ord[i].id != (-1))
    {
      printf("* %s %d %d\n", ord[i].descricao, ord[i].preco, ord[i].stock);
    }
    else
    {
      
    }

  }

}

int main()
{
  char command;
  char descricao[64];
  int ide;
  int idp;
  int preco;
  int peso;
  int qtd;
  init();
  while (1)
  {
    command = getchar();
    switch (command)
    {
      case 'a':
        for (int descricao_index = 0; descricao_index < 10; descricao_index++)
      {
        descricao[descricao_index] = new_sym_var(sizeof(char) * 8);
      }

        descricao[10 - 1] = '\0';
        preco = new_sym_var(sizeof(int) * 8);
        peso = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        run_a(descricao, preco, peso, qtd);
        break;

      case 'q':
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        run_q(idp, qtd);
        break;

      case 'N':
        run_N();
        break;

      case 'A':
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        run_A(ide, idp, qtd);
        break;

      case 'r':
        idp = new_sym_var(sizeof(int) * 8);
        qtd = new_sym_var(sizeof(int) * 8);
        run_r(idp, qtd);
        break;

      case 'R':
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        run_R(ide, idp);
        break;

      case 'C':
        ide = new_sym_var(sizeof(int) * 8);
        run_C(ide);
        break;

      case 'p':
        idp = new_sym_var(sizeof(int) * 8);
        preco = new_sym_var(sizeof(int) * 8);
        run_p(idp, preco);
        break;

      case 'E':
        ide = new_sym_var(sizeof(int) * 8);
        idp = new_sym_var(sizeof(int) * 8);
        run_E(ide, idp);
        break;

      case 'm':
        idp = new_sym_var(sizeof(int) * 8);
        run_m(idp);
        break;

      case 'l':
        run_l();
        break;

      case 'L':
        ide = new_sym_var(sizeof(int) * 8);
        run_L(ide);
        break;

      case 'x':
        return 0;

    }

  }

  return -1;
}

