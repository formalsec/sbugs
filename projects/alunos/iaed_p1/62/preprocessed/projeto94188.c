/*File generated by PreProcessor.py*/


#include <string.h>
#include <stdio.h>


typedef struct 
{
  char descricao[64];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct 
{
  int qtd[10000];
} encomenda;
produto todos_produtos[10000];
encomenda todas_encomendas[500];
int aux[10000];
short k;
void merge(int a[], int inicio, int meio, int fim)
{
  int i;
  int j;
  int r;
  for (i = meio + 1; i > inicio; i--)
    aux[i - 1] = a[i - 1];

  for (j = meio; j < fim; j++)
    aux[(fim + meio) - j] = a[j + 1];

  if (k)
  {
    for (r = inicio; r <= fim; r++)
    {
      if ((todos_produtos[aux[j]].preco < todos_produtos[aux[i]].preco) || ((todos_produtos[aux[j]].preco == todos_produtos[aux[i]].preco) && (aux[j] < aux[i])))
      {
        a[r] = aux[j--];
      }
      else
      {
        a[r] = aux[i++];
      }

    }

  }
  else
  {
    for (r = inicio; r <= fim; r++)
    {
      if ((strcmp(todos_produtos[aux[j]].descricao, todos_produtos[aux[i]].descricao) < 0) || ((strcmp(todos_produtos[aux[j]].descricao, todos_produtos[aux[i]].descricao) == 0) && (aux[j] < aux[i])))
      {
        a[r] = aux[j--];
      }
      else
      {
        a[r] = aux[i++];
      }

    }

  }

}

void mergesort(int a[], int inicio, int fim)
{
  int meio = (inicio + fim) / 2;
  if (fim <= inicio)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, inicio, meio);
  mergesort(a, meio + 1, fim);
  merge(a, inicio, meio, fim);
}

void criar_vetor_indices(int array[])
{
  int i;
  for (i = 0; i < 10000; i++)
    array[i] = i;

}

int criar_vetor_indices_enc(int array[], int ide)
{
  int i;
  int j;
  j = 0;
  for (i = 0; i < 10000; i++)
    if (todas_encomendas[ide].qtd[i] != 0)
  {
    array[j] = i;
    j++;
  }
  else
  {
    
  }


  ;
  return j;
}

int peso_enc(int ide)
{
  int total;
  int i;
  i = (total = 0);
  while (todos_produtos[i].peso != 0)
  {
    total += todos_produtos[i].peso * todas_encomendas[ide].qtd[i];
    i++;
  }

  ;
  return total;
}

int a(int n_prod)
{
  int c;
  int i;
  i = 0;
  c = getchar();
  while ((c = getchar()) != ':')
  {
    todos_produtos[n_prod].descricao[i] = c;
    i++;
  }

  ;
  todos_produtos[n_prod].descricao[i] = '\0';
  todos_produtos[n_prod].preco = new_sym_var(sizeof(int) * 8);
  todos_produtos[n_prod].peso = new_sym_var(sizeof(int) * 8);
  todos_produtos[n_prod].qtd = new_sym_var(sizeof(int) * 8);
  printf("Novo produto %d.\n", n_prod);
  return n_prod + 1;
}

void q(int n_prod)
{
  int id;
  int qtd;
  id = getchar();
  id = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (id < n_prod)
  {
    todos_produtos[id].qtd += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", id);
  }

}

int N(int num_e)
{
  printf("Nova encomenda %d.\n", num_e);
  return num_e + 1;
}

void A(int num_produto, int num_e)
{
  int ide;
  int idp;
  int qtd;
  ide = getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (ide >= num_e)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= num_produto)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (qtd > todos_produtos[idp].qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((peso_enc(ide) + (qtd * todos_produtos[idp].peso)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          todas_encomendas[ide].qtd[idp] += qtd;
          todos_produtos[idp].qtd -= qtd;
        }

      }

    }

  }

  ;
}

void r(int num_produto)
{
  int idp;
  int qtd;
  idp = getchar();
  idp = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (idp >= num_produto)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if ((todos_produtos[idp].qtd - qtd) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, idp);
    }
    else
    {
      todos_produtos[idp].qtd -= qtd;
    }

  }

}

void R(int num_e, int num_produto)
{
  int ide;
  int idp;
  ide = getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= num_e)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= num_produto)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      todos_produtos[idp].qtd += todas_encomendas[ide].qtd[idp];
      todas_encomendas[ide].qtd[idp] = 0;
    }

  }

  ;
}

void C(int num_e, int num_produto)
{
  int ide;
  int total;
  int i;
  i = (total = 0);
  ide = getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= num_e)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; i < num_produto; i++)
      total += todas_encomendas[ide].qtd[i] * todos_produtos[i].preco;

    printf("Custo da encomenda %d %d.\n", ide, total);
  }

  ;
}

void p(int num_produto)
{
  int idp;
  int preco;
  idp = getchar();
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= num_produto)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    todos_produtos[idp].preco = preco;
  }

}

void E(int num_produto, int num_e)
{
  int ide;
  int idp;
  ide = getchar();
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= num_e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= num_produto)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      printf("%s %d.\n", todos_produtos[idp].descricao, todas_encomendas[ide].qtd[idp]);
    }

  }

  ;
}

void m(int num_produto, int num_e)
{
  int i;
  int idp;
  int max;
  int max_i;
  idp = getchar();
  max = (max_i = 0);
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= num_produto)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    for (i = 0; i < num_e; i++)
    {
      if (todas_encomendas[i].qtd[idp] > max)
      {
        max = todas_encomendas[i].qtd[idp];
        max_i = i;
      }
      else
      {
        
      }

      ;
    }

    ;
    if (max)
    {
      printf("Maximo produto %d %d %d.\n", idp, max_i, max);
    }
    else
    {
      
    }

  }

}

void l(int num_produto)
{
  int indices[10000];
  int i;
  criar_vetor_indices(indices);
  k = 1;
  mergesort(indices, 0, num_produto - 1);
  printf("Produtos\n");
  for (i = 0; i < num_produto; i++)
  {
    int id;
    id = indices[i];
    printf("* %s %d %d\n", todos_produtos[id].descricao, todos_produtos[id].preco, todos_produtos[id].qtd);
  }

  ;
}

void L(int num_e)
{
  int indices[10000];
  int ide;
  int i;
  int len;
  ide = getchar();
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= num_e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    len = criar_vetor_indices_enc(indices, ide);
    k = 0;
    mergesort(indices, 0, len - 1);
    printf("Encomenda %d\n", ide);
    for (i = 0; i < len; i++)
    {
      int id;
      id = indices[i];
      printf("* %s %d %d\n", todos_produtos[id].descricao, todos_produtos[id].preco, todas_encomendas[ide].qtd[id]);
    }

  }

  ;
}

int main()
{
  int estado = 1;
  int c;
  int num_produto = 0;
  int num_e = 0;
  while (estado)
  {
    c = getchar();
    switch (c)
    {
      case 'a':
        num_produto = a(num_produto);
        break;

      case 'q':
        q(num_produto);
        break;

      case 'N':
        num_e = N(num_e);
        break;

      case 'A':
        A(num_produto, num_e);
        break;

      case 'r':
        r(num_produto);
        break;

      case 'R':
        R(num_e, num_produto);
        break;

      case 'C':
        C(num_e, num_produto);
        break;

      case 'p':
        p(num_produto);
        break;

      case 'E':
        E(num_produto, num_e);
        break;

      case 'm':
        m(num_produto, num_e);
        break;

      case 'l':
        l(num_produto);
        break;

      case 'L':
        L(num_e);
        break;

      case 'x':
        estado = 0;
        break;

    }

    ;
  }

  ;
  return 0;
}

