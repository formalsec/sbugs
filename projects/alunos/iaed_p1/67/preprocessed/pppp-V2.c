/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


void a();
void q();
void N();
void A();
void r();
void R();
void C();
void p();
void E();
void m();
void l();
void L();
void mergesort(int a[], int left, int right, int prod[]);
void merge(int a[], int left, int m, int right, int prod[]);
struct Produto
{
  int numero;
  char descricao[64];
  int preco;
  int peso;
  int quantidade;
};
struct Encomenda
{
  int produtos[200];
  int quantidade[200];
  int numero_produtos;
  int peso;
};
struct Produto Prod[10000];
struct Encomenda Encom[500];
int identificador_produtos = 0;
int identificador_encomendas = 0;
int main()
{
  char n;
  for (n = getchar(); n != 'x'; n = getchar())
  {
    if (n == 'a')
    {
      n = getchar();
      a();
    }
    else
    {
      if (n == 'q')
      {
        n = getchar();
        q();
      }
      else
      {
        if (n == 'N')
        {
          N();
        }
        else
        {
          if (n == 'A')
          {
            n = getchar();
            A();
          }
          else
          {
            if (n == 'r')
            {
              n = getchar();
              r();
            }
            else
            {
              if (n == 'R')
              {
                n = getchar();
                R();
              }
              else
              {
                if (n == 'C')
                {
                  n = getchar();
                  C();
                }
                else
                {
                  if (n == 'p')
                  {
                    n = getchar();
                    p();
                  }
                  else
                  {
                    if (n == 'E')
                    {
                      n = getchar();
                      E();
                    }
                    else
                    {
                      if (n == 'm')
                      {
                        n = getchar();
                        m();
                      }
                      else
                      {
                        if (n == 'l')
                        {
                          l();
                        }
                        else
                        {
                          if (n == 'L')
                          {
                            getchar();
                            L();
                          }
                          else
                          {
                            
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

    for (; n != '\n';)
      n = getchar();

  }

  return 0;
}

void a()
{
  char nome[64];
  int preco;
  int peso;
  int qtd;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  preco = new_sym_var(sizeof(int) * 8);
  peso = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  strcpy(Prod[identificador_produtos].descricao, nome);
  Prod[identificador_produtos].numero = identificador_produtos;
  Prod[identificador_produtos].peso = peso;
  Prod[identificador_produtos].preco = preco;
  Prod[identificador_produtos].quantidade = qtd;
  printf("Novo produto %d.\n", identificador_produtos);
  identificador_produtos++;
}

void q()
{
  int qtd;
  int iden;
  iden = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (iden < identificador_produtos)
  {
    Prod[iden].quantidade += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", iden);
  }

}

void N()
{
  int i;
  Encom[identificador_encomendas].peso = 0;
  Encom[identificador_encomendas].numero_produtos = 0;
  for (i = 0; i < 200; i++)
    Encom[identificador_encomendas].produtos[i] = -1;

  printf("Nova encomenda %d.\n", identificador_encomendas);
  identificador_encomendas++;
}

void A()
{
  int iden;
  int encomenda;
  int qtd;
  int i;
  int Existe = 0;
  encomenda = new_sym_var(sizeof(int) * 8);
  iden = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (identificador_encomendas <= encomenda)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", iden, encomenda);
  }
  else
  {
    if (identificador_produtos <= iden)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", iden, encomenda);
    }
    else
    {
      if (qtd > Prod[iden].quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", iden, encomenda);
      }
      else
      {
        if ((Encom[encomenda].peso + (Prod[iden].peso * qtd)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", iden, encomenda);
        }
        else
        {
          Prod[iden].quantidade -= qtd;
          Encom[encomenda].peso += Prod[iden].peso * qtd;
          for (i = 0; i < 200; i++)
            if (Encom[encomenda].produtos[i] == iden)
          {
            Encom[encomenda].quantidade[i] += qtd;
            Existe = 1;
            break;
          }
          else
          {
            
          }


          if (Existe == 0)
          {
            for (i = 0; i < 200; i++)
              if (Encom[encomenda].produtos[i] == (-1))
            {
              Encom[encomenda].produtos[i] = iden;
              Encom[encomenda].quantidade[i] = qtd;
              Encom[encomenda].numero_produtos += 1;
              break;
            }
            else
            {
              
            }


          }
          else
          {
            
          }

        }

      }

    }

  }

}

void r()
{
  int iden;
  int qtd;
  iden = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  if (iden >= identificador_produtos)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", iden);
  }
  else
  {
    if (qtd > Prod[iden].quantidade)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd, iden);
    }
    else
    {
      Prod[iden].quantidade -= qtd;
    }

  }

}

void R()
{
  int iden_prod;
  int iden_enc;
  int i;
  iden_enc = new_sym_var(sizeof(int) * 8);
  iden_prod = new_sym_var(sizeof(int) * 8);
  if (iden_enc >= identificador_encomendas)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", iden_prod, iden_enc);
  }
  else
  {
    if (iden_prod >= identificador_produtos)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", iden_prod, iden_enc);
    }
    else
    {
      for (i = 0; i < 200; i++)
        if (Encom[iden_enc].produtos[i] == iden_prod)
      {
        Encom[iden_enc].peso -= Prod[iden_prod].peso * Encom[iden_enc].quantidade[i];
        Prod[iden_prod].quantidade += Encom[iden_enc].quantidade[i];
        Encom[iden_enc].produtos[i] = -1;
        Encom[iden_enc].quantidade[i] = 0;
        Encom[iden_enc].numero_produtos -= 1;
        break;
      }
      else
      {
        
      }


    }

  }

}

void C()
{
  int iden;
  int total = 0;
  int i;
  iden = new_sym_var(sizeof(int) * 8);
  if (iden >= identificador_encomendas)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", iden);
  }
  else
  {
    for (i = 0; i < 200; i++)
      if (Encom[iden].produtos[i] != (-1))
    {
      total += Prod[Encom[iden].produtos[i]].preco * Encom[iden].quantidade[i];
    }
    else
    {
      
    }


    printf("Custo da encomenda %d %d.\n", iden, total);
  }

}

void p()
{
  int iden;
  int preco;
  iden = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (iden >= identificador_produtos)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", iden);
  }
  else
  {
    
  }

  Prod[iden].preco = preco;
}

void E()
{
  int iden_enc;
  int iden_prod;
  int i;
  iden_enc = new_sym_var(sizeof(int) * 8);
  iden_prod = new_sym_var(sizeof(int) * 8);
  if (iden_enc >= identificador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", iden_enc);
  }
  else
  {
    if (iden_prod >= identificador_produtos)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", iden_prod);
    }
    else
    {
      for (i = 0; i < 200; i++)
      {
        if (Encom[iden_enc].produtos[i] == iden_prod)
        {
          printf("%s %d.\n", Prod[iden_prod].descricao, Encom[iden_enc].quantidade[i]);
          break;
        }
        else
        {
          if (i == (200 - 1))
          {
            printf("%s 0.\n", Prod[iden_prod].descricao);
            break;
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void m()
{
  int iden_prod;
  int enc_max;
  int qtd = -1;
  int i;
  int j;
  int Existe = 0;
  iden_prod = new_sym_var(sizeof(int) * 8);
  if (iden_prod >= identificador_produtos)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", iden_prod);
  }
  else
  {
    
  }

  for (i = 0; i < identificador_encomendas; i++)
    for (j = 0; j < 200; j++)
    if (Encom[i].produtos[j] == iden_prod)
  {
    if (Encom[i].quantidade[j] > qtd)
    {
      Existe = 1;
      enc_max = i;
      qtd = Encom[i].quantidade[j];
    }
    else
    {
      
    }

  }
  else
  {
    
  }



  if (Existe == 1)
  {
    printf("Maximo produto %d %d %d.\n", iden_prod, enc_max, qtd);
  }
  else
  {
    
  }

}

void l()
{
  int numeros[10000];
  int precos[10000];
  int i;
  printf("Produtos\n");
  for (i = 0; i < identificador_produtos; i++)
  {
    numeros[i] = i;
    precos[i] = Prod[i].preco;
  }

  if (identificador_produtos != 0)
  {
    mergesort(precos, 0, identificador_produtos - 1, numeros);
  }
  else
  {
    
  }

  for (i = 0; i < identificador_produtos; i++)
    printf("* %s %d %d\n", Prod[numeros[i]].descricao, precos[i], Prod[numeros[i]].quantidade);

}

void mergesort(int a[], int left, int right, int prod[])
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, left, m, prod);
  mergesort(a, m + 1, right, prod);
  merge(a, left, m, right, prod);
}

void merge(int a[], int left, int m, int right, int prod[])
{
  int i;
  int j;
  int k;
  int aux_preco[10000];
  int aux_numero[10000];
  for (i = m + 1; i > left; i--)
  {
    aux_preco[i - 1] = a[i - 1];
    aux_numero[i - 1] = prod[i - 1];
  }

  for (j = m; j < right; j++)
  {
    aux_preco[(right + m) - j] = a[j + 1];
    aux_numero[(right + m) - j] = prod[j + 1];
  }

  for (k = left; k <= right; k++)
  {
    if (aux_preco[j] < aux_preco[i])
    {
      a[k] = aux_preco[j];
      prod[k] = aux_numero[j--];
    }
    else
    {
      if ((aux_preco[j] == aux_preco[i]) && (aux_numero[j] < aux_numero[i]))
      {
        a[k] = aux_preco[j];
        prod[k] = aux_numero[j--];
      }
      else
      {
        a[k] = aux_preco[i];
        prod[k] = aux_numero[i++];
      }

    }

  }

}

void L()
{
  int iden_enc;
  int numero_prod;
  iden_enc = new_sym_var(sizeof(int) * 8);
  if (iden_enc >= identificador_encomendas)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", iden_enc);
  }
  else
  {
    printf("Encomenda %d\n", iden_enc);
    numero_prod = Encom[iden_enc].numero_produtos;
    if (numero_prod != 0)
    {
      int produtos[200];
      int qtd[200];
      char descricoes[200][64];
      int i;
      int j = 0;
      for (i = 0; i <= 200; i++)
        if (Encom[iden_enc].produtos[i] != (-1))
      {
        produtos[j] = Encom[iden_enc].produtos[i];
        qtd[j] = Encom[iden_enc].quantidade[i];
        strcpy(descricoes[j], Prod[Encom[iden_enc].produtos[i]].descricao);
        j++;
      }
      else
      {
        
      }


      for (i = 0; i < numero_prod; i++)
      {
        int aux_prod;
        int aux_qtd;
        int min = i;
        char aux_desc[64];
        for (j = i + 1; j < numero_prod; j++)
          if (strcmp(descricoes[j], descricoes[min]) < 0)
        {
          min = j;
        }
        else
        {
          
        }


        strcpy(aux_desc, descricoes[i]);
        strcpy(descricoes[i], descricoes[min]);
        strcpy(descricoes[min], aux_desc);
        aux_prod = produtos[i];
        produtos[i] = produtos[min];
        produtos[min] = aux_prod;
        aux_qtd = qtd[i];
        qtd[i] = qtd[min];
        qtd[min] = aux_qtd;
      }

      for (i = 0; i < numero_prod; i++)
        printf("* %s %d %d\n", Prod[produtos[i]].descricao, Prod[produtos[i]].preco, qtd[i]);

    }
    else
    {
      
    }

  }

}

