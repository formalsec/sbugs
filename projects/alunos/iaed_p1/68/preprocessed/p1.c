/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  char Descricao[63];
  int Preco;
  int Peso;
  int Quantidade;
  int Identificacao;
} produto;
typedef struct encomenda
{
  int Idp_qnt[2][200];
  int Peso_total;
  int Numero_produtos;
} encomenda;
produto s[10000];
encomenda t[500];
int ide = 0;
int idp = 0;
void AdicionaProduto();
int Procura_Idp(int id);
void AdicionaStock();
void AdicionaProdutoEncomenda();
void RemoveStock();
void RemoveProdutoEncomenda();
void CalculaCusto();
void AlteraPrecoProduto();
void ListaProdutoEncomenda();
void ListaMaximoId();
void ListaProdutosOrdenados();
void quicksort(int l, int r);
int partition(int l, int r);
void ListaEncomendasOrdenadas();
int main()
{
  int i;
  char c;
  for (i = 0; i < 10000; i++)
    s[i].Quantidade = -1;

  while (c != 'x')
  {
    switch (c = getchar())
    {
      case 'a':
        AdicionaProduto();
        break;

      case 'q':
        AdicionaStock();
        break;

      case 'N':
        printf("Nova encomenda %d.\n", ide++);
        break;

      case 'A':
        AdicionaProdutoEncomenda();
        break;

      case 'r':
        RemoveStock();
        break;

      case 'R':
        RemoveProdutoEncomenda();
        break;

      case 'C':
        CalculaCusto();
        break;

      case 'p':
        AlteraPrecoProduto();
        break;

      case 'E':
        ListaProdutoEncomenda();
        break;

      case 'm':
        ListaMaximoId();
        break;

      case 'l':
        ListaProdutosOrdenados();
        break;

      case 'L':
        ListaEncomendasOrdenadas();
        break;

    }

  }

  return 0;
}

void AdicionaProduto()
{
  for (int s_index = 0; s_index < 10; s_index++)
  {
    s[idp].Descricao[s_index] = new_sym_var(sizeof(char) * 8);
  }

  s[idp].Descricao[10 - 1] = '\0';
  s[idp].Preco = new_sym_var(sizeof(int) * 8);
  s[idp].Peso = new_sym_var(sizeof(int) * 8);
  s[idp].Quantidade = new_sym_var(sizeof(int) * 8);
  s[idp].Identificacao = idp;
  printf("Novo produto %d.\n", idp++);
}

int Procura_Idp(int id)
{
  int i;
  for (i = 0; i < idp; i++)
  {
    if (s[i].Identificacao == id)
    {
      break;
    }
    else
    {
      
    }

  }

  return i;
}

void AdicionaStock()
{
  int idp1;
  int idp_1;
  int qtd;
  idp1 = new_sym_var(sizeof(int) * 8);
  qtd = new_sym_var(sizeof(int) * 8);
  idp_1 = Procura_Idp(idp1);
  if (s[idp_1].Quantidade >= 0)
  {
    s[idp_1].Quantidade += qtd;
  }
  else
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp1);
  }

}

void AdicionaProdutoEncomenda()
{
  int ide1;
  int idp2;
  int idp_2;
  int qtd1 = 0;
  int i;
  ide1 = new_sym_var(sizeof(int) * 8);
  idp2 = new_sym_var(sizeof(int) * 8);
  qtd1 = new_sym_var(sizeof(int) * 8);
  idp_2 = Procura_Idp(idp2);
  if (ide1 >= ide)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp2, ide1);
    return;
  }
  else
  {
    if (s[idp_2].Quantidade == (-1))
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp2, ide1);
      return;
    }
    else
    {
      if (qtd1 > s[idp_2].Quantidade)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp2, ide1);
        return;
      }
      else
      {
        
      }

    }

  }

  for (i = 0; i < t[ide1].Numero_produtos; i++)
  {
    if (t[ide1].Idp_qnt[0][i] == idp2)
    {
      if ((t[ide1].Peso_total + (qtd1 * s[idp_2].Peso)) > 200)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp2, ide1);
        return;
      }
      else
      {
        t[ide1].Peso_total += qtd1 * s[idp_2].Peso;
      }

      break;
    }
    else
    {
      
    }

  }

  if (i != t[ide1].Numero_produtos)
  {
    t[ide1].Idp_qnt[1][i] += qtd1;
  }
  else
  {
    if ((t[ide1].Peso_total + (qtd1 * s[idp_2].Peso)) <= 200)
    {
      t[ide1].Idp_qnt[0][t[ide1].Numero_produtos] = idp2;
      t[ide1].Idp_qnt[1][t[ide1].Numero_produtos] = qtd1;
      t[ide1].Peso_total += qtd1 * s[idp_2].Peso;
      t[ide1].Numero_produtos++;
    }
    else
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp2, ide1);
      return;
    }

  }

  s[idp_2].Quantidade -= qtd1;
}

void RemoveStock()
{
  int idp3;
  int idp_3;
  int qtd2;
  idp3 = new_sym_var(sizeof(int) * 8);
  qtd2 = new_sym_var(sizeof(int) * 8);
  idp_3 = Procura_Idp(idp3);
  if (s[idp_3].Quantidade >= 0)
  {
    if ((s[idp_3].Quantidade - qtd2) >= 0)
    {
      s[idp_3].Quantidade -= qtd2;
    }
    else
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", qtd2, idp3);
    }

  }
  else
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp3);
  }

}

void RemoveProdutoEncomenda()
{
  int ide2;
  int idp4;
  int idp_4;
  int i;
  ide2 = new_sym_var(sizeof(int) * 8);
  idp4 = new_sym_var(sizeof(int) * 8);
  idp_4 = Procura_Idp(idp4);
  if (ide2 < ide)
  {
    if (s[idp_4].Quantidade >= 0)
    {
      for (i = 0; i < t[ide2].Numero_produtos; i++)
      {
        if (t[ide2].Idp_qnt[0][i] == idp4)
        {
          s[idp_4].Quantidade += t[ide2].Idp_qnt[1][i];
          t[ide2].Peso_total -= t[ide2].Idp_qnt[1][i] * s[idp_4].Peso;
          t[ide2].Idp_qnt[1][i] = 0;
        }
        else
        {
          
        }

      }

    }
    else
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp4, ide2);
    }

  }
  else
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp4, ide2);
  }

}

void CalculaCusto()
{
  int i;
  int j;
  int ide3;
  int total = 0;
  ide3 = new_sym_var(sizeof(int) * 8);
  if (ide3 < ide)
  {
    for (i = 0; i < t[ide3].Numero_produtos; i++)
    {
      j = Procura_Idp(t[ide3].Idp_qnt[0][i]);
      if (j != idp)
      {
        total += s[j].Preco * t[ide3].Idp_qnt[1][i];
      }
      else
      {
        
      }

    }

    printf("Custo da encomenda %d %d.\n", ide3, total);
  }
  else
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide3);
  }

  total = 0;
}

void AlteraPrecoProduto()
{
  int idp5;
  int idp_5;
  int valor;
  idp5 = new_sym_var(sizeof(int) * 8);
  valor = new_sym_var(sizeof(int) * 8);
  idp_5 = Procura_Idp(idp5);
  if (s[idp_5].Quantidade >= 0)
  {
    s[idp_5].Preco = valor;
  }
  else
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp5);
  }

}

void ListaProdutoEncomenda()
{
  int i;
  int ide4;
  int idp6;
  int idp_6;
  int in = 0;
  ide4 = new_sym_var(sizeof(int) * 8);
  idp6 = new_sym_var(sizeof(int) * 8);
  idp_6 = Procura_Idp(idp6);
  if (ide4 < ide)
  {
    if (s[idp_6].Quantidade >= 0)
    {
      for (i = 0; i < t[ide4].Numero_produtos; i++)
      {
        if (t[ide4].Idp_qnt[0][i] == idp6)
        {
          in = 1;
          printf("%s %d.\n", s[idp_6].Descricao, t[ide4].Idp_qnt[1][i]);
        }
        else
        {
          
        }

      }

      if (!in)
      {
        printf("%s 0.\n", s[idp_6].Descricao);
      }
      else
      {
        
      }

    }
    else
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp6);
    }

  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide4);
  }

}

void ListaMaximoId()
{
  int i;
  int j;
  int idp7;
  int idp_7;
  int max_qnt = 0;
  int max_id = 0;
  idp7 = new_sym_var(sizeof(int) * 8);
  idp_7 = Procura_Idp(idp7);
  if (s[idp_7].Quantidade >= 0)
  {
    if (ide != 0)
    {
      for (i = 0; i < ide; i++)
      {
        for (j = 0; j < t[i].Numero_produtos; j++)
        {
          if (t[i].Idp_qnt[0][j] == idp7)
          {
            if (t[i].Idp_qnt[1][j] > max_qnt)
            {
              max_qnt = t[i].Idp_qnt[1][j];
              max_id = i;
            }
            else
            {
              
            }

            break;
          }
          else
          {
            
          }

        }

      }

      if (max_qnt != 0)
      {
        printf("Maximo produto %d %d %d.\n", idp7, max_id, max_qnt);
      }
      else
      {
        
      }

    }
    else
    {
      
    }

  }
  else
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp7);
  }

}

void ListaProdutosOrdenados()
{
  int i;
  quicksort(0, idp - 1);
  printf("Produtos\n");
  for (i = 0; i < idp; i++)
  {
    printf("* %s %d %d\n", s[i].Descricao, s[i].Preco, s[i].Quantidade);
  }

}

void quicksort(int l, int r)
{
  int i;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  i = partition(l, r);
  quicksort(l, i - 1);
  quicksort(i + 1, r);
}

int partition(int l, int r)
{
  int i = l - 1;
  int j = r;
  int v = s[r].Preco;
  int v1 = s[r].Identificacao;
  while (i < j)
  {
    do
    {
      i++;
    }
    while ((s[i].Preco < v) || ((s[i].Preco == v) && (s[i].Identificacao < v1)));
    do
    {
      j--;
      if (j == l)
      {
        break;
      }
      else
      {
        
      }

    }
    while ((v < s[j].Preco) || ((v == s[j].Preco) && (v1 < s[j].Identificacao)));
    if (i < j)
    {
      {
        produto t = s[i];
        s[i] = s[j];
        s[j] = t;
      }
      ;
    }
    else
    {
      
    }

  }

  {
    produto t = s[i];
    s[i] = s[r];
    s[r] = t;
  }
  ;
  return i;
}

void ListaEncomendasOrdenadas()
{
  int ide5;
  int i;
  int j;
  int pi;
  int pj;
  int aux;
  ide5 = new_sym_var(sizeof(int) * 8);
  if (ide5 < ide)
  {
    for (i = 0; i < t[ide5].Numero_produtos; i++)
    {
      for (j = 0; j < ((t[ide5].Numero_produtos - i) - 1); j++)
      {
        pi = Procura_Idp(t[ide5].Idp_qnt[0][j]);
        pj = Procura_Idp(t[ide5].Idp_qnt[0][j + 1]);
        if (strcmp(s[pi].Descricao, s[pj].Descricao) > 0)
        {
          aux = t[ide5].Idp_qnt[0][j];
          t[ide5].Idp_qnt[0][j] = t[ide5].Idp_qnt[0][j + 1];
          t[ide5].Idp_qnt[0][j + 1] = aux;
          aux = t[ide5].Idp_qnt[1][j];
          t[ide5].Idp_qnt[1][j] = t[ide5].Idp_qnt[1][j + 1];
          t[ide5].Idp_qnt[1][j + 1] = aux;
        }
        else
        {
          
        }

      }

    }

    printf("Encomenda %d\n", ide5);
    for (i = 0; i < t[ide5].Numero_produtos; i++)
    {
      j = Procura_Idp(t[ide5].Idp_qnt[0][i]);
      if (t[ide5].Idp_qnt[1][i] != 0)
      {
        printf("* %s %d %d\n", s[j].Descricao, s[j].Preco, t[ide5].Idp_qnt[1][i]);
      }
      else
      {
        
      }

    }

  }
  else
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide5);
  }

}

