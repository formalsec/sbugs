/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>


typedef struct produtos
{
  char desc[63];
  int idp;
  int preco;
  int peso;
  int qtd;
} p;
p sistema[10000] = {0};
p encomendas[500][200] = {0};
int s = 0;
int e = 0;
int peso_encomenda(int ide)
{
  int peso = 0;
  int i;
  for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
    peso += encomendas[ide][i].peso * encomendas[ide][i].qtd;

  return peso;
}

void apagar_produto(int ide, int n)
{
  int a;
  for (a = 0; a < 63; a++)
    encomendas[ide][n].desc[a] = '\0';

  encomendas[ide][n].idp = 0;
  encomendas[ide][n].preco = 0;
  encomendas[ide][n].peso = 0;
  encomendas[ide][n].qtd = 0;
}

void InsertionSort_preco(p v[], int esquerda, int direita)
{
  int i;
  int j;
  for (i = esquerda + 1; i <= direita; i++)
  {
    p aux = v[i];
    j = i - 1;
    while ((j >= esquerda) && ((aux.preco < v[j].preco) || ((aux.preco == v[j].preco) && (aux.idp < v[j].idp))))
    {
      v[j + 1] = v[j];
      j--;
    }

    v[j + 1] = aux;
  }

}

void InsertionSort_desc(p v[], int esquerda, int direita)
{
  int i;
  int j;
  for (i = esquerda + 1; i <= direita; i++)
  {
    p aux = v[i];
    j = i - 1;
    while ((j >= esquerda) && ((strcmp(aux.desc, v[j].desc) < 0) || ((strcmp(aux.desc, v[j].desc) == 0) && (aux.idp < v[j].idp))))
    {
      v[j + 1] = v[j];
      j--;
    }

    v[j + 1] = aux;
  }

}

void comando_a()
{
  for (int sistema_index = 0; sistema_index < 10; sistema_index++)
  {
    sistema[s].desc[sistema_index] = new_sym_var(sizeof(char) * 8);
  }

  sistema[s].desc[10 - 1] = '\0';
  sistema[s].preco = new_sym_var(sizeof(int) * 8);
  sistema[s].peso = new_sym_var(sizeof(int) * 8);
  sistema[s].qtd = new_sym_var(sizeof(int) * 8);
  sistema[s].idp = s;
  printf("Novo produto %d.\n", s);
  s++;
}

void comando_q()
{
  int produ;
  int quant;
  produ = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (sistema[produ].preco == 0)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", produ);
  }
  else
  {
    sistema[produ].qtd += quant;
  }

}

void comando_N()
{
  printf("Nova encomenda %d.\n", e);
  e++;
}

void comando_A()
{
  int ide;
  int produ;
  int quant;
  int i;
  int estado = 0;
  ide = new_sym_var(sizeof(int) * 8);
  produ = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", produ, ide);
  }
  else
  {
    if (sistema[produ].preco == 0)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", produ, ide);
    }
    else
    {
      if ((sistema[produ].qtd - quant) < 0)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", produ, ide);
      }
      else
      {
        if ((peso_encomenda(ide) + (quant * sistema[produ].peso)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", produ, ide);
        }
        else
        {
          sistema[produ].qtd -= quant;
          for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
          {
            if (encomendas[ide][i].idp == sistema[produ].idp)
            {
              encomendas[ide][i].qtd += quant;
              estado = 1;
            }
            else
            {
              
            }

          }

          if (!estado)
          {
            encomendas[ide][i] = sistema[produ];
            encomendas[ide][i].qtd = quant;
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void comando_r()
{
  int produ;
  int quant;
  produ = new_sym_var(sizeof(int) * 8);
  quant = new_sym_var(sizeof(int) * 8);
  if (sistema[produ].preco == 0)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", produ);
  }
  else
  {
    if ((sistema[produ].qtd - quant) < 0)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quant, produ);
    }
    else
    {
      sistema[produ].qtd -= quant;
    }

  }

}

void comando_R()
{
  int ide;
  int produ;
  int i;
  int numero_produtos = 0;
  int j = -1;
  ide = new_sym_var(sizeof(int) * 8);
  produ = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", produ, ide);
  }
  else
  {
    if (sistema[produ].preco == 0)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", produ, ide);
    }
    else
    {
      for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      {
        if (sistema[produ].idp == encomendas[ide][i].idp)
        {
          j = i;
          sistema[produ].qtd += encomendas[ide][i].qtd;
        }
        else
        {
          
        }

        numero_produtos++;
      }

      if (j == (numero_produtos - 1))
      {
        apagar_produto(ide, j);
      }
      else
      {
        if (j > (-1))
        {
          for (i = j; i < (numero_produtos - 1); i++)
            encomendas[ide][i] = encomendas[ide][i + 1];

          apagar_produto(ide, i);
        }
        else
        {
          
        }

      }

    }

  }

}

void comando_C()
{
  int ide;
  int i;
  int custo = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      custo += encomendas[ide][i].preco * encomendas[ide][i].qtd;

    printf("Custo da encomenda %d %d.\n", ide, custo);
  }

}

void comando_p()
{
  int produ;
  int novo_preco;
  int ide;
  int i;
  produ = new_sym_var(sizeof(int) * 8);
  novo_preco = new_sym_var(sizeof(int) * 8);
  if (sistema[produ].preco == 0)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", produ);
  }
  else
  {
    sistema[produ].preco = novo_preco;
    for (ide = 0; ide < e; ide++)
    {
      for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      {
        if (encomendas[ide][i].idp == sistema[produ].idp)
        {
          encomendas[ide][i].preco = novo_preco;
        }
        else
        {
          
        }

      }

    }

  }

}

void comando_E()
{
  int i;
  int ide;
  int produ;
  int estado = 0;
  ide = new_sym_var(sizeof(int) * 8);
  produ = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (sistema[produ].preco == 0)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", produ);
    }
    else
    {
      for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      {
        if (encomendas[ide][i].idp == sistema[produ].idp)
        {
          printf("%s %d.\n", encomendas[ide][i].desc, encomendas[ide][i].qtd);
          estado = 1;
        }
        else
        {
          
        }

      }

      if (!estado)
      {
        printf("%s 0.\n", sistema[produ].desc);
      }
      else
      {
        
      }

    }

  }

}

void comando_m()
{
  int i = 0;
  int maior_quant = 0;
  int ide = 0;
  int produ;
  int resposta;
  int estado = 0;
  produ = new_sym_var(sizeof(int) * 8);
  if (sistema[produ].preco == 0)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", produ);
  }
  else
  {
    for (ide = 0; ide < e; ide++)
    {
      for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      {
        if (sistema[produ].idp == encomendas[ide][i].idp)
        {
          estado = 1;
          if (encomendas[ide][i].qtd > maior_quant)
          {
            maior_quant = encomendas[ide][i].qtd;
            resposta = ide;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }

    }

    if (estado)
    {
      printf("Maximo produto %d %d %d.\n", produ, resposta, maior_quant);
    }
    else
    {
      
    }

  }

}

void comando_l()
{
  int i;
  int j;
  p aux_preco[10000] = {0};
  printf("Produtos\n");
  for (i = 0; i < s; i++)
    aux_preco[i] = sistema[i];

  InsertionSort_preco(aux_preco, 0, i - 1);
  for (j = 0; j < i; j++)
    printf("* %s %d %d\n", aux_preco[j].desc, aux_preco[j].preco, aux_preco[j].qtd);

}

void comando_L()
{
  int i;
  int j;
  int ide;
  p aux_descricoes[200] = {0};
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    printf("Encomenda %d\n", ide);
    for (i = 0; (encomendas[ide][i].preco != 0) && (i < 200); i++)
      aux_descricoes[i] = encomendas[ide][i];

    InsertionSort_desc(aux_descricoes, 0, i - 1);
    for (j = 0; j < i; j++)
      printf("* %s %d %d\n", aux_descricoes[j].desc, aux_descricoes[j].preco, aux_descricoes[j].qtd);

  }

}

int main()
{
  char comando = getchar();
  while (comando != 'x')
  {
    switch (comando)
    {
      case 'a':
        comando_a();
        break;

      case 'q':
        comando_q();
        break;

      case 'N':
        comando_N();
        break;

      case 'A':
        comando_A();
        break;

      case 'r':
        comando_r();
        break;

      case 'R':
        comando_R();
        break;

      case 'C':
        comando_C();
        break;

      case 'p':
        comando_p();
        break;

      case 'E':
        comando_E();
        break;

      case 'm':
        comando_m();
        break;

      case 'l':
        comando_l();
        break;

      case 'L':
        comando_L();
        break;

      default:
        break;

    }

    comando = getchar();
  }

  return 0;
}

