#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct produto
{
  int idp;
  char descricao[63];
  int preco;
  int peso;
  int qtd;
} produto;
typedef struct encomenda
{
  int lista[10000];
} encomenda;
produto sistema[10000];
encomenda encomendas[500];
produto copia[10000];
produto aux[10000];
int identificador_p = 0;
int identificador_e = 0;
void comando_a()
{
  if (identificador_p < 10000)
  {
    for (int sistema_index = 0; sistema_index < 10; sistema_index++)
    {
      sistema[identificador_p].descricao[sistema_index] = new_sym_var(sizeof(char) * 8);
    }

    sistema[identificador_p].descricao[10 - 1] = '\0';
    sistema[identificador_p].preco = new_sym_var(sizeof(int) * 8);
    sistema[identificador_p].peso = new_sym_var(sizeof(int) * 8);
    sistema[identificador_p].qtd = new_sym_var(sizeof(int) * 8);
    sistema[identificador_p].idp = identificador_p;
    printf("Novo produto %d.\n", identificador_p);
    identificador_p++;
  }
  else
  {
    
  }

}

void comando_q()
{
  int idp;
  int quantidade;
  idp = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (idp >= identificador_p)
  {
    printf("Impossivel adicionar produto %d ao stock. Produto inexistente.\n", idp);
  }
  else
  {
    sistema[idp].qtd += quantidade;
  }

}

void comando_N()
{
  int n = 0;
  if (identificador_e < 500)
  {
    while (n < 10000)
    {
      encomendas[identificador_e].lista[n] = 0;
      n++;
    }

    printf("Nova encomenda %d.\n", identificador_e);
    identificador_e++;
  }
  else
  {
    
  }

}

void comando_A()
{
  int ide;
  int idp;
  int quantidade;
  int peso = 0;
  int n = 0;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  while (n < identificador_p)
  {
    peso = peso + (encomendas[ide].lista[n] * sistema[n].peso);
    n++;
  }

  if (ide >= identificador_e)
  {
    printf("Impossivel adicionar produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= identificador_p)
    {
      printf("Impossivel adicionar produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      if (quantidade > sistema[idp].qtd)
      {
        printf("Impossivel adicionar produto %d a encomenda %d. Quantidade em stock insuficiente.\n", idp, ide);
      }
      else
      {
        if ((peso + (quantidade * sistema[idp].peso)) > 200)
        {
          printf("Impossivel adicionar produto %d a encomenda %d. Peso da encomenda excede o maximo de 200.\n", idp, ide);
        }
        else
        {
          encomendas[ide].lista[idp] = encomendas[ide].lista[idp] + quantidade;
          sistema[idp].qtd = sistema[idp].qtd - quantidade;
        }

      }

    }

  }

}

void comando_r()
{
  int idp;
  int quantidade;
  idp = new_sym_var(sizeof(int) * 8);
  quantidade = new_sym_var(sizeof(int) * 8);
  if (idp >= identificador_p)
  {
    printf("Impossivel remover stock do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    if (quantidade > sistema[idp].qtd)
    {
      printf("Impossivel remover %d unidades do produto %d do stock. Quantidade insuficiente.\n", quantidade, idp);
    }
    else
    {
      sistema[idp].qtd = sistema[idp].qtd - quantidade;
    }

  }

}

void comando_R()
{
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= identificador_e)
  {
    printf("Impossivel remover produto %d a encomenda %d. Encomenda inexistente.\n", idp, ide);
  }
  else
  {
    if (idp >= identificador_p)
    {
      printf("Impossivel remover produto %d a encomenda %d. Produto inexistente.\n", idp, ide);
    }
    else
    {
      sistema[idp].qtd += encomendas[ide].lista[idp];
      encomendas[ide].lista[idp] = 0;
    }

  }

}

void comando_C()
{
  int ide;
  int n = 0;
  int preco = 0;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= identificador_e)
  {
    printf("Impossivel calcular custo da encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    while (n < identificador_p)
    {
      if (encomendas[ide].lista[n] != 0)
      {
        preco = preco + (encomendas[ide].lista[n] * sistema[n].preco);
      }
      else
      {
        
      }

      n++;
    }

    printf("Custo da encomenda %d %d.\n", ide, preco);
  }

}

void comando_p()
{
  int idp;
  int preco;
  idp = new_sym_var(sizeof(int) * 8);
  preco = new_sym_var(sizeof(int) * 8);
  if (idp >= identificador_p)
  {
    printf("Impossivel alterar preco do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    sistema[idp].preco = preco;
  }

}

void comando_E()
{
  int ide;
  int idp;
  ide = new_sym_var(sizeof(int) * 8);
  idp = new_sym_var(sizeof(int) * 8);
  if (ide >= identificador_e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    if (idp >= identificador_p)
    {
      printf("Impossivel listar produto %d. Produto inexistente.\n", idp);
    }
    else
    {
      printf("%s %d.\n", sistema[idp].descricao, encomendas[ide].lista[idp]);
    }

  }

}

void comando_m()
{
  int idp;
  int n = 0;
  int maior_qtd = 0;
  int maior_ide;
  idp = new_sym_var(sizeof(int) * 8);
  if (idp >= identificador_p)
  {
    printf("Impossivel listar maximo do produto %d. Produto inexistente.\n", idp);
  }
  else
  {
    
  }

  while (n < identificador_e)
  {
    if (encomendas[n].lista[idp] > maior_qtd)
    {
      maior_qtd = encomendas[n].lista[idp];
      maior_ide = n;
    }
    else
    {
      
    }

    n++;
  }

  if ((maior_qtd > 0) && (n > 0))
  {
    printf("Maximo produto %d %d %d.\n", idp, maior_ide, maior_qtd);
  }
  else
  {
    
  }

}

void merge_l(int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    aux[i - 1] = copia[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = copia[j + 1];

  for (k = left; k <= right; k++)
  {
    if (aux[j].preco < aux[i].preco)
    {
      copia[k] = aux[j--];
    }
    else
    {
      if (aux[j].preco == aux[i].preco)
      {
        if (aux[j].idp < aux[i].idp)
        {
          copia[k] = aux[j--];
        }
        else
        {
          copia[k] = aux[i++];
        }

      }
      else
      {
        copia[k] = aux[i++];
      }

    }

  }

}

void mergesort_l(int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_l(left, m);
  mergesort_l(m + 1, right);
  merge_l(left, m, right);
}

void comando_l()
{
  int n = 0;
  int m = 0;
  int left = 0;
  int right = identificador_p - 1;
  while (n < identificador_p)
  {
    if (sistema[n].preco != 0)
    {
      copia[m] = sistema[n];
      m++;
    }
    else
    {
      
    }

    n++;
  }

  n = 0;
  mergesort_l(left, right);
  printf("Produtos\n");
  while (n < identificador_p)
  {
    printf("* %s %d %d\n", copia[n].descricao, copia[n].preco, copia[n].qtd);
    n++;
  }

}

void merge_L(int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    aux[i - 1] = copia[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = copia[j + 1];

  for (k = left; k <= right; k++)
  {
    if (strcmp(aux[j].descricao, aux[i].descricao) < 0)
    {
      copia[k] = aux[j--];
    }
    else
    {
      copia[k] = aux[i++];
    }

  }

}

void mergesort_L(int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort_L(left, m);
  mergesort_L(m + 1, right);
  merge_L(left, m, right);
}

void comando_L()
{
  int ide;
  int n = 0;
  int left = 0;
  int right = identificador_p - 1;
  ide = new_sym_var(sizeof(int) * 8);
  if (ide >= identificador_e)
  {
    printf("Impossivel listar encomenda %d. Encomenda inexistente.\n", ide);
  }
  else
  {
    while (n < identificador_p)
    {
      copia[n] = sistema[n];
      n++;
    }

    n = 0;
    mergesort_L(left, right);
    printf("Encomenda %d\n", ide);
    while (n < identificador_p)
    {
      if ((encomendas[ide].lista[copia[n].idp] != 0) && (copia[n].preco != 0))
      {
        printf("* %s %d %d\n", copia[n].descricao, copia[n].preco, encomendas[ide].lista[copia[n].idp]);
      }
      else
      {
        
      }

      n++;
    }

  }

}

int main()
{
  char c;
  c = getchar();
  while (c != 'x')
  {
    if (c == 'a')
    {
      comando_a();
    }
    else
    {
      if (c == 'q')
      {
        comando_q();
      }
      else
      {
        if (c == 'N')
        {
          comando_N();
        }
        else
        {
          if (c == 'A')
          {
            comando_A();
          }
          else
          {
            if (c == 'r')
            {
              comando_r();
            }
            else
            {
              if (c == 'R')
              {
                comando_R();
              }
              else
              {
                if (c == 'C')
                {
                  comando_C();
                }
                else
                {
                  if (c == 'p')
                  {
                    comando_p();
                  }
                  else
                  {
                    if (c == 'E')
                    {
                      comando_E();
                    }
                    else
                    {
                      if (c == 'm')
                      {
                        comando_m();
                      }
                      else
                      {
                        if (c == 'l')
                        {
                          comando_l();
                        }
                        else
                        {
                          if (c == 'L')
                          {
                            comando_L();
                          }
                          else
                          {
                            
                          }

                        }

                      }

                    }

                  }

                }

              }

            }

          }

        }

      }

    }

    c = getchar();
    c = getchar();
  }

  return 0;
}

