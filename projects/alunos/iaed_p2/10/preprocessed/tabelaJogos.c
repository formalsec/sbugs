#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "tabelaJogos.h"


int hash(char *nome)
{
  int h;
  int a;
  int m;
  h = 0;
  a = 127;
  m = 10000;
  for (; (*nome) != '\0'; nome++)
  {
    h = ((a * h) + (*nome)) % m;
  }

  return h;
}

pTabela novaTabJogos(int m)
{
  int i;
  pTabela novaTabela = (pTabela) malloc(sizeof(struct entradasJogo));
  novaTabela->numJogos = 0;
  novaTabela->tamanho = m;
  novaTabela->entradaLista = (listaJogo *) malloc((sizeof(listaJogo)) * m);
  for (i = 0; i < m; i++)
  {
    novaTabela->entradaLista[i] = 0;
  }

  return novaTabela;
}

void adicionarJogoTabela(pTabela tabelaJogos, pJogo jogo, int ordem, int numINP)
{
  if (jogo != 0)
  {
    int h;
    h = hash(jogo->nome);
    tabelaJogos->entradaLista[h] = adicionarNovoJogo(jogo, tabelaJogos->entradaLista + h, ordem, numINP);
  }
  else
  {
    
  }

}

pJogo procurarJogoTabela(pTabela tabelaJogos, char *nome)
{
  int h;
  pJogo jogo;
  h = hash(nome);
  jogo = procurarJogoLista(tabelaJogos->entradaLista + h, nome);
  return jogo;
}

void apagarJogoTabela(pTabela tabelaJogos, char *nome, int numINP)
{
  int h;
  h = hash(nome);
  apagarJogoLista(tabelaJogos->entradaLista + h, nome, numINP);
}

void alteraPontuacao(pTabela tabelaJogos, char *nome, int pont1, int pont2, int numINP)
{
  pJogo jogo;
  jogo = procurarJogoTabela(tabelaJogos, nome);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", numINP);
    return;
  }
  else
  {
    
  }

  retiraVitoria(jogo);
  jogo->pont1 = pont1;
  jogo->pont2 = pont2;
  adicionaVitoria(jogo);
}

void listarJogos(pTabela tabelaJogos, int ordem, int numINP)
{
  int i;
  int k;
  listaJogo *entradas;
  entradas = (listaJogo *) malloc((sizeof(listaJogo)) * tabelaJogos->tamanho);
  k = 0;
  for (i = 0; i < tabelaJogos->tamanho; i++)
  {
    entradas[i] = tabelaJogos->entradaLista[i];
  }

  while (k <= ordem)
  {
    for (i = 0; i < tabelaJogos->tamanho; i++)
    {
      if ((entradas[i] != 0) && (entradas[i]->ordem <= k))
      {
        mostrarJogo(entradas[i]->ptJogo, numINP);
        entradas[i] = entradas[i]->proximo;
      }
      else
      {
        
      }

    }

    k++;
  }

  free(entradas);
}

void libertarTabela(pTabela tabelaJogos)
{
  int i;
  for (i = 0; i < tabelaJogos->tamanho; i++)
  {
    libertarListaJogos(tabelaJogos->entradaLista + i);
  }

  free(tabelaJogos->entradaLista);
  free(tabelaJogos);
}

