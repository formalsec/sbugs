/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "gameslinked.h"
#include "hashteams.h"


gamelist game_listInit()
{
  gamelist list = malloc(sizeof(struct _gamelist));
  list->head = 0;
  list->tail = 0;
  return list;
}

gamelink game_listAddNode(Game game, gamelink prev, gamelink next)
{
  gamelink node = malloc(sizeof(struct gamenode));
  node->game = game;
  node->next = next;
  node->prev = prev;
  return node;
}

gamelist game_insertListEnd(gamelist list, Game game)
{
  if (game_listEmpty(list))
  {
    gamelist aux = list;
    gamelink node = game_listAddNode(game, 0, 0);
    node->prev = node;
    aux->head = (aux->tail = node);
    return aux;
  }
  else
  {
    
  }

  list->tail->next = game_listAddNode(game, list->tail, 0);
  list->tail = list->tail->next;
  return list;
}

void game_listDeleteNode(gamelink node)
{
  gameDestroy(node->game);
  free(node);
}

Game game_getItem(gamelist list)
{
  if (!game_listEmpty(list))
  {
    return list->head->game;
  }
  else
  {
    
  }

  return 0;
}

int game_listEmpty(gamelist list)
{
  return list->head == 0;
}

gamelink game_searchList(gamelist list, char *key)
{
  if (!game_listEmpty(list))
  {
    if (strcmp(list->head->game->name, key) == 0)
    {
      return list->head;
    }
    else
    {
      if (strcmp(list->tail->game->name, key) == 0)
      {
        return list->tail;
      }
      else
      {
        gamelink node;
        for (node = list->head; node != 0; node = node->next)
          if (strcmp(node->game->name, key) == 0)
        {
          return node;
        }
        else
        {
          
        }


      }

    }

  }
  else
  {
    
  }

  return 0;
}

gamelist game_removeList(gamelist list, gamelink node2Delete)
{
  if (node2Delete)
  {
    if (list->tail == list->head)
    {
      list->head = (list->tail = 0);
    }
    else
    {
      if (node2Delete == list->head)
      {
        list->head = node2Delete->next;
        list->head->prev = list->tail;
      }
      else
      {
        if (node2Delete == list->tail)
        {
          list->tail = node2Delete->prev;
          list->tail->next = 0;
        }
        else
        {
          node2Delete->next->prev = node2Delete->prev;
          node2Delete->prev->next = node2Delete->next;
        }

      }

    }

  }
  else
  {
    
  }

  game_listDeleteNode(node2Delete);
  return list;
}

void game_showList(int NL, gamelist list)
{
  gamelink current;
  for (current = list->head; current != 0; current = current->next)
  {
    gamePrint(NL, current->game);
  }

}

gamelist game_changeScore(int NL, gamelist list, char *key, int news1, int news2)
{
  gamelink node = game_searchList(list, key);
  if (node)
  {
    int s1 = gameScoreT1(node->game);
    int s2 = gameScoreT2(node->game);
    node->game = gameChangeScore(node->game, news1, news2);
    if (s1 != s2)
    {
      if (s1 > s2)
      {
        node->game->t1->wins--;
      }
      else
      {
        
      }

      if (s1 < s2)
      {
        node->game->t2->wins--;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    if (news1 == news2)
    {
      return list;
    }
    else
    {
      
    }

    if (news1 > news2)
    {
      node->game->t1->wins++;
    }
    else
    {
      
    }

    if (news1 < news2)
    {
      node->game->t2->wins++;
    }
    else
    {
      
    }

  }
  else
  {
    printf("%d Jogo inexistente.\n", NL);
  }

  return list;
}

void game_destroyList(gamelist list)
{
  gamelink current;
  gamelink aux;
  for (current = list->head; current != 0; current = aux)
  {
    aux = current->next;
    game_listDeleteNode(current);
  }

  free(list);
}

