/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "newTeam.h"
#include "hashTables.h"
#include "newGame.h"
#include "gamesList.h"


TeamsHash *adicionaEquipa(TeamsHash *HashT, int cont)
{
  teamNodeP newTNode;
  char nomeEq1[1024];
  char *eq1;
  int c;
  int i;
  c = getchar();
  for (int nomeEq1_index = 0; nomeEq1_index < 10; nomeEq1_index++)
  {
    nomeEq1[nomeEq1_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeEq1[10 - 1] = '\0';
  eq1 = (char *) malloc((sizeof(char)) * (strlen(nomeEq1) + 1));
  strcpy(eq1, nomeEq1);
  i = verifyExistentTeam(HashT, eq1);
  if ((c > 0) && (i == (-1)))
  {
    printf("%d Equipa existente.\n", cont);
  }
  else
  {
    newTNode = newTeam(eq1);
    HashT = addTeam(HashT, i, newTNode);
  }

  free(eq1);
  return HashT;
}

void procuraEquipa(TeamsHash *HashT, int cont)
{
  char nomeEq1[1024];
  char *eq1;
  Team *team;
  for (int nomeEq1_index = 0; nomeEq1_index < 10; nomeEq1_index++)
  {
    nomeEq1[nomeEq1_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeEq1[10 - 1] = '\0';
  eq1 = (char *) malloc((sizeof(char)) * (strlen(nomeEq1) + 1));
  strcpy(eq1, nomeEq1);
  team = searchTeam(HashT, eq1);
  if (team == 0)
  {
    printf("%d Equipa inexistente.\n", cont);
  }
  else
  {
    printf("%d %s %d\n", cont, team->name, team->wins);
  }

  free(eq1);
}

GamesHash *adicionaJogo(GamesHash *HashG, TeamsHash *HashT, gameListP gameList, int cont)
{
  gameNodeP newGNode;
  char nomeJogo[1024];
  char nomeEq1[1024];
  char nomeEq2[1024];
  char *jogo;
  char *eq1;
  char *eq2;
  int score1 = 0;
  int score2 = 0;
  int a = 0;
  int b = 0;
  int d = 0;
  for (int nomeJogo_index = 0; nomeJogo_index < 10; nomeJogo_index++)
  {
    nomeJogo[nomeJogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeJogo[10 - 1] = '\0';
  for (int nomeEq1_index = 0; nomeEq1_index < 10; nomeEq1_index++)
  {
    nomeEq1[nomeEq1_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeEq1[10 - 1] = '\0';
  for (int nomeEq2_index = 0; nomeEq2_index < 10; nomeEq2_index++)
  {
    nomeEq2[nomeEq2_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeEq2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = (char *) malloc((sizeof(char)) * (strlen(nomeJogo) + 1));
  strcpy(jogo, nomeJogo);
  a = verifyExistentGame(HashG, jogo);
  free(jogo);
  if (a == (-1))
  {
    printf("%d Jogo existente.\n", cont);
  }
  else
  {
    eq1 = (char *) malloc(((sizeof(char)) * strlen(nomeEq1)) + 1);
    strcpy(eq1, nomeEq1);
    eq2 = (char *) malloc(((sizeof(char)) * strlen(nomeEq2)) + 1);
    strcpy(eq2, nomeEq2);
    b = verifyExistentTeam(HashT, eq1);
    d = verifyExistentTeam(HashT, eq2);
    if ((b != (-1)) || (d != (-1)))
    {
      printf("%d Equipa inexistente.\n", cont);
    }
    else
    {
      newGNode = newGame(HashT, nomeJogo, eq1, eq2, score1, score2);
      HashG = addGameHash(HashG, a, newGNode);
      addGameList(gameList, newGNode);
    }

    free(eq1);
    free(eq2);
  }

  return HashG;
}

void procuraJogo(GamesHash *HashG, int cont)
{
  Game *game;
  char nomeJogo[1024];
  char *jogo;
  for (int nomeJogo_index = 0; nomeJogo_index < 10; nomeJogo_index++)
  {
    nomeJogo[nomeJogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeJogo[10 - 1] = '\0';
  jogo = (char *) malloc((sizeof(char)) * (strlen(nomeJogo) + 1));
  strcpy(jogo, nomeJogo);
  game = searchGame(HashG, jogo);
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", cont);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", cont, game->name, game->team1->name, game->team2->name, game->score1, game->score2);
  }

  free(jogo);
}

void apagaJogo(GamesHash *HashG, gameListP gameList, int cont)
{
  Game *game;
  char nomeJogo[1024];
  char *jogo;
  for (int nomeJogo_index = 0; nomeJogo_index < 10; nomeJogo_index++)
  {
    nomeJogo[nomeJogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeJogo[10 - 1] = '\0';
  jogo = (char *) malloc((sizeof(char)) * (strlen(nomeJogo) + 1));
  strcpy(jogo, nomeJogo);
  game = searchGame(HashG, jogo);
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", cont);
  }
  else
  {
    removeWin(game);
    deleteGame(gameList, HashG, jogo);
  }

  free(jogo);
}

void alteraScore(GamesHash *HashG, int cont)
{
  int a;
  int score1 = 0;
  int score2 = 0;
  char nomeJogo[1024];
  char *jogo;
  for (int nomeJogo_index = 0; nomeJogo_index < 10; nomeJogo_index++)
  {
    nomeJogo[nomeJogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nomeJogo[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = (char *) malloc((sizeof(char)) * (strlen(nomeJogo) + 1));
  strcpy(jogo, nomeJogo);
  a = verifyExistentGame(HashG, jogo);
  if (a != (-1))
  {
    printf("%d Jogo inexistente.\n", cont);
  }
  else
  {
    changeScores(HashG, jogo, score1, score2);
  }

  free(jogo);
}

void vencedores(TeamsHash *HashT, int cont)
{
  Team **winnersTable;
  int max = 500;
  winnersTable = (Team **) malloc((sizeof(Team *)) * 500);
  winnersTable = winners(HashT, winnersTable, max, cont);
  free(winnersTable);
}

void destroyAll(GamesHash *HashG, TeamsHash *HashT, gameListP gameList)
{
  destroyTeamsHash(HashT);
  destroyGamesHash(HashG);
  free(HashT);
  free(HashG);
  free(gameList);
}

int main()
{
  int c;
  int cont = 1;
  gameListP gameList;
  TeamsHash *HashT;
  GamesHash *HashG;
  HashT = initTeamsHash(1023);
  HashG = initGamesHash(1023);
  gameList = initGamesList();
  while ((c = getchar()) != 'x')
  {
    if (c == 'A')
    {
      HashT = adicionaEquipa(HashT, cont);
    }
    else
    {
      if (c == 'P')
      {
        procuraEquipa(HashT, cont);
      }
      else
      {
        if (c == 'a')
        {
          HashG = adicionaJogo(HashG, HashT, gameList, cont);
        }
        else
        {
          if (c == 'l')
          {
            listGames(gameList, cont);
          }
          else
          {
            if (c == 'p')
            {
              procuraJogo(HashG, cont);
            }
            else
            {
              if (c == 'r')
              {
                apagaJogo(HashG, gameList, cont);
              }
              else
              {
                if (c == 's')
                {
                  alteraScore(HashG, cont);
                }
                else
                {
                  if (c == 'g')
                  {
                    vencedores(HashT, cont);
                  }
                  else
                  {
                    
                  }

                }

              }

            }

          }

        }

      }

    }

    cont++;
    c = getchar();
  }

  destroyAll(HashG, HashT, gameList);
  return 0;
}

