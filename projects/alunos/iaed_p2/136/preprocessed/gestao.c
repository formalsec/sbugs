/*File generated by PreProcessor.py*/


#include "gestao.h"
#include <stdio.h>
#include <string.h>
#include <stdlib.h>


void inicializa(fila equipas, fila jogos, fila jogos_ord, fila equipas_ord)
{
  int i;
  FILAinit(jogos_ord);
  FILAinit(equipas_ord);
  for (i = 0; i < 9973; i++)
  {
    FILAinit(equipas + i);
    FILAinit(jogos + i);
  }

}

void liberta(fila equipas, fila jogos, fila jogos_ord, fila equipas_ord)
{
  node aux;
  int i;
  for (i = 0; i < 9973; i++)
  {
    aux = equipas[i].head;
    while (aux)
    {
      apaga_equipa((equipa) aux->elem);
      aux = aux->next;
    }

    aux = jogos[i].head;
    while (aux)
    {
      apaga_jogo((jogo) aux->elem);
      aux = aux->next;
    }

    FILAclear(equipas + i);
    FILAclear(jogos + i);
  }

  FILAclear(jogos_ord);
  FILAclear(equipas_ord);
}

void escreve_erro(int nL, int erro)
{
  switch (erro)
  {
    case -1:
      printf("%d Equipa inexistente.\n", nL);
      break;

    case -2:
      printf("%d Equipa existente.\n", nL);
      break;

    case -3:
      printf("%d Jogo inexistente.\n", nL);
      break;

    case -4:
      printf("%d Jogo existente.\n", nL);
      break;

  }

  return;
}

void *encontra(fila Lst, chave c, int flag)
{
  node aux_b;
  node aux_e;
  if ((!Lst->head) || (!Lst->tail))
  {
    return 0;
  }
  else
  {
    
  }

  aux_b = Lst->head;
  aux_e = Lst->tail;
  while (aux_b && aux_e)
  {
    if (flag == (-5))
    {
      if (strcmp(((equipa) aux_b->elem)->nome, c) == 0)
      {
        return aux_b->elem;
      }
      else
      {
        
      }

      if (strcmp(((equipa) aux_e->elem)->nome, c) == 0)
      {
        return aux_e->elem;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    if (flag == (-6))
    {
      if (strcmp(c, ((jogo) aux_b->elem)->nome) == 0)
      {
        return aux_b->elem;
      }
      else
      {
        
      }

      if (strcmp(c, ((jogo) aux_e->elem)->nome) == 0)
      {
        return aux_e->elem;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    aux_b = aux_b->next;
    aux_e = aux_e->prev;
  }

  return 0;
}

void junta_j(fila jogos, jogo j, int flag)
{
  int hashJ;
  switch (flag)
  {
    case -7:
      FILAadd(jogos, j);
      break;

    case -8:
      hashJ = hash(j->nome);
      FILAadd(jogos + hashJ, j);
      break;

  }

}

jogo encontra_j_lst(fila jogos, chave nome)
{
  jogo j;
  j = (jogo) encontra(jogos, nome, -6);
  return j;
}

jogo encontra_j_tab(fila jogos, chave nome)
{
  int hashJ;
  jogo j;
  hashJ = hash(nome);
  j = encontra_j_lst(jogos + hashJ, nome);
  return j;
}

void tira_j(fila jogos, jogo j, int flag)
{
  int hashJ;
  switch (flag)
  {
    case -7:
      FILAremove(jogos, j);
      break;

    case -8:
      hashJ = hash(j->nome);
      FILAremove(jogos + hashJ, j);
      break;

  }

}

void escreve_j_lst(int nL, fila jogos)
{
  node aux;
  aux = jogos->head;
  while (aux)
  {
    escreve_jogo(nL, (jogo) aux->elem);
    aux = aux->next;
  }

}

void junta_e(fila equipas, equipa e, int flag)
{
  int hashE;
  switch (flag)
  {
    case -7:
      FILAadd(equipas, e);
      break;

    case -8:
      hashE = hash(e->nome);
      FILAadd(equipas + hashE, e);
      break;

  }

}

equipa encontra_e_lst(fila equipas, chave nome)
{
  equipa e;
  e = (equipa) encontra(equipas, nome, -5);
  return e;
}

equipa encontra_e_tab(fila equipas, chave nome)
{
  int hashE;
  equipa e;
  hashE = hash(nome);
  e = encontra_e_lst(equipas + hashE, nome);
  return e;
}

par_resultado maximo_vitorias(fila equipas_ord)
{
  node aux_b;
  node aux_e;
  par_resultado max;
  equipa e1;
  equipa e2;
  max.maximo = -9;
  max.num_venc = -9;
  aux_b = equipas_ord->head;
  aux_e = equipas_ord->tail;
  while ((aux_b && aux_e) && (aux_e->next != aux_b))
  {
    e1 = (equipa) aux_b->elem;
    e2 = (equipa) aux_e->elem;
    if (e1->vitorias == max.maximo)
    {
      max.num_venc++;
    }
    else
    {
      if (e1->vitorias > max.maximo)
      {
        max.maximo = e1->vitorias;
        max.num_venc = 1;
      }
      else
      {
        
      }

    }

    if (e2->vitorias == max.maximo)
    {
      max.num_venc++;
    }
    else
    {
      if (e2->vitorias > max.maximo)
      {
        max.maximo = e2->vitorias;
        max.num_venc = 1;
      }
      else
      {
        
      }

    }

    aux_b = aux_b->next;
    aux_e = aux_e->prev;
  }

  return max;
}

arvore *ARVbuild(arvore *raiz, fila equipas_ord, int maximo, int num_venc)
{
  node aux_b;
  node aux_e;
  int i = 0;
  aux_b = equipas_ord->head;
  aux_e = equipas_ord->tail;
  while (i < num_venc)
  {
    equipa e1;
    equipa e2;
    e1 = (equipa) aux_b->elem;
    e2 = (equipa) aux_e->elem;
    if (e1->vitorias == maximo)
    {
      raiz = ARVadd(raiz, e1);
      i++;
    }
    else
    {
      
    }

    if (e2->vitorias == maximo)
    {
      raiz = ARVadd(raiz, e2);
      i++;
    }
    else
    {
      
    }

    aux_b = aux_b->next;
    aux_e = aux_e->prev;
  }

  return raiz;
}

