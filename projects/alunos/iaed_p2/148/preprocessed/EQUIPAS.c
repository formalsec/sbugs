#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "EQUIPAS.h"


ItemE novaEquipa(char *equipa, int vitorias)
{
  ItemE novo = (ItemE) malloc(sizeof(struct Equipas));
  novo->equipa = (char *) malloc((sizeof(char)) * (strlen(equipa) + 1));
  strcpy(novo->equipa, equipa);
  novo->vitorias = vitorias;
  return novo;
}

void freeEquipa(ItemE a)
{
  free(a->equipa);
  free(a);
}

void imprimeEquipa(ItemE a)
{
  printf("%s %d\n", a->equipa, a->vitorias);
}

int funcao_hashE(char *v)
{
  int h = 0;
  int a = 127;
  for (; (*v) != '\0'; v++)
    h = ((a * h) + (*v)) % 997;

  return h;
}

void iniciaE(linkE headsE[])
{
  int i;
  for (i = 0; i < 997; i++)
  {
    headsE[i] = 0;
  }

}

void inserirE(ItemE item, linkE headsE[])
{
  int i = funcao_hashE(item->equipa);
  headsE[i] = inserir_inicioE(headsE[i], item);
}

linkE inserir_inicioE(linkE head, ItemE a)
{
  linkE x = (linkE) malloc(sizeof(struct nodeE));
  x->item = a;
  x->next = head;
  return x;
}

ItemE procura_equipa(char *nome, linkE headsE[])
{
  int i = funcao_hashE(nome);
  return procura_lista_equipa(headsE[i], nome);
}

ItemE procura_lista_equipa(linkE head, char *nome)
{
  linkE t;
  for (t = head; t != 0; t = t->next)
  {
    if (strcmp(t->item->equipa, nome) == 0)
    {
      return t->item;
    }
    else
    {
      
    }

  }

  return 0;
}

int numero_vitorias(linkE headsE[])
{
  int i;
  int vitorias = 0;
  linkE t;
  for (i = 0; i < 997; i++)
  {
    for (t = headsE[i]; t != 0; t = t->next)
    {
      if (t->item->vitorias > vitorias)
      {
        vitorias = t->item->vitorias;
      }
      else
      {
        
      }

    }

  }

  return vitorias;
}

void nome_equipas(int vitorias, int nl, int contadorequipas, linkE headsE[])
{
  int i;
  int x;
  int j = 0;
  char **equipas;
  linkE t;
  equipas = (char **) malloc((sizeof(char *)) * contadorequipas);
  for (i = 0; i < 997; i++)
  {
    for (t = headsE[i]; t != 0; t = t->next)
    {
      if (t->item->vitorias == vitorias)
      {
        equipas[j] = (char *) malloc((sizeof(char)) * (strlen(t->item->equipa) + 1));
        strcpy(equipas[j], t->item->equipa);
        j++;
      }
      else
      {
        
      }

    }

  }

  if (j > 0)
  {
    qsort(equipas, j, sizeof(char *), compara);
    printf("%d Melhores %d\n", nl, vitorias);
    for (x = 0; x < j; x++)
    {
      printf("%d * %s\n", nl, equipas[x]);
      free(equipas[x]);
    }

  }
  else
  {
    
  }

  free(equipas);
}

void sair_hashE(linkE headsE[])
{
  linkE t;
  linkE aux;
  int i;
  for (i = 0; i < 997; i++)
  {
    for (t = headsE[i]; t != 0;)
    {
      aux = t;
      t = t->next;
      freeEquipa(aux->item);
      free(aux);
    }

  }

}

int compara(const void *a, const void *b)
{
  char **aa;
  char **bb;
  aa = (char **) a;
  bb = (char **) b;
  return strcmp(*aa, *bb);
}

