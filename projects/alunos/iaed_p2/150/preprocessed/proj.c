/*File generated by PreProcessor.py*/


#include "proj.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>


void AddNewGame(char *name, char *team1, char *team2, int score1, int score2, TEAMlink *Teams, GAMElink *Games, int *countInput, int *countGames, int *index)
{
  Game *new = 0;
  Team *t1 = TEAMsearch(team1, Teams);
  Team *t2 = TEAMsearch(team2, Teams);
  (*countInput)++;
  if (GAMEsearch(name, Games) != 0)
  {
    printf("%d Jogo existente.\n", *countInput);
  }
  else
  {
    if ((t1 == 0) || (t2 == 0))
    {
      printf("%d Equipa inexistente.\n", *countInput);
    }
    else
    {
      (*countGames)++;
      new = newGame(name, team1, team2, score1, score2, index);
      GAMEinsert(new, Games);
      if (score1 > score2)
      {
        t1->wins++;
      }
      else
      {
        if (score1 < score2)
        {
          t2->wins++;
        }
        else
        {
          
        }

      }

      (*index)++;
    }

  }

}

void AddNewTeam(char *name, TEAMlink *Teams, int *countInput)
{
  Team *new = 0;
  (*countInput)++;
  if (TEAMsearch(name, Teams) != 0)
  {
    printf("%d Equipa existente.\n", *countInput);
  }
  else
  {
    new = newTeam(name);
    TEAMinsert(new, Teams);
  }

}

void SearchGame(char *name, GAMElink *Games, int *countInput)
{
  Game *game = GAMEsearch(name, Games);
  (*countInput)++;
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", *countInput);
  }
  else
  {
    printf("%d ", *countInput);
    printGame(game);
  }

}

void DeleteGame(char *name, TEAMlink *Teams, GAMElink *Games, int *countInput, int *countGames)
{
  Game *game = GAMEsearch(name, Games);
  Team *t1;
  Team *t2;
  (*countInput)++;
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", *countInput);
  }
  else
  {
    t1 = TEAMsearch(game->team1, Teams);
    t2 = TEAMsearch(game->team2, Teams);
    if (game->score1 > game->score2)
    {
      t1->wins--;
    }
    else
    {
      if (game->score1 < game->score2)
      {
        t2->wins--;
      }
      else
      {
        
      }

    }

    GAMEdelete(name, Games);
    (*countGames)--;
  }

}

void ChangeScore(char *name, int NewScore1, int NewScore2, TEAMlink *Teams, GAMElink *Games, int *countInput)
{
  Game *game = GAMEsearch(name, Games);
  Team *team1;
  Team *team2;
  int OldScore1;
  int OldScore2;
  (*countInput)++;
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", *countInput);
  }
  else
  {
    OldScore1 = game->score1;
    OldScore2 = game->score2;
    game->score1 = NewScore1;
    game->score2 = NewScore2;
    team1 = TEAMsearch(game->team1, Teams);
    team2 = TEAMsearch(game->team2, Teams);
    if (OldScore1 > OldScore2)
    {
      if (NewScore1 < NewScore2)
      {
        team1->wins--;
        team2->wins++;
      }
      else
      {
        if (NewScore1 == NewScore2)
        {
          team1->wins--;
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (OldScore1 < OldScore2)
      {
        if (NewScore1 > NewScore2)
        {
          team1->wins++;
          team2->wins--;
        }
        else
        {
          if (NewScore1 == NewScore2)
          {
            team2->wins--;
          }
          else
          {
            
          }

        }

      }
      else
      {
        if (OldScore1 == OldScore2)
        {
          if (NewScore1 > NewScore2)
          {
            team1->wins++;
          }
          else
          {
            if (NewScore1 < NewScore2)
            {
              team2->wins++;
            }
            else
            {
              
            }

          }

        }
        else
        {
          
        }

      }

    }

  }

}

void SearchTeam(char *name, TEAMlink *Teams, int *countInput)
{
  Team *team = TEAMsearch(name, Teams);
  (*countInput)++;
  if (team == 0)
  {
    printf("%d Equipa inexistente.\n", *countInput);
  }
  else
  {
    printf("%d ", *countInput);
    printTeam(team);
    printf(" %d\n", team->wins);
  }

}

int CompIndex(const void *a, const void *b)
{
  Game *game1;
  Game *game2;
  game1 = *((Game **) a);
  game2 = *((Game **) b);
  return game1->index - game2->index;
}

void ListsGames(GAMElink *Games, int *countGames, int *countInput)
{
  Game **GamesList;
  GAMElink head;
  int i;
  int j = 0;
  (*countInput)++;
  if ((*countGames) < 0)
  {
    return;
  }
  else
  {
    
  }

  GamesList = malloc((sizeof(Game *)) * ((*countGames) + 1));
  for (i = 0; i < 1009; i++)
  {
    head = Games[i];
    while (head)
    {
      GamesList[j] = head->game;
      head = head->next;
      j++;
    }

  }

  qsort(GamesList, (*countGames) + 1, sizeof(Game *), CompIndex);
  for (i = 0; i <= (*countGames); i++)
  {
    printf("%d ", *countInput);
    printGame(GamesList[i]);
  }

  free(GamesList);
}

int CompFunc(const void *a, const void *b)
{
  Team *team1;
  Team *team2;
  team1 = *((Team **) a);
  team2 = *((Team **) b);
  return strcmp(team1->name, team2->name);
}

void ListsBestTeams(TEAMlink *Teams, int *countInput)
{
  int i;
  int j = 0;
  int BestScore = 0;
  int countTeams = -1;
  Team **TeamsList;
  TEAMlink head;
  (*countInput)++;
  for (i = 0; i < 1009; i++)
  {
    head = Teams[i];
    while (head)
    {
      if (head->team->wins == BestScore)
      {
        countTeams++;
      }
      else
      {
        if (head->team->wins > BestScore)
        {
          countTeams = 0;
          BestScore = head->team->wins;
        }
        else
        {
          
        }

      }

      head = head->next;
    }

  }

  if (countTeams < 0)
  {
    return;
  }
  else
  {
    
  }

  TeamsList = malloc((sizeof(Team *)) * (countTeams + 1));
  for (i = 0; i < 1009; i++)
  {
    head = Teams[i];
    while (head)
    {
      if (head->team->wins == BestScore)
      {
        TeamsList[j] = head->team;
        j++;
      }
      else
      {
        
      }

      head = head->next;
    }

  }

  qsort(TeamsList, countTeams + 1, sizeof(Team *), CompFunc);
  printf("%d Melhores %d\n", *countInput, BestScore);
  for (i = 0; i <= countTeams; i++)
  {
    printf("%d * ", *countInput);
    printTeam(TeamsList[i]);
    printf("\n");
  }

  free(TeamsList);
}

