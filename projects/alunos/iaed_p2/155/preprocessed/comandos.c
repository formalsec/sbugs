#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "comandos.h"


char LeCaracterInicial()
{
  char CaracterInicial;
  CaracterInicial = new_sym_var(sizeof(char) * 8);
  return CaracterInicial;
}

unsigned int hash_function(char *nome)
{
  int tamanho;
  int i;
  unsigned int hash = 0;
  tamanho = strlen(nome);
  for (i = 0; i < tamanho; i++)
  {
    hash = hash + (nome[i] ^ 3);
    hash = hash + (nome[i] * nome[i]);
    hash = (hash * nome[i]) % 2000;
  }

  return hash;
}

void free_jogos(jogo *hash[2000])
{
  int i;
  jogo *aux_1;
  jogo *aux_2;
  for (i = 0; i < 2000; i++)
  {
    if (hash[i] != 0)
    {
      for (aux_1 = hash[i]; aux_1 != 0; aux_1 = aux_2)
      {
        aux_2 = aux_1->next;
        free(aux_1->equipa_1);
        free(aux_1->equipa_2);
        free(aux_1->nome_jogo);
        free(aux_1);
      }

    }
    else
    {
      
    }

  }

}

void free_equipas(equipa *hash[2000])
{
  int i;
  equipa *aux_1;
  equipa *aux_2;
  for (i = 0; i < 2000; i++)
  {
    if (hash[i] != 0)
    {
      for (aux_1 = hash[i]; aux_1 != 0; aux_1 = aux_2)
      {
        aux_2 = aux_1->next;
        free(aux_1->nome_equipa);
        free(aux_1);
      }

    }
    else
    {
      
    }

  }

}

void free_listas(node *head)
{
  node *aux_1;
  node *aux_2;
  aux_1 = head;
  while (aux_1 != 0)
  {
    aux_2 = aux_1->next;
    free(aux_1);
    aux_1 = aux_2;
  }

  free(aux_1);
}

jogo *Comando_a(int contador, equipa *hash_1[2000], jogo *hash_2[2000])
{
  char string_nome[1024];
  char string_nome_1[1024];
  char string_nome_2[1024];
  equipa *aux_1;
  equipa *aux_2;
  jogo *novo_jogo;
  jogo *jogo_aux;
  novo_jogo = (jogo *) malloc(sizeof(jogo));
  for (int string_nome_index = 0; string_nome_index < 10; string_nome_index++)
  {
    string_nome[string_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  string_nome[10 - 1] = '\0';
  for (int string_nome_1_index = 0; string_nome_1_index < 10; string_nome_1_index++)
  {
    string_nome_1[string_nome_1_index] = new_sym_var(sizeof(char) * 8);
  }

  string_nome_1[10 - 1] = '\0';
  for (int string_nome_2_index = 0; string_nome_2_index < 10; string_nome_2_index++)
  {
    string_nome_2[string_nome_2_index] = new_sym_var(sizeof(char) * 8);
  }

  string_nome_2[10 - 1] = '\0';
  novo_jogo->score_1 = new_sym_var(sizeof(int) * 8);
  novo_jogo->score_2 = new_sym_var(sizeof(int) * 8);
  novo_jogo->nome_jogo = (char *) malloc((strlen(string_nome) + 1) * (sizeof(char)));
  novo_jogo->equipa_1 = (char *) malloc((strlen(string_nome_1) + 1) * (sizeof(char)));
  novo_jogo->equipa_2 = (char *) malloc((strlen(string_nome_2) + 1) * (sizeof(char)));
  strcpy(novo_jogo->nome_jogo, string_nome);
  strcpy(novo_jogo->equipa_1, string_nome_1);
  strcpy(novo_jogo->equipa_2, string_nome_2);
  jogo_aux = hash_table_jogo_lookup(novo_jogo->nome_jogo, hash_2);
  aux_1 = hash_table_equipa_lookup(novo_jogo->equipa_1, hash_1);
  aux_2 = hash_table_equipa_lookup(novo_jogo->equipa_2, hash_1);
  if ((jogo_aux != 0) && (strcmp(jogo_aux->nome_jogo, novo_jogo->nome_jogo) == 0))
  {
    printf("%d Jogo existente.\n", contador);
    free(novo_jogo->equipa_1);
    free(novo_jogo->equipa_2);
    free(novo_jogo->nome_jogo);
    free(novo_jogo);
    return 0;
  }
  else
  {
    
  }

  if ((aux_1 == 0) || (aux_2 == 0))
  {
    printf("%d Equipa inexistente.\n", contador);
    free(novo_jogo->equipa_1);
    free(novo_jogo->equipa_2);
    free(novo_jogo->nome_jogo);
    free(novo_jogo);
    return 0;
  }
  else
  {
    if (novo_jogo->score_1 > novo_jogo->score_2)
    {
      aux_1->vitorias++;
    }
    else
    {
      
    }

    if (novo_jogo->score_1 < novo_jogo->score_2)
    {
      aux_2->vitorias++;
    }
    else
    {
      
    }

    return novo_jogo;
  }

}

equipa *Comando_A(int contador, equipa *hash[2000])
{
  char string_nome_equipa[1024];
  equipa *nova_equipa;
  equipa *equipa_aux;
  nova_equipa = (equipa *) malloc(sizeof(equipa));
  for (int string_nome_equipa_index = 0; string_nome_equipa_index < 10; string_nome_equipa_index++)
  {
    string_nome_equipa[string_nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  string_nome_equipa[10 - 1] = '\0';
  nova_equipa->nome_equipa = (char *) malloc((strlen(string_nome_equipa) + 1) * (sizeof(char)));
  strcpy(nova_equipa->nome_equipa, string_nome_equipa);
  equipa_aux = hash_table_equipa_lookup(nova_equipa->nome_equipa, hash);
  if ((equipa_aux != 0) && (strcmp(equipa_aux->nome_equipa, nova_equipa->nome_equipa) == 0))
  {
    printf("%d Equipa existente.\n", contador);
    free(nova_equipa->nome_equipa);
    free(nova_equipa);
    return 0;
  }
  else
  {
    return nova_equipa;
  }

}

int Comando_l(int contador, node *head)
{
  node *aux_1;
  jogo *aux_3;
  int aux_2;
  aux_2 = contador;
  if (head != 0)
  {
    for (aux_1 = head; aux_1 != 0; aux_1 = aux_1->next)
    {
      aux_3 = aux_1->jogo;
      printf("%d %s %s %s %d %d\n", aux_2, aux_3->nome_jogo, aux_3->equipa_1, aux_3->equipa_2, aux_3->score_1, aux_3->score_2);
    }

  }
  else
  {
    
  }

  return aux_2;
}

void Comando_p(int contador, jogo *hash[2000])
{
  char nome[1024];
  jogo *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = hash_table_jogo_lookup(nome, hash);
  if (aux == 0)
  {
    printf("%d Jogo inexistente.\n", contador);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", contador, aux->nome_jogo, aux->equipa_1, aux->equipa_2, aux->score_1, aux->score_2);
  }

}

void Comando_P(int contador, equipa *hash[2000])
{
  char nome[1024];
  equipa *aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux = hash_table_equipa_lookup(nome, hash);
  if (aux == 0)
  {
    printf("%d Equipa inexistente.\n", contador);
  }
  else
  {
    printf("%d %s %d\n", contador, aux->nome_equipa, aux->vitorias);
  }

}

jogo *Comando_r(int contador, jogo *hash_1[2000], equipa *hash_2[2000])
{
  char nome[1024];
  jogo *aux_1;
  equipa *equipa_aux;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  aux_1 = hash_table_jogo_lookup(nome, hash_1);
  if (aux_1 == 0)
  {
    printf("%d Jogo inexistente.\n", contador);
    return 0;
  }
  else
  {
    if (aux_1->score_1 > aux_1->score_2)
    {
      equipa_aux = hash_table_equipa_lookup(aux_1->equipa_1, hash_2);
      equipa_aux->vitorias--;
    }
    else
    {
      
    }

    if (aux_1->score_1 < aux_1->score_2)
    {
      equipa_aux = hash_table_equipa_lookup(aux_1->equipa_2, hash_2);
      equipa_aux->vitorias--;
    }
    else
    {
      
    }

    return aux_1;
  }

}

node *Comando_s(int contador, jogo *hash_1[2000], equipa *hash_2[2000], node *head)
{
  char nome[1024];
  int score_1;
  int score_2;
  int score_orig_1;
  int score_orig_2;
  jogo *aux_1;
  node *aux_2;
  equipa *equipa_1;
  equipa *equipa_2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score_1 = new_sym_var(sizeof(int) * 8);
  score_2 = new_sym_var(sizeof(int) * 8);
  aux_1 = hash_table_jogo_lookup(nome, hash_1);
  if (aux_1 == 0)
  {
    printf("%d Jogo inexistente.\n", contador);
  }
  else
  {
    score_orig_1 = aux_1->score_1;
    score_orig_2 = aux_1->score_2;
    aux_1->score_1 = score_1;
    aux_1->score_2 = score_2;
    aux_2 = lista_lookup(nome, head);
    aux_2->jogo->score_1 = score_1;
    aux_2->jogo->score_2 = score_2;
    equipa_1 = hash_table_equipa_lookup(aux_1->equipa_1, hash_2);
    equipa_2 = hash_table_equipa_lookup(aux_1->equipa_2, hash_2);
    if (score_orig_1 > score_orig_2)
    {
      if (score_1 == score_2)
      {
        equipa_1->vitorias--;
      }
      else
      {
        if (score_1 < score_2)
        {
          equipa_1->vitorias--;
          equipa_2->vitorias++;
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (score_orig_1 < score_orig_2)
      {
        if (score_1 == score_2)
        {
          equipa_2->vitorias--;
        }
        else
        {
          
        }

        if (score_1 > score_2)
        {
          equipa_2->vitorias--;
          equipa_1->vitorias++;
        }
        else
        {
          
        }

      }
      else
      {
        if (score_1 < score_2)
        {
          equipa_2->vitorias++;
        }
        else
        {
          
        }

        if (score_1 > score_2)
        {
          equipa_1->vitorias++;
        }
        else
        {
          
        }

      }

    }

  }

  return head;
}

int Compara_strings(const void *string_1, const void *string_2)
{
  const char *p_string_1;
  const char *p_string_2;
  p_string_1 = *((const char **) string_1);
  p_string_2 = *((const char **) string_2);
  return strcmp(p_string_1, p_string_2);
}

int Comando_g(int contador, equipa *hash[2000])
{
  int max_vitorias;
  int index_matriz;
  int existe;
  int cont;
  int i;
  int j;
  int k;
  char *vetor_strings[1024];
  equipa *aux_1;
  equipa *aux_2;
  equipa *aux_3;
  equipa *aux_4;
  max_vitorias = 0;
  index_matriz = 0;
  cont = contador;
  existe = 0;
  for (i = 0; i < 2000; i++)
  {
    aux_1 = hash[i];
    for (aux_2 = aux_1; aux_2 != 0; aux_2 = aux_2->next)
    {
      if (aux_2->vitorias >= max_vitorias)
      {
        max_vitorias = aux_2->vitorias;
        existe = 1;
      }
      else
      {
        
      }

    }

  }

  if (existe == 1)
  {
    for (k = 0; k < 2000; k++)
    {
      aux_3 = hash[k];
      for (aux_4 = aux_3; aux_4 != 0; aux_4 = aux_4->next)
      {
        if (aux_4->vitorias == max_vitorias)
        {
          vetor_strings[index_matriz] = aux_4->nome_equipa;
          index_matriz++;
        }
        else
        {
          
        }

      }

    }

    qsort(vetor_strings, index_matriz, sizeof(char *), Compara_strings);
    printf("%d Melhores %d\n", cont, max_vitorias);
    for (j = 0; j < index_matriz; j++)
    {
      printf("%d * %s\n", cont, vetor_strings[j]);
    }

  }
  else
  {
    
  }

  return cont;
}

