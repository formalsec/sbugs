/*File generated by PreProcessor.py*/


#include <stdio.h>
#include "jogos.h"


link_jogo *a(int NL, pt_nome *nomes_jogos, link_jogo *jogos, link_equipa *equipas)
{
  int score1;
  int score2;
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  pt_jogo jogo_novo;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if (jogo_existe(nome, jogos))
  {
    printf("%d Jogo existente.\n", NL);
    return jogos;
  }
  else
  {
    if (!equipa_existe(equipa1, equipas))
    {
      printf("%d Equipa inexistente.\n", NL);
      return jogos;
    }
    else
    {
      if (!equipa_existe(equipa2, equipas))
      {
        printf("%d Equipa inexistente.\n", NL);
        return jogos;
      }
      else
      {
        
      }

    }

  }

  jogo_novo = novo_jogo(nome, equipa1, equipa2, score1, score2, equipas);
  insere_jogo_tabela(jogo_novo, jogos);
  *nomes_jogos = novo_nome(nome, *nomes_jogos);
  if (score1 > score2)
  {
    jogo_novo->equipa1->vitorias++;
  }
  else
  {
    if (score2 > score1)
    {
      jogo_novo->equipa2->vitorias++;
    }
    else
    {
      
    }

  }

  return jogos;
}

link_equipa *A(int NL, link_equipa *equipas)
{
  char nome[1024];
  pt_equipa equipa;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (equipa_existe(nome, equipas))
  {
    printf("%d Equipa existente.\n", NL);
    return equipas;
  }
  else
  {
    equipa = nova_equipa(nome);
    insere_equipa_tabela(equipa, equipas);
    return equipas;
  }

}

void l(int NL, pt_nome nomes_jogos, link_jogo *jogos)
{
  pt_jogo jogo;
  while (nomes_jogos->next != 0)
  {
    jogo = procura_jogo(nomes_jogos->nome, jogos);
    printf("%d %s %s %s %d %d\n", NL, nomes_jogos->nome, jogo->equipa1->nome, jogo->equipa2->nome, jogo->score1, jogo->score2);
    nomes_jogos = nomes_jogos->next;
  }

}

void p(int NL, link_jogo *jogos)
{
  char nome[1024];
  pt_jogo jogo;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  jogo = procura_jogo(nome, jogos);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", NL, nome, jogo->equipa1->nome, jogo->equipa2->nome, jogo->score1, jogo->score2);
  }

}

void P(int NL, link_equipa *equipas)
{
  char nome[1024];
  pt_equipa equipa;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa = procura_equipa(nome, equipas);
  if (equipa == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
  }
  else
  {
    printf("%d %s %d\n", NL, nome, equipa->vitorias);
  }

}

link_jogo *r(int NL, pt_nome *nomes_jogos, link_jogo *jogos)
{
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (!jogo_existe(nome, jogos))
  {
    printf("%d Jogo inexistente.\n", NL);
    return jogos;
  }
  else
  {
    apaga_jogo_tabela(nome, jogos);
    *nomes_jogos = apaga_nome_lista(*nomes_jogos, nome);
    return jogos;
  }

}

link_jogo *s(int NL, link_jogo *jogos)
{
  char nome[1024];
  pt_jogo jogo;
  int score1;
  int score2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = procura_jogo(nome, jogos);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
    return jogos;
  }
  else
  {
    if ((jogo->score1 > jogo->score2) && (score1 < score2))
    {
      jogo->equipa1->vitorias--;
      jogo->equipa2->vitorias++;
    }
    else
    {
      if ((jogo->score1 < jogo->score2) && (score1 > score2))
      {
        jogo->equipa2->vitorias--;
        jogo->equipa1->vitorias++;
      }
      else
      {
        if ((jogo->score1 > jogo->score2) && (score1 == score2))
        {
          jogo->equipa1->vitorias--;
        }
        else
        {
          if ((jogo->score1 < jogo->score2) && (score1 == score2))
          {
            jogo->equipa2->vitorias--;
          }
          else
          {
            if ((jogo->score1 == jogo->score2) && (score1 > score2))
            {
              jogo->equipa1->vitorias++;
            }
            else
            {
              if ((jogo->score1 == jogo->score2) && (score1 < score2))
              {
                jogo->equipa2->vitorias++;
              }
              else
              {
                
              }

            }

          }

        }

      }

    }

    jogo->score1 = score1;
    jogo->score2 = score2;
    return jogos;
  }

}

void g(int NL, link_equipa *equipas)
{
  pt_nome nomes[1024];
  link_equipa aux;
  int i;
  int comp;
  int max_comp = 0;
  int size;
  int max_score = max_vitorias(equipas);
  size = 0;
  for (i = 0; i < (1009 / 2); i++)
  {
    aux = equipas[i];
    while (aux != 0)
    {
      if (aux->equipa->vitorias == max_score)
      {
        comp = strlen(aux->equipa->nome) + 1;
        if (comp > max_comp)
        {
          max_comp = comp;
        }
        else
        {
          
        }

        nomes[size] = (pt_nome) malloc(sizeof(struct nome));
        nomes[size]->nome = (char *) malloc(comp * (sizeof(char)));
        strcpy(nomes[size]->nome, aux->equipa->nome);
        size++;
      }
      else
      {
        
      }

      aux = aux->next;
    }

  }

  qsort(nomes, size, max_comp, compara);
  if (size > 0)
  {
    printf("%d Melhores %d\n", NL, max_score);
  }
  else
  {
    
  }

  for (i = 0; i < size; i++)
  {
    printf("%d * %s\n", NL, nomes[i]->nome);
    free(nomes[i]->nome);
    free(nomes[i]);
  }

}

int main()
{
  char com;
  int NL = 0;
  link_jogo *jogos;
  link_equipa *equipas;
  pt_nome nomes_jogos = (pt_nome) malloc(sizeof(struct nome));
  nomes_jogos->next = 0;
  jogos = (link_jogo *) malloc(1009 * (sizeof(struct node_jogo)));
  jogos = init_jogos(jogos);
  equipas = (link_equipa *) malloc((1009 / 2) * (sizeof(struct node_equipa)));
  equipas = init_equipas(equipas);
  while ((com = getchar()) != 'x')
  {
    switch (com)
    {
      case 'a':
        NL++;
        jogos = a(NL, &nomes_jogos, jogos, equipas);
        break;

      case 'A':
        NL++;
        equipas = A(NL, equipas);
        break;

      case 'l':
        NL++;
        l(NL, nomes_jogos, jogos);
        break;

      case 'p':
        NL++;
        p(NL, jogos);
        break;

      case 'P':
        NL++;
        P(NL, equipas);
        break;

      case 'r':
        NL++;
        r(NL, &nomes_jogos, jogos);
        break;

      case 's':
        NL++;
        s(NL, jogos);
        break;

      case 'g':
        NL++;
        g(NL, equipas);
        break;

      default:
        break;

    }

  }

  free_all(jogos, equipas, nomes_jogos);
  return 0;
}

