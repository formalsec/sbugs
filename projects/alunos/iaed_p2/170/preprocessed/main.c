/*File generated by PreProcessor.py*/


#include "hashtable.h"
#include "data.h"
#include "list.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdbool.h>


void PrintTeam(Team team, int NL)
{
  printf("%d %s %d\n", NL, NameTeam(team), Wins(team));
}

void PrintGame(Game game, int NL)
{
  printf("%d %s %s %s %d %d\n", NL, NameGame(game), Team1(game), Team2(game), Score1(game), Score2(game));
}

void ErrorTeam1(int NL)
{
  printf("%d Equipa existente.\n", NL);
}

void ErrorTeam2(int NL)
{
  printf("%d Equipa inexistente.\n", NL);
}

void ErrorGame1(int NL)
{
  printf("%d Jogo existente.\n", NL);
}

void ErrorGame2(int NL)
{
  printf("%d Jogo inexistente.\n", NL);
}

void A(HT_Team Teams, int NL)
{
  char name[1024];
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  if (SearchHT_Team(Teams, name) != 0)
  {
    ErrorTeam1(NL);
  }
  else
  {
    InsertHT_Team(Teams, NewTeam(name));
  }

}

void P(HT_Team Teams, int NL)
{
  char name[1024];
  Team team;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  team = SearchHT_Team(Teams, name);
  if (team == 0)
  {
    ErrorTeam2(NL);
  }
  else
  {
    PrintTeam(team, NL);
  }

}

void a(HT_Game Games, HT_Team Teams, List Glist, int NL)
{
  char game_name[1024];
  char team1[1024];
  char team2[1024];
  int score1;
  int score2;
  Team T1;
  Team T2;
  for (int game_name_index = 0; game_name_index < 10; game_name_index++)
  {
    game_name[game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  game_name[10 - 1] = '\0';
  for (int team1_index = 0; team1_index < 10; team1_index++)
  {
    team1[team1_index] = new_sym_var(sizeof(char) * 8);
  }

  team1[10 - 1] = '\0';
  for (int team2_index = 0; team2_index < 10; team2_index++)
  {
    team2[team2_index] = new_sym_var(sizeof(char) * 8);
  }

  team2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  T1 = SearchHT_Team(Teams, team1);
  T2 = SearchHT_Team(Teams, team2);
  if (SearchHT_Game(Games, game_name) != 0)
  {
    ErrorGame1(NL);
  }
  else
  {
    if ((T1 == 0) || (T2 == 0))
    {
      ErrorTeam2(NL);
    }
    else
    {
      InsertHT_Game(Games, NewGame(game_name, team1, team2, score1, score2));
      if (score1 > score2)
      {
        ChangeWins(T1, 1);
      }
      else
      {
        if (score2 > score1)
        {
          ChangeWins(T2, 1);
        }
        else
        {
          
        }

      }

      Append_List(Glist, game_name);
    }

  }

}

void p(HT_Game Games, int NL)
{
  char name[1024];
  Game game;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  game = SearchHT_Game(Games, name);
  if (game == 0)
  {
    ErrorGame2(NL);
  }
  else
  {
    PrintGame(game, NL);
  }

}

void r(HT_Game Games, HT_Team Teams, List Glist, int NL)
{
  char name[1024];
  int score1;
  int score2;
  Team T1;
  Team T2;
  Game game;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  game = SearchHT_Game(Games, name);
  if (game == 0)
  {
    ErrorGame2(NL);
  }
  else
  {
    score1 = Score1(game);
    score2 = Score2(game);
    T1 = SearchHT_Team(Teams, Team1(game));
    T2 = SearchHT_Team(Teams, Team2(game));
    RemoveHT_Game(Games, game);
    Remove_List(Glist, name);
    if (score1 > score2)
    {
      ChangeWins(T1, -1);
    }
    else
    {
      if (score1 < score2)
      {
        ChangeWins(T2, -1);
      }
      else
      {
        
      }

    }

  }

}

void s(HT_Game Games, HT_Team Teams, int NL)
{
  char name[1024];
  int score1;
  int score2;
  int old_score1;
  int old_score2;
  Game game;
  Team T1;
  Team T2;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  game = SearchHT_Game(Games, name);
  if (game == 0)
  {
    ErrorGame2(NL);
  }
  else
  {
    old_score1 = Score1(game);
    old_score2 = Score2(game);
    ChangeScore(game, score1, score2);
    T1 = SearchHT_Team(Teams, Team1(game));
    T2 = SearchHT_Team(Teams, Team2(game));
    if ((old_score1 > old_score2) && ((score1 < score2) || (score1 == score2)))
    {
      ChangeWins(T1, -1);
      if (score1 < score2)
      {
        ChangeWins(T2, 1);
      }
      else
      {
        
      }

    }
    else
    {
      if ((old_score1 < old_score2) && ((score1 > score2) || (score1 == score2)))
      {
        ChangeWins(T2, -1);
        if (score1 > score2)
        {
          ChangeWins(T1, 1);
        }
        else
        {
          
        }

      }
      else
      {
        if (old_score1 == old_score2)
        {
          if (score1 > score2)
          {
            ChangeWins(T1, 1);
          }
          else
          {
            if (score1 < score2)
            {
              ChangeWins(T2, 1);
            }
            else
            {
              
            }

          }

        }
        else
        {
          
        }

      }

    }

  }

}

void l(HT_Game Games, List Glist, int NL)
{
  Node aux = Glist->head;
  Game game;
  char *name;
  while (aux != 0)
  {
    name = aux->name;
    game = SearchHT_Game(Games, name);
    PrintGame(game, NL);
    aux = aux->next;
  }

}

void g(HT_Team Teams, int NL)
{
  HighestWin(Teams, NL);
}

int main()
{
  char command = 0;
  int NL = 0;
  List Glist = NewList();
  HT_Team Teams = NewHT_Team(769);
  HT_Game Games = NewHT_Game(769);
  while (command != 'x')
  {
    switch (command = getchar())
    {
      case 'A':
      {
        NL++;
        A(Teams, NL);
        break;
      }

      case 'P':
      {
        NL++;
        P(Teams, NL);
        break;
      }

      case 'a':
      {
        NL++;
        a(Games, Teams, Glist, NL);
        break;
      }

      case 'p':
      {
        NL++;
        p(Games, NL);
        break;
      }

      case 'r':
      {
        NL++;
        r(Games, Teams, Glist, NL);
        break;
      }

      case 's':
      {
        NL++;
        s(Games, Teams, NL);
        break;
      }

      case 'l':
      {
        NL++;
        l(Games, Glist, NL);
        break;
      }

      case 'g':
      {
        NL++;
        g(Teams, NL);
        break;
      }

    }

  }

  DeleteHT_Game(Games);
  DeleteHT_Team(Teams);
  Delete_List(Glist);
  return 0;
}

