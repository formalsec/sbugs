#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "library.h"


ptr_jogo *Init_hash_jogo(int j, ptr_jogo *h_jogo)
{
  int i;
  h_jogo = (ptr_jogo *) malloc(j * (sizeof(ptr_jogo)));
  for (i = 0; i < j; i++)
    h_jogo[i] = 0;

  return h_jogo;
}

void free_jogo(ptr_jogo ptr_j)
{
  free(ptr_j->nome);
  free(ptr_j);
}

void free_hash_jogo(int j, ptr_jogo *h_jogo)
{
  int i;
  ptr_jogo elem;
  ptr_jogo aux;
  for (i = 0; i < j; i++)
  {
    elem = h_jogo[i];
    while (elem != 0)
    {
      aux = elem->next;
      free_jogo(elem);
      elem = aux;
    }

  }

  free(h_jogo);
}

void ptr_ord_jogo(ptr_jogo fila, ptr_jogo ptr)
{
  int anterior;
  int proximo;
  ptr_jogo elem;
  elem = fila;
  while (elem != 0)
  {
    anterior = strcmp(elem->nome, ptr->nome);
    if (anterior == 0)
    {
      return;
    }
    else
    {
      if (elem->next == 0)
      {
        elem->next = ptr;
        ptr->last = elem;
        return;
      }
      else
      {
        
      }

    }

    proximo = strcmp(elem->next->nome, ptr->nome);
    if (proximo == 0)
    {
      return;
    }
    else
    {
      if ((anterior < 0) && (proximo > 0))
      {
        ptr->next = elem->next;
        elem->next = ptr;
        ptr->next->last = ptr;
        ptr->last = elem;
        return;
      }
      else
      {
        
      }

    }

    elem = elem->next;
  }

  return;
}

ptr_jogo percorre_fila(ptr_jogo elem, char *nome)
{
  while (elem != 0)
  {
    if (strcmp(elem->nome, nome) == 0)
    {
      return elem;
    }
    else
    {
      if (strcmp(elem->nome, nome) > 0)
      {
        break;
      }
      else
      {
        
      }

    }

    elem = elem->next;
  }

  return 0;
}

void add_jogo_lista(ptr_jogo *head, ptr_jogo *tail, ptr_jogo jogo)
{
  if (head[0] == 0)
  {
    head[0] = jogo;
    return;
  }
  else
  {
    if (head[0]->next_ordem == 0)
    {
      tail[0] = jogo;
      head[0]->next_ordem = tail[0];
      tail[0]->last_ordem = head[0];
      return;
    }
    else
    {
      
    }

  }

  jogo->last_ordem = tail[0];
  tail[0]->next_ordem = jogo;
  tail[0] = tail[0]->next_ordem;
  return;
}

void remove_jogo_lista(ptr_jogo *head, ptr_jogo *tail, ptr_jogo jogo)
{
  if (head[0] == jogo)
  {
    if (head[0]->next_ordem == 0)
    {
      head[0] = 0;
      return;
    }
    else
    {
      if (head[0]->next_ordem == tail[0])
      {
        head[0] = tail[0];
        head[0]->last_ordem = 0;
        tail[0] = 0;
        return;
      }
      else
      {
        
      }

    }

    head[0] = head[0]->next_ordem;
    head[0]->last_ordem = 0;
    return;
  }
  else
  {
    if (tail[0] == jogo)
    {
      if (tail[0]->last_ordem == head[0])
      {
        head[0]->next_ordem = 0;
        tail[0] = 0;
        return;
      }
      else
      {
        
      }

      tail[0] = tail[0]->last_ordem;
      tail[0]->next_ordem = 0;
      return;
    }
    else
    {
      
    }

  }

  jogo->last_ordem->next_ordem = jogo->next_ordem;
  jogo->next_ordem->last_ordem = jogo->last_ordem;
  return;
}

void novo_jogo(int NL, ptr_jogo *h_jogo, ptr_equipa *h_equipa, int j, int e, ptr_jogo *head_jogo, ptr_jogo *tail_jogo, ptr_equipa *head_equipa, ptr_equipa *tail_equipa)
{
  int h_indice_e;
  int h_indice_j;
  int score1;
  int score2;
  char nome_j[1024];
  char n_equipa1[1024];
  char n_equipa2[1024];
  ptr_equipa p_equipa1;
  ptr_equipa p_equipa2;
  ptr_jogo ptr_j;
  ptr_jogo aux;
  for (int nome_j_index = 0; nome_j_index < 10; nome_j_index++)
  {
    nome_j[nome_j_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_j[10 - 1] = '\0';
  for (int n_equipa1_index = 0; n_equipa1_index < 10; n_equipa1_index++)
  {
    n_equipa1[n_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  n_equipa1[10 - 1] = '\0';
  for (int n_equipa2_index = 0; n_equipa2_index < 10; n_equipa2_index++)
  {
    n_equipa2[n_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  n_equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  ptr_j = (ptr_jogo) malloc(sizeof(jogo));
  ptr_j->nome = copia_string(nome_j);
  h_indice_j = hash(ptr_j->nome, j);
  aux = percorre_fila(h_jogo[h_indice_j], ptr_j->nome);
  if ((h_jogo[h_indice_j] != 0) && (aux != 0))
  {
    printf("%d Jogo existente.\n", NL);
    free_jogo(ptr_j);
    return;
  }
  else
  {
    
  }

  h_indice_e = hash(n_equipa1, e);
  p_equipa1 = devolve_ptr_e(h_equipa[h_indice_e], n_equipa1);
  if (p_equipa1 == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
    free_jogo(ptr_j);
    return;
  }
  else
  {
    
  }

  ptr_j->equipa1 = p_equipa1;
  h_indice_e = hash(n_equipa2, e);
  p_equipa2 = devolve_ptr_e(h_equipa[h_indice_e], n_equipa2);
  if (p_equipa2 == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
    free_jogo(ptr_j);
    return;
  }
  else
  {
    
  }

  ptr_j->equipa2 = p_equipa2;
  ptr_j->score1 = score1;
  ptr_j->score2 = score2;
  ptr_j->next = 0;
  ptr_j->next_ordem = 0;
  ptr_j->last = 0;
  ptr_j->last_ordem = 0;
  if (h_jogo[h_indice_j] == 0)
  {
    h_jogo[h_indice_j] = ptr_j;
    add_jogo_lista(head_jogo, tail_jogo, ptr_j);
    if (score1 < score2)
    {
      ptr_j->equipa2->jogos_ganhos++;
      altera_fila(head_equipa, tail_equipa, ptr_j->equipa2, 1);
    }
    else
    {
      if (score1 > score2)
      {
        ptr_j->equipa1->jogos_ganhos++;
        altera_fila(head_equipa, tail_equipa, ptr_j->equipa1, 1);
      }
      else
      {
        
      }

    }

    return;
  }
  else
  {
    if ((h_jogo[h_indice_j] != 0) && (h_jogo[h_indice_j]->next == 0))
    {
      if (strcmp(h_jogo[h_indice_j]->nome, ptr_j->nome) < 0)
      {
        ptr_j->last = h_jogo[h_indice_j];
        h_jogo[h_indice_j]->next = ptr_j;
        add_jogo_lista(head_jogo, tail_jogo, ptr_j);
        if (score1 < score2)
        {
          ptr_j->equipa2->jogos_ganhos++;
          altera_fila(head_equipa, tail_equipa, ptr_j->equipa2, 1);
        }
        else
        {
          if (score1 > score2)
          {
            ptr_j->equipa1->jogos_ganhos++;
            altera_fila(head_equipa, tail_equipa, ptr_j->equipa1, 1);
          }
          else
          {
            
          }

        }

        return;
      }
      else
      {
        if (strcmp(h_jogo[h_indice_j]->nome, ptr_j->nome) > 0)
        {
          h_jogo[h_indice_j]->last = ptr_j;
          ptr_j->next = h_jogo[h_indice_j];
          h_jogo[h_indice_j] = ptr_j;
          add_jogo_lista(head_jogo, tail_jogo, ptr_j);
          if (score1 < score2)
          {
            ptr_j->equipa2->jogos_ganhos++;
            altera_fila(head_equipa, tail_equipa, ptr_j->equipa2, 1);
          }
          else
          {
            if (score1 > score2)
            {
              ptr_j->equipa1->jogos_ganhos++;
              altera_fila(head_equipa, tail_equipa, ptr_j->equipa1, 1);
            }
            else
            {
              
            }

          }

          return;
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (strcmp(h_jogo[h_indice_j]->nome, ptr_j->nome) > 0)
      {
        h_jogo[h_indice_j]->last = ptr_j;
        ptr_j->next = h_jogo[h_indice_j];
        h_jogo[h_indice_j] = ptr_j;
        add_jogo_lista(head_jogo, tail_jogo, ptr_j);
        if (score1 < score2)
        {
          ptr_j->equipa2->jogos_ganhos++;
          altera_fila(head_equipa, tail_equipa, ptr_j->equipa2, 1);
        }
        else
        {
          if (score1 > score2)
          {
            ptr_j->equipa1->jogos_ganhos++;
            altera_fila(head_equipa, tail_equipa, ptr_j->equipa1, 1);
          }
          else
          {
            
          }

        }

        return;
      }
      else
      {
        ptr_ord_jogo(h_jogo[h_indice_j], ptr_j);
        add_jogo_lista(head_jogo, tail_jogo, ptr_j);
        if (score1 < score2)
        {
          ptr_j->equipa2->jogos_ganhos++;
          altera_fila(head_equipa, tail_equipa, ptr_j->equipa2, 1);
        }
        else
        {
          if (score1 > score2)
          {
            ptr_j->equipa1->jogos_ganhos++;
            altera_fila(head_equipa, tail_equipa, ptr_j->equipa1, 1);
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void procura_jogo(int NL, ptr_jogo *h_jogo, int j)
{
  int h_indice;
  char nome_j[1024];
  ptr_jogo elem;
  for (int nome_j_index = 0; nome_j_index < 10; nome_j_index++)
  {
    nome_j[nome_j_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_j[10 - 1] = '\0';
  h_indice = hash(nome_j, j);
  elem = h_jogo[h_indice];
  elem = percorre_fila(elem, nome_j);
  if (elem != 0)
  {
    printf("%d %s %s %s %d %d\n", NL, elem->nome, elem->equipa1->nome, elem->equipa2->nome, elem->score1, elem->score2);
    return;
  }
  else
  {
    
  }

  printf("%d Jogo inexistente.\n", NL);
  return;
}

void r_jogo(int NL, ptr_jogo *h_jogo, ptr_jogo *head_jogo, ptr_jogo *tail_jogo, int j, ptr_equipa *head_equipa, ptr_equipa *tail_equipa)
{
  ptr_jogo elem;
  ptr_jogo anterior;
  ptr_jogo proximo;
  int h_indice;
  char nome_j[1024];
  for (int nome_j_index = 0; nome_j_index < 10; nome_j_index++)
  {
    nome_j[nome_j_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_j[10 - 1] = '\0';
  h_indice = hash(nome_j, j);
  elem = h_jogo[h_indice];
  elem = percorre_fila(elem, nome_j);
  if (elem != 0)
  {
    if (elem->score1 < elem->score2)
    {
      elem->equipa2->jogos_ganhos--;
      altera_fila(head_equipa, tail_equipa, elem->equipa2, 0);
    }
    else
    {
      if (elem->score1 > elem->score2)
      {
        elem->equipa1->jogos_ganhos--;
        altera_fila(head_equipa, tail_equipa, elem->equipa1, 0);
      }
      else
      {
        
      }

    }

    if (elem == h_jogo[h_indice])
    {
      if (elem->next == 0)
      {
        remove_jogo_lista(head_jogo, tail_jogo, elem);
        free_jogo(elem);
        h_jogo[h_indice] = 0;
        return;
      }
      else
      {
        
      }

      remove_jogo_lista(head_jogo, tail_jogo, elem);
      h_jogo[h_indice] = elem->next;
      h_jogo[h_indice]->last = 0;
      free_jogo(elem);
      return;
    }
    else
    {
      if (elem->next == 0)
      {
        remove_jogo_lista(head_jogo, tail_jogo, elem);
        elem->last->next = 0;
        free_jogo(elem);
        return;
      }
      else
      {
        
      }

    }

    remove_jogo_lista(head_jogo, tail_jogo, elem);
    anterior = elem->last;
    proximo = elem->next;
    anterior->next = proximo;
    proximo->last = anterior;
    free_jogo(elem);
    return;
  }
  else
  {
    
  }

  printf("%d Jogo inexistente.\n", NL);
  return;
}

void altera_score(int NL, ptr_jogo *h_jogo, int j, ptr_equipa *head, ptr_equipa *tail)
{
  ptr_jogo elem;
  int h_indice;
  int score1;
  int score2;
  char nome_j[1024];
  for (int nome_j_index = 0; nome_j_index < 10; nome_j_index++)
  {
    nome_j[nome_j_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_j[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  h_indice = hash(nome_j, j);
  elem = h_jogo[h_indice];
  elem = percorre_fila(elem, nome_j);
  if (elem != 0)
  {
    if (elem->score1 == elem->score2)
    {
      if (score1 > score2)
      {
        elem->equipa1->jogos_ganhos++;
        altera_fila(head, tail, elem->equipa1, 1);
      }
      else
      {
        if (score1 < score2)
        {
          elem->equipa2->jogos_ganhos++;
          altera_fila(head, tail, elem->equipa2, 1);
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (elem->score1 > elem->score2)
      {
        if (score1 == score2)
        {
          elem->equipa1->jogos_ganhos--;
          altera_fila(head, tail, elem->equipa1, 0);
        }
        else
        {
          if (score1 < score2)
          {
            elem->equipa1->jogos_ganhos--;
            altera_fila(head, tail, elem->equipa1, 0);
            elem->equipa2->jogos_ganhos++;
            altera_fila(head, tail, elem->equipa2, 1);
          }
          else
          {
            
          }

        }

      }
      else
      {
        if (elem->score1 < elem->score2)
        {
          if (score1 == score2)
          {
            elem->equipa2->jogos_ganhos--;
            altera_fila(head, tail, elem->equipa2, 0);
          }
          else
          {
            if (score1 > score2)
            {
              elem->equipa2->jogos_ganhos--;
              altera_fila(head, tail, elem->equipa2, 0);
              elem->equipa1->jogos_ganhos++;
              altera_fila(head, tail, elem->equipa1, 1);
            }
            else
            {
              
            }

          }

        }
        else
        {
          
        }

      }

    }

    elem->score1 = score1;
    elem->score2 = score2;
    return;
  }
  else
  {
    
  }

  printf("%d Jogo inexistente.\n", NL);
  return;
}

void lista_jogos(int NL, ptr_jogo *head)
{
  ptr_jogo elem = head[0];
  if (head[0] == 0)
  {
    return;
  }
  else
  {
    
  }

  while (elem != 0)
  {
    printf("%d %s %s %s %d %d\n", NL, elem->nome, elem->equipa1->nome, elem->equipa2->nome, elem->score1, elem->score2);
    elem = elem->next_ordem;
  }

  return;
}

