#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "constants.h"
#include "jogos.h"
#include "equipas.h"


void open_files(int argc, const char *argv[]);
int main(int argc, const char *argv[])
{
  int runner = 0;
  int commandNumber = 0;
  Teams *listTeams = 0;
  Game *listGames = 0;
  Game *forFree;
  char string[1024 * 4];
  char c;
  open_files(argc, argv);
  while (runner == 0)
  {
    switch (c = fgetc(inputFile))
    {
      case 'a':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024 * 4, inputFile);
        string[strlen(string) - 1] = '\0';
        prepareGame(&listGames, listTeams, string, commandNumber);
        break;

      case 'l':
        commandNumber++;
        printGames(listGames, commandNumber);
        break;

      case 'p':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024, inputFile);
        string[strlen(string) - 1] = '\0';
        searchGame(listGames, string, commandNumber);
        break;

      case 'r':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024, inputFile);
        string[strlen(string) - 1] = '\0';
        listGames = removeGame(listGames, listTeams, string, commandNumber);
        break;

      case 's':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024, inputFile);
        string[strlen(string) - 1] = '\0';
        changeScore(listGames, listTeams, string, commandNumber);
        break;

      case 'A':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024, inputFile);
        string[strlen(string) - 1] = '\0';
        if (listTeams == 0)
      {
        listTeams = createTeams(string);
      }
      else
      {
        if (addTeam(string, listTeams) == 0)
        {
          fprintf(outputFile, "%d Equipa existente.\n", commandNumber);
        }
        else
        {
          
        }

      }

        break;

      case 'P':
        commandNumber++;
        fgetc(inputFile);
        fgets(string, 1024, inputFile);
        string[strlen(string) - 1] = '\0';
        printTeam(listTeams, string, commandNumber);
        break;

      case 'g':
        commandNumber++;
        printBest(listTeams, commandNumber);
        break;

      case 'x':
        runner = 1;
        break;

    }

    string[0] = '\0';
  }

  freeTeams(listTeams);
  if (listGames != 0)
  {
    while (listGames->nextGame != 0)
    {
      forFree = listGames;
      listGames = forFree->nextGame;
      freeGame(forFree);
    }

    if (listGames != 0)
    {
      freeGame(listGames);
    }
    else
    {
      
    }

  }
  else
  {
    
  }

  fclose(outputFile);
  fclose(inputFile);
  return 0;
}

void open_files(int argc, const char *argv[])
{
  if ((argc > 1) && (argc < 4))
  {
    inputFile = fopen(argv[1], "r");
    if (argc == 3)
    {
      outputFile = fopen(argv[2], "w");
    }
    else
    {
      outputFile = stdout;
    }

  }
  else
  {
    inputFile = stdin;
    outputFile = stdout;
  }

  if ((!inputFile) || (!outputFile))
  {
    perror("Couldn't open files");
    exit(1);
  }
  else
  {
    
  }

}

