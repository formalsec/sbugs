#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "function_hashtable.h"
#include "team_hashtable.h"


void init_team_hashtable_table(Team_Hashtable *TH)
{
  int i;
  TH->team_table = (Team *) malloc((sizeof(Team)) * TH->size);
  for (i = 0; i < TH->size; i++)
  {
    TH->team_table[i] = 0;
  }

}

Team_Hashtable *init_team_hashtable(int team_hashtable_size)
{
  Team_Hashtable *TH = malloc(sizeof(struct team_hashtable));
  TH->size = team_hashtable_size;
  TH->count = 0;
  init_team_hashtable_table(TH);
  return TH;
}

void insert_team_hashtable(Team_Hashtable *TH, Team team)
{
  int index = hash(team->name, TH->size);
  int position = index;
  if (TH->count > (TH->size / 2))
  {
    expand_team_hashtable(TH);
  }
  else
  {
    
  }

  while (TH->team_table[position] != 0)
  {
    position = (index++) % TH->size;
  }

  TH->team_table[position] = team;
  TH->count++;
}

void expand_team_hashtable(Team_Hashtable *TH)
{
  int i;
  int old_size = TH->size;
  Team *aux_team_table = TH->team_table;
  TH->size = old_size * 4;
  init_team_hashtable_table(TH);
  for (i = 0; i < (TH->size / 2); i++)
  {
    if (aux_team_table[i] != 0)
    {
      insert_team_hashtable(TH, aux_team_table[i]);
    }
    else
    {
      
    }

  }

  free(aux_team_table);
}

Team search_team_hashtable(Team_Hashtable *TH, char *name)
{
  int index = hash(name, TH->size);
  int position = index;
  while (TH->team_table[position] != 0)
  {
    if (strcmp(TH->team_table[position]->name, name) == 0)
    {
      return TH->team_table[position];
    }
    else
    {
      
    }

    position = (index++) % TH->size;
  }

  return 0;
}

void free_team_hashtable_table(Team_Hashtable *TH, int index)
{
  free(TH->team_table[index]->name);
  free(TH->team_table[index]);
}

void free_teams_hashtable(Team_Hashtable *TH)
{
  int i = 0;
  while (TH->team_table[i] != 0)
  {
    free_team_hashtable_table(TH, i);
    i++;
  }

  free(TH->team_table);
  free(TH);
}

