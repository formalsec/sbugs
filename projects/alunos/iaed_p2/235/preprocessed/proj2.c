#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include "declaracoes.h"


int returnGameIndex(Game g[3500], char n[1023 + 1], int i)
{
  int x;
  for (x = 0; x <= i; x++)
  {
    if (strcmp(g[x].name, n) == 0)
    {
      return x;
    }
    else
    {
      continue;
    }

  }

  return -1;
}

int returnTeamIndex(Team t[3500], char n[1023 + 1], int j)
{
  int x;
  for (x = 0; x <= j; x++)
  {
    if (strcmp(t[x].name, n) == 0)
    {
      return x;
    }
    else
    {
      continue;
    }

  }

  return -1;
}

int addOrSubtractVictories(int s1, int s2, int ns1, int ns2)
{
  if ((s1 > s2) && (ns1 < ns2))
  {
    return 0;
  }
  else
  {
    if ((s1 < s2) && (ns1 > ns2))
    {
      return 1;
    }
    else
    {
      if ((s1 == s2) && (ns1 > ns2))
      {
        return -1;
      }
      else
      {
        if ((s1 == s2) && (ns1 < ns2))
        {
          return 2;
        }
        else
        {
          if ((s1 > s2) && (ns1 == ns2))
          {
            return -2;
          }
          else
          {
            if ((s1 < s2) && (ns1 == ns2))
            {
              return 3;
            }
            else
            {
              return -3;
            }

          }

        }

      }

    }

  }

}

int createNewGame(Game g[3500], Team t[3500], int nl, int i, int j)
{
  char n[1023 + 1];
  char t1[1023 + 1];
  char t2[1023 + 1];
  int s1;
  int s2;
  int a;
  int b;
  int c;
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  for (int t1_index = 0; t1_index < (1023 + 1); t1_index++)
  {
    t1[t1_index] = new_sym_var(sizeof(char) * 8);
  }

  t1[(1023 + 1) - 1] = '\0';
  for (int t2_index = 0; t2_index < (1023 + 1); t2_index++)
  {
    t2[t2_index] = new_sym_var(sizeof(char) * 8);
  }

  t2[(1023 + 1) - 1] = '\0';
  s1 = new_sym_var(sizeof(int) * 8);
  s2 = new_sym_var(sizeof(int) * 8);
  a = returnGameIndex(g, n, i);
  b = returnTeamIndex(t, t1, j);
  c = returnTeamIndex(t, t2, j);
  if (a != (-1))
  {
    printf("%d Jogo existente.\n", nl);
    return 0;
  }
  else
  {
    if ((b == (-1)) || (c == (-1)))
    {
      printf("%d Equipa inexistente.\n", nl);
      return 0;
    }
    else
    {
      if (i < 3500)
      {
        strcpy(g[i].name, n);
        strcpy(g[i].team1, t1);
        strcpy(g[i].team2, t2);
        g[i].score1 = s1;
        g[i].score2 = s2;
        if (s1 > s2)
        {
          t[b].victories++;
        }
        else
        {
          if (s2 > s1)
          {
            t[c].victories++;
          }
          else
          {
            
          }

        }

        return 1;
      }
      else
      {
        
      }

    }

  }

  return 0;
}

int createNewTeam(Team t[3500], int nl, int j)
{
  char n[1023 + 1];
  int a;
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  a = returnTeamIndex(t, n, j);
  if (a != (-1))
  {
    printf("%d Equipa existente.\n", nl);
  }
  else
  {
    if (j < 3500)
    {
      strcpy(t[j].name, n);
      t[j].victories = 0;
      return 1;
    }
    else
    {
      
    }

  }

  return 0;
}

void listGames(Game g[3500], int nl, int i)
{
  int x;
  for (x = 0; x < i; x++)
  {
    printf("%d %s %s", nl, g[x].name, g[x].team1);
    printf(" %s %d %d\n", g[x].team2, g[x].score1, g[x].score2);
  }

}

void searchGame(Game g[3500], int nl, int i)
{
  int a;
  char n[1023 + 1];
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  a = returnGameIndex(g, n, i);
  if (a == (-1))
  {
    printf("%d Jogo inexistente.\n", nl);
  }
  else
  {
    printf("%d %s %s", nl, g[a].name, g[a].team1);
    printf(" %s %d %d\n", g[a].team2, g[a].score1, g[a].score2);
  }

}

void searchTeam(Team t[3500], int nl, int j)
{
  int a;
  char n[1023 + 1];
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  a = returnTeamIndex(t, n, j);
  if (a == (-1))
  {
    printf("%d Equipa inexistente.\n", nl);
  }
  else
  {
    printf("%d %s %d\n", nl, t[a].name, t[a].victories);
  }

}

int removeGame(Game g[3500], Team t[3500], int nl, int i, int j)
{
  int a;
  int b;
  int c;
  int x;
  char n[1023 + 1];
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  a = returnGameIndex(g, n, i);
  if (a == (-1))
  {
    printf("%d Jogo inexistente.\n", nl);
  }
  else
  {
    b = returnTeamIndex(t, g[a].team1, j);
    c = returnTeamIndex(t, g[a].team2, j);
    if (g[a].score1 > g[a].score2)
    {
      t[b].victories--;
    }
    else
    {
      if (g[a].score2 > g[a].score1)
      {
        t[c].victories--;
      }
      else
      {
        
      }

    }

    for (x = a; x <= i; x++)
    {
      g[x] = g[x + 1];
    }

    return 1;
  }

  return 0;
}

void changeScore(Game g[3500], Team t[3500], int nl, int i, int j)
{
  char n[1023 + 1];
  int s1;
  int s2;
  int a;
  int b;
  int c;
  int d;
  for (int n_index = 0; n_index < (1023 + 1); n_index++)
  {
    n[n_index] = new_sym_var(sizeof(char) * 8);
  }

  n[(1023 + 1) - 1] = '\0';
  s1 = new_sym_var(sizeof(int) * 8);
  s2 = new_sym_var(sizeof(int) * 8);
  a = returnGameIndex(g, n, i);
  if (a == (-1))
  {
    printf("%d Jogo inexistente.\n", nl);
  }
  else
  {
    if ((s1 >= 0) && (s2 >= 0))
    {
      b = returnTeamIndex(t, g[a].team1, j);
      c = returnTeamIndex(t, g[a].team2, j);
      d = addOrSubtractVictories(g[a].score1, g[a].score2, s1, s2);
      if (d == 0)
      {
        t[b].victories--;
        t[c].victories++;
      }
      else
      {
        if (d == 1)
        {
          t[b].victories++;
          t[c].victories--;
        }
        else
        {
          if (d == (-1))
          {
            t[b].victories++;
          }
          else
          {
            if (d == 2)
            {
              t[c].victories++;
            }
            else
            {
              if (d == (-2))
              {
                t[b].victories--;
              }
              else
              {
                if (d == 3)
                {
                  t[c].victories--;
                }
                else
                {
                  
                }

              }

            }

          }

        }

      }

      g[a].score1 = s1;
      g[a].score2 = s2;
    }
    else
    {
      
    }

  }

}

void listMostWins(Team t[3500], int nl, int j)
{
  int max_v = 0;
  int x = 0;
  int y;
  int z = -1;
  char o[10][1023 + 1];
  char temp[1023 + 1];
  while (x < j)
  {
    if (max_v < t[x].victories)
    {
      max_v = t[x].victories;
    }
    else
    {
      
    }

    x++;
  }

  for (x = 0; x < j; x++)
  {
    if (t[x].victories == max_v)
    {
      z++;
      strcpy(o[z], t[x].name);
    }
    else
    {
      continue;
    }

  }

  for (x = 0; x <= z; x++)
  {
    for (y = x + 1; y <= z; y++)
    {
      if (strcmp(o[x], o[y]) > 0)
      {
        strcpy(temp, o[x]);
        strcpy(o[x], o[y]);
        strcpy(o[y], temp);
      }
      else
      {
        
      }

    }

  }

  if (j > 0)
  {
    printf("%d Melhores %d\n", nl, max_v);
    for (x = 0; x <= z; x++)
      printf("%d * %s\n", nl, o[x]);

  }
  else
  {
    
  }

}

int main()
{
  int a;
  char c;
  static int nl = 0;
  static int i = 0;
  static int j = 0;
  static Game games[3500];
  static Team teams[3500];
  c = new_sym_var(sizeof(char) * 8);
  while (c != 'x')
  {
    switch (c)
    {
      case 'a':
        nl++;
        a = createNewGame(games, teams, nl, i, j);
        if (a == 1)
      {
        i++;
      }
      else
      {
        
      }

        break;

      case 'A':
        nl++;
        a = createNewTeam(teams, nl, j);
        if (a == 1)
      {
        j++;
      }
      else
      {
        
      }

        break;

      case 'l':
        nl++;
        listGames(games, nl, i);
        break;

      case 'p':
        nl++;
        searchGame(games, nl, i);
        break;

      case 'P':
        nl++;
        searchTeam(teams, nl, j);
        break;

      case 'r':
        nl++;
        a = removeGame(games, teams, nl, i, j);
        if (a == 1)
      {
        i--;
      }
      else
      {
        
      }

        break;

      case 's':
        nl++;
        changeScore(games, teams, nl, i, j);
        break;

      case 'g':
        nl++;
        listMostWins(teams, nl, j);
        break;

    }

    c = new_sym_var(sizeof(char) * 8);
  }

  return 0;
}

