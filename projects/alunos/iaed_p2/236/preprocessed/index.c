/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "consts.h"
#include "structures.h"


team *newTeam(char team_name[]);
void insertTeam(team *hash_table[], team *new_team);
team *findTeam(team *hash_table[], char *name);
void initTeamHashTable(team *hash_table[]);
void freeTeamHashTable(team *hash_table[]);
game *newGame(char *name, char *team_name1, char *team_name2, int score1, int score2);
void insertGame(game *hash_table[], game *new_game);
game *findGame(game *hash_table[], char *name);
void deleteGame(game *hash_table[], char *name);
void initGameHashTable(game *hash_table[]);
void printSingleGame(game *single_game, int NL);
void freeGameHashTable(game *hash_table[]);
game_reference *newReference(game *data);
game_reference *findReference(game_reference *head, char *name);
void pushReference(game_reference **head, game_reference *new_game);
void deleteReference(game_reference **head, game_reference *node_to_delete);
void printReference(game_reference *head, int NL);
void freeReference(game_reference *head);
void printBestTeams(team *team_hash_table[], int NL);
int main()
{
  char input[3076];
  char *command;
  char *name;
  char *team_name1;
  char *team_name2;
  game *game_hash_table[1000];
  game *game_current;
  game_reference *game_head;
  team *team_hash_table[1000];
  team *team1;
  team *team2;
  int score1;
  int score2;
  int NL;
  initGameHashTable(game_hash_table);
  initTeamHashTable(team_hash_table);
  NL = 0;
  game_head = 0;
  team1 = 0;
  team2 = 0;
  game_current = 0;
  command = malloc(sizeof(char));
  team_name1 = malloc(1024 * (sizeof(char)));
  team_name2 = malloc(1024 * (sizeof(char)));
  name = malloc(1024 * (sizeof(char)));
  for (;;)
  {
    fgets(input, 3076, stdin);
    for (int command_index = 0; command_index < 10; command_index++)
    {
      command[command_index] = new_sym_var(sizeof(char) * 8);
    }

    command[10 - 1] = '\0';
    for (int name_index = 0; name_index < 10; name_index++)
    {
      name[name_index] = new_sym_var(sizeof(char) * 8);
    }

    name[10 - 1] = '\0';
    for (int team_name1_index = 0; team_name1_index < 10; team_name1_index++)
    {
      team_name1[team_name1_index] = new_sym_var(sizeof(char) * 8);
    }

    team_name1[10 - 1] = '\0';
    for (int team_name2_index = 0; team_name2_index < 10; team_name2_index++)
    {
      team_name2[team_name2_index] = new_sym_var(sizeof(char) * 8);
    }

    team_name2[10 - 1] = '\0';
    score1 = new_sym_var(sizeof(int) * 8);
    score2 = new_sym_var(sizeof(int) * 8);
    ++NL;
    switch (command[0])
    {
      case 'a':
        ;
        game_current = newGame(name, team_name1, team_name2, score1, score2);
        team1 = findTeam(team_hash_table, team_name1);
        team2 = findTeam(team_hash_table, team_name2);
        if (findGame(game_hash_table, game_current->name) != 0)
      {
        printf("%d Jogo existente.\n", NL);
      }
      else
      {
        if ((team1 == 0) || (team2 == 0))
        {
          printf("%d Equipa inexistente.\n", NL);
        }
        else
        {
          if (score1 > score2)
          {
            team1->wins++;
          }
          else
          {
            if (score2 > score1)
            {
              team2->wins++;
            }
            else
            {
              
            }

          }

          insertGame(game_hash_table, game_current);
          pushReference(&game_head, newReference(game_current));
        }

      }

        break;

      case 'A':
        ;
        if (findTeam(team_hash_table, name) != 0)
      {
        printf("%d Equipa existente.\n", NL);
      }
      else
      {
        insertTeam(team_hash_table, newTeam(name));
      }

        break;

      case 'l':
        ;
        printReference(game_head, NL);
        break;

      case 'p':
        ;
        game_current = findGame(game_hash_table, name);
        if (game_current == 0)
      {
        printf("%d Jogo inexistente.\n", NL);
      }
      else
      {
        printSingleGame(game_current, NL);
      }

        break;

      case 'P':
        ;
        team1 = findTeam(team_hash_table, name);
        if (team1 == 0)
      {
        printf("%d Equipa inexistente.\n", NL);
      }
      else
      {
        printf("%d %s %d\n", NL, name, team1->wins);
      }

        break;

      case 's':
        ;
        for (int name_index = 0; name_index < 10; name_index++)
      {
        name[name_index] = new_sym_var(sizeof(char) * 8);
      }

        name[10 - 1] = '\0';
        score1 = new_sym_var(sizeof(int) * 8);
        score2 = new_sym_var(sizeof(int) * 8);
        game_current = findGame(game_hash_table, name);
        if (game_current == 0)
      {
        printf("%d Jogo inexistente.\n", NL);
      }
      else
      {
        team1 = findTeam(team_hash_table, game_current->team1);
        team2 = findTeam(team_hash_table, game_current->team2);
        if ((score1 > score2) && ((*game_current->score1) < (*game_current->score2)))
        {
          team1->wins++;
        }
        else
        {
          
        }

        if ((score1 < score2) && ((*game_current->score1) > (*game_current->score2)))
        {
          team1->wins--;
        }
        else
        {
          
        }

        if ((score1 > score2) && ((*game_current->score1) == (*game_current->score2)))
        {
          team1->wins++;
        }
        else
        {
          
        }

        if ((score1 == score2) && ((*game_current->score1) > (*game_current->score2)))
        {
          team1->wins--;
        }
        else
        {
          
        }

        if ((score2 > score1) && ((*game_current->score2) < (*game_current->score1)))
        {
          team2->wins++;
        }
        else
        {
          
        }

        if ((score2 < score1) && ((*game_current->score2) > (*game_current->score1)))
        {
          team2->wins--;
        }
        else
        {
          
        }

        if ((score2 == score1) && ((*game_current->score2) > (*game_current->score1)))
        {
          team2->wins--;
        }
        else
        {
          
        }

        if ((score2 > score1) && ((*game_current->score2) == (*game_current->score1)))
        {
          team2->wins++;
        }
        else
        {
          
        }

        *game_current->score1 = score1;
        *game_current->score2 = score2;
      }

        break;

      case 'g':
        ;
        printBestTeams(team_hash_table, NL);
        break;

      case 'r':
        ;
        game_current = findGame(game_hash_table, name);
        if (game_current == 0)
      {
        printf("%d Jogo inexistente.\n", NL);
      }
      else
      {
        team1 = findTeam(team_hash_table, game_current->team1);
        team2 = findTeam(team_hash_table, game_current->team2);
        if (((*game_current->score1) > (*game_current->score2)) && (team1->wins > 0))
        {
          team1->wins--;
        }
        else
        {
          if (((*game_current->score2) > (*game_current->score1)) && (team2->wins > 0))
          {
            team2->wins--;
          }
          else
          {
            
          }

        }

        deleteReference(&game_head, findReference(game_head, name));
        deleteGame(game_hash_table, name);
      }

        break;

      case 'x':
        ;
        free(command);
        free(name);
        free(team_name1);
        free(team_name2);
        freeGameHashTable(game_hash_table);
        freeTeamHashTable(team_hash_table);
        freeReference(game_head);
        return 0;

    }

  }

}

