#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h> 
#include "game.h"
#include "hash_table.h"


int hash(char *name, int M)
{
  int h;
  int a = 31415;
  int b = 27183;
  for (h = 0; (*name) != '\0'; name++, a = (a * b) % (M - 1))
    h = ((a * h) + (*name)) % M;

  return h;
}

Game_node **init_table_game()
{
  int i;
  Game_node **games_table = malloc(11119 * (sizeof(Game_node *)));
  for (i = 0; i < 11119; i++)
    games_table[i] = 0;

  return games_table;
}

Team_node **init_table_team()
{
  int i;
  Team_node **team_table = malloc(11119 * (sizeof(Team_node *)));
  for (i = 0; i < 11119; i++)
    team_table[i] = 0;

  return team_table;
}

Game_node *new_game_node(Game p_game)
{
  Game_node *x = malloc(sizeof(Game_node));
  x->g = p_game;
  x->next = 0;
  return x;
}

Team_node *new_team_node(Team p_team)
{
  Team_node *x = malloc(sizeof(Team_node));
  x->t = p_team;
  x->next = 0;
  return x;
}

Game_node *insert_game_table(Game g, Game_node **head)
{
  int i = hash(g.name, 11119);
  Game_node *x = new_game_node(g);
  x->next = head[i];
  head[i] = x;
  return x;
}

Team_node *insert_team_table(Team t, Team_node **head)
{
  int i = hash(t.name, 11119);
  Team_node *x = new_team_node(t);
  x->next = head[i];
  head[i] = x;
  return x;
}

Game_node *search_game(char *name, Game_node **head)
{
  int i = hash(name, 11119);
  Game_node *aux;
  for (aux = head[i]; aux != 0; aux = aux->next)
  {
    if (strcmp(name, aux->g.name) == 0)
    {
      return aux;
    }
    else
    {
      
    }

  }

  return 0;
}

Team_node *search_team(char *name, Team_node **head)
{
  int i = hash(name, 11119);
  Team_node *aux;
  for (aux = head[i]; aux != 0; aux = aux->next)
  {
    if (strcmp(name, aux->t.name) == 0)
    {
      return aux;
    }
    else
    {
      
    }

  }

  return 0;
}

void delete_game_table(char *name, Game_node **head)
{
  int i = hash(name, 11119);
  Game_node *aux;
  Game_node *prev;
  for (aux = head[i], prev = 0; aux != 0; prev = aux, aux = aux->next)
  {
    if (strcmp(name, aux->g.name) == 0)
    {
      if (aux == head[i])
      {
        head[i] = aux->next;
      }
      else
      {
        prev->next = aux->next;
      }

      free(aux->g.name);
      free(aux);
      return;
    }
    else
    {
      
    }

  }

}

void delete_team_table(char *name, Team_node **head)
{
  int i = hash(name, 11119);
  Team_node *aux;
  Team_node *prev;
  for (aux = head[i], prev = 0; aux != 0; prev = aux, aux = aux->next)
  {
    if (strcmp(name, aux->t.name) == 0)
    {
      if (aux == head[i])
      {
        head[i] = aux->next;
      }
      else
      {
        prev->next = aux->next;
      }

      free(aux->t.name);
      free(aux);
      return;
    }
    else
    {
      
    }

  }

}

