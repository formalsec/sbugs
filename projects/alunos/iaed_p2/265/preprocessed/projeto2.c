#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "header.h"


int main()
{
  char p;
  int NL = 0;
  lugar_no_hash_j **hash_do_jogo;
  lugar_no_hash_e **hash_das_equipes;
  link **a_lista;
  hash_do_jogo = iniciar_hash_jogo(509);
  hash_das_equipes = iniciar_hash_equipe(509);
  a_lista = iniciar_listinha(509);
  while (1)
  {
    switch (p = getchar())
    {
      case 'a':
        NL++;
        getchar();
        adiciona_jogo(hash_do_jogo, a_lista, hash_das_equipes, NL);
        break;

      case 'A':
        NL++;
        getchar();
        adiciona_equipe(hash_das_equipes, NL);
        break;

      case 'l':
        NL++;
        lista_de_jogos(a_lista);
        break;

      case 'p':
        NL++;
        getchar();
        encontrar_jogo(hash_do_jogo, NL);
        break;

      case 'P':
        NL++;
        getchar();
        encontrar_equipe(hash_das_equipes, NL);
        break;

      case 'r':
        NL++;
        break;

      case 's':
        NL++;
        break;

      case 'g':
        NL++;
        break;

      case 'x':
        return 0;

    }

  }

}

JOGO *cria_jogo(char *nomej, EQUIPE *equipa_1, EQUIPE *equipa_2, int a, int b)
{
  JOGO *y;
  y = malloc(sizeof(JOGO));
  y->nome_j = malloc(sizeof(char *));
  y->score1 = a;
  y->score2 = b;
  strcpy(y->nome_j, nomej);
  y->equipa1->nome_e = equipa_1->nome_e;
  y->equipa2->nome_e = equipa_2->nome_e;
  y->equipa1->ganhos = equipa_1->ganhos;
  y->equipa2->ganhos = equipa_2->ganhos;
  return y;
}

lugar_no_hash_j *adicionar_a_listinha_j(lugar_no_hash_j *point_j, JOGO *jg)
{
  lugar_no_hash_j *lista_j = malloc(509 * (sizeof(lugar_no_hash_j)));
  lista_j->jogo = jg;
  lista_j->seguinte_j = point_j;
  return lista_j;
}

lugar_no_hash_j **iniciar_hash_jogo(int m)
{
  int i;
  int M;
  lugar_no_hash_j **hashtable_j;
  M = m;
  hashtable_j = malloc(509 * (sizeof(lugar_no_hash_j)));
  for (i = 0; i < M; i++)
    hashtable_j[i] = 0;

  return hashtable_j;
}

link *listinha_da_ordem(link *apoint, JOGO *jogou)
{
  link *listinha = malloc(sizeof(link));
  listinha->jogo = jogou;
  listinha->next = apoint;
  return listinha;
}

link **iniciar_listinha(int m)
{
  int i;
  int M;
  link **lista;
  M = m;
  lista = malloc(1023 * (sizeof(link)));
  for (i = 0; i < M; i++)
    lista[i] = 0;

  return lista;
}

void adiciona_jogo(lugar_no_hash_j **hashtable_j, link **fila, lugar_no_hash_e **hashtable_e, int NL)
{
  JOGO *jog;
  long hash_j;
  char daequipe1[1023];
  char daequipe2[1023];
  char dojogo[1023];
  int plac1;
  int plac2;
  EQUIPE *equipe1;
  EQUIPE *equipe2;
  for (int dojogo_index = 0; dojogo_index < 10; dojogo_index++)
  {
    dojogo[dojogo_index] = new_sym_var(sizeof(char) * 8);
  }

  dojogo[10 - 1] = '\0';
  for (int daequipe1_index = 0; daequipe1_index < 10; daequipe1_index++)
  {
    daequipe1[daequipe1_index] = new_sym_var(sizeof(char) * 8);
  }

  daequipe1[10 - 1] = '\0';
  for (int daequipe2_index = 0; daequipe2_index < 10; daequipe2_index++)
  {
    daequipe2[daequipe2_index] = new_sym_var(sizeof(char) * 8);
  }

  daequipe2[10 - 1] = '\0';
  plac1 = new_sym_var(sizeof(int) * 8);
  plac2 = new_sym_var(sizeof(int) * 8);
  if (encontrar_jogo_aux(dojogo, hashtable_j) != 0)
  {
    printf("%d Jogo existente.\n", NL);
    return;
  }
  else
  {
    
  }

  if ((equipe1 = encontrar_equipe_aux(daequipe1, hashtable_e)) == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  if ((equipe2 = encontrar_equipe_aux(daequipe2, hashtable_e)) == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  jog = cria_jogo(dojogo, equipe1, equipe2, plac1, plac2);
  hash_j = hashU(dojogo, 1023);
  hashtable_j[hash_j] = adicionar_a_listinha_j(hashtable_j[hash_j], jog);
  *fila = listinha_da_ordem(*fila, jog);
}

void lista_de_jogos(link **fila)
{
  int i;
  i = 0;
  if (fila[0] == 0)
  {
    return;
  }
  else
  {
    
  }

  while (fila[i] != 0)
  {
    printf(fila[i]->jogo->nome_j, fila[i]->jogo->equipa1->nome_e, fila[i]->jogo->equipa2->nome_e);
    i++;
  }

}

void encontrar_jogo(lugar_no_hash_j **hashtable_j, int NL)
{
  JOGO *point;
  long indcj;
  char names[1023];
  for (int names_index = 0; names_index < 10; names_index++)
  {
    names[names_index] = new_sym_var(sizeof(char) * 8);
  }

  names[10 - 1] = '\0';
  indcj = hashU(names, 1023);
  point = encontrar_jogo_aux(names, hashtable_j);
  if (point == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  printf("%s %s %s %d %d\n", hashtable_j[indcj]->jogo->nome_j, hashtable_j[indcj]->jogo->equipa1->nome_e, hashtable_j[indcj]->jogo->equipa2->nome_e, hashtable_j[indcj]->jogo->score1, hashtable_j[indcj]->jogo->score2);
}

JOGO *encontrar_jogo_aux(char *names, lugar_no_hash_j **hashtable_j)
{
  long indcj;
  indcj = hashU(names, 509);
  while ((hashtable_j[indcj] != 0) && (strcmp(names, hashtable_j[indcj]->jogo->nome_j) != 0))
    hashtable_j[indcj] = hashtable_j[indcj]->seguinte_j;

  if (hashtable_j[indcj] == 0)
  {
    return 0;
  }
  else
  {
    return hashtable_j[indcj]->jogo;
  }

}

lugar_no_hash_e **iniciar_hash_equipe(int m)
{
  int i;
  int M;
  lugar_no_hash_e **hashtable_e;
  M = m;
  hashtable_e = malloc(509 * (sizeof(lugar_no_hash_e)));
  for (i = 0; i < M; i++)
    hashtable_e[i] = 0;

  return hashtable_e;
}

EQUIPE *cria_equipe(char *nomee)
{
  EQUIPE *x;
  x = malloc(sizeof(EQUIPE));
  x->nome_e = malloc(sizeof(char *));
  x->ganhos = 0;
  strcpy(x->nome_e, nomee);
  return x;
}

lugar_no_hash_e *adicionar_a_listinha_e(lugar_no_hash_e *point_e, EQUIPE *eq)
{
  lugar_no_hash_e *lista_e = malloc(509 * (sizeof(lugar_no_hash_e)));
  lista_e->equipe = eq;
  lista_e->seguinte_e = point_e;
  return lista_e;
}

void adiciona_equipe(lugar_no_hash_e **hashtable_e, int NL)
{
  EQUIPE *equip;
  long hash;
  char daequipe[1023];
  for (int daequipe_index = 0; daequipe_index < 10; daequipe_index++)
  {
    daequipe[daequipe_index] = new_sym_var(sizeof(char) * 8);
  }

  daequipe[10 - 1] = '\0';
  hash = hashU(daequipe, 1023);
  if (encontrar_equipe_aux(daequipe, hashtable_e) != 0)
  {
    printf("%d Equipa existente.\n", NL);
  }
  else
  {
    
  }

  equip = cria_equipe(daequipe);
  hashtable_e[hash] = adicionar_a_listinha_e(hashtable_e[hash], equip);
}

void encontrar_equipe(lugar_no_hash_e **hashtable_e, int NL)
{
  EQUIPE *point;
  long indce;
  char names[1023];
  for (int names_index = 0; names_index < 10; names_index++)
  {
    names[names_index] = new_sym_var(sizeof(char) * 8);
  }

  names[10 - 1] = '\0';
  indce = hashU(names, 1023);
  point = encontrar_equipe_aux(names, hashtable_e);
  if (point == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  printf("%s %d\n", names, hashtable_e[indce]->equipe->ganhos);
}

EQUIPE *encontrar_equipe_aux(char *names, lugar_no_hash_e **hashtable_e)
{
  long indce;
  lugar_no_hash_e *aux;
  indce = hashU(names, 1023);
  aux = hashtable_e[indce];
  if (aux == 0)
  {
    return 0;
  }
  else
  {
    
  }

  while ((aux != 0) && (strcmp(names, aux->equipe->nome_e) != 0))
    aux = aux->seguinte_e;

  return aux->equipe;
}

