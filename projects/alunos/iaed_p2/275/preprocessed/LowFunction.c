/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "LowFunction.h"


linkEquipa NEWequipa(char *new_equipa)
{
  linkEquipa equipa = malloc(sizeof(struct node));
  equipa->nome = malloc((sizeof(char)) * (strlen(new_equipa) + 1));
  equipa->wins = 0;
  strcpy(equipa->nome, new_equipa);
  equipa->next = 0;
  return equipa;
}

linkJogo NEWjogo(char *new_jogo, char *new_equipa1, char *new_equipa2, int new_score1, int new_score2)
{
  linkJogo jogo = malloc(sizeof(struct nodejogo));
  jogo->nome = malloc((sizeof(char)) * (strlen(new_jogo) + 1));
  jogo->equipa1 = malloc(((sizeof(char)) * strlen(new_equipa1)) + 1);
  jogo->equipa2 = malloc(((sizeof(char)) * strlen(new_equipa2)) + 1);
  jogo->score1 = new_score1;
  jogo->score2 = new_score2;
  strcpy(jogo->nome, new_jogo);
  strcpy(jogo->equipa1, new_equipa1);
  strcpy(jogo->equipa2, new_equipa2);
  jogo->next = 0;
  return jogo;
}

linkEquipa insertBeginListEquipa(linkEquipa head, char *name)
{
  linkEquipa equipa = NEWequipa(name);
  equipa->next = head;
  return equipa;
}

linkJogo insertBeginListJogo(linkJogo head, char *jogo_nome, char *equipa1_nome, char *equipa2_nome, int resultado1, int resultado2)
{
  linkJogo jogo = NEWjogo(jogo_nome, equipa1_nome, equipa2_nome, resultado1, resultado2);
  jogo->next = head;
  return jogo;
}

linkEquipa searchListEquipa(linkEquipa head, char *name)
{
  linkEquipa equipa;
  for (equipa = head; equipa != 0; equipa = equipa->next)
  {
    if (strcmp(equipa->nome, name) == 0)
    {
      return equipa;
    }
    else
    {
      
    }

  }

  return 0;
}

linkJogo searchListJogo(linkJogo head, char *name)
{
  linkJogo jogo;
  for (jogo = head; jogo != 0; jogo = jogo->next)
  {
    if (strcmp(jogo->nome, name) == 0)
    {
      return jogo;
    }
    else
    {
      
    }

  }

  return 0;
}

linkEquipa removeFromListEquipa(linkEquipa head, char *name)
{
  linkEquipa equipa;
  linkEquipa prev;
  for (equipa = head, prev = 0; equipa != 0; prev = equipa, equipa = equipa->next)
  {
    if (strcmp(equipa->nome, name) == 0)
    {
      if (equipa == head)
      {
        head = equipa->next;
      }
      else
      {
        prev->next = equipa->next;
      }

      free(equipa->next);
      free(equipa);
    }
    else
    {
      
    }

  }

  return head;
}

linkJogo removeFromListJogo(linkJogo head, char *name)
{
  linkJogo jogo;
  linkJogo prev;
  for (jogo = head, prev = 0; jogo != 0; prev = jogo, jogo = jogo->next)
  {
    if (strcmp(jogo->nome, name) == 0)
    {
      if (jogo == head)
      {
        head = jogo->next;
      }
      else
      {
        prev->next = jogo->next;
      }

      free(jogo->next);
      free(jogo);
    }
    else
    {
      
    }

  }

  return head;
}

linkJogo insertEnd(linkJogo head, char *jogo_nome, char *equipa1_nome, char *equipa2_nome, int resultado1, int resultado2)
{
  linkJogo jogo;
  if (head == 0)
  {
    return NEWjogo(jogo_nome, equipa1_nome, equipa2_nome, resultado1, resultado2);
  }
  else
  {
    
  }

  for (jogo = head; jogo->next != 0; jogo = jogo->next)
  {
    ;
  }

  jogo->next = NEWjogo(jogo_nome, equipa1_nome, equipa2_nome, resultado1, resultado2);
  return head;
}

int hash(char *v)
{
  int h = 0;
  int a = 31415;
  int b = 27183;
  int size = 5281;
  for (h = 0; (*v) != '\0'; v++, a = (a * b) % (size - 1))
  {
    h = ((a * h) + (*v)) % size;
  }

  return h;
}

void freeEquipa(linkEquipa equipa)
{
  free(equipa->nome);
  free(equipa);
}

void freeJogo(linkJogo jogo)
{
  free(jogo->nome);
  free(jogo->equipa1);
  free(jogo->equipa2);
  free(jogo);
}

void printEquipa(linkEquipa equipa)
{
  printf("%s %d\n", equipa->nome, equipa->wins);
}

void printJogo(linkJogo jogo)
{
  printf("%s %s %s %d %d\n", jogo->nome, jogo->equipa1, jogo->equipa2, jogo->score1, jogo->score2);
}

TableEquipas *STinitEquipa()
{
  int i;
  TableEquipas *table_equipas = malloc(sizeof(TableEquipas));
  table_equipas->M = 5281;
  table_equipas->headsEquipa = malloc(table_equipas->M * (sizeof(linkEquipa)));
  for (i = 0; i < table_equipas->M; i++)
    table_equipas->headsEquipa[i] = 0;

  return table_equipas;
}

TableJogos *STinitJogo()
{
  int i;
  TableJogos *table_jogos = malloc(sizeof(TableJogos));
  table_jogos->M = 5281;
  table_jogos->headsJogo = malloc(table_jogos->M * (sizeof(linkJogo)));
  for (i = 0; i < table_jogos->M; i++)
    table_jogos->headsJogo[i] = 0;

  return table_jogos;
}

void STinsertEquipa(char *nome, TableEquipas *table_equipas)
{
  int i = hash(nome);
  table_equipas->headsEquipa[i] = insertBeginListEquipa(table_equipas->headsEquipa[i], nome);
}

void STinsertJogo(TableJogos *table_jogos, char *jogo_nome, char *equipa1_nome, char *equipa2_nome, int resultado1, int resultado2)
{
  int i = hash(jogo_nome);
  table_jogos->headsJogo[i] = insertBeginListJogo(table_jogos->headsJogo[i], jogo_nome, equipa1_nome, equipa2_nome, resultado1, resultado2);
}

void STdeleteEquipa(linkEquipa equipa, TableEquipas *table_equipas)
{
  int i = hash(equipa->nome);
  table_equipas->headsEquipa[i] = removeFromListEquipa(table_equipas->headsEquipa[i], equipa->nome);
}

void STdeleteJogo(linkJogo jogo, TableJogos *table_jogos)
{
  int i = hash(jogo->nome);
  table_jogos->headsJogo[i] = removeFromListJogo(table_jogos->headsJogo[i], jogo->nome);
}

linkEquipa STsearchEquipa(Key v, TableEquipas *table_equipas)
{
  int i = hash(v);
  return searchListEquipa(table_equipas->headsEquipa[i], v);
}

linkJogo STsearchJogo(Key v, TableJogos *table_jogos)
{
  int i = hash(v);
  return searchListJogo(table_jogos->headsJogo[i], v);
}

