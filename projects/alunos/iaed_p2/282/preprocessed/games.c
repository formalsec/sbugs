/*File generated by PreProcessor.py*/


#include "games.h"


void add_new_game(Hash_table_games HTG, Node_game_lst *Lst_jogos, Hash_table HT, int line)
{
  char nome_jogo[1023];
  char equipa1[1023];
  char equipa2[1023];
  int golos_equipa1;
  int golos_equipa2;
  Node_team *aux;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  golos_equipa1 = new_sym_var(sizeof(int) * 8);
  golos_equipa2 = new_sym_var(sizeof(int) * 8);
  if (!search_HTG(HTG, nome_jogo))
  {
    if ((search_HT(HT, equipa1) != 0) && (search_HT(HT, equipa2) != 0))
    {
      Lst_jogos->head = insert_end(Lst_jogos, nome_jogo, equipa1, equipa2, golos_equipa1, golos_equipa2);
      HT_games_insert(HTG, Lst_jogos->last, nome_jogo);
      if (golos_equipa1 > golos_equipa2)
      {
        aux = search_HT(HT, equipa1);
        aux->vitorias++;
      }
      else
      {
        if (golos_equipa2 > golos_equipa1)
        {
          aux = search_HT(HT, equipa2);
          aux->vitorias++;
        }
        else
        {
          
        }

      }

    }
    else
    {
      printf("%d Equipa inexistente.\n", line);
    }

  }
  else
  {
    printf("%d Jogo existente.\n", line);
  }

}

void search_game(Hash_table_games HTG, int line)
{
  char nome_jogo[1023];
  Node_g_ht *p;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  p = search_HTG(HTG, nome_jogo);
  if (!p)
  {
    printf("%d Jogo inexistente.\n", line);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", line, p->node_game_ptr->jogo->nome, p->node_game_ptr->jogo->equipa1, p->node_game_ptr->jogo->equipa2, p->node_game_ptr->jogo->golos_equipa1, p->node_game_ptr->jogo->golos_equipa2);
  }

}

void lst_games(Node_game *head, int line)
{
  if (head != 0)
  {
    for (; head != 0; head = head->next)
    {
      printf("%d %s %s %s %d %d\n", line, head->jogo->nome, head->jogo->equipa1, head->jogo->equipa2, head->jogo->golos_equipa1, head->jogo->golos_equipa2);
    }

  }
  else
  {
    
  }

}

void remove_game(Hash_table_games HTG, Node_game_lst *Lst_jogos, Hash_table HT, int line)
{
  char nome_jogo[1023];
  int i;
  Node_g_ht *p;
  Node_team *aux;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  p = search_HTG(HTG, nome_jogo);
  if (!p)
  {
    printf("%d Jogo inexistente.\n", line);
  }
  else
  {
    if (p->node_game_ptr->jogo->golos_equipa1 > p->node_game_ptr->jogo->golos_equipa2)
    {
      aux = search_HT(HT, p->node_game_ptr->jogo->equipa1);
      aux->vitorias--;
    }
    else
    {
      if (p->node_game_ptr->jogo->golos_equipa2 > p->node_game_ptr->jogo->golos_equipa1)
      {
        aux = search_HT(HT, p->node_game_ptr->jogo->equipa2);
        aux->vitorias--;
      }
      else
      {
        
      }

    }

    if ((p->node_game_ptr->prev != 0) && (p->node_game_ptr->next != 0))
    {
      p->node_game_ptr->prev->next = p->node_game_ptr->next;
      p->node_game_ptr->next->prev = p->node_game_ptr->prev;
    }
    else
    {
      if ((p->node_game_ptr->prev != 0) && (p->node_game_ptr->next == 0))
      {
        p->node_game_ptr->prev->next = 0;
        Lst_jogos->last = p->node_game_ptr->prev;
      }
      else
      {
        if ((p->node_game_ptr->prev == 0) && (p->node_game_ptr->next != 0))
        {
          p->node_game_ptr->next->prev = 0;
          Lst_jogos->head = p->node_game_ptr->next;
        }
        else
        {
          Lst_jogos->head = 0;
        }

      }

    }

    clear_node_game(p->node_game_ptr);
    p->node_game_ptr = 0;
    i = hash(nome_jogo);
    if ((p->prev != 0) && (p->next != 0))
    {
      p->prev->next = p->next;
      p->next->prev = p->prev;
    }
    else
    {
      if ((p->prev != 0) && (p->next == 0))
      {
        p->prev->next = 0;
      }
      else
      {
        if ((p->prev == 0) && (p->next != 0))
        {
          p->next->prev = 0;
          if (HTG.heads[i] == p)
          {
            HTG.heads[i] = p->next;
          }
          else
          {
            
          }

        }
        else
        {
          HTG.heads[i] = 0;
        }

      }

    }

    free(p);
    p = 0;
  }

}

void change_score(Hash_table_games HTG, Hash_table HT, int line)
{
  char nome_jogo[1023];
  int new_score1;
  int new_score2;
  Node_g_ht *p;
  Node_team *aux;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  new_score1 = new_sym_var(sizeof(int) * 8);
  new_score2 = new_sym_var(sizeof(int) * 8);
  p = search_HTG(HTG, nome_jogo);
  if (!p)
  {
    printf("%d Jogo inexistente.\n", line);
  }
  else
  {
    if (p->node_game_ptr->jogo->golos_equipa1 > p->node_game_ptr->jogo->golos_equipa2)
    {
      if (new_score1 <= new_score2)
      {
        aux = search_HT(HT, p->node_game_ptr->jogo->equipa1);
        aux->vitorias--;
        if (new_score2 > new_score1)
        {
          aux = search_HT(HT, p->node_game_ptr->jogo->equipa2);
          aux->vitorias++;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }
    else
    {
      if (p->node_game_ptr->jogo->golos_equipa2 > p->node_game_ptr->jogo->golos_equipa1)
      {
        if (new_score2 <= new_score1)
        {
          aux = search_HT(HT, p->node_game_ptr->jogo->equipa2);
          aux->vitorias--;
          if (new_score1 > new_score2)
          {
            aux = search_HT(HT, p->node_game_ptr->jogo->equipa1);
            aux->vitorias++;
          }
          else
          {
            
          }

        }
        else
        {
          
        }

      }
      else
      {
        if (new_score1 > new_score2)
        {
          aux = search_HT(HT, p->node_game_ptr->jogo->equipa1);
          aux->vitorias++;
        }
        else
        {
          if (new_score2 > new_score1)
          {
            aux = search_HT(HT, p->node_game_ptr->jogo->equipa2);
            aux->vitorias++;
          }
          else
          {
            
          }

        }

      }

    }

    p->node_game_ptr->jogo->golos_equipa1 = new_score1;
    p->node_game_ptr->jogo->golos_equipa2 = new_score2;
  }

}

