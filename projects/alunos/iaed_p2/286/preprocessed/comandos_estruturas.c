#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "comandos_estruturas.h"


jogos *novo_jogo(char *nome, char *equipa1, char *equipa2, int score1, int score2)
{
  jogos *x = malloc(sizeof(jogos));
  x->nome = malloc((strlen(nome) + 1) * (sizeof(char)));
  strcpy(x->nome, nome);
  x->equipa1 = malloc((strlen(equipa1) + 1) * (sizeof(char)));
  strcpy(x->equipa1, equipa1);
  x->equipa2 = malloc((strlen(equipa2) + 1) * (sizeof(char)));
  strcpy(x->equipa2, equipa2);
  x->score1 = score1;
  x->score2 = score2;
  x->next = 0;
  return x;
}

void HTinserejogo(jogos **htjogos, jogos *jogo)
{
  int indice = hash(jogo->nome);
  htjogos[indice] = insere_inicio_jogo(htjogos[indice], jogo);
}

jogos *insere_inicio_jogo(jogos *headj, jogos *jogo)
{
  jogo->next = headj;
  return jogo;
}

equipas *nova_equipa(char *nome)
{
  equipas *x = malloc(sizeof(equipas));
  x->nome_equipa = malloc((strlen(nome) + 1) * (sizeof(char)));
  strcpy(x->nome_equipa, nome);
  x->vitoria = 0;
  x->next = 0;
  return x;
}

void HTinsere_equipa(equipas **ht, equipas *eq)
{
  int indice = hash(eq->nome_equipa);
  ht[indice] = insere_inicio(ht[indice], eq);
}

equipas *insere_inicio(equipas *head, equipas *eq)
{
  eq->next = head;
  return eq;
}

void HTprocura_p(jogos **htjogos, char *nome, int num)
{
  int indice = hash(nome);
  procura_jogo_p(htjogos[indice], nome, num);
}

int procura_jogo_p(jogos *headj, char *nome, int num)
{
  jogos *t = headj;
  while (t != 0)
  {
    if (strcmp(t->nome, nome) == 0)
    {
      printf("%d %s %s %s %d %d\n", num, nome, t->equipa1, t->equipa2, t->score1, t->score2);
      return 0;
    }
    else
    {
      
    }

    t = t->next;
  }

  printf("%d Jogo inexistente.\n", num);
  return 0;
}

void procura_equipa_P(equipas **ht, char *nome, int num)
{
  int indice = hash(nome);
  lista_equipa_P(ht[indice], nome, num);
}

void lista_equipa_P(equipas *head, char *nome, int num)
{
  equipas *t = head;
  while (t != 0)
  {
    if (strcmp(t->nome_equipa, nome) == 0)
    {
      printf("%d %s %d\n", num, nome, t->vitoria);
      return;
    }
    else
    {
      
    }

    t = t->next;
  }

  printf("%d Equipa inexistente.\n", num);
}

void HT_elimina_jogo(jogos **htjogos, equipas **ht, char *nome, int num)
{
  int indice = hash(nome);
  htjogos[indice] = elimina_jogo_r(ht, htjogos[indice], nome, num);
}

jogos *elimina_jogo_r(equipas **ht, jogos *headj, char *nome, int num)
{
  jogos *t;
  jogos *anterior;
  int i = 0;
  for (t = headj, anterior = 0; t != 0; anterior = t, t = t->next)
  {
    if (strcmp(t->nome, nome) == 0)
    {
      i = 1;
      if (t == headj)
      {
        if (t->score1 > t->score2)
        {
          HT_tira_vitoria(ht, t->equipa1);
        }
        else
        {
          if (t->score2 > t->score1)
          {
            HT_tira_vitoria(ht, t->equipa2);
          }
          else
          {
            
          }

        }

        headj = t->next;
      }
      else
      {
        if (t->score1 > t->score2)
        {
          HT_tira_vitoria(ht, t->equipa1);
        }
        else
        {
          if (t->score2 > t->score1)
          {
            HT_tira_vitoria(ht, t->equipa2);
          }
          else
          {
            
          }

        }

        anterior->next = t->next;
      }

      free(t->nome);
      free(t->equipa1);
      free(t->equipa2);
      free(t);
      break;
    }
    else
    {
      
    }

  }

  verifica(i, num);
  return headj;
}

void verifica(int i, int num)
{
  if (i == 0)
  {
    printf("%d Jogo inexistente.\n", num);
  }
  else
  {
    
  }

}

jogos *elimina_jogo_lista(jogos *head, char *nome, equipas *head_e)
{
  jogos *t;
  jogos *anterior;
  for (t = head, anterior = 0; t != 0; anterior = t, t = t->next)
  {
    if (strcmp(t->nome, nome) == 0)
    {
      if (t == head)
      {
        if (t->score1 > t->score2)
        {
          tirar_vitoria_lista(head_e, t->equipa1);
        }
        else
        {
          if (t->score2 > t->score1)
          {
            tirar_vitoria_lista(head_e, t->equipa2);
          }
          else
          {
            
          }

        }

        head = t->next;
      }
      else
      {
        if (t->score1 > t->score2)
        {
          tirar_vitoria_lista(head_e, t->equipa1);
        }
        else
        {
          if (t->score2 > t->score1)
          {
            tirar_vitoria_lista(head_e, t->equipa2);
          }
          else
          {
            
          }

        }

        anterior->next = t->next;
      }

      free(t->nome);
      free(t->equipa1);
      free(t->equipa2);
      free(t);
      break;
    }
    else
    {
      
    }

  }

  return head;
}

void HT_altera_score(jogos **htjogos, equipas **ht, char *nome, int score1, int score2, int num, jogos *head, equipas *head_e)
{
  int indice = hash(nome);
  altera_score_lista(ht, htjogos[indice], nome, score1, score2, num, head, head_e);
}

int altera_score_lista(equipas **ht, jogos *headj, char *nome, int score1, int score2, int num, jogos *head, equipas *head_e)
{
  jogos *t = headj;
  int i1;
  int i2;
  while (t != 0)
  {
    if (strcmp(t->nome, nome) == 0)
    {
      if (t->score1 > t->score2)
      {
        HT_tira_vitoria(ht, t->equipa1);
        tirar_vitoria_lista(head_e, t->equipa1);
      }
      else
      {
        
      }

      if (t->score2 > t->score1)
      {
        HT_tira_vitoria(ht, t->equipa2);
        tirar_vitoria_lista(head_e, t->equipa2);
      }
      else
      {
        
      }

      t->score1 = score1;
      t->score2 = score2;
      i1 = HTprocura(ht, t->equipa1);
      i2 = HTprocura(ht, t->equipa2);
      if (((i1 == 1) && (i2 == 1)) && (score1 > score2))
      {
        HT_soma_vitoria(ht, t->equipa1);
        soma_vitoria(head_e, t->equipa1);
      }
      else
      {
        if (((i1 == 1) && (i2 == 1)) && (score2 > score1))
        {
          HT_soma_vitoria(ht, t->equipa2);
          soma_vitoria(head_e, t->equipa2);
        }
        else
        {
          
        }

      }

      break;
    }
    else
    {
      
    }

    t = t->next;
  }

  if (t == 0)
  {
    printf("%d Jogo inexistente.\n", num);
  }
  else
  {
    
  }

  while (head != 0)
  {
    if (strcmp(head->nome, nome) == 0)
    {
      head->score1 = score1;
      head->score2 = score2;
      break;
    }
    else
    {
      
    }

    head = head->next;
  }

  return 0;
}

int *maior_numero_vitorias(equipas *head_e, int *v)
{
  equipas *i;
  v[0] = 0;
  v[1] = 0;
  for (i = head_e; i != 0; i = i->next)
  {
    if (i->vitoria > v[1])
    {
      v[0] = 0;
      v[1] = i->vitoria;
      v[0] = v[0] + 1;
    }
    else
    {
      if (i->vitoria == v[1])
      {
        v[0] = v[0] + 1;
      }
      else
      {
        
      }

    }

  }

  return v;
}

char **maior_equipas(equipas *head_e, int num_equipas, int max_vitorias)
{
  int cont = 0;
  equipas *i = head_e;
  char **nome = malloc((sizeof(char *)) * num_equipas);
  while (i != 0)
  {
    if (i->vitoria == max_vitorias)
    {
      nome[cont] = i->nome_equipa;
      cont++;
    }
    else
    {
      
    }

    i = i->next;
  }

  return nome;
}

void mergesort(char **nome, char **aux, int left, int right)
{
  int m = (right + left) / 2;
  if (right <= left)
  {
    return;
  }
  else
  {
    
  }

  mergesort(nome, aux, left, m);
  mergesort(nome, aux, m + 1, right);
  merge(nome, aux, left, m, right);
}

void merge(char **nome, char **aux, int left, int m, int right)
{
  int i;
  int j;
  int k;
  for (i = m + 1; i > left; i--)
    aux[i - 1] = nome[i - 1];

  for (j = m; j < right; j++)
    aux[(right + m) - j] = nome[j + 1];

  for (k = left; k <= right; k++)
  {
    if (strcmp(aux[j], aux[i]) < 0)
    {
      nome[k] = aux[j--];
    }
    else
    {
      nome[k] = aux[i++];
    }

  }

}

unsigned int hash(char *nome)
{
  unsigned int valor = 0;
  int tamanho = strlen(nome);
  int i = 0;
  while (i < tamanho)
  {
    valor = valor * tamanho;
    valor = valor + nome[i];
    i++;
  }

  return valor % 1024;
}

jogos *insere_fim_jogos(jogos *head, jogos *jogo)
{
  jogos *x;
  if (head == 0)
  {
    return novo_jogo(jogo->nome, jogo->equipa1, jogo->equipa2, jogo->score1, jogo->score2);
  }
  else
  {
    
  }

  for (x = head; x->next != 0; x = x->next)
    ;

  x->next = novo_jogo(jogo->nome, jogo->equipa1, jogo->equipa2, jogo->score1, jogo->score2);
  return head;
}

equipas *insere_fim_equipas(equipas *head_e, equipas *equipa)
{
  equipas *x;
  if (head_e == 0)
  {
    return nova_equipa(equipa->nome_equipa);
  }
  else
  {
    
  }

  for (x = head_e; x->next != 0; x = x->next)
  {
    ;
  }

  x->next = nova_equipa(equipa->nome_equipa);
  return head_e;
}

int HTprocurajogo(jogos **htjogos, char *nome)
{
  int indice = hash(nome);
  int i = procura_jogo(htjogos[indice], nome);
  return i;
}

int procura_jogo(jogos *headj, char *nome)
{
  jogos *t = headj;
  while (t != 0)
  {
    if (strcmp(t->nome, nome) == 0)
    {
      return 1;
    }
    else
    {
      
    }

    t = t->next;
  }

  return 0;
}

int HTprocura(equipas **ht, char *nome)
{
  int indice = hash(nome);
  int i = procura_equipa(ht[indice], nome);
  return i;
}

int procura_equipa(equipas *head, char *nome)
{
  equipas *t = head;
  while (t != 0)
  {
    if (strcmp(t->nome_equipa, nome) == 0)
    {
      return 1;
    }
    else
    {
      
    }

    t = t->next;
  }

  return 0;
}

void HT_tira_vitoria(equipas **ht, char *nome)
{
  int indice = hash(nome);
  tirar_vitoria_lista(ht[indice], nome);
}

void tirar_vitoria_lista(equipas *head, char *equipa_vitoria)
{
  equipas *t = head;
  while (t != 0)
  {
    if (strcmp(t->nome_equipa, equipa_vitoria) == 0)
    {
      t->vitoria = t->vitoria - 1;
      break;
    }
    else
    {
      
    }

    t = t->next;
  }

}

void HT_soma_vitoria(equipas **ht, char *equipa_vitoria)
{
  int indice = hash(equipa_vitoria);
  soma_vitoria(ht[indice], equipa_vitoria);
}

void soma_vitoria(equipas *head_e, char *equipa_vitoria)
{
  equipas *t = head_e;
  while (t != 0)
  {
    if (strcmp(t->nome_equipa, equipa_vitoria) == 0)
    {
      t->vitoria = t->vitoria + 1;
    }
    else
    {
      
    }

    t = t->next;
  }

}

void procura_free(jogos **htjogos, equipas **ht)
{
  int i = 0;
  while (i != 1025)
  {
    dar_free_equipas(ht[i]);
    dar_free_jogos(htjogos[i]);
    i++;
  }

}

void dar_free_equipas(equipas *eq)
{
  equipas *t = eq;
  equipas *novo_t;
  while (t != 0)
  {
    novo_t = t;
    free(novo_t->nome_equipa);
    t = novo_t->next;
    free(novo_t);
  }

}

void dar_free_jogos(jogos *jogo)
{
  jogos *t = jogo;
  jogos *novo_t;
  while (t != 0)
  {
    novo_t = t;
    free(novo_t->nome);
    free(novo_t->equipa1);
    free(novo_t->equipa2);
    t = novo_t->next;
    free(novo_t);
  }

}

