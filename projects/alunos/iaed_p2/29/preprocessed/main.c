#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include "game.h"


ent *hashGames;
tent *hashTeams;
int debug;
int end;
void processaLinha(char *input)
{
  switch (input[0])
  {
    case 'a':
    {
      int final;
      int scoretot[2];
      char name[1024];
      char team1[1024];
      char team2[1024];
      char score1[4];
      char score2[4];
      strcpy(name, strtok(input + 2, ":"));
      strcpy(team1, strtok(0, ":"));
      strcpy(team2, strtok(0, ":"));
      strcpy(score1, strtok(0, ":"));
      strcpy(score2, strtok(0, "\n"));
      scoretot[0] = atoi(score1);
      scoretot[1] = atoi(score2);
      final = htGame_insert(hashGames, hashTeams, name, team1, team2, scoretot);
      if (final == (-1))
      {
        printf("%d Equipa inexistente.\n", debug);
      }
      else
      {
        
      }

      if (final == 0)
      {
        printf("%d Jogo existente.\n", debug);
      }
      else
      {
        
      }

      break;
    }

    case 'A':
    {
      int final;
      char name[1024];
      strcpy(name, strtok(input + 2, "\n"));
      final = htTeam_insert(hashTeams, name);
      if (final == 0)
      {
        printf("%d Equipa existente.\n", debug);
      }
      else
      {
        
      }

      break;
    }

    case 'l':
    {
      printGames(debug);
      break;
    }

    case 'p':
    {
      game *test;
      char name[1024];
      strcpy(name, strtok(input + 2, "\n"));
      test = htGame_search(hashGames, name);
      if (test == 0)
      {
        printf("%d Jogo inexistente.\n", debug);
      }
      else
      {
        printf("%d %s %s %s %d %d\n", debug, name, test->team[0]->name, test->team[1]->name, test->score[0], test->score[1]);
      }

      break;
    }

    case 'r':
    {
      char name[1024];
      strcpy(name, strtok(input + 2, "\n"));
      if (htGame_search(hashGames, name) == 0)
      {
        printf("%d Jogo inexistente.\n", debug);
        break;
      }
      else
      {
        
      }

      htGame_delete(hashGames, name);
      break;
    }

    case 's':
    {
      int s1;
      int s2;
      char name[1024];
      char score1[4];
      char score2[4];
      game *t;
      strtok(input, " ");
      strcpy(name, strtok(0, ":"));
      strcpy(score1, strtok(0, ":"));
      strcpy(score2, strtok(0, "\n"));
      s1 = atoi(score1);
      s2 = atoi(score2);
      t = htGame_search(hashGames, name);
      if (t == 0)
      {
        printf("%d Jogo inexistente.\n", debug);
        break;
      }
      else
      {
        
      }

      htGame_change(t, s1, s2);
      break;
    }

    case 'P':
    {
      team *t;
      char name[1024];
      strcpy(name, strtok(input + 2, "\n"));
      t = htTeam_search(hashTeams, name);
      if (t == 0)
      {
        printf("%d Equipa inexistente.\n", debug);
        break;
      }
      else
      {
        
      }

      printf("%d %s %d\n", debug, name, t->wins);
      break;
    }

    case 'g':
    {
      presentOrdered(debug);
      break;
    }

    case 'x':
    {
      end = 1;
      break;
    }

  }

}

int main()
{
  hashGames = htGame_create();
  hashTeams = htTeam_create();
  dummy = malloc(sizeof(game));
  dummy->score[0] = -1;
  dummy->name = 0;
  debug = 0;
  end = 0;
  do
  {
    char linha[4100];
    debug++;
    fgets(linha, 4100, stdin);
    processaLinha(linha);
  }
  while (end == 0);
  return 0;
}

