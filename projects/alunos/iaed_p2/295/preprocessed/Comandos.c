#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "Estruturas.h"
#include "Comandos.h"


void comando_A(int nl, lista_equipas *a, lista_equipas_aux *b)
{
  char nome_equipa[1024];
  Equipa *c;
  Equipa *e;
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  c = procura_equipa(nome_equipa, a);
  if (c != 0)
  {
    printf("%d Equipa existente.\n", nl);
  }
  else
  {
    e = malloc(sizeof(Equipa));
    e->nome_equipa = malloc((sizeof(char)) * (strlen(nome_equipa) + 1));
    strcpy(e->nome_equipa, nome_equipa);
    e->n_vitorias = 0;
    insere_equipa(a, e);
    insere_equipa_aux(b, e);
  }

}

void comando_a(int nl, lista_equipas *a, lista_jogos *b, lista_jogos_aux *c, lista_equipas *g)
{
  char nome_jogo[1024];
  char nome_equipa1[1024];
  char nome_equipa2[1024];
  int res_equipa1;
  int res_equipa2;
  Equipa *d;
  Equipa *f;
  Jogo *e;
  Jogo *i;
  Jogo_aux *h;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int nome_equipa1_index = 0; nome_equipa1_index < 10; nome_equipa1_index++)
  {
    nome_equipa1[nome_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa1[10 - 1] = '\0';
  for (int nome_equipa2_index = 0; nome_equipa2_index < 10; nome_equipa2_index++)
  {
    nome_equipa2[nome_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa2[10 - 1] = '\0';
  res_equipa1 = new_sym_var(sizeof(int) * 8);
  res_equipa2 = new_sym_var(sizeof(int) * 8);
  d = procura_equipa(nome_equipa1, a);
  f = procura_equipa(nome_equipa2, a);
  e = procura_jogo(nome_jogo, b);
  if (e != 0)
  {
    printf("%d Jogo existente.\n", nl);
  }
  else
  {
    if ((d == 0) || (f == 0))
    {
      printf("%d Equipa inexistente.\n", nl);
    }
    else
    {
      i = malloc(sizeof(Jogo));
      i->nome_jogo = malloc((sizeof(char)) * (strlen(nome_jogo) + 1));
      strcpy(i->nome_jogo, nome_jogo);
      i->equipa1 = malloc((sizeof(char)) * (strlen(nome_equipa1) + 1));
      strcpy(i->equipa1, nome_equipa1);
      i->equipa2 = malloc((sizeof(char)) * (strlen(nome_equipa2) + 1));
      strcpy(i->equipa2, nome_equipa2);
      i->resultado1 = res_equipa1;
      i->resultado2 = res_equipa2;
      h = malloc(sizeof(Jogo_aux));
      h->nome_jogo = malloc((sizeof(char)) * (strlen(nome_jogo) + 1));
      strcpy(h->nome_jogo, nome_jogo);
      h->equipa1 = malloc((sizeof(char)) * (strlen(nome_equipa1) + 1));
      strcpy(h->equipa1, nome_equipa1);
      h->equipa2 = malloc((sizeof(char)) * (strlen(nome_equipa2) + 1));
      strcpy(h->equipa2, nome_equipa2);
      h->resultado1 = res_equipa1;
      h->resultado2 = res_equipa2;
      insere_jogo(b, i, g);
      insere_jogo_aux(c, h);
    }

  }

}

void comando_P(int nl, lista_equipas *a)
{
  char nome_equipa[1024];
  Equipa *b;
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  b = procura_equipa(nome_equipa, a);
  if (b != 0)
  {
    printf("%d %s %d\n", nl, b->nome_equipa, b->n_vitorias);
  }
  else
  {
    printf("%d Equipa inexistente.\n", nl);
  }

}

void comando_p(int nl, lista_jogos *a)
{
  char nome_jogo[1024];
  Jogo *b;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  b = procura_jogo(nome_jogo, a);
  if (b != 0)
  {
    printf("%d %s %s %s %d %d\n", nl, b->nome_jogo, b->equipa1, b->equipa2, b->resultado1, b->resultado2);
  }
  else
  {
    printf("%d Jogo inexistente.\n", nl);
  }

}

void comando_r(int nl, lista_jogos *a, lista_equipas *b)
{
  int i;
  char nome_jogo[1024];
  Jogo *c;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  c = procura_jogo(nome_jogo, a);
  i = hash(nome_jogo);
  if (c != 0)
  {
    a->no[i] = remove_jogo(nome_jogo, a, b);
  }
  else
  {
    printf("%d Jogo inexistente.\n", nl);
  }

}

void comando_s(int nl, lista_jogos *a, lista_equipas *c)
{
  char nome_jogo[1024];
  int res_equipa1;
  int res_equipa2;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  res_equipa1 = new_sym_var(sizeof(int) * 8);
  res_equipa2 = new_sym_var(sizeof(int) * 8);
  muda_resultado(nl, nome_jogo, res_equipa1, res_equipa2, a, c);
}

void comando_l(int nl, lista_jogos *a, lista_jogos_aux *b)
{
  int e = 0;
  no_jogos_aux *c;
  no_jogos_aux *g;
  Jogo *d;
  c = b->head;
  while (c)
  {
    g = c->next;
    d = procura_jogo(c->jog->nome_jogo, a);
    if (d != 0)
    {
      for (; g; g = g->next)
      {
        if (strcmp(d->nome_jogo, g->jog->nome_jogo) == 0)
        {
          e++;
        }
        else
        {
          
        }

      }

      if (e == 0)
      {
        printf("%d %s %s %s %d %d\n", nl, d->nome_jogo, d->equipa1, d->equipa2, d->resultado1, d->resultado2);
        c = c->next;
        e = 0;
      }
      else
      {
        c = c->next;
        e = 0;
      }

    }
    else
    {
      c = c->next;
    }

  }

}

void comando_g(int nl, lista_equipas_aux *b)
{
  int n_vitorias = 0;
  int i = 0;
  int j = 0;
  no_equipas *lista_nos[1024];
  no_equipas *c;
  no_equipas *d;
  c = b->head;
  d = b->head;
  while (c)
  {
    if (c->eq->n_vitorias > n_vitorias)
    {
      n_vitorias = c->eq->n_vitorias;
      c = c->next;
    }
    else
    {
      c = c->next;
    }

  }

  while (d)
  {
    if (d->eq->n_vitorias == n_vitorias)
    {
      lista_nos[i] = d;
      d = d->next;
      i++;
      j++;
    }
    else
    {
      d = d->next;
    }

  }

  mergesort(lista_nos, 0, i - 1);
  if (b->head)
  {
    printf("%d Melhores %d\n", nl, n_vitorias);
    for (i = 0; i < j; i++)
    {
      printf("%d * %s\n", nl, lista_nos[i]->eq->nome_equipa);
    }

  }
  else
  {
    
  }

}

void direciona(char e, int nl, lista_equipas *a, lista_equipas_aux *b, lista_jogos *c, lista_jogos_aux *d)
{
  switch (e)
  {
    case 'a':
      comando_a(nl, a, c, d, a);
      break;

    case 'l':
      comando_l(nl, c, d);
      break;

    case 'p':
      comando_p(nl, c);
      break;

    case 'r':
      comando_r(nl, c, a);
      break;

    case 's':
      comando_s(nl, c, a);
      break;

    case 'A':
      comando_A(nl, a, b);
      break;

    case 'P':
      comando_P(nl, a);
      break;

    case 'g':
      comando_g(nl, b);
      break;

  }

}

