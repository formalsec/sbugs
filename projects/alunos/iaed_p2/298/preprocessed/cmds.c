/*File generated by PreProcessor.py*/


#include "jogos_linked.h"
#include "jogos_hash.h"
#include "equipas.h"
#include "aux.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>


void command_a(int *nl, JOGO_HASH **hashtable_jogos, JOGO_LIST *lista_de_jogos, EQUIPA **hashtable_equipas)
{
  int score1;
  int score2;
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  JOGO *novo_jogo;
  JOGO *jogo_procurado;
  EQUIPA *equipa1_procurada;
  EQUIPA *equipa2_procurada;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo_procurado = procura_jogo(hashtable_jogos, nome);
  if (jogo_procurado != 0)
  {
    printf("%d Jogo existente.\n", *nl);
  }
  else
  {
    equipa1_procurada = procura_equipa(hashtable_equipas, equipa1);
    if (equipa1_procurada == 0)
    {
      printf("%d Equipa inexistente.\n", *nl);
    }
    else
    {
      equipa2_procurada = procura_equipa(hashtable_equipas, equipa2);
      if (equipa2_procurada == 0)
      {
        printf("%d Equipa inexistente.\n", *nl);
      }
      else
      {
        novo_jogo = cria_jogo(lista_de_jogos, nome, equipa1, equipa2, score1, score2);
        add_jogo_hash(hashtable_jogos, novo_jogo);
        if (score1 > score2)
        {
          add_score(hashtable_equipas, equipa1);
        }
        else
        {
          if (score1 < score2)
          {
            add_score(hashtable_equipas, equipa2);
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void command_l(int *nl, JOGO_LIST *lista_de_jogos)
{
  JOGO *tmp = lista_de_jogos->head;
  while (tmp != 0)
  {
    escreve_jogo(nl, tmp);
    tmp = tmp->next;
  }

}

void command_p(int *nl, JOGO_HASH **hashtable_jogos)
{
  char nome[1024];
  JOGO *jogo_procurado;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  jogo_procurado = procura_jogo(hashtable_jogos, nome);
  if (jogo_procurado == 0)
  {
    printf("%d Jogo inexistente.\n", *nl);
  }
  else
  {
    escreve_jogo(nl, jogo_procurado);
  }

}

void command_r(int *nl, JOGO_HASH **hashtable_jogos, EQUIPA **hashtable_equipas, JOGO_LIST *lista_de_jogos)
{
  char nome[1024];
  char *nome_equipa_win;
  JOGO *jogo_eliminar;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  jogo_eliminar = procura_jogo(hashtable_jogos, nome);
  if (jogo_eliminar == 0)
  {
    printf("%d Jogo inexistente.\n", *nl);
  }
  else
  {
    nome_equipa_win = maior_score_jogo(hashtable_jogos, nome);
    if (nome_equipa_win != 0)
    {
      remove_score(hashtable_equipas, nome_equipa_win);
    }
    else
    {
      
    }

    remove_jogo(hashtable_jogos, lista_de_jogos, nome);
  }

}

void command_s(int *nl, JOGO_HASH **hashtable_jogos, EQUIPA **hashtable_equipas)
{
  char nome[1024];
  char *nome_win;
  char *nome_next_win;
  int score1;
  int score2;
  JOGO *jogo_alterar;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo_alterar = procura_jogo(hashtable_jogos, nome);
  if (jogo_alterar == 0)
  {
    printf("%d Jogo inexistente.\n", *nl);
  }
  else
  {
    nome_win = maior_score_jogo(hashtable_jogos, nome);
    altera_score(hashtable_jogos, nome, score1, score2);
    nome_next_win = maior_score_jogo(hashtable_jogos, nome);
    if (((nome_win != 0) && (nome_next_win != 0)) && (strcmp(nome_win, nome_next_win) != 0))
    {
      add_score(hashtable_equipas, nome_next_win);
      remove_score(hashtable_equipas, nome_win);
    }
    else
    {
      if ((nome_win != 0) && (nome_next_win == 0))
      {
        remove_score(hashtable_equipas, nome_win);
      }
      else
      {
        if ((nome_win == 0) && (nome_next_win != 0))
        {
          add_score(hashtable_equipas, nome_next_win);
        }
        else
        {
          
        }

      }

    }

  }

}

void command_A(int *nl, EQUIPA **hashtable_equipas)
{
  char nome[1024];
  EQUIPA *nova_equipa;
  EQUIPA *equipa_procurada;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa_procurada = procura_equipa(hashtable_equipas, nome);
  if (equipa_procurada != 0)
  {
    printf("%d Equipa existente.\n", *nl);
  }
  else
  {
    nova_equipa = cria_equipa(nome);
    add_equipa(hashtable_equipas, nova_equipa);
  }

}

void command_P(int *nl, EQUIPA **hashtable_equipas)
{
  char nome[1024];
  EQUIPA *equipa_procurada;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa_procurada = procura_equipa(hashtable_equipas, nome);
  if (equipa_procurada == 0)
  {
    printf("%d Equipa inexistente.\n", *nl);
  }
  else
  {
    printf("%d %s %d\n", *nl, nome, equipa_procurada->score);
  }

}

void command_g(int *nl, EQUIPA **hashtable_equipas)
{
  int i;
  int maior_score = 0;
  int num_jogos = 0;
  char **lista_nomes = 0;
  maior_score = maior_score_equipa(hashtable_equipas);
  num_jogos = num_equipas(hashtable_equipas, maior_score);
  if (num_jogos != 0)
  {
    lista_nomes = malloc((sizeof(char *)) * (num_jogos + 1));
    cria_lista_nomes(lista_nomes, hashtable_equipas, maior_score);
    qsort(lista_nomes, num_jogos, sizeof(char *), compara_nomes);
    printf("%d Melhores %d\n", *nl, maior_score);
    for (i = 0; i < num_jogos; i++)
    {
      printf("%d * %s\n", *nl, lista_nomes[i]);
      free(lista_nomes[i]);
    }

    free(lista_nomes);
  }
  else
  {
    
  }

}

void command_x(EQUIPA **hashtable_equipas, JOGO_LIST *lista_de_jogos, JOGO_HASH **hashtable_jogos)
{
  destroy_hash_equipa(hashtable_equipas);
  destroy_jogos(hashtable_jogos, lista_de_jogos);
}

