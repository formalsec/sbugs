#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "MAIN_FUNTIONS.h"


void add_game(Game **game_hash, team **team_hash, int NL)
{
  char name_game[1023];
  char teamA[1023];
  char teamB[1023];
  int index;
  int scoreA;
  int scoreB;
  team *A;
  team *B;
  Game *new;
  Game *game;
  for (int name_game_index = 0; name_game_index < 10; name_game_index++)
  {
    name_game[name_game_index] = new_sym_var(sizeof(char) * 8);
  }

  name_game[10 - 1] = '\0';
  for (int teamA_index = 0; teamA_index < 10; teamA_index++)
  {
    teamA[teamA_index] = new_sym_var(sizeof(char) * 8);
  }

  teamA[10 - 1] = '\0';
  for (int teamB_index = 0; teamB_index < 10; teamB_index++)
  {
    teamB[teamB_index] = new_sym_var(sizeof(char) * 8);
  }

  teamB[10 - 1] = '\0';
  scoreA = new_sym_var(sizeof(int) * 8);
  scoreB = new_sym_var(sizeof(int) * 8);
  index = hash(name_game);
  game = game_hash[index];
  if (!game)
  {
    if (!(A = get_team(team_hash, teamA)))
    {
      printf("%d Equipa inexistente.\n", NL);
      return;
    }
    else
    {
      
    }

    if (!(B = get_team(team_hash, teamB)))
    {
      printf("%d Equipa inexistente.\n", NL);
      return;
    }
    else
    {
      
    }

    game = create_game(name_game, A, B, scoreA, scoreB);
    game->NL = NL;
    if (scoreA > scoreB)
    {
      A->vitories++;
    }
    else
    {
      if (scoreB > scoreA)
      {
        B->vitories++;
      }
      else
      {
        
      }

    }

    game_hash[index] = game;
    return;
  }
  else
  {
    
  }

  for (; game; game = game->next)
  {
    if (!strcmp(game->name, name_game))
    {
      printf("%d Jogo existente.\n", NL);
      return;
    }
    else
    {
      
    }

    if (!game->next)
    {
      break;
    }
    else
    {
      
    }

  }

  if (!(A = get_team(team_hash, teamA)))
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  if (!(B = get_team(team_hash, teamB)))
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  new = create_game(name_game, A, B, scoreA, scoreB);
  new->NL = NL;
  game->next = new;
  if (scoreA > scoreB)
  {
    A->vitories++;
  }
  else
  {
    if (scoreB > scoreA)
    {
      B->vitories++;
    }
    else
    {
      
    }

  }

  return;
}

void show_list_game(Game **game_hash, int NL)
{
  Game *p;
  Game *s = 0;
  int i = 0;
  for (; i < 15; i++)
  {
    p = game_hash[i];
    for (; p; p = p->next)
    {
      s = add_order_game(s, p->name, p->A, p->B, p->scoreA, p->scoreB, p->NL);
    }

  }

  if (!s)
  {
    return;
  }
  else
  {
    
  }

  p = s;
  for (; s; s = s->next)
  {
    printf("%d %s %s %s %d %d\n", NL, s->name, s->A->name, s->B->name, s->scoreA, s->scoreB);
  }

  p = destroy_game(p);
}

void search_game(Game **game_hash, int NL)
{
  char name[1023];
  Game *s;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  s = game_hash[hash(name)];
  for (; s; s = s->next)
    if (!strcmp(s->name, name))
  {
    printf("%d %s %s %s %d %d\n", NL, s->name, s->A->name, s->B->name, s->scoreA, s->scoreB);
    return;
  }
  else
  {
    
  }


  printf("%d Jogo inexistente.\n", NL);
}

void change_score_game(Game **game_hash, int NL)
{
  Game *game;
  char name_game[1023];
  int new_scoreA;
  int new_scoreB;
  int index = 0;
  for (int name_game_index = 0; name_game_index < 10; name_game_index++)
  {
    name_game[name_game_index] = new_sym_var(sizeof(char) * 8);
  }

  name_game[10 - 1] = '\0';
  new_scoreA = new_sym_var(sizeof(int) * 8);
  new_scoreB = new_sym_var(sizeof(int) * 8);
  index = hash(name_game);
  game = game_hash[index];
  while (game)
  {
    if (!strcmp(game->name, name_game))
    {
      break;
    }
    else
    {
      
    }

    game = game->next;
  }

  if (!game)
  {
    printf("%d Jogo inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  if (game->scoreA > game->scoreB)
  {
    if (new_scoreA < new_scoreB)
    {
      game->A->vitories--;
      game->B->vitories++;
    }
    else
    {
      if (new_scoreA == new_scoreB)
      {
        game->A->vitories--;
      }
      else
      {
        
      }

    }

  }
  else
  {
    if (game->scoreA < game->scoreB)
    {
      if (new_scoreA > new_scoreB)
      {
        game->A->vitories++;
        game->B->vitories--;
      }
      else
      {
        if (new_scoreA == new_scoreB)
        {
          game->B->vitories--;
        }
        else
        {
          
        }

      }

    }
    else
    {
      if (game->scoreA == game->scoreB)
      {
        if (new_scoreA > new_scoreB)
        {
          game->A->vitories++;
        }
        else
        {
          if (new_scoreA < new_scoreB)
          {
            game->B->vitories++;
          }
          else
          {
            
          }

        }

      }
      else
      {
        
      }

    }

  }

  game->scoreA = new_scoreA;
  game->scoreB = new_scoreB;
}

void delete_game(Game **game_hash, int NL)
{
  Game *delete;
  Game *aux;
  char name[1023];
  int index = 0;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  index = hash(name);
  delete = game_hash[index];
  if (!delete)
  {
    printf("%d Jogo inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  if (!strcmp(delete->name, name))
  {
    if (delete->scoreA > delete->scoreB)
    {
      delete->A->vitories--;
    }
    else
    {
      if (delete->scoreB > delete->scoreA)
      {
        delete->B->vitories--;
      }
      else
      {
        
      }

    }

    game_hash[index] = pop_game(game_hash[index]);
    return;
  }
  else
  {
    
  }

  aux = delete;
  delete = delete->next;
  for (; delete; delete = delete->next, aux = aux->next)
  {
    if (!strcmp(delete->name, name))
    {
      if (delete->scoreA > delete->scoreB)
      {
        delete->A->vitories--;
      }
      else
      {
        if (delete->scoreB > delete->scoreA)
        {
          delete->B->vitories--;
        }
        else
        {
          
        }

      }

      delete = pop_game(delete);
      aux->next = delete;
      return;
    }
    else
    {
      
    }

  }

  printf("%d Jogo inexistente.\n", NL);
  return;
}

void add_team(team **team_hash, int NL)
{
  char name[1023];
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  list_put_team(team_hash, name, NL);
}

void team_search(team **team_hash, int NL)
{
  char name[1023];
  team *lookteam = 0;
  for (int name_index = 0; name_index < 10; name_index++)
  {
    name[name_index] = new_sym_var(sizeof(char) * 8);
  }

  name[10 - 1] = '\0';
  lookteam = team_hash[hash(name)];
  for (; lookteam; lookteam = lookteam->next)
  {
    if (!strcmp(lookteam->name, name))
    {
      printf("%d %s %d\n", NL, lookteam->name, lookteam->vitories);
      return;
    }
    else
    {
      
    }

  }

  printf("%d Equipa inexistente.\n", NL);
}

void most_vitories(team **team_hash, int NL)
{
  int i = 0;
  team *point;
  team *print = 0;
  team *free_team;
  for (i = 0; i < 15; i++)
  {
    point = team_hash[i];
    for (; point; point = point->next)
    {
      if (!print)
      {
        print = create_team(point->name);
        print->vitories = point->vitories;
      }
      else
      {
        if (point->vitories >= print->vitories)
        {
          print = push_team(point->name, print);
          print->vitories = point->vitories;
        }
        else
        {
          
        }

      }

    }

  }

  if (!print)
  {
    return;
  }
  else
  {
    
  }

  point = 0;
  free_team = print;
  printf("%d Melhores %d\n", NL, print->vitories);
  for (; print; print = print->next)
  {
    point = add_order_team(point, print->name);
    if (print->next == 0)
    {
      break;
    }
    else
    {
      
    }

    if (print->vitories > print->next->vitories)
    {
      break;
    }
    else
    {
      
    }

  }

  print = point;
  for (; print; print = print->next)
  {
    printf("%d * %s\n", NL, print->name);
  }

  free_team = destroy_index_team(free_team);
  point = destroy_index_team(point);
}

