/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "estruturas.h"


acede_equipa_normal *adiciona_equipa_fim(equipas *p, acede_equipa_normal *a)
{
  if (a->head == 0)
  {
    no_equipa_normal *b = malloc(sizeof(no_equipa_normal));
    b->p = p;
    b->next = 0;
    a->head = b;
    a->last = b;
    return a;
  }
  else
  {
    no_equipa_normal *b = a->last;
    a->last = malloc(sizeof(no_equipa_normal));
    a->last->p = p;
    a->last->next = 0;
    b->next = a->last;
    return a;
  }

}

jogo_normal *cria_no_jogo_normal(char *nome, equipas *equipa1, equipas *equipa2, int res1, int res2)
{
  jogo_normal *novo = malloc(sizeof(jogo_normal));
  novo->nome = malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(novo->nome, nome);
  novo->equipa1 = equipa1;
  novo->equipa2 = equipa2;
  novo->resultado1 = res1;
  novo->resultado2 = res2;
  return novo;
}

acede_jogo_normal *adiciona_jogo_fim(jogo_normal *p, acede_jogo_normal *a)
{
  if (a->head == 0)
  {
    no_jogo_normal *b = malloc(sizeof(no_jogo_normal));
    b->p = p;
    b->next = 0;
    a->head = b;
    a->last = b;
    return a;
  }
  else
  {
    no_jogo_normal *b = a->last;
    a->last = malloc(sizeof(no_jogo_normal));
    a->last->p = p;
    a->last->next = 0;
    b->next = a->last;
    return a;
  }

}

void inicia_normais(acede_equipa_normal *a, acede_jogo_normal *b)
{
  a->head = 0;
  a->last = 0;
  b->head = 0;
  b->last = 0;
}

int hash(char *v)
{
  int h;
  int a = 31415;
  int b = 27183;
  for (h = 0; (*v) != '\0'; v++, a = (a * b) % (1013 - 1))
    h = ((a * h) + (*v)) % 1013;

  return h;
}

no_jogo *coloca_inicio_jogo(acede_jogos *lista, jogos *p)
{
  int i = hash(p->nome);
  no_jogo *c = lista->heads[i];
  lista->heads[i] = malloc(sizeof(no_jogo));
  lista->heads[i]->p = p;
  lista->heads[i]->next = c;
  lista->heads[i]->previous = 0;
  if (c != 0)
  {
    c->previous = lista->heads[i];
  }
  else
  {
    
  }

  return lista->heads[i];
}

jogos *procura_jogo(acede_jogos *lista, char *nome)
{
  int i = hash(nome);
  no_jogo *a = lista->heads[i];
  if (lista->heads[i] == 0)
  {
    return 0;
  }
  else
  {
    
  }

  while (a != 0)
  {
    if (strcmp(a->p->nome, nome) == 0)
    {
      return a->p;
    }
    else
    {
      
    }

    a = a->next;
  }

  return 0;
}

no_jogo *remove_jogo(acede_jogos *lista, char *nome)
{
  int i = hash(nome);
  no_jogo *q = lista->heads[i];
  no_jogo *c = lista->heads[i];
  for (; c; c = c->next)
  {
    if (strcmp(c->p->nome, nome) == 0)
    {
      if ((c->next == 0) && (c->previous == 0))
      {
        free(c->p->nome);
        free(c->p);
        free(c);
        c = 0;
        return c;
      }
      else
      {
        if (c->previous == 0)
        {
          no_jogo *a = c->next;
          a->previous = 0;
          free(c->p->nome);
          free(c->p);
          free(c);
          return a;
        }
        else
        {
          no_jogo *a = c->next;
          no_jogo *b = c->previous;
          if (a != 0)
          {
            a->previous = b;
          }
          else
          {
            
          }

          b->next = a;
          free(c->p->nome);
          free(c->p);
          free(c);
          return q;
        }

      }

    }
    else
    {
      
    }

  }

  return 0;
}

acede_jogos *inicializa_jogo(acede_jogos *lista_ligada_jogos)
{
  int i;
  for (i = 0; i < 1013; i++)
  {
    lista_ligada_jogos->heads[i] = 0;
  }

  return lista_ligada_jogos;
}

jogos *jogos_procura(char *nome, acede_jogos *lista_ligada_jogos)
{
  return procura_jogo(lista_ligada_jogos, nome);
}

void jogos_insere(jogos *p, acede_jogos *lista_ligada_jogos)
{
  int i = hash(p->nome);
  lista_ligada_jogos->heads[i] = coloca_inicio_jogo(lista_ligada_jogos, p);
}

void jogos_apaga(char *nome, acede_jogos *lista_ligada_jogos)
{
  int i = hash(nome);
  lista_ligada_jogos->heads[i] = remove_jogo(lista_ligada_jogos, nome);
}

jogos *cria_no_jogo(char *nome, equipas *equipa1, equipas *equipa2, int res1, int res2)
{
  jogos *novo = malloc(sizeof(jogos));
  novo->nome = malloc((sizeof(char)) * (strlen(nome) + 1));
  strcpy(novo->nome, nome);
  novo->equipa1 = equipa1;
  novo->equipa2 = equipa2;
  novo->resultado1 = res1;
  novo->resultado2 = res2;
  return novo;
}

no_equipa *coloca_inicio_equipa(lista_equipas *lista, equipas *p)
{
  int i = hash(p->nome);
  no_equipa *c = lista->heads[i];
  lista->heads[i] = malloc(sizeof(no_equipa));
  lista->heads[i]->p = p;
  lista->heads[i]->next = c;
  return lista->heads[i];
}

equipas *procura_equipa(lista_equipas *lista, char *nome)
{
  int i = hash(nome);
  no_equipa *a = lista->heads[i];
  if (lista->heads[i] == 0)
  {
    return 0;
  }
  else
  {
    
  }

  while (a != 0)
  {
    if (strcmp(a->p->nome, nome) == 0)
    {
      return a->p;
    }
    else
    {
      
    }

    a = a->next;
  }

  return 0;
}

lista_equipas *inicializa_equipa(lista_equipas *lista_ligada_equipas)
{
  int i;
  for (i = 0; i < 1013; i++)
  {
    lista_ligada_equipas->heads[i] = 0;
  }

  return lista_ligada_equipas;
}

equipas *equipa_procura(char *nome, lista_equipas *lista_ligada_equipas)
{
  equipas *b;
  b = procura_equipa(lista_ligada_equipas, nome);
  return b;
}

void equipa_insere(equipas *p, lista_equipas *lista_ligada_equipas)
{
  int i = hash(p->nome);
  lista_ligada_equipas->heads[i] = coloca_inicio_equipa(lista_ligada_equipas, p);
}

equipas *cria_no_equipa(char *nome)
{
  equipas *novo = malloc(sizeof(equipas));
  novo->nome = malloc((sizeof(char)) * (strlen(nome) + 1));
  novo->vitorias = 0;
  strcpy(novo->nome, nome);
  return novo;
}

int compara_s(char a[], char b[])
{
  if (strcmp(a, b) > 0)
  {
    return 1;
  }
  else
  {
    if (strcmp(a, b) < 0)
    {
      return 0;
    }
    else
    {
      
    }

  }

  return 0;
}

void merge(equipas *a[1][10000], int l, int m, int r)
{
  equipas *aux[1000];
  int i;
  int j;
  int k;
  for (i = m + 1; i > l; i--)
    aux[i - 1] = a[0][i - 1];

  for (j = m; j < r; j++)
    aux[(r + m) - j] = a[0][j + 1];

  for (k = l; k <= r; k++)
  {
    if (compara_s(aux[i]->nome, aux[j]->nome))
    {
      a[0][k] = aux[j--];
    }
    else
    {
      a[0][k] = aux[i++];
    }

  }

}

void mergesort(equipas *a[1][10000], int l, int r)
{
  int m = (r + l) / 2;
  if (r <= l)
  {
    return;
  }
  else
  {
    
  }

  mergesort(a, l, m);
  mergesort(a, m + 1, r);
  merge(a, l, m, r);
}

void func_a(int NL, lista_equipas *lista_ligada_equipas, acede_jogos *lista_ligada_jogos, acede_jogo_normal *jogos_normais)
{
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  int res1;
  int res2;
  jogos *v;
  jogo_normal *q;
  equipas *b;
  equipas *c;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  res1 = new_sym_var(sizeof(int) * 8);
  res2 = new_sym_var(sizeof(int) * 8);
  if (jogos_procura(nome, lista_ligada_jogos) != 0)
  {
    printf("%d Jogo existente.\n", NL);
  }
  else
  {
    if (equipa_procura(equipa1, lista_ligada_equipas) == 0)
    {
      printf("%d Equipa inexistente.\n", NL);
    }
    else
    {
      if (equipa_procura(equipa2, lista_ligada_equipas) == 0)
      {
        printf("%d Equipa inexistente.\n", NL);
      }
      else
      {
        b = equipa_procura(equipa1, lista_ligada_equipas);
        c = equipa_procura(equipa2, lista_ligada_equipas);
        v = cria_no_jogo(nome, b, c, res1, res2);
        q = cria_no_jogo_normal(nome, b, c, res1, res2);
        jogos_insere(v, lista_ligada_jogos);
        adiciona_jogo_fim(q, jogos_normais);
        if (res1 > res2)
        {
          b->vitorias += 1;
        }
        else
        {
          if (res1 < res2)
          {
            c->vitorias += 1;
          }
          else
          {
            
          }

        }

      }

    }

  }

}

void func_A(int NL, lista_equipas *lista_ligada_equipas, acede_equipa_normal *equipas_normais)
{
  char a[1024];
  equipas *v;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a[10 - 1] = '\0';
  if (equipa_procura(a, lista_ligada_equipas) != 0)
  {
    printf("%d Equipa existente.\n", NL);
  }
  else
  {
    v = cria_no_equipa(a);
    equipa_insere(v, lista_ligada_equipas);
    adiciona_equipa_fim(v, equipas_normais);
  }

}

void func_l(int NL, acede_jogo_normal *jogos_normais, acede_jogos *lista_ligada_jogos)
{
  jogos *b;
  char *lista[10000];
  int contador = 0;
  int i;
  int estado = 0;
  if (jogos_normais == 0)
  {
  }
  else
  {
    no_jogo_normal *a = jogos_normais->head;
    while (a != 0)
    {
      for (i = contador - 1; i >= 0; i--)
      {
        if (strcmp(lista[i], a->p->nome) == 0)
        {
          estado = 1;
        }
        else
        {
          
        }

      }

      if (estado != 1)
      {
        if ((b = jogos_procura(a->p->nome, lista_ligada_jogos)) != 0)
        {
          printf("%d %s %s %s %d %d\n", NL, a->p->nome, a->p->equipa1->nome, a->p->equipa2->nome, b->resultado1, b->resultado2);
          lista[contador] = a->p->nome;
          contador += 1;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

      a = a->next;
      estado = 0;
    }

  }

}

void func_p(int NL, acede_jogos *lista_ligada_jogos)
{
  char a[1024];
  jogos *b;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a[10 - 1] = '\0';
  b = jogos_procura(a, lista_ligada_jogos);
  if (b == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", NL, b->nome, b->equipa1->nome, b->equipa2->nome, b->resultado1, b->resultado2);
  }

}

void func_r(int NL, acede_jogos *lista_ligada_jogos)
{
  char a[1024];
  jogos *b;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a[10 - 1] = '\0';
  b = jogos_procura(a, lista_ligada_jogos);
  if (b == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    if (b->resultado1 > b->resultado2)
    {
      b->equipa1->vitorias -= 1;
    }
    else
    {
      
    }

    if (b->resultado1 < b->resultado2)
    {
      b->equipa2->vitorias -= 1;
    }
    else
    {
      
    }

    jogos_apaga(b->nome, lista_ligada_jogos);
  }

}

void func_P(int NL, lista_equipas *lista_ligada_equipas)
{
  char a[1024];
  equipas *b;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a[10 - 1] = '\0';
  b = equipa_procura(a, lista_ligada_equipas);
  if (b == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
  }
  else
  {
    printf("%d %s %d\n", NL, b->nome, b->vitorias);
  }

}

void func_s(int NL, acede_jogos *lista_ligada_jogos)
{
  char a[1024];
  int b;
  int c;
  jogos *jogo;
  for (int a_index = 0; a_index < 10; a_index++)
  {
    a[a_index] = new_sym_var(sizeof(char) * 8);
  }

  a[10 - 1] = '\0';
  b = new_sym_var(sizeof(int) * 8);
  c = new_sym_var(sizeof(int) * 8);
  jogo = jogos_procura(a, lista_ligada_jogos);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    if ((b > c) && (jogo->resultado1 < jogo->resultado2))
    {
      jogo->equipa1->vitorias += 1;
      jogo->equipa2->vitorias -= 1;
    }
    else
    {
      if ((b < c) && (jogo->resultado1 > jogo->resultado2))
      {
        jogo->equipa1->vitorias -= 1;
        jogo->equipa2->vitorias += 1;
      }
      else
      {
        if ((b == c) && (jogo->resultado1 > jogo->resultado2))
        {
          jogo->equipa1->vitorias -= 1;
        }
        else
        {
          if ((b == c) && (jogo->resultado1 < jogo->resultado2))
          {
            jogo->equipa2->vitorias -= 1;
          }
          else
          {
            if ((b > c) && (jogo->resultado1 == jogo->resultado2))
            {
              jogo->equipa1->vitorias += 1;
            }
            else
            {
              if ((b < c) && (jogo->resultado1 == jogo->resultado2))
              {
                jogo->equipa2->vitorias += 1;
              }
              else
              {
                
              }

            }

          }

        }

      }

    }

    jogo->resultado1 = b;
    jogo->resultado2 = c;
  }

}

void func_g(int NL, acede_equipa_normal *equipas_normais)
{
  int i = 0;
  int c;
  int contador = 0;
  equipas *lista_equipas_vitorias[1][10000];
  no_equipa_normal *a = equipas_normais->head;
  no_equipa_normal *b = equipas_normais->head;
  if (equipas_normais->head == 0)
  {
  }
  else
  {
    while (a != 0)
    {
      if (a->p->vitorias > i)
      {
        i = a->p->vitorias;
      }
      else
      {
        
      }

      a = a->next;
    }

    while (b != 0)
    {
      if (b->p->vitorias == i)
      {
        lista_equipas_vitorias[0][contador] = b->p;
        contador += 1;
      }
      else
      {
        
      }

      b = b->next;
    }

    if (contador == 1)
    {
    }
    else
    {
      mergesort(lista_equipas_vitorias, 0, contador - 1);
    }

    printf("%d Melhores %d\n", NL, i);
    for (c = 0; c < contador; c++)
    {
      printf("%d * %s\n", NL, lista_equipas_vitorias[0][c]->nome);
    }

  }

}

void que_func(int NL, char *letra, lista_equipas *lista_ligada_equipas, acede_jogos *lista_ligada_jogos, acede_jogo_normal *jogos_normais, acede_equipa_normal *equipas_normais)
{
  switch (*letra)
  {
    case 'a':
      func_a(NL, lista_ligada_equipas, lista_ligada_jogos, jogos_normais);
      break;

    case 'A':
      func_A(NL, lista_ligada_equipas, equipas_normais);
      break;

    case 'l':
      func_l(NL, jogos_normais, lista_ligada_jogos);
      break;

    case 'p':
      func_p(NL, lista_ligada_jogos);
      break;

    case 'r':
      func_r(NL, lista_ligada_jogos);
      break;

    case 'P':
      func_P(NL, lista_ligada_equipas);
      break;

    case 's':
      func_s(NL, lista_ligada_jogos);
      break;

    case 'g':
      func_g(NL, equipas_normais);
      break;

  }

}

void free_da_hash_jogo(acede_jogos *lista_ligada_jogos)
{
  int i;
  no_jogo *aux1;
  no_jogo *aux2;
  for (i = 0; i < 1013; i++)
  {
    aux1 = lista_ligada_jogos->heads[i];
    if (aux1 == 0)
    {
      free(aux1);
    }
    else
    {
      while (aux1)
      {
        if (aux1->next != 0)
        {
          aux2 = aux1->next;
        }
        else
        {
          aux2 = 0;
        }

        free(aux1->p->nome);
        free(aux1->p);
        free(aux1);
        aux1 = aux2;
      }

    }

  }

  free(lista_ligada_jogos);
}

void free_da_hash_equipa(lista_equipas *lista_ligada_equipas)
{
  int i;
  no_equipa *aux1;
  no_equipa *aux2;
  for (i = 0; i < 1013; i++)
  {
    aux1 = lista_ligada_equipas->heads[i];
    while (aux1)
    {
      if (aux1->next != 0)
      {
        aux2 = aux1->next;
      }
      else
      {
        aux2 = 0;
      }

      free(aux1->p->nome);
      free(aux1->p);
      free(aux1);
      aux1 = aux2;
    }

  }

  free(lista_ligada_equipas);
}

void free_jogos_normais(acede_jogo_normal *jogos_normais)
{
  no_jogo_normal *aux = jogos_normais->head;
  no_jogo_normal *aux2;
  while (aux)
  {
    if (aux->next != 0)
    {
      aux2 = aux->next;
    }
    else
    {
      aux2 = 0;
    }

    free(aux->p->nome);
    free(aux->p);
    free(aux);
    aux = aux2;
  }

  free(jogos_normais);
}

void free_equipas_normais(acede_equipa_normal *equipas_normais)
{
  no_equipa_normal *aux = equipas_normais->head;
  no_equipa_normal *aux2;
  while (aux)
  {
    if (aux->next != 0)
    {
      aux2 = aux->next;
    }
    else
    {
      aux2 = 0;
    }

    free(aux);
    aux = aux2;
  }

  free(equipas_normais);
}

