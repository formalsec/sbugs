/*File generated by PreProcessor.py*/


#include "hashtable.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>


long hash(char *string, int tamanho)
{
  long i;
  long a = 31415;
  long b = 27183;
  for (i = 0; (*string) != '\0'; string++, a = (a * b) % (tamanho - 1))
  {
    i = ((a * i) + (*string)) % tamanho;
  }

  return i;
}

hashTable *HTinit(int tamanho_jogos, int tamanho_equipas)
{
  hashTable *ht = malloc(sizeof(hashTable));
  ht->tamanho_jogos = 2 * tamanho_jogos;
  ht->numero_jogos = 0;
  ht->elementos_jogos = calloc(ht->tamanho_jogos, sizeof(node_jogos *));
  ht->tamanho_equipas = 2 * tamanho_equipas;
  ht->numero_equipas = 0;
  ht->elementos_equipas = calloc(ht->tamanho_equipas, sizeof(node_equipas *));
  return ht;
}

void HTdestroy(hashTable *ht)
{
  free(ht->elementos_jogos);
  free(ht->elementos_equipas);
  free(ht);
}

void expand_jogos(hashTable *ht)
{
  hashTable *new_ht = HTinit(ht->tamanho_jogos * 2, 1);
  long i;
  for (i = 0; i < ht->tamanho_jogos; i++)
    if (ht->elementos_jogos[i])
  {
    HTinsert_jogo(new_ht, ht->elementos_jogos[i]);
  }
  else
  {
    
  }


  free(ht->elementos_jogos);
  ht->elementos_jogos = new_ht->elementos_jogos;
  ht->tamanho_jogos = new_ht->tamanho_jogos;
  free(new_ht->elementos_equipas);
  free(new_ht);
}

void HTinsert_jogo(hashTable *ht, node_jogos *jogo)
{
  long i = hash(jogo->nome, ht->tamanho_jogos);
  while (ht->elementos_jogos[i] != 0)
    i = (i + 1) % ht->tamanho_jogos;

  ht->elementos_jogos[i] = jogo;
  if ((ht->numero_jogos++) > (ht->tamanho_jogos / 2))
  {
    expand_jogos(ht);
  }
  else
  {
    
  }

}

void HTdelete_jogo(hashTable *ht, char *nome)
{
  node_jogos *aux = 0;
  long j;
  long i = hash(nome, ht->tamanho_jogos);
  while (ht->elementos_jogos[i] != 0)
    if (!strcmp(nome, ht->elementos_jogos[i]->nome))
  {
    break;
  }
  else
  {
    i = (i + 1) % ht->tamanho_jogos;
  }


  if (ht->elementos_jogos[i] == 0)
  {
    return;
  }
  else
  {
    
  }

  ht->elementos_jogos[i] = 0;
  ht->numero_jogos--;
  for (j = (i + 1) % ht->tamanho_jogos; ht->elementos_jogos[j] != 0; j = (j + 1) % ht->tamanho_jogos, ht->numero_jogos--)
  {
    aux = ht->elementos_jogos[j];
    ht->elementos_jogos[j] = 0;
    HTinsert_jogo(ht, aux);
  }

}

node_jogos *HTsearch_jogo(hashTable *ht, char *nome)
{
  long i = hash(nome, ht->tamanho_jogos);
  while (ht->elementos_jogos[i] != 0)
  {
    if (!strcmp(nome, ht->elementos_jogos[i]->nome))
    {
      return ht->elementos_jogos[i];
    }
    else
    {
      i = (i + 1) % ht->tamanho_jogos;
    }

  }

  return 0;
}

void expand_equipas(hashTable *ht)
{
  hashTable *new_ht = HTinit(1, ht->tamanho_equipas * 2);
  long i;
  for (i = 0; i < ht->tamanho_equipas; i++)
    if (ht->elementos_equipas[i])
  {
    HTinsert_equipa(new_ht, ht->elementos_equipas[i]);
  }
  else
  {
    
  }


  free(ht->elementos_equipas);
  ht->elementos_equipas = new_ht->elementos_equipas;
  ht->tamanho_equipas = new_ht->tamanho_equipas;
  free(new_ht->elementos_jogos);
  free(new_ht);
}

void HTinsert_equipa(hashTable *ht, node_equipas *equipa)
{
  long i = hash(equipa->nome, ht->tamanho_equipas);
  while (ht->elementos_equipas[i] != 0)
    i = (i + 1) % ht->tamanho_equipas;

  ht->elementos_equipas[i] = equipa;
  if ((ht->numero_equipas++) > (ht->tamanho_equipas / 2))
  {
    expand_equipas(ht);
  }
  else
  {
    
  }

}

node_equipas *HTsearch_equipa(hashTable *ht, char *nome)
{
  long i = hash(nome, ht->tamanho_equipas);
  while (ht->elementos_equipas[i] != 0)
  {
    if (!strcmp(nome, ht->elementos_equipas[i]->nome))
    {
      return ht->elementos_equipas[i];
    }
    else
    {
      i = (i + 1) % ht->tamanho_equipas;
    }

  }

  return 0;
}

