/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "heads.h"


void add_equipa(int NL, list_equipas *teams, HT_equipas *HT_equipas, int HT_tam)
{
  char nome[1023];
  equipa *novo = calloc(1, sizeof(equipa));
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (searchEquipa(nome, HT_equipas, HT_tam))
  {
    printf("%d Equipa existente.\n", NL);
    free(novo);
  }
  else
  {
    novo->nome = malloc((sizeof(char)) * (strlen(nome) + 1));
    strcpy(novo->nome, nome);
    novo->jogos_ganhos = 0;
    if (teams->last)
    {
      teams->last->next = novo;
    }
    else
    {
      teams->head = novo;
    }

    teams->last = novo;
    addHTE(novo, HT_equipas, HT_tam);
  }

}

void procura_equipa(int NL, HT_equipas *HT_equipas, int HT_tam)
{
  equipa *equipa;
  char nome[1023];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  equipa = searchEquipa(nome, HT_equipas, HT_tam);
  if (equipa)
  {
    printf("%d %s %d\n", NL, equipa->nome, equipa->jogos_ganhos);
  }
  else
  {
    printf("%d Equipa inexistente.\n", NL);
  }

}

int cmpfunc(const void *a, const void *b)
{
  struct equipa *ia = (struct equipa *) a;
  struct equipa *ib = (struct equipa *) b;
  return strcmp(ia->nome, ib->nome);
}

void encontra_equipas(int NL, list_equipas *teams)
{
  equipa *equipa_;
  equipa *champs;
  int tam = 0;
  int i = 0;
  int melhor = 0;
  int mem_a = 100;
  int mem_u = 0;
  champs = malloc((sizeof(equipa_)) * mem_a);
  for (equipa_ = teams->head; equipa_; equipa_ = equipa_->next)
  {
    if (equipa_->jogos_ganhos > melhor)
    {
      melhor = equipa_->jogos_ganhos;
      mem_u = 1;
    }
    else
    {
      if (equipa_->jogos_ganhos == melhor)
      {
        mem_u += 1;
        if (mem_u >= (mem_a - 1))
        {
          mem_a = mem_a + 100;
          champs = realloc(champs, (sizeof(equipa_)) * mem_a);
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }

  }

  if (teams->head)
  {
    printf("%d Melhores %d\n", NL, melhor);
  }
  else
  {
    
  }

  for (equipa_ = teams->head; equipa_; equipa_ = equipa_->next)
  {
    if (equipa_->jogos_ganhos == melhor)
    {
      champs[tam] = equipa_[0];
      tam++;
    }
    else
    {
      
    }

  }

  qsort(champs, tam, sizeof(struct equipa), cmpfunc);
  for (i = 0; i < tam; i++)
  {
    printf("%d * %s\n", NL, champs[i].nome);
  }

  free(champs);
}

