#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "main.h"


int comando_A(int counter, Hash_Array *team_hash)
{
  char *team_name;
  Game *team;
  Game *aux;
  team_name = malloc((sizeof(char)) * 1024);
  for (int team_name_index = 0; team_name_index < 10; team_name_index++)
  {
    team_name[team_name_index] = new_sym_var(sizeof(char) * 8);
  }

  team_name[10 - 1] = '\0';
  team_name = resize_string(team_name);
  aux = hashtable_get(team_hash, team_name);
  if (aux != 0)
  {
    free(team_name);
    printf("%d Equipa existente.\n", counter);
    return 1;
  }
  else
  {
    
  }

  team = malloc(sizeof(Game));
  team->score1 = 0;
  team->team_flag = 1;
  hashtable_insert(team_hash, team_name, team);
  return 1;
}

int comando_P(int counter, Hash_Array *team_hash)
{
  char team_name[1024];
  Game *output;
  for (int team_name_index = 0; team_name_index < 10; team_name_index++)
  {
    team_name[team_name_index] = new_sym_var(sizeof(char) * 8);
  }

  team_name[10 - 1] = '\0';
  output = hashtable_get(team_hash, team_name);
  if (output == 0)
  {
    printf("%d Equipa inexistente.\n", counter);
    return 1;
  }
  else
  {
    
  }

  printf("%d %s %d\n", counter, team_name, output->score1);
  return 1;
}

Node_ptr comando_a(int counter, Hash_Array *game_hash, Hash_Array *team_hash, Node_ptr top_game_list)
{
  int score1;
  int score2;
  char *game_name;
  char *team1;
  char *team2;
  Game *game;
  Game *aux;
  Game *aux1;
  Game *winning_team;
  game_name = read_string();
  team1 = read_string();
  team2 = read_string();
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  aux = hashtable_get(game_hash, game_name);
  if (aux != 0)
  {
    free(game_name);
    free(team1);
    free(team2);
    printf("%d Jogo existente.\n", counter);
    return 0;
  }
  else
  {
    
  }

  aux = hashtable_get(team_hash, team1);
  aux1 = hashtable_get(team_hash, team2);
  if ((aux == 0) || (aux1 == 0))
  {
    free(team1);
    free(team2);
    free(game_name);
    printf("%d Equipa inexistente.\n", counter);
    return 0;
  }
  else
  {
    
  }

  if (score1 > score2)
  {
    winning_team = hashtable_get(team_hash, team1);
  }
  else
  {
    
  }

  if (score1 < score2)
  {
    winning_team = hashtable_get(team_hash, team2);
  }
  else
  {
    
  }

  if (score1 == score2)
  {
    winning_team = 0;
  }
  else
  {
    
  }

  if (winning_team != 0)
  {
    winning_team->score1 = winning_team->score1 + 1;
  }
  else
  {
    
  }

  game = malloc(sizeof(Game));
  game->team_flag = 0;
  game->score1 = score1;
  game->score2 = score2;
  game->team1 = team1;
  game->team2 = team2;
  hashtable_insert(game_hash, game_name, game);
  top_game_list = push(game_name, top_game_list);
  game->index = &top_game_list->size;
  return top_game_list;
}

int comando_l(int counter, Hash_Array *game_hash, Node_ptr top_game_list)
{
  Node_ptr list_aux;
  Game *game;
  if (top_game_list == 0)
  {
    return 0;
  }
  else
  {
    
  }

  list_aux = top_game_list->first;
  if (list_aux == top_game_list)
  {
    game = hashtable_get(game_hash, list_aux->value);
    printf("%d %s %s %s %d %d\n", counter, list_aux->value, game->team1, game->team2, game->score1, game->score2);
    return 0;
  }
  else
  {
    
  }

  while (list_aux != 0)
  {
    game = hashtable_get(game_hash, list_aux->value);
    printf("%d %s %s %s %d %d\n", counter, list_aux->value, game->team1, game->team2, game->score1, game->score2);
    list_aux = list_aux->prev;
  }

  return 0;
}

int comando_p(int counter, Hash_Array *game_hash)
{
  char game_name[1024];
  Game *game;
  for (int game_name_index = 0; game_name_index < 10; game_name_index++)
  {
    game_name[game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  game_name[10 - 1] = '\0';
  game = hashtable_get(game_hash, game_name);
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", counter);
    return 1;
  }
  else
  {
    
  }

  printf("%d %s %s %s %d %d\n", counter, game_name, game->team1, game->team2, game->score1, game->score2);
  return 1;
}

Node_ptr comando_r(int counter, Hash_Array *game_hash, Hash_Array *team_hash, Node_ptr top_game_list)
{
  char game_name[1024];
  Game *game;
  Game *winning_team;
  for (int game_name_index = 0; game_name_index < 10; game_name_index++)
  {
    game_name[game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  game_name[10 - 1] = '\0';
  game = hashtable_get(game_hash, game_name);
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", counter);
    return top_game_list;
  }
  else
  {
    
  }

  if (game->score1 > game->score2)
  {
    winning_team = hashtable_get(team_hash, game->team1);
  }
  else
  {
    
  }

  if (game->score1 < game->score2)
  {
    winning_team = hashtable_get(team_hash, game->team2);
  }
  else
  {
    
  }

  if (game->score1 == game->score2)
  {
    winning_team = 0;
  }
  else
  {
    
  }

  if (winning_team != 0)
  {
    winning_team->score1 = winning_team->score1 - 1;
  }
  else
  {
    
  }

  top_game_list = delete_index(*game->index, top_game_list);
  hashtable_del(game_hash, game_name);
  return top_game_list;
}

int comando_s(int counter, Hash_Array *game_hash, Hash_Array *team_hash)
{
  Game *game;
  Game *winning_team;
  Game *losing_team;
  char game_name[1024];
  int score1;
  int score2;
  int before;
  int after;
  for (int game_name_index = 0; game_name_index < 10; game_name_index++)
  {
    game_name[game_name_index] = new_sym_var(sizeof(char) * 8);
  }

  game_name[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  game = hashtable_get(game_hash, game_name);
  if (game == 0)
  {
    printf("%d Jogo inexistente.\n", counter);
    return 1;
  }
  else
  {
    
  }

  before = game->score1 - game->score2;
  after = score1 - score2;
  if (((before * after) >= 1) || ((before == 0) && (after == 0)))
  {
    game->score1 = score1;
    game->score2 = score2;
    return 1;
  }
  else
  {
    
  }

  if (game->score1 == game->score2)
  {
    if (score1 > score2)
    {
      winning_team = hashtable_get(team_hash, game->team1);
      winning_team->score1 = winning_team->score1 + 1;
      game->score1 = score1;
      game->score2 = score2;
      return 1;
    }
    else
    {
      
    }

    if (score2 > score1)
    {
      winning_team = hashtable_get(team_hash, game->team2);
      winning_team->score1 = winning_team->score1 + 1;
      game->score1 = score1;
      game->score2 = score2;
      return 1;
    }
    else
    {
      
    }

  }
  else
  {
    
  }

  if (score1 == score2)
  {
    if (game->score1 > game->score2)
    {
      winning_team = hashtable_get(team_hash, game->team1);
      winning_team->score1 = winning_team->score1 - 1;
      game->score1 = score1;
      game->score2 = score2;
      return 1;
    }
    else
    {
      
    }

    winning_team = hashtable_get(team_hash, game->team2);
    winning_team->score1 = winning_team->score1 - 1;
    game->score1 = score1;
    game->score2 = score2;
    return 1;
  }
  else
  {
    
  }

  if (score1 > score2)
  {
    winning_team = hashtable_get(team_hash, game->team1);
    losing_team = hashtable_get(team_hash, game->team2);
  }
  else
  {
    
  }

  if (score1 < score2)
  {
    winning_team = hashtable_get(team_hash, game->team2);
    losing_team = hashtable_get(team_hash, game->team1);
  }
  else
  {
    
  }

  winning_team->score1 = winning_team->score1 + 1;
  losing_team->score1 = losing_team->score1 - 1;
  if (losing_team->score1 < 0)
  {
    losing_team->score1 = 0;
  }
  else
  {
    
  }

  game->score1 = score1;
  game->score2 = score2;
  return 1;
}

int comando_g(int counter, Hash_Array *team_hash)
{
  biggest_wins(counter, team_hash);
  return 0;
}

char *resize_string(char *string)
{
  char *output;
  output = malloc(((sizeof(char)) * strlen(string)) + 1);
  strcpy(output, string);
  free(string);
  return output;
}

char *read_string()
{
  char *output;
  output = malloc((sizeof(char)) * 1024);
  for (int output_index = 0; output_index < 10; output_index++)
  {
    output[output_index] = new_sym_var(sizeof(char) * 8);
  }

  output[10 - 1] = '\0';
  output = resize_string(output);
  return output;
}

