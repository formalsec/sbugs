#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "funcoes.h"


void vitoria_eq1(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq1;
  int index_eq2;
  NodeE *tmpE;
  index_eq1 = hash(tmpJ->aponta_jogo->equipa1, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq1];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa1) == 0)
    {
      tmpE->aponta_equipa->vitorias += 1;
      break;
    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

  index_eq2 = hash(tmpJ->aponta_jogo->equipa2, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq2];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa2) == 0)
    {
      if (tmpE->aponta_equipa->vitorias > 0)
      {
        tmpE->aponta_equipa->vitorias -= 1;
        break;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void vitoria_eq2(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq1;
  int index_eq2;
  NodeE *tmpE;
  index_eq1 = hash(tmpJ->aponta_jogo->equipa1, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq1];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa1) == 0)
    {
      if (tmpE->aponta_equipa->vitorias > 0)
      {
        tmpE->aponta_equipa->vitorias -= 1;
        break;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

  index_eq2 = hash(tmpJ->aponta_jogo->equipa2, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq2];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa2) == 0)
    {
      tmpE->aponta_equipa->vitorias += 1;
      break;
    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void empate1(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq1;
  NodeE *tmpE;
  index_eq1 = hash(tmpJ->aponta_jogo->equipa1, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq1];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa1) == 0)
    {
      tmpE->aponta_equipa->vitorias += 1;
      break;
    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void empate2(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq2;
  NodeE *tmpE;
  index_eq2 = hash(tmpJ->aponta_jogo->equipa2, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq2];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa2) == 0)
    {
      tmpE->aponta_equipa->vitorias += 1;
      break;
    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void retira_eq1(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq1;
  NodeE *tmpE;
  index_eq1 = hash(tmpJ->aponta_jogo->equipa1, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq1];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa1) == 0)
    {
      if (tmpE->aponta_equipa->vitorias > 0)
      {
        tmpE->aponta_equipa->vitorias -= 1;
        break;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void retira_eq2(Hequipas *TabEquipas, NodeJ *tmpJ)
{
  int index_eq2;
  NodeE *tmpE;
  index_eq2 = hash(tmpJ->aponta_jogo->equipa2, TabEquipas->capacidade);
  tmpE = TabEquipas->cabecas[index_eq2];
  while (tmpE != 0)
  {
    if (strcmp(tmpE->aponta_equipa->nome, tmpJ->aponta_jogo->equipa2) == 0)
    {
      if (tmpE->aponta_equipa->vitorias > 0)
      {
        tmpE->aponta_equipa->vitorias -= 1;
        break;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

    tmpE = tmpE->proximo;
  }

}

void atualizador(NodeJ *tmpJ, int pontos1_novos, int pontos2_novos)
{
  tmpJ->aponta_jogo->pontos1 = pontos1_novos;
  tmpJ->aponta_jogo->pontos2 = pontos2_novos;
}

void remove_jLista(Cabeca_cauda *extremos_lista_jogos, NodeJ *tmpJ)
{
  if (tmpJ->aponta_jogo->anterior == 0)
  {
    extremos_lista_jogos->cabeca = tmpJ->aponta_jogo->proximo;
  }
  else
  {
    tmpJ->aponta_jogo->anterior->proximo = tmpJ->aponta_jogo->proximo;
  }

  if (tmpJ->aponta_jogo->proximo == 0)
  {
    extremos_lista_jogos->cauda = tmpJ->aponta_jogo->anterior;
  }
  else
  {
    tmpJ->aponta_jogo->proximo->anterior = tmpJ->aponta_jogo->anterior;
  }

  free(tmpJ->aponta_jogo->nome);
  free(tmpJ->aponta_jogo->equipa1);
  free(tmpJ->aponta_jogo->equipa2);
  free(tmpJ->aponta_jogo);
}

void remove_jHash(Hjogos *TabJogos, NodeJ *tmpJ, int index)
{
  NodeJ *atual = TabJogos->cabecas[index];
  NodeJ *aux = TabJogos->cabecas[index];
  if (atual == tmpJ)
  {
    TabJogos->cabecas[index] = atual->proximo;
    free(atual);
  }
  else
  {
    while (atual != tmpJ)
    {
      aux = atual;
      atual = atual->proximo;
    }

    aux->proximo = atual->proximo;
    free(atual);
  }

}

static int myCompare(const void *a, const void *b)
{
  return strcmp(*((const char **) a), *((const char **) b));
}

void sort(char *arr[], int n)
{
  qsort(arr, n, sizeof(const char *), myCompare);
}

void a(Hequipas *TabEquipas, Hjogos *TabJogos, Cabeca_cauda *extremos_lista_jogos, int *NL)
{
  char nome_aux[1024];
  char equipa1_aux[1024];
  char equipa2_aux[1024];
  int pontos1;
  int pontos2;
  int index;
  NodeE *tmp;
  getchar();
  for (int nome_aux_index = 0; nome_aux_index < 10; nome_aux_index++)
  {
    nome_aux[nome_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_aux[10 - 1] = '\0';
  for (int equipa1_aux_index = 0; equipa1_aux_index < 10; equipa1_aux_index++)
  {
    equipa1_aux[equipa1_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1_aux[10 - 1] = '\0';
  for (int equipa2_aux_index = 0; equipa2_aux_index < 10; equipa2_aux_index++)
  {
    equipa2_aux[equipa2_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2_aux[10 - 1] = '\0';
  pontos1 = new_sym_var(sizeof(int) * 8);
  pontos2 = new_sym_var(sizeof(int) * 8);
  if (procuraJ(TabJogos, nome_aux))
  {
    printf("%d Jogo existente.\n", *NL);
    *NL += 1;
  }
  else
  {
    if (!(procuraE(TabEquipas, equipa1_aux) && procuraE(TabEquipas, equipa2_aux)))
    {
      printf("%d Equipa inexistente.\n", *NL);
      *NL += 1;
    }
    else
    {
      hash_insertJ(TabJogos, extremos_lista_jogos, nome_aux, equipa1_aux, equipa2_aux, pontos1, pontos2);
      if (pontos1 > pontos2)
      {
        index = hash(equipa1_aux, TabEquipas->capacidade);
        tmp = TabEquipas->cabecas[index];
        while (tmp != 0)
        {
          if (strcmp(tmp->aponta_equipa->nome, equipa1_aux) == 0)
          {
            tmp->aponta_equipa->vitorias += 1;
            break;
          }
          else
          {
            
          }

          tmp = tmp->proximo;
        }

      }
      else
      {
        if (pontos2 > pontos1)
        {
          index = hash(equipa2_aux, TabEquipas->capacidade);
          tmp = TabEquipas->cabecas[index];
          while (tmp != 0)
          {
            if (strcmp(tmp->aponta_equipa->nome, equipa2_aux) == 0)
            {
              tmp->aponta_equipa->vitorias += 1;
              break;
            }
            else
            {
              
            }

            tmp = tmp->proximo;
          }

        }
        else
        {
          
        }

      }

      *NL += 1;
    }

  }

}

Equipa *A(Hequipas *TabEquipas, Equipa *cabeca_equipas, int *NL)
{
  char buffer[1024];
  getchar();
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[10 - 1] = '\0';
  if (procuraE(TabEquipas, buffer))
  {
    printf("%d Equipa existente.\n", *NL);
    *NL += 1;
    return cabeca_equipas;
  }
  else
  {
    *NL += 1;
    return hash_insertE(TabEquipas, cabeca_equipas, buffer);
  }

}

void l(int *NL, Cabeca_cauda *extremos_lista_jogos)
{
  Jogo *tmp = extremos_lista_jogos->cabeca;
  while (tmp != 0)
  {
    printf("%d %s %s %s %d %d\n", *NL, tmp->nome, tmp->equipa1, tmp->equipa2, tmp->pontos1, tmp->pontos2);
    tmp = tmp->proximo;
  }

  *NL += 1;
}

void p(Hjogos *TabJogos, int *NL)
{
  char nome_aux[1024];
  int index;
  NodeJ *tmp;
  getchar();
  for (int nome_aux_index = 0; nome_aux_index < 10; nome_aux_index++)
  {
    nome_aux[nome_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_aux[10 - 1] = '\0';
  if (procuraJ(TabJogos, nome_aux))
  {
    index = hash(nome_aux, TabJogos->capacidade);
    tmp = TabJogos->cabecas[index];
    while (tmp != 0)
    {
      if (strcmp(tmp->aponta_jogo->nome, nome_aux) == 0)
      {
        printf("%d %s %s %s %d %d\n", *NL, tmp->aponta_jogo->nome, tmp->aponta_jogo->equipa1, tmp->aponta_jogo->equipa2, tmp->aponta_jogo->pontos1, tmp->aponta_jogo->pontos2);
        break;
      }
      else
      {
        
      }

      tmp = tmp->proximo;
    }

    *NL += 1;
  }
  else
  {
    printf("%d Jogo inexistente.\n", *NL);
    *NL += 1;
  }

}

void P(Hequipas *TabEquipas, int *NL)
{
  char buffer[1024];
  int index;
  NodeE *tmp;
  getchar();
  for (int buffer_index = 0; buffer_index < 10; buffer_index++)
  {
    buffer[buffer_index] = new_sym_var(sizeof(char) * 8);
  }

  buffer[10 - 1] = '\0';
  if (procuraE(TabEquipas, buffer))
  {
    index = hash(buffer, TabEquipas->capacidade);
    tmp = TabEquipas->cabecas[index];
    while (tmp != 0)
    {
      if (strcmp(tmp->aponta_equipa->nome, buffer) == 0)
      {
        printf("%d %s %d\n", *NL, tmp->aponta_equipa->nome, tmp->aponta_equipa->vitorias);
        break;
      }
      else
      {
        
      }

      tmp = tmp->proximo;
    }

    *NL += 1;
  }
  else
  {
    printf("%d Equipa inexistente.\n", *NL);
    *NL += 1;
  }

}

void r(int *NL, Hjogos *TabJogos, Hequipas *TabEquipas, Cabeca_cauda *extremos_lista_jogos)
{
  char nome_aux[1024];
  int index;
  NodeJ *tmpJ;
  getchar();
  for (int nome_aux_index = 0; nome_aux_index < 10; nome_aux_index++)
  {
    nome_aux[nome_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_aux[10 - 1] = '\0';
  index = hash(nome_aux, TabJogos->capacidade);
  tmpJ = TabJogos->cabecas[index];
  if (!procuraJ(TabJogos, nome_aux))
  {
    printf("%d Jogo inexistente.\n", *NL);
    *NL += 1;
  }
  else
  {
    while (tmpJ != 0)
    {
      if (strcmp(tmpJ->aponta_jogo->nome, nome_aux) == 0)
      {
        if (tmpJ->aponta_jogo->pontos1 > tmpJ->aponta_jogo->pontos2)
        {
          retira_eq1(TabEquipas, tmpJ);
          remove_jLista(extremos_lista_jogos, tmpJ);
          remove_jHash(TabJogos, tmpJ, index);
          *NL += 1;
          return;
        }
        else
        {
          if (tmpJ->aponta_jogo->pontos2 > tmpJ->aponta_jogo->pontos1)
          {
            retira_eq2(TabEquipas, tmpJ);
            remove_jLista(extremos_lista_jogos, tmpJ);
            remove_jHash(TabJogos, tmpJ, index);
            *NL += 1;
            return;
          }
          else
          {
            remove_jLista(extremos_lista_jogos, tmpJ);
            remove_jHash(TabJogos, tmpJ, index);
            *NL += 1;
            return;
          }

        }

      }
      else
      {
        
      }

      tmpJ = tmpJ->proximo;
    }

  }

}

void s(Hequipas *TabEquipas, Hjogos *TabJogos, int *NL)
{
  char nome_aux[1024];
  int index;
  int pontos1_novos;
  int pontos2_novos;
  NodeJ *tmpJ;
  getchar();
  for (int nome_aux_index = 0; nome_aux_index < 10; nome_aux_index++)
  {
    nome_aux[nome_aux_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_aux[10 - 1] = '\0';
  pontos1_novos = new_sym_var(sizeof(int) * 8);
  pontos2_novos = new_sym_var(sizeof(int) * 8);
  if (procuraJ(TabJogos, nome_aux))
  {
    index = hash(nome_aux, TabJogos->capacidade);
    tmpJ = TabJogos->cabecas[index];
    while (tmpJ != 0)
    {
      if (strcmp(tmpJ->aponta_jogo->nome, nome_aux) == 0)
      {
        if (pontos1_novos > pontos2_novos)
        {
          if (tmpJ->aponta_jogo->pontos2 > tmpJ->aponta_jogo->pontos1)
          {
            vitoria_eq1(TabEquipas, tmpJ);
            atualizador(tmpJ, pontos1_novos, pontos2_novos);
          }
          else
          {
            if (tmpJ->aponta_jogo->pontos1 == tmpJ->aponta_jogo->pontos2)
            {
              empate1(TabEquipas, tmpJ);
              atualizador(tmpJ, pontos1_novos, pontos2_novos);
            }
            else
            {
              atualizador(tmpJ, pontos1_novos, pontos2_novos);
            }

          }

          break;
        }
        else
        {
          if (pontos2_novos > pontos1_novos)
          {
            if (tmpJ->aponta_jogo->pontos1 > tmpJ->aponta_jogo->pontos2)
            {
              vitoria_eq2(TabEquipas, tmpJ);
              atualizador(tmpJ, pontos1_novos, pontos2_novos);
            }
            else
            {
              if (tmpJ->aponta_jogo->pontos1 == tmpJ->aponta_jogo->pontos2)
              {
                empate2(TabEquipas, tmpJ);
                atualizador(tmpJ, pontos1_novos, pontos2_novos);
              }
              else
              {
                atualizador(tmpJ, pontos1_novos, pontos2_novos);
              }

            }

            break;
          }
          else
          {
            if (tmpJ->aponta_jogo->pontos1 > tmpJ->aponta_jogo->pontos2)
            {
              retira_eq1(TabEquipas, tmpJ);
              atualizador(tmpJ, pontos1_novos, pontos2_novos);
            }
            else
            {
              if (tmpJ->aponta_jogo->pontos2 > tmpJ->aponta_jogo->pontos1)
              {
                retira_eq2(TabEquipas, tmpJ);
                atualizador(tmpJ, pontos1_novos, pontos2_novos);
              }
              else
              {
                atualizador(tmpJ, pontos1_novos, pontos2_novos);
              }

            }

            break;
          }

        }

      }
      else
      {
        
      }

      tmpJ = tmpJ->proximo;
    }

  }
  else
  {
    printf("%d Jogo inexistente.\n", *NL);
  }

  *NL += 1;
}

void g(int *NL, Equipa *cabeca_equipas)
{
  Equipa *tmp = cabeca_equipas;
  Equipa *tmp2 = cabeca_equipas;
  Equipa *tmp3 = cabeca_equipas;
  int max = 0;
  int contador_equipas = 0;
  int i = 0;
  char **equipas_maior;
  if (tmp != 0)
  {
    while (tmp != 0)
    {
      if (tmp->vitorias > max)
      {
        max = tmp->vitorias;
      }
      else
      {
        
      }

      tmp = tmp->proximo;
    }

    while (tmp2 != 0)
    {
      if (tmp2->vitorias == max)
      {
        contador_equipas += 1;
      }
      else
      {
        
      }

      tmp2 = tmp2->proximo;
    }

    equipas_maior = malloc((sizeof(char *)) * contador_equipas);
    while (tmp3 != 0)
    {
      if (tmp3->vitorias == max)
      {
        equipas_maior[i] = malloc((sizeof(char)) * (strlen(tmp3->nome) + 1));
        strcpy(equipas_maior[i], tmp3->nome);
        i++;
      }
      else
      {
        
      }

      tmp3 = tmp3->proximo;
    }

    printf("%d Melhores %d\n", *NL, max);
    sort(equipas_maior, contador_equipas);
    for (i = 0; i < contador_equipas; i++)
    {
      printf("%d * %s\n", *NL, equipas_maior[i]);
    }

    for (i = 0; i < contador_equipas; i++)
    {
      free(equipas_maior[i]);
    }

    free(equipas_maior);
  }
  else
  {
    
  }

  *NL += 1;
}

