#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "hashtable_equipas.h"


int hash(char *nome, int M)
{
  int h;
  int a = 313;
  int b = 171;
  for (h = 0; (*nome) != '\0'; nome++, a = (a * b) % (M - 1))
  {
    h = ((a * h) + (*nome)) % M;
  }

  return h;
}

table_e **inicializa_e(table_e **heads, int M)
{
  int i;
  heads = malloc(M * (sizeof(table_e *)));
  for (i = 0; i < M; i++)
  {
    heads[i] = 0;
  }

  return heads;
}

void adiciona_e(table_e **heads, Equipa *eq, int M)
{
  Equipa *x;
  int key = hash(eq->nome, M);
  if (heads[key] == 0)
  {
    heads[key] = malloc(sizeof(table_e));
    heads[key]->equipas = eq;
  }
  else
  {
    x = heads[key]->equipas;
    heads[key]->equipas = eq;
    eq->next = x;
  }

}

Equipa *encontra(Equipa *head, char *nome)
{
  Equipa *equipa;
  for (equipa = head; equipa != 0; equipa = equipa->next)
  {
    if (strcmp(equipa->nome, nome) == 0)
    {
      return equipa;
    }
    else
    {
      
    }

  }

  return 0;
}

Equipa *procura_equipa_hash(table_e **heads, Chave nome, int M)
{
  Equipa *x;
  int key = hash(nome, M);
  if (heads[key] != 0)
  {
    x = heads[key]->equipas;
    if ((x = encontra(x, nome)) == 0)
    {
      return 0;
    }
    else
    {
      return x;
    }

  }
  else
  {
    
  }

  return 0;
}

int mais_ganhos(table_e **heads, int size_hash, int *count)
{
  int max = 0;
  int ganhos;
  int i;
  Equipa *x;
  for (i = 0; i < size_hash; i++)
  {
    if (heads[i] != 0)
    {
      for (x = heads[i]->equipas; x != 0; x = x->next)
      {
        if ((ganhos = x->ganhos) == max)
        {
          *count = (*count) + 1;
        }
        else
        {
          if (ganhos > max)
          {
            max = ganhos;
            *count = 1;
          }
          else
          {
            
          }

        }

      }

    }
    else
    {
      
    }

  }

  return max;
}

void free_hash_equipas(table_e **heads, int M)
{
  Equipa *x;
  Equipa *head;
  int i;
  for (i = 0; i < M; i++)
  {
    if (heads[i] != 0)
    {
      head = heads[i]->equipas;
      for (x = head; head != 0; x = head)
      {
        head = head->next;
        free_equipa(x);
      }

    }
    else
    {
      
    }

    free(heads[i]);
  }

  free(heads);
}

