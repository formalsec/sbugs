#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "Const.h"
#include "Team.h"
#include "TeamLinkedList.h"
#include "QuickSortTeams.h"
#include "TeamHashTable.h"


void addTeam(int debugLine, Hash_Table_Team *t, LinkedList_Team *llT)
{
  char teamName[1023];
  int index;
  Hash_Node_Team *pHN;
  for (int teamName_index = 0; teamName_index < 10; teamName_index++)
  {
    teamName[teamName_index] = new_sym_var(sizeof(char) * 8);
  }

  teamName[10 - 1] = '\0';
  index = hash_key(teamName, t->capacity);
  pHN = t->table[index];
  while (pHN)
  {
    if (!strcmp(teamName, pHN->team->name))
    {
      printf("%d Equipa existente.\n", debugLine);
      return;
    }
    else
    {
      
    }

    pHN = pHN->next;
  }

  addToTeamHashList(teamName, t, index);
  addToTeamLinkedList(llT, t->table[index]->team);
}

void findTeam(int debugLine, Hash_Table_Team *t)
{
  int index;
  char teamName[1023];
  Hash_Node_Team *pHN;
  for (int teamName_index = 0; teamName_index < 10; teamName_index++)
  {
    teamName[teamName_index] = new_sym_var(sizeof(char) * 8);
  }

  teamName[10 - 1] = '\0';
  index = hash_key(teamName, t->capacity);
  pHN = t->table[index];
  while (pHN)
  {
    if (!strcmp(teamName, pHN->team->name))
    {
      printf("%d %s %d\n", debugLine, pHN->team->name, pHN->team->gamesWon);
      return;
    }
    else
    {
      
    }

    if (pHN->next != 0)
    {
      pHN = pHN->next;
    }
    else
    {
      break;
    }

  }

  printf("%d Equipa inexistente.\n", debugLine);
}

void listTeamsMostWinsByName(int debugLine, LinkedList_Team *llT)
{
  int i;
  Team **teamsMostWins;
  List_Node_Team *lNT = llT->head;
  if (llT->maxTeamsVictories == 0)
  {
    return;
  }
  else
  {
    
  }

  teamsMostWins = malloc((sizeof(Team)) * llT->maxTeamsVictories);
  for (i = 0; i < llT->maxTeamsVictories; i++)
  {
    while (lNT)
    {
      if (lNT->team->gamesWon == llT->maxVictories)
      {
        teamsMostWins[i] = lNT->team;
        lNT = lNT->next;
        break;
      }
      else
      {
        
      }

      lNT = lNT->next;
    }

  }

  quickSortByTName(teamsMostWins, 0, llT->maxTeamsVictories - 1);
  printf("%d Melhores %d\n", debugLine, llT->maxVictories);
  for (i = 0; i < llT->maxTeamsVictories; i++)
  {
    printf("%d * %s\n", debugLine, teamsMostWins[i]->name);
  }

  free(teamsMostWins);
}

Team *teamExists(char *teamName, Hash_Table_Team *t)
{
  int index;
  Hash_Node_Team *pHN;
  index = hash_key(teamName, t->capacity);
  pHN = t->table[index];
  while (t->table[index])
  {
    if (!strcmp(teamName, pHN->team->name))
    {
      return pHN->team;
    }
    else
    {
      
    }

    if (pHN->next != 0)
    {
      pHN = pHN->next;
    }
    else
    {
      break;
    }

  }

  return 0;
}

void updateMaxVictories(LinkedList_Team *llT)
{
  List_Node_Team *lNT = llT->head;
  int maxGamesWon = 0;
  int maxTeams = 0;
  while (lNT)
  {
    if (lNT->team->gamesWon > maxGamesWon)
    {
      maxGamesWon = lNT->team->gamesWon;
      maxTeams = 1;
    }
    else
    {
      if (lNT->team->gamesWon == maxGamesWon)
      {
        maxTeams++;
      }
      else
      {
        
      }

    }

    lNT = lNT->next;
  }

  llT->maxVictories = maxGamesWon;
  llT->maxTeamsVictories = maxTeams;
}

void updateScoreValues(Team *team1, Team *team2, int score1, int score2, LinkedList_Team *ll_Teams)
{
  int maxGamesWon = 0;
  if (team1->gamesWon == ll_Teams->maxVictories)
  {
    ll_Teams->maxTeamsVictories--;
  }
  else
  {
    
  }

  if (team2->gamesWon == ll_Teams->maxVictories)
  {
    ll_Teams->maxTeamsVictories--;
  }
  else
  {
    
  }

  if (score1 > score2)
  {
    team1->gamesWon++;
  }
  else
  {
    if (score1 < score2)
    {
      team2->gamesWon++;
    }
    else
    {
      
    }

  }

  if (team1->gamesWon >= team2->gamesWon)
  {
    maxGamesWon = team1->gamesWon;
  }
  else
  {
    if (team1->gamesWon < team2->gamesWon)
    {
      maxGamesWon = team2->gamesWon;
    }
    else
    {
      
    }

  }

  if (maxGamesWon > ll_Teams->maxVictories)
  {
    ll_Teams->maxVictories = maxGamesWon;
    ll_Teams->maxTeamsVictories = 0;
  }
  else
  {
    
  }

  if (team1->gamesWon == ll_Teams->maxVictories)
  {
    ll_Teams->maxTeamsVictories++;
  }
  else
  {
    
  }

  if (team2->gamesWon == ll_Teams->maxVictories)
  {
    ll_Teams->maxTeamsVictories++;
  }
  else
  {
    
  }

}

