/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <stdlib.h>
#include "hashGame.h"


gamelink push_game(gamelink head, GAME i)
{
  gamelink aux = NEWNode_game(i, head);
  return aux;
}

gamelink remove_Game(gamelink head, gameKey k)
{
  gamelink current;
  gamelink prev;
  for (current = head, prev = 0; current; prev = current, current = current->next)
  {
    if (strcmp(k, current->GAME->Gamename) == 0)
    {
      if (current == head)
      {
        head = current->next;
      }
      else
      {
        prev->next = current->next;
      }

      DELETENode_game(current);
      return head;
    }
    else
    {
      
    }

  }

  return head;
}

GAME search_list_game(gamelink head, gameKey key)
{
  gamelink current;
  for (current = head; current; current = current->next)
  {
    if (strcmp(current->GAME->Gamename, key) == 0)
    {
      return current->GAME;
    }
    else
    {
      
    }

  }

  return 0;
}

void destroy_list_game(gamelink head)
{
  gamelink current;
  gamelink aux;
  if (!head)
  {
    return;
  }
  else
  {
    
  }

  for (current = head, aux = head->next; current; aux = current->next, DELETENode_game(current), current = aux)
  {
  }

}

gamelink *HASHinit_game(int max)
{
  int i;
  gamelink *heads = (gamelink *) malloc(max * (sizeof(gamelink)));
  for (i = 0; i < max; i++)
  {
    heads[i] = 0;
  }

  return heads;
}

int hash_game(char *v)
{
  int h;
  int a = 31415;
  int b = 27183;
  for (h = 0; (*v) != '\0'; v++, a = (a * b) % (2371 - 1))
    h = ((a * h) + (*v)) % 2371;

  return h;
}

gamelink NEWNode_game(GAME GAME, gamelink next)
{
  gamelink x = (gamelink) malloc(sizeof(struct gamenode));
  x->GAME = GAME;
  x->next = next;
  return x;
}

void DELETENode_game(gamelink gamenode)
{
  deleteGame(gamenode->GAME);
  free(gamenode);
}

void insert_game(gamelink *heads, GAME GAME)
{
  int i = hash_game(GAME->Gamename);
  heads[i] = push_game(heads[i], GAME);
}

void delete_game(gamelink *heads, gameKey k)
{
  int i = hash_game(k);
  heads[i] = remove_Game(heads[i], k);
}

GAME search_game(gamelink *heads, gameKey k)
{
  int i = hash_game(k);
  return search_list_game(heads[i], k);
}

void destroy_hash_game(gamelink *heads)
{
  int i;
  for (i = 0; i < 2371; i++)
  {
    destroy_list_game(heads[i]);
  }

  free(heads);
}

