/*File generated by PreProcessor.py*/


#include "projeto.h"


void add_equipa(equipa *table_equipas, int linha)
{
  int i;
  char nome_equipa[1024];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  if (procura_equipa(table_equipas, nome_equipa) != 0)
  {
    printf("%d Equipa existente.\n", linha);
    return;
  }
  else
  {
    
  }

  i = hash(nome_equipa, 593);
  table_equipas[i] = insere_equipa(&table_equipas[i], nome_equipa);
  return;
}

equipa procura_equipa(equipa *table_equipas, char *nome_equipa)
{
  int i;
  i = hash(nome_equipa, 593);
  return searchList(table_equipas[i], nome_equipa);
}

equipa searchList(equipa head, char *nome_equipa)
{
  equipa aux;
  aux = head;
  while (aux != 0)
  {
    if (strcmp(aux->nome, nome_equipa) == 0)
    {
      return aux;
    }
    else
    {
      
    }

    aux = aux->next;
  }

  return 0;
}

equipa insere_equipa(equipa *head, char *nome_equipa)
{
  equipa novo = (equipa) malloc(sizeof(struct str_equipa));
  novo->nome = (char *) malloc((sizeof(char)) * (strlen(nome_equipa) + 1));
  strcpy(novo->nome, nome_equipa);
  novo->jogos_ganhos = (int *) malloc(sizeof(int));
  *novo->jogos_ganhos = 0;
  novo->next = *head;
  return novo;
}

void print_equipa(equipa *table_equipas, int linha)
{
  equipa equipa;
  char nome_buf[1024];
  for (int nome_buf_index = 0; nome_buf_index < 10; nome_buf_index++)
  {
    nome_buf[nome_buf_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_buf[10 - 1] = '\0';
  equipa = procura_equipa(table_equipas, nome_buf);
  if (equipa == 0)
  {
    printf("%d Equipa inexistente.\n", linha);
  }
  else
  {
    printf("%d %s %d\n", linha, equipa->nome, *equipa->jogos_ganhos);
  }

}

void mais_vitorias(equipa *table_equipas, int linha)
{
  int i;
  int max = 0;
  int num = 0;
  equipa aux;
  for (i = 0; i < 593; i++)
  {
    for (aux = table_equipas[i]; aux != 0; aux = aux->next)
    {
      if ((*aux->jogos_ganhos) == max)
      {
        num++;
      }
      else
      {
        if ((*aux->jogos_ganhos) > max)
        {
          num = 1;
          max = *aux->jogos_ganhos;
        }
        else
        {
          
        }

      }

    }

  }

  if (num != 0)
  {
    cria_e_ordena_vetor(table_equipas, max, num, linha);
  }
  else
  {
    
  }

}

void cria_e_ordena_vetor(equipa *table_equipas, int max, int num, int linha)
{
  char **vetor;
  int i;
  int j = 0;
  equipa aux;
  vetor = (char **) malloc((sizeof(char *)) * num);
  for (i = 0; i < 593; i++)
  {
    for (aux = table_equipas[i]; aux != 0; aux = aux->next)
    {
      if ((*aux->jogos_ganhos) == max)
      {
        vetor[j] = aux->nome;
        j++;
      }
      else
      {
        
      }

    }

  }

  qsort(vetor, num, sizeof(char *), compara_strings);
  printf("%d Melhores %d\n", linha, max);
  for (j = 0; j < num; j++)
  {
    printf("%d * %s\n", linha, vetor[j]);
  }

  free(vetor);
}

int compara_strings(const void *a, const void *b)
{
  const char **ia = (const char **) a;
  const char **ib = (const char **) b;
  return strcmp(*ia, *ib);
}

