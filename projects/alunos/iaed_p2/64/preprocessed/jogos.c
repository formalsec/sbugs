#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include "projeto.h"


void add_jogo(equipa *table_equipas, jogo *table_jogos, jogo *head, jogo *tail, int linha)
{
  char nome_jogo[1024];
  char nome_equipa1[1024];
  char nome_equipa2[1024];
  int score1 = 0;
  int score2 = 0;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int nome_equipa1_index = 0; nome_equipa1_index < 10; nome_equipa1_index++)
  {
    nome_equipa1[nome_equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa1[10 - 1] = '\0';
  for (int nome_equipa2_index = 0; nome_equipa2_index < 10; nome_equipa2_index++)
  {
    nome_equipa2[nome_equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if (procura_jogo(table_jogos, nome_jogo) != 0)
  {
    printf("%d Jogo existente.\n", linha);
    return;
  }
  else
  {
    
  }

  if ((procura_equipa(table_equipas, nome_equipa1) == 0) || (procura_equipa(table_equipas, nome_equipa2) == 0))
  {
    printf("%d Equipa inexistente.\n", linha);
    return;
  }
  else
  {
    
  }

  add_jogo_hash(table_jogos, table_equipas, nome_jogo, nome_equipa1, nome_equipa2, score1, score2);
  add_jogo_lista(head, tail, table_jogos, nome_jogo);
}

void add_jogo_hash(jogo *table_jogos, equipa *table_equipas, char *nome_jogo, char *nome_equipa1, char *nome_equipa2, int score1, int score2)
{
  int i;
  i = hash(nome_jogo, 997);
  table_jogos[i] = insere_jogo(&table_jogos[i], table_equipas, nome_jogo, nome_equipa1, nome_equipa2, score1, score2);
  return;
}

jogo insere_jogo(jogo *head, equipa *table_equipas, char *nome_jogo, char *nome_equipa1, char *nome_equipa2, int score1, int score2)
{
  jogo novo = (jogo) malloc(sizeof(struct str_jogo));
  novo->nome = (char *) malloc((sizeof(char)) * (strlen(nome_jogo) + 1));
  strcpy(novo->nome, nome_jogo);
  novo->equipa1 = procura_equipa(table_equipas, nome_equipa1);
  novo->equipa2 = procura_equipa(table_equipas, nome_equipa2);
  if (score1 > score2)
  {
    (*novo->equipa1->jogos_ganhos)++;
  }
  else
  {
    if (score2 > score1)
    {
      (*novo->equipa2->jogos_ganhos)++;
    }
    else
    {
      
    }

  }

  novo->score1 = (int *) malloc(sizeof(int));
  *novo->score1 = score1;
  novo->score2 = (int *) malloc(sizeof(int));
  *novo->score2 = score2;
  novo->next = *head;
  return novo;
}

void add_jogo_lista(jogo *head, jogo *tail, jogo *table_jogos, char *nome_jogo)
{
  jogo novo;
  novo = procura_jogo(table_jogos, nome_jogo);
  novo->next_lista = 0;
  if ((*head) == 0)
  {
    *tail = novo;
    *head = novo;
    return;
  }
  else
  {
    
  }

  (*tail)->next_lista = novo;
  *tail = novo;
}

jogo procura_jogo(jogo *table_jogos, char *nome_jogo)
{
  int i;
  i = hash(nome_jogo, 997);
  return searchList_jogo(table_jogos[i], nome_jogo);
}

jogo searchList_jogo(jogo head, char *nome_jogo)
{
  jogo aux;
  aux = head;
  while (aux != 0)
  {
    if (strcmp(aux->nome, nome_jogo) == 0)
    {
      return aux;
    }
    else
    {
      
    }

    aux = aux->next;
  }

  return 0;
}

void print(jogo head, int linha)
{
  jogo first = head;
  while (first != 0)
  {
    printf("%d %s %s %s %d %d\n", linha, first->nome, first->equipa1->nome, first->equipa2->nome, *first->score1, *first->score2);
    first = first->next_lista;
  }

}

void print_jogo(jogo *table_jogos, int linha)
{
  jogo jogo;
  char nome_jogo[1024];
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  jogo = procura_jogo(table_jogos, nome_jogo);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", linha);
  }
  else
  {
    printf("%d %s %s %s %d %d\n", linha, jogo->nome, jogo->equipa1->nome, jogo->equipa2->nome, *jogo->score1, *jogo->score2);
  }

}

void altera_score(jogo *table_jogos, int linha)
{
  char nome_jogo[1024];
  int score1 = 0;
  int score2 = 0;
  jogo jogo;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  jogo = procura_jogo(table_jogos, nome_jogo);
  if (jogo == 0)
  {
    printf("%d Jogo inexistente.\n", linha);
    return;
  }
  else
  {
    
  }

  if ((*jogo->score1) > (*jogo->score2))
  {
    if (score1 <= score2)
    {
      (*jogo->equipa1->jogos_ganhos)--;
      if (score1 < score2)
      {
        (*jogo->equipa2->jogos_ganhos)++;
      }
      else
      {
        
      }

    }
    else
    {
      
    }

  }
  else
  {
    if ((*jogo->score1) < (*jogo->score2))
    {
      if (score1 >= score2)
      {
        (*jogo->equipa2->jogos_ganhos)--;
        if (score1 > score2)
        {
          (*jogo->equipa1->jogos_ganhos)++;
        }
        else
        {
          
        }

      }
      else
      {
        
      }

    }
    else
    {
      if (score1 > score2)
      {
        (*jogo->equipa1->jogos_ganhos)++;
      }
      else
      {
        if (score1 < score2)
        {
          (*jogo->equipa2->jogos_ganhos)++;
        }
        else
        {
          
        }

      }

    }

  }

  *jogo->score1 = score1;
  *jogo->score2 = score2;
  return;
}

void remove_jogo(jogo *head, jogo *tail, jogo *table_jogos, int linha)
{
  char nome_jogo[1024];
  jogo aux;
  jogo prev;
  jogo teste;
  int i;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  teste = procura_jogo(table_jogos, nome_jogo);
  if (teste == 0)
  {
    printf("%d Jogo inexistente.\n", linha);
    return;
  }
  else
  {
    
  }

  if ((*teste->score1) > (*teste->score2))
  {
    (*teste->equipa1->jogos_ganhos)--;
  }
  else
  {
    if ((*teste->score1) < (*teste->score2))
    {
      (*teste->equipa2->jogos_ganhos)--;
    }
    else
    {
      
    }

  }

  for (aux = *head, prev = 0; aux != 0; prev = aux, aux = aux->next_lista)
  {
    if (strcmp(aux->nome, nome_jogo) == 0)
    {
      if ((aux == (*head)) && (aux == (*tail)))
      {
        *head = 0;
        *tail = 0;
      }
      else
      {
        if (aux == (*head))
        {
          *head = aux->next_lista;
        }
        else
        {
          if (aux == (*tail))
          {
            *tail = prev;
            (*tail)->next_lista = 0;
          }
          else
          {
            prev->next_lista = aux->next_lista;
          }

        }

      }

    }
    else
    {
      
    }

  }

  i = hash(nome_jogo, 997);
  table_jogos[i] = remove_jogo_hash(table_jogos[i], nome_jogo);
}

jogo remove_jogo_hash(jogo head, char *nome_jogo)
{
  jogo aux;
  jogo prev;
  for (aux = head, prev = 0; aux != 0; prev = aux, aux = aux->next)
  {
    if (strcmp(aux->nome, nome_jogo) == 0)
    {
      if (aux == head)
      {
        head = aux->next;
      }
      else
      {
        prev->next = aux->next;
      }

      free(aux->nome);
      free(aux->score1);
      free(aux->score2);
      free(aux);
      return head;
    }
    else
    {
      
    }

  }

  return head;
}

