/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "comandos.h"


void comando_a(int linha, jlink *hash_jogos, elink *hash_equipas, Lista_Jogos lista)
{
  Jogo jogo = malloc(sizeof(struct jogo));
  Equipa equipa1;
  Equipa equipa2;
  char nome_jogo[1024];
  char eq1_nome[1024];
  char eq2_nome[1024];
  int res1;
  int res2;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  for (int eq1_nome_index = 0; eq1_nome_index < 10; eq1_nome_index++)
  {
    eq1_nome[eq1_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  eq1_nome[10 - 1] = '\0';
  for (int eq2_nome_index = 0; eq2_nome_index < 10; eq2_nome_index++)
  {
    eq2_nome[eq2_nome_index] = new_sym_var(sizeof(char) * 8);
  }

  eq2_nome[10 - 1] = '\0';
  res1 = new_sym_var(sizeof(int) * 8);
  res2 = new_sym_var(sizeof(int) * 8);
  if (!existe_jogo(hash_jogos, nome_jogo))
  {
    equipa1 = procura_equipa(hash_equipas, eq1_nome);
    if (equipa1 == 0)
    {
      free(jogo);
      printf("%d Equipa inexistente.\n", linha);
      return;
    }
    else
    {
      equipa2 = procura_equipa(hash_equipas, eq2_nome);
      if (equipa2 == 0)
      {
        free(jogo);
        printf("%d Equipa inexistente.\n", linha);
        return;
      }
      else
      {
        
      }

    }

    if (res1 > res2)
    {
      jogo->vencedora = equipa1;
      equipa1->total_ganhos++;
    }
    else
    {
      if (res1 < res2)
      {
        jogo->vencedora = equipa2;
        equipa2->total_ganhos++;
      }
      else
      {
        jogo->vencedora = 0;
      }

    }

    jogo->nome = malloc((sizeof(char)) * (strlen(nome_jogo) + 1));
    jogo->nome = strcpy(jogo->nome, nome_jogo);
    jogo->eq1 = equipa1;
    jogo->eq2 = equipa2;
    jogo->res1 = res1;
    jogo->res2 = res2;
    adiciona_jogo(hash_jogos, lista, jogo);
  }
  else
  {
    free(jogo);
    printf("%d Jogo existente.\n", linha);
  }

}

void comando_A(int linha, elink *hash_equipas)
{
  char nome_equipa[1024];
  Equipa equipa = malloc(sizeof(struct equipa));
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  equipa->nome = malloc((sizeof(char)) * (strlen(nome_equipa) + 1));
  strcpy(equipa->nome, nome_equipa);
  equipa->total_ganhos = 0;
  if (!existe_equipa(hash_equipas, equipa->nome))
  {
    adiciona_equipa(hash_equipas, equipa);
  }
  else
  {
    printf("%d Equipa existente.\n", linha);
    FREEequipa(equipa);
  }

}

void comando_l(int linha, Lista_Jogos lista)
{
  jog_lig x = lista->primeiro;
  if (lista->primeiro == 0)
  {
    return;
  }
  else
  {
    
  }

  while (x != lista->ultimo)
  {
    printf("%d %s %s %s %d %d\n", linha, x->jogo->nome, x->jogo->eq1->nome, x->jogo->eq2->nome, x->jogo->res1, x->jogo->res2);
    x = x->seguinte;
  }

  printf("%d %s %s %s %d %d\n", linha, x->jogo->nome, x->jogo->eq1->nome, x->jogo->eq2->nome, x->jogo->res1, x->jogo->res2);
}

void comando_p(int linha, jlink *hash_jogos)
{
  char nome_jogo[1024];
  Jogo jogo;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  jogo = procura_jogo(hash_jogos, nome_jogo);
  if (jogo != 0)
  {
    printf("%d %s %s %s %d %d\n", linha, jogo->nome, jogo->eq1->nome, jogo->eq2->nome, jogo->res1, jogo->res2);
  }
  else
  {
    printf("%d Jogo inexistente.\n", linha);
  }

}

void comando_P(int linha, elink *hash_equipas)
{
  char nome_equipa[1024];
  Equipa equipa;
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  equipa = procura_equipa(hash_equipas, nome_equipa);
  if (equipa != 0)
  {
    printf("%d %s %d\n", linha, equipa->nome, equipa->total_ganhos);
  }
  else
  {
    printf("%d Equipa inexistente.\n", linha);
  }

}

void comando_r(int linha, jlink *hash_jogos, Lista_Jogos lista)
{
  char nome_jogo[1024];
  Jogo x;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  x = procura_jogo(hash_jogos, nome_jogo);
  if (x != 0)
  {
    if (x->vencedora != 0)
    {
      x->vencedora->total_ganhos--;
    }
    else
    {
      
    }

    remove_jogo(hash_jogos, lista, x);
  }
  else
  {
    printf("%d Jogo inexistente.\n", linha);
  }

}

void comando_s(int linha, jlink *hash_jogos)
{
  char nome_jogo[1024];
  int novo_1;
  int novo_2;
  Jogo x;
  for (int nome_jogo_index = 0; nome_jogo_index < 10; nome_jogo_index++)
  {
    nome_jogo[nome_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_jogo[10 - 1] = '\0';
  novo_1 = new_sym_var(sizeof(int) * 8);
  novo_2 = new_sym_var(sizeof(int) * 8);
  if ((novo_1 < 0) || (novo_2 < 0))
  {
    return;
  }
  else
  {
    
  }

  x = procura_jogo(hash_jogos, nome_jogo);
  if (x != 0)
  {
    x->res1 = novo_1;
    x->res2 = novo_2;
    if (x->vencedora != 0)
    {
      x->vencedora->total_ganhos--;
    }
    else
    {
      
    }

    if (novo_1 > novo_2)
    {
      x->vencedora = x->eq1;
      x->vencedora->total_ganhos++;
    }
    else
    {
      if (novo_1 < novo_2)
      {
        x->vencedora = x->eq2;
        x->vencedora->total_ganhos++;
      }
      else
      {
        x->vencedora = 0;
      }

    }

  }
  else
  {
    printf("%d Jogo inexistente.\n", linha);
  }

}

void comando_g(int linha, elink *hash_equipas)
{
  int i;
  int max_ganhos = 0;
  Lista_Equipas lista = init_lista_eq();
  max_ganhos = calcula_max_ganhos(hash_equipas, max_ganhos);
  for (i = 0; i < 1657; i++)
  {
    obter_equipas(hash_equipas[i], lista, max_ganhos);
  }

  print_lista_eq(lista, linha, max_ganhos);
  destroi_eq_ligadas(lista);
}

