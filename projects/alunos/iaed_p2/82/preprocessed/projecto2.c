/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>


typedef struct jogo
{
  char nome[1023];
  char equipa1[1023];
  char equipa2[1023];
  int score1;
  int score2;
} Jogo;
Jogo jogos[1000];
char equipas[1000][1023];
int NL = 0;
void nova_equipa();
void novo_jogo();
int existe_equipa(char equipa[1023]);
int existe_jogo(char nome[1023]);
void lista_jogos();
void apaga_jogo();
void altera_score();
void procura_jogo();
void procura_equipa();
int n_jogos_ganhos(char equipa[1023]);
void lista_melhores();
int main()
{
  int i;
  char comando;
  Jogo jogo_vazio = {"?", "?", "?", -1, -1};
  for (i = 0; i < 1000; i++)
  {
    strcpy(equipas[i], "?");
  }

  for (i = 0; i < 1000; i++)
  {
    jogos[i] = jogo_vazio;
  }

  do
  {
    switch (comando = getchar())
    {
      case 'A':
        NL++;
        nova_equipa();
        break;

      case 'a':
        NL++;
        novo_jogo();
        break;

      case 'l':
        NL++;
        lista_jogos();
        break;

      case 'r':
        NL++;
        apaga_jogo();
        break;

      case 's':
        NL++;
        altera_score();
        break;

      case 'p':
        NL++;
        procura_jogo();
        break;

      case 'P':
        NL++;
        procura_equipa();
        break;

      case 'g':
        NL++;
        lista_melhores();
        break;

      case 'e':
        printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
        for (i = 0; i < 5; i++)
        printf("%s\n", equipas[i]);

        printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
        break;

      case 'j':
        printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
        for (i = 0; i < 5; i++)
        printf("%s %s %s %d %d\n", jogos[i].nome, jogos[i].equipa1, jogos[i].equipa2, jogos[i].score1, jogos[i].score2);

        printf("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n");
        break;

    }

  }
  while (comando != 'x');
  return 0;
}

void nova_equipa()
{
  int i;
  char nova_equipa[1023];
  for (int nova_equipa_index = 0; nova_equipa_index < 10; nova_equipa_index++)
  {
    nova_equipa[nova_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nova_equipa[10 - 1] = '\0';
  if (existe_equipa(nova_equipa) == 1)
  {
    printf("%d Equipa existente.\n", NL);
    return;
  }
  else
  {
    for (i = 0; i < 1000; i++)
    {
      if (strcmp(equipas[i], "?") == 0)
      {
        strcpy(equipas[i], nova_equipa);
        return;
      }
      else
      {
        
      }

    }

  }

}

void novo_jogo()
{
  int i;
  Jogo novo_jogo;
  for (int novo_jogo_index = 0; novo_jogo_index < 10; novo_jogo_index++)
  {
    novo_jogo.nome[novo_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  novo_jogo.nome[10 - 1] = '\0';
  for (int novo_jogo_index = 0; novo_jogo_index < 10; novo_jogo_index++)
  {
    novo_jogo.equipa1[novo_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  novo_jogo.equipa1[10 - 1] = '\0';
  for (int novo_jogo_index = 0; novo_jogo_index < 10; novo_jogo_index++)
  {
    novo_jogo.equipa2[novo_jogo_index] = new_sym_var(sizeof(char) * 8);
  }

  novo_jogo.equipa2[10 - 1] = '\0';
  novo_jogo.score1 = new_sym_var(sizeof(int) * 8);
  novo_jogo.score2 = new_sym_var(sizeof(int) * 8);
  if (existe_jogo(novo_jogo.nome) == 1)
  {
    printf("%d Jogo existente.\n", NL);
    return;
  }
  else
  {
    
  }

  if ((existe_equipa(novo_jogo.equipa1) == 0) || (existe_equipa(novo_jogo.equipa2) == 0))
  {
    printf("%d Equipa inexistente.\n", NL);
    return;
  }
  else
  {
    
  }

  for (i = 0; i < 1000; i++)
  {
    if (strcmp(jogos[i].nome, "?") == 0)
    {
      jogos[i] = novo_jogo;
      return;
    }
    else
    {
      
    }

  }

}

int existe_equipa(char equipa[1023])
{
  int i;
  for (i = 0; strcmp(equipas[i], "?") != 0; i++)
  {
    if (strcmp(equipas[i], equipa) == 0)
    {
      return 1;
    }
    else
    {
      
    }

  }

  return 0;
}

int existe_jogo(char nome[1023])
{
  int i;
  for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
  {
    if (strcmp(jogos[i].nome, nome) == 0)
    {
      return 1;
    }
    else
    {
      
    }

  }

  return 0;
}

void lista_jogos()
{
  int i;
  for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
  {
    printf("%d %s %s %s %d %d\n", NL, jogos[i].nome, jogos[i].equipa1, jogos[i].equipa2, jogos[i].score1, jogos[i].score2);
  }

}

void apaga_jogo()
{
  int i;
  int e;
  char nome[1023];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (existe_jogo(nome) == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
    return;
  }
  else
  {
    for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
    {
      if (strcmp(jogos[i].nome, nome) == 0)
      {
        for (e = i; strcmp(jogos[e].nome, "?") != 0; e++)
        {
          jogos[e] = jogos[e + 1];
        }

        return;
      }
      else
      {
        
      }

    }

  }

}

void altera_score()
{
  int i;
  int score1_novo;
  int score2_novo;
  char nome[1023];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1_novo = new_sym_var(sizeof(int) * 8);
  score2_novo = new_sym_var(sizeof(int) * 8);
  if (existe_jogo(nome) == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
    return;
  }
  else
  {
    for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
    {
      if (strcmp(jogos[i].nome, nome) == 0)
      {
        jogos[i].score1 = score1_novo;
        jogos[i].score2 = score2_novo;
        return;
      }
      else
      {
        
      }

    }

  }

}

void procura_jogo()
{
  int i;
  char nome[1023];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (existe_jogo(nome) == 0)
  {
    printf("%d Jogo inexistente.\n", NL);
  }
  else
  {
    for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
    {
      if (strcmp(jogos[i].nome, nome) == 0)
      {
        printf("%d %s %s %s %d %d\n", NL, jogos[i].nome, jogos[i].equipa1, jogos[i].equipa2, jogos[i].score1, jogos[i].score2);
        return;
      }
      else
      {
        
      }

    }

  }

}

void procura_equipa()
{
  int i;
  int jogos_ganhos = 0;
  char nome_equipa[1023];
  for (int nome_equipa_index = 0; nome_equipa_index < 10; nome_equipa_index++)
  {
    nome_equipa[nome_equipa_index] = new_sym_var(sizeof(char) * 8);
  }

  nome_equipa[10 - 1] = '\0';
  if (existe_equipa(nome_equipa) == 0)
  {
    printf("%d Equipa inexistente.\n", NL);
  }
  else
  {
    for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
    {
      if ((strcmp(jogos[i].equipa1, nome_equipa) == 0) && (jogos[i].score1 > jogos[i].score2))
      {
        jogos_ganhos++;
      }
      else
      {
        
      }

      if ((strcmp(jogos[i].equipa2, nome_equipa) == 0) && (jogos[i].score2 > jogos[i].score1))
      {
        jogos_ganhos++;
      }
      else
      {
        
      }

    }

    printf("%d %s %d\n", NL, nome_equipa, jogos_ganhos);
  }

}

int n_jogos_ganhos(char equipa[1023])
{
  int i;
  int jogos_ganhos = 0;
  for (i = 0; strcmp(jogos[i].nome, "?") != 0; i++)
  {
    if ((strcmp(jogos[i].equipa1, equipa) == 0) && (jogos[i].score1 > jogos[i].score2))
    {
      jogos_ganhos++;
    }
    else
    {
      
    }

    if ((strcmp(jogos[i].equipa2, equipa) == 0) && (jogos[i].score2 > jogos[i].score1))
    {
      jogos_ganhos++;
    }
    else
    {
      
    }

  }

  return jogos_ganhos;
}

void lista_melhores()
{
  int i;
  int e = 0;
  int n = 0;
  int contador = 0;
  char melhores[1000][1023];
  char temp[1023];
  if (strcmp(equipas[0], "?") != 0)
  {
    for (i = 0; i < 1000; i++)
    {
      strcpy(melhores[i], "?");
    }

    for (i = 0; strcmp(equipas[i], "?") != 0; i++)
    {
      if (n_jogos_ganhos(equipas[i]) > n)
      {
        n = n_jogos_ganhos(equipas[i]);
      }
      else
      {
        
      }

    }

    for (i = 0; strcmp(equipas[i], "?") != 0; i++)
    {
      if (n_jogos_ganhos(equipas[i]) == n)
      {
        strcpy(melhores[e], equipas[i]);
        e++;
      }
      else
      {
        
      }

    }

    for (i = 0; strcmp(melhores[i], "?") != 0; i++)
    {
      contador++;
    }

    for (i = 0; i < contador; i++)
    {
      for (e = i + 1; e < contador; e++)
      {
        if (strcmp(melhores[i], melhores[e]) > 0)
        {
          strcpy(temp, melhores[i]);
          strcpy(melhores[i], melhores[e]);
          strcpy(melhores[e], temp);
        }
        else
        {
          
        }

      }

    }

    printf("%d Melhores %d\n", NL, n);
    for (i = 0; strcmp(melhores[i], "?") != 0; i++)
    {
      printf("%d * %s\n", NL, melhores[i]);
    }

  }
  else
  {
    
  }

}

