#include "/home/fmarques/sbugs/projects/alunos/lib/stubs.h"
/*File generated by PreProcessor.py*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "geral.h"
#include "structs.h"


void a(int cont, table_eq tab_eq, table_jogos tab_j, listagem lst)
{
  char nome[1024];
  char equipa1[1024];
  char equipa2[1024];
  int score1;
  int score2;
  pJogo match;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  for (int equipa1_index = 0; equipa1_index < 10; equipa1_index++)
  {
    equipa1[equipa1_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa1[10 - 1] = '\0';
  for (int equipa2_index = 0; equipa2_index < 10; equipa2_index++)
  {
    equipa2[equipa2_index] = new_sym_var(sizeof(char) * 8);
  }

  equipa2[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if (SearchJogo(nome, tab_j))
  {
    printf("%d Jogo existente.\n", cont);
    return;
  }
  else
  {
    
  }

  if ((SearchEquipa(equipa1, tab_eq) == 0) || (SearchEquipa(equipa2, tab_eq) == 0))
  {
    printf("%d Equipa inexistente.\n", cont);
    return;
  }
  else
  {
    
  }

  match = cria_jogo(nome, equipa1, equipa2, score1, score2, tab_eq);
  add_last(lst, match);
  InsertJogo(match, tab_j);
}

void l(int cont, listagem lst)
{
  pJogo temp;
  temp = lst->head;
  while (temp != 0)
  {
    printf("%d %s %s", cont, temp->nome, temp->equipa1);
    printf(" %s %d %d\n", temp->equipa2, temp->score1, temp->score2);
    temp = temp->next;
  }

}

void p(int cont, table_jogos tab_j)
{
  char nome[1024];
  pJogo match;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (SearchJogo(nome, tab_j) == 0)
  {
    printf("%d Jogo inexistente.\n", cont);
    return;
  }
  else
  {
    
  }

  match = SearchJogo(nome, tab_j);
  printf("%d %s %s ", cont, nome, match->equipa1);
  printf("%s %d %d\n", match->equipa2, match->score1, match->score2);
}

void r(int cont, table_jogos tab_j, table_eq tab_eq, listagem lst)
{
  char nome[1024];
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (SearchJogo(nome, tab_j) == 0)
  {
    printf("%d Jogo inexistente.\n", cont);
    return;
  }
  else
  {
    
  }

  if (SearchJogo(nome, tab_j)->winner != 0)
  {
    SearchEquipa(SearchJogo(nome, tab_j)->winner, tab_eq)->vitorias--;
  }
  else
  {
    
  }

  delete_jogo_lst(lst, SearchJogo(nome, tab_j));
  DeleteJogoHash(nome, tab_j);
}

void s(int cont, table_jogos tab_j, table_eq tab_eq)
{
  char nome[1024];
  char *old_winner = 0;
  pJogo match;
  int score1;
  int score2;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  score1 = new_sym_var(sizeof(int) * 8);
  score2 = new_sym_var(sizeof(int) * 8);
  if (SearchJogo(nome, tab_j) == 0)
  {
    printf("%d Jogo inexistente.\n", cont);
    return;
  }
  else
  {
    
  }

  match = SearchJogo(nome, tab_j);
  if (match->winner != 0)
  {
    old_winner = malloc(((sizeof(char)) * strlen(match->winner)) + 1);
    strcpy(old_winner, match->winner);
  }
  else
  {
    
  }

  Change_Score(match, score1, score2);
  Change_Wins(match, tab_eq, old_winner);
  free(old_winner);
}

void A(int cont, table_eq tab_eq)
{
  char nome[1024];
  Equipas equipa;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (SearchEquipa(nome, tab_eq))
  {
    printf("%d Equipa existente.\n", cont);
    return;
  }
  else
  {
    
  }

  equipa = cria_equipa(nome);
  InsertEquipa(equipa, tab_eq);
}

void P(int cont, table_eq tab_eq)
{
  char nome[1024];
  int wins;
  for (int nome_index = 0; nome_index < 10; nome_index++)
  {
    nome[nome_index] = new_sym_var(sizeof(char) * 8);
  }

  nome[10 - 1] = '\0';
  if (SearchEquipa(nome, tab_eq) == 0)
  {
    printf("%d Equipa inexistente.\n", cont);
    cont++;
    return;
  }
  else
  {
    
  }

  wins = SearchEquipa(nome, tab_eq)->vitorias;
  printf("%d %s %d\n", cont, nome, wins);
}

int my_strcmp(const void *a, const void *b)
{
  char **v1;
  char **v2;
  v1 = (char **) a;
  v2 = (char **) b;
  return strcmp(*v1, *v2);
}

void g(int cont, table_eq tab_eq)
{
  int i;
  int j = 0;
  int max_wins = 0;
  int nr_eq = 0;
  char **vetor;
  Node_eq temp = 0;
  for (i = 0; i < tab_eq->M; i++)
  {
    temp = tab_eq->heads[i];
    while (temp != 0)
    {
      if (temp->equipa->vitorias == max_wins)
      {
        nr_eq++;
      }
      else
      {
        
      }

      if (temp->equipa->vitorias > max_wins)
      {
        max_wins = temp->equipa->vitorias;
        nr_eq = 1;
      }
      else
      {
        
      }

      temp = temp->next;
    }

  }

  if (nr_eq == 0)
  {
    return;
  }
  else
  {
    
  }

  vetor = (char **) malloc((sizeof(char *)) * nr_eq);
  for (i = 0; (i < tab_eq->M) && (j != nr_eq); i++)
  {
    temp = tab_eq->heads[i];
    while (temp != 0)
    {
      if (temp->equipa->vitorias == max_wins)
      {
        vetor[j] = malloc(((sizeof(char)) * strlen(temp->equipa->nome)) + 1);
        strcpy(vetor[j], temp->equipa->nome);
        j++;
      }
      else
      {
        
      }

      temp = temp->next;
    }

  }

  qsort(vetor, nr_eq, sizeof(char *), my_strcmp);
  printf("%d Melhores %d\n", cont, max_wins);
  for (i = 0; (i < nr_eq) && (vetor[i] != 0); i++)
  {
    printf("%d * %s\n", cont, vetor[i]);
  }

  for (i = 0; i < nr_eq; i++)
  {
    free(vetor[i]);
  }

  free(vetor);
}

